[{
"title":"æ’åºç®—æ³•æ€»ç»“",
"permalink": "http://localhost:1313/posts/datastructalgorithm/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/",
"summary": "æ€»ç»“â€”â€”æ‰€æœ‰å¸¸è§æ’åºç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ã€æ—¶é—´å¤æ‚åº¦ã€ç©ºé—´å¤æ‚åº¦ã€ç¨³å®šæ€§ã€æ˜¯å¦åŸåœ°æ’åºã€é€‚ç”¨åœºæ™¯å’Œç®€å•ä¾‹å­ã€‚ ä¸‹é¢æ˜¯æœ€å…¨é¢ä¸”é¢è¯•å¯¼å‘çš„æ€»ç»“ç‰ˆæœ¬ğŸ‘‡\nğŸ§  æ’åºç®—æ³•æ€»è§ˆè¡¨ ç®—æ³• æ€æƒ³ æ—¶é—´å¤æ‚åº¦ ç©ºé—´å¤æ‚åº¦ ç¨³å®šæ€§ åŸåœ°æ’åº é€‚ç”¨åœºæ™¯ å†’æ³¡æ’åº (Bubble Sort) ç›¸é‚»äº¤æ¢ï¼Œæœ€å¤§ï¼ˆæˆ–æœ€å°ï¼‰å…ƒç´ é€æ­¥â€œæµ®å‡ºâ€ O(nÂ²) O(1) âœ… ç¨³å®š âœ… æ•°æ®é‡å°ã€éƒ¨åˆ†æœ‰åº é€‰æ‹©æ’åº (Selection Sort) æ¯æ¬¡é€‰æ‹©æœ€å°å…ƒç´ æ”¾åˆ°å‰é¢ O(nÂ²) O(1) âŒ ä¸ç¨³å®š âœ… æ•°æ®é‡å°ï¼Œå¯¹äº¤æ¢æ¬¡æ•°æ•æ„Ÿ æ’å…¥æ’åº (Insertion Sort) å°†æœªæ’åºå…ƒç´ æ’å…¥åˆ°å·²æ’åºåºåˆ—ä¸­ O(nÂ²) O(1) âœ… ç¨³å®š âœ… æ•°æ®åŸºæœ¬æœ‰åºæ—¶é«˜æ•ˆ å¸Œå°”æ’åº (Shell Sort) æ’å…¥æ’åºçš„æ”¹è¿›ç‰ˆï¼Œåˆ†ç»„æ¯”è¾ƒå‡å°‘äº¤æ¢ O(nÂ¹Ë™Â³~nÂ²) O(1) âŒ ä¸ç¨³å®š âœ… ä¸­ç­‰è§„æ¨¡æ•°æ® å½’å¹¶æ’åº (Merge Sort) åˆ†æ²» + åˆå¹¶æœ‰åºå­åºåˆ— O(n log n) O(n) âœ… ç¨³å®š âŒ å¤§æ•°æ®ã€å¤–éƒ¨æ’åº å¿«é€Ÿæ’åº (Quick Sort) åˆ†æ²» + åŸºå‡†åˆ’åˆ† å¹³å‡ O(n log n)æœ€å O(nÂ²) O(log n) âŒ ä¸ç¨³å®š âœ… é€šç”¨æœ€å¿«çš„å†…éƒ¨æ’åº å †æ’åº (Heap Sort) åˆ©ç”¨å †ç»“æ„ç»´æŠ¤æœ€å¤§/æœ€å°å€¼ O(n log n) O(1) âŒ ä¸ç¨³å®š âœ… éœ€è¦å¿«é€Ÿæ‰¾æœ€å¤§/æœ€å°çš„åœºæ™¯ è®¡æ•°æ’åº (Counting Sort) ç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‡ºç°æ¬¡æ•° O(n + k) O(n + k) âœ… ç¨³å®š âŒ æ•´æ•°ã€èŒƒå›´è¾ƒå°çš„åœºæ™¯ æ¡¶æ’åº (Bucket Sort) æŒ‰åŒºé—´åˆ’åˆ†å¤šä¸ªæ¡¶å†åˆ†åˆ«æ’åº O(n + k) O(n + k) âœ… ç¨³å®šï¼ˆè§†å­æ’åºï¼‰ âŒ æ•°æ®å‡åŒ€åˆ†å¸ƒçš„æµ®ç‚¹æ•° åŸºæ•°æ’åº (Radix Sort) æŒ‰ä½ï¼ˆä¸ªä½â†’é«˜ä½ï¼‰æ’åº O(dÂ·(n+k)) O(n + k) âœ… ç¨³å®š âŒ æ•´æ•°ã€å­—ç¬¦ä¸²æ’åº ğŸ” å„ç®—æ³•æ ¸å¿ƒæ€æƒ³è®²è§£ä¸ä»£ç ç¤ºä¾‹ 1ï¸âƒ£ å†’æ³¡æ’åº Bubble Sort æ¯ä¸€è½®ä¸¤ä¸¤æ¯”è¾ƒï¼ŒæŠŠæœ€å¤§å€¼â€œå†’æ³¡â€åˆ°æœ€åã€‚\n",
"content": "æ€»ç»“â€”â€”æ‰€æœ‰å¸¸è§æ’åºç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ã€æ—¶é—´å¤æ‚åº¦ã€ç©ºé—´å¤æ‚åº¦ã€ç¨³å®šæ€§ã€æ˜¯å¦åŸåœ°æ’åºã€é€‚ç”¨åœºæ™¯å’Œç®€å•ä¾‹å­ã€‚ ä¸‹é¢æ˜¯æœ€å…¨é¢ä¸”é¢è¯•å¯¼å‘çš„æ€»ç»“ç‰ˆæœ¬ğŸ‘‡\nğŸ§  æ’åºç®—æ³•æ€»è§ˆè¡¨ ç®—æ³• æ€æƒ³ æ—¶é—´å¤æ‚åº¦ ç©ºé—´å¤æ‚åº¦ ç¨³å®šæ€§ åŸåœ°æ’åº é€‚ç”¨åœºæ™¯ å†’æ³¡æ’åº (Bubble Sort) ç›¸é‚»äº¤æ¢ï¼Œæœ€å¤§ï¼ˆæˆ–æœ€å°ï¼‰å…ƒç´ é€æ­¥â€œæµ®å‡ºâ€ O(nÂ²) O(1) âœ… ç¨³å®š âœ… æ•°æ®é‡å°ã€éƒ¨åˆ†æœ‰åº é€‰æ‹©æ’åº (Selection Sort) æ¯æ¬¡é€‰æ‹©æœ€å°å…ƒç´ æ”¾åˆ°å‰é¢ O(nÂ²) O(1) âŒ ä¸ç¨³å®š âœ… æ•°æ®é‡å°ï¼Œå¯¹äº¤æ¢æ¬¡æ•°æ•æ„Ÿ æ’å…¥æ’åº (Insertion Sort) å°†æœªæ’åºå…ƒç´ æ’å…¥åˆ°å·²æ’åºåºåˆ—ä¸­ O(nÂ²) O(1) âœ… ç¨³å®š âœ… æ•°æ®åŸºæœ¬æœ‰åºæ—¶é«˜æ•ˆ å¸Œå°”æ’åº (Shell Sort) æ’å…¥æ’åºçš„æ”¹è¿›ç‰ˆï¼Œåˆ†ç»„æ¯”è¾ƒå‡å°‘äº¤æ¢ O(nÂ¹Ë™Â³~nÂ²) O(1) âŒ ä¸ç¨³å®š âœ… ä¸­ç­‰è§„æ¨¡æ•°æ® å½’å¹¶æ’åº (Merge Sort) åˆ†æ²» + åˆå¹¶æœ‰åºå­åºåˆ— O(n log n) O(n) âœ… ç¨³å®š âŒ å¤§æ•°æ®ã€å¤–éƒ¨æ’åº å¿«é€Ÿæ’åº (Quick Sort) åˆ†æ²» + åŸºå‡†åˆ’åˆ† å¹³å‡ O(n log n)æœ€å O(nÂ²) O(log n) âŒ ä¸ç¨³å®š âœ… é€šç”¨æœ€å¿«çš„å†…éƒ¨æ’åº å †æ’åº (Heap Sort) åˆ©ç”¨å †ç»“æ„ç»´æŠ¤æœ€å¤§/æœ€å°å€¼ O(n log n) O(1) âŒ ä¸ç¨³å®š âœ… éœ€è¦å¿«é€Ÿæ‰¾æœ€å¤§/æœ€å°çš„åœºæ™¯ è®¡æ•°æ’åº (Counting Sort) ç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‡ºç°æ¬¡æ•° O(n + k) O(n + k) âœ… ç¨³å®š âŒ æ•´æ•°ã€èŒƒå›´è¾ƒå°çš„åœºæ™¯ æ¡¶æ’åº (Bucket Sort) æŒ‰åŒºé—´åˆ’åˆ†å¤šä¸ªæ¡¶å†åˆ†åˆ«æ’åº O(n + k) O(n + k) âœ… ç¨³å®šï¼ˆè§†å­æ’åºï¼‰ âŒ æ•°æ®å‡åŒ€åˆ†å¸ƒçš„æµ®ç‚¹æ•° åŸºæ•°æ’åº (Radix Sort) æŒ‰ä½ï¼ˆä¸ªä½â†’é«˜ä½ï¼‰æ’åº O(dÂ·(n+k)) O(n + k) âœ… ç¨³å®š âŒ æ•´æ•°ã€å­—ç¬¦ä¸²æ’åº ğŸ” å„ç®—æ³•æ ¸å¿ƒæ€æƒ³è®²è§£ä¸ä»£ç ç¤ºä¾‹ 1ï¸âƒ£ å†’æ³¡æ’åº Bubble Sort æ¯ä¸€è½®ä¸¤ä¸¤æ¯”è¾ƒï¼ŒæŠŠæœ€å¤§å€¼â€œå†’æ³¡â€åˆ°æœ€åã€‚\nfunc bubbleSort(nums []int) { n := len(nums) for i := 0; i \u0026lt; n-1; i++ { for j := 0; j \u0026lt; n-i-1; j++ { if nums[j] \u0026gt; nums[j+1] { nums[j], nums[j+1] = nums[j+1], nums[j] } } } } âœ… ç¨³å®šã€å®ç°ç®€å• âŒ æ…¢ï¼Œä¸é€‚åˆå¤§æ•°æ®\n2ï¸âƒ£ é€‰æ‹©æ’åº Selection Sort æ¯è½®é€‰å‡ºæœ€å°å€¼æ”¾åˆ°å‰é¢ã€‚\nfunc selectionSort(nums []int) { n := len(nums) for i := 0; i \u0026lt; n-1; i++ { min := i for j := i + 1; j \u0026lt; n; j++ { if nums[j] \u0026lt; nums[min] { min = j } } nums[i], nums[min] = nums[min], nums[i] } } âŒ ä¸ç¨³å®šï¼ˆå› ä¸ºæœ€å°å€¼å’Œå‰é¢å…ƒç´ äº¤æ¢ä¼šç ´åé¡ºåºï¼‰ âœ… ç®€å•ã€äº¤æ¢æ¬¡æ•°å°‘\n3ï¸âƒ£ æ’å…¥æ’åº Insertion Sort æŠŠå½“å‰å…ƒç´ æ’å…¥åˆ°å‰é¢å·²æ’åºçš„éƒ¨åˆ†ã€‚\nfunc insertionSort(nums []int) { for i := 1; i \u0026lt; len(nums); i++ { key := nums[i] j := i - 1 for j \u0026gt;= 0 \u0026amp;\u0026amp; nums[j] \u0026gt; key { nums[j+1] = nums[j] j-- } nums[j+1] = key } } âœ… ç¨³å®šï¼Œå°è§„æ¨¡æˆ–å‡ ä¹æœ‰åºæ•°ç»„å¾ˆå¿«ã€‚ ğŸ“ˆ å¹³å‡ O(nÂ²)ï¼Œæœ€å¥½ O(n)ã€‚\n4ï¸âƒ£ å¸Œå°”æ’åº Shell Sort æ’å…¥æ’åº + åˆ†ç»„åŠ é€Ÿã€‚\nfunc shellSort(nums []int) { for gap := len(nums) / 2; gap \u0026gt; 0; gap /= 2 { for i := gap; i \u0026lt; len(nums); i++ { temp := nums[i] j := i for ; j \u0026gt;= gap \u0026amp;\u0026amp; nums[j-gap] \u0026gt; temp; j -= gap { nums[j] = nums[j-gap] } nums[j] = temp } } } âŒ ä¸ç¨³å®š âœ… æ¯”æ’å…¥æ’åºå¿«å¾—å¤šã€‚\n5ï¸âƒ£ å½’å¹¶æ’åº Merge Sort åˆ†æ²» + åˆå¹¶ï¼ˆè§ä½ å‰é¢çš„æ¨¡æ¿ï¼‰ã€‚ âœ… ç¨³å®š âŒ éœ€è¦ O(n) é¢å¤–ç©ºé—´ã€‚\n6ï¸âƒ£ å¿«é€Ÿæ’åº Quick Sort é€‰ä¸€ä¸ªåŸºå‡†ï¼ŒæŠŠå°äºå®ƒçš„æ”¾å·¦è¾¹ï¼Œå¤§äºçš„æ”¾å³è¾¹ï¼Œå†é€’å½’ã€‚\nfunc quickSort(nums []int) { if len(nums) \u0026lt;= 1 { return } sort(nums, 0, len(nums)-1) } func sort(nums []int, l, r int) { if l \u0026gt;= r { return } pivot := partition(nums, l, r) sort(nums, l, pivot-1) sort(nums, pivot+1, r) } func partition(nums []int, l, r int) int { pivot := nums[r] i := l for j := l; j \u0026lt; r; j++ { if nums[j] \u0026lt; pivot { nums[i], nums[j] = nums[j], nums[i] i++ } } nums[i], nums[r] = nums[r], nums[i] return i } âš¡ é€šå¸¸æ˜¯æœ€å¿«çš„å†…éƒ¨æ’åºç®—æ³•ã€‚ âŒ ä¸ç¨³å®šï¼Œæœ€åæƒ…å†µ O(nÂ²)ï¼Œä½†å¹³å‡éå¸¸å¥½ã€‚\n7ï¸âƒ£ å †æ’åº Heap Sort æ„å»ºæœ€å¤§å †ï¼Œæ¯æ¬¡å–å‡ºå †é¡¶ï¼ˆæœ€å¤§å€¼ï¼‰æ”¾åˆ°æœ«å°¾ã€‚\nfunc heapSort(nums []int) { n := len(nums) for i := n/2 - 1; i \u0026gt;= 0; i-- { heapify(nums, n, i) } for i := n - 1; i \u0026gt; 0; i-- { nums[0], nums[i] = nums[i], nums[0] heapify(nums, i, 0) } } func heapify(nums []int, n, i int) { largest := i l, r := 2*i+1, 2*i+2 if l \u0026lt; n \u0026amp;\u0026amp; nums[l] \u0026gt; nums[largest] { largest = l } if r \u0026lt; n \u0026amp;\u0026amp; nums[r] \u0026gt; nums[largest] { largest = r } if largest != i { nums[i], nums[largest] = nums[largest], nums[i] heapify(nums, n, largest) } } âœ… ä¸éœ€è¦é¢å¤–ç©ºé—´ï¼ŒO(1) ç©ºé—´å¤æ‚åº¦ âŒ ä¸ç¨³å®š\n8ï¸âƒ£ è®¡æ•°æ’åº Counting Sort ç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‡ºç°æ¬¡æ•°ï¼ŒæŒ‰æ¬¡æ•°è¾“å‡ºã€‚\nfunc countingSort(nums []int, maxVal int) []int { count := make([]int, maxVal+1) for _, v := range nums { count[v]++ } idx := 0 for i, c := range count { for c \u0026gt; 0 { nums[idx] = i idx++ c-- } } return nums } âœ… ç¨³å®šã€çº¿æ€§æ—¶é—´ âŒ åªèƒ½ç”¨äºéè´Ÿæ•´æ•°ï¼Œä¸”èŒƒå›´ä¸èƒ½å¤ªå¤§ã€‚\n9ï¸âƒ£ æ¡¶æ’åº Bucket Sort æŠŠæ•°æ®åˆ†è¿›å¤šä¸ªæ¡¶ï¼Œæ¯ä¸ªæ¡¶å†…éƒ¨å†æ’åºã€‚\nfunc bucketSort(nums []float64) []float64 { n := len(nums) buckets := make([][]float64, n) for _, v := range nums { idx := int(v * float64(n)) buckets[idx] = append(buckets[idx], v) } // å¯¹æ¯ä¸ªæ¡¶å†…éƒ¨æ’åºï¼ˆå¯ç”¨æ’å…¥æ’åºï¼‰ for i := range buckets { insertionSortFloat(buckets[i]) } result := make([]float64, 0, n) for _, b := range buckets { result = append(result, b...) } return result } func insertionSortFloat(nums []float64) { for i := 1; i \u0026lt; len(nums); i++ { key := nums[i] j := i - 1 for j \u0026gt;= 0 \u0026amp;\u0026amp; nums[j] \u0026gt; key { nums[j+1] = nums[j] j-- } nums[j+1] = key } } é€‚ç”¨äºï¼šåˆ†å¸ƒå‡åŒ€çš„æµ®ç‚¹æ•°ï¼ˆä¾‹å¦‚ [0,1) åŒºé—´å†…ï¼‰ã€‚\nğŸ”Ÿ åŸºæ•°æ’åº Radix Sort æŒ‰ä¸ªä½ã€åä½ã€ç™¾ä½â€¦â€¦ä¾æ¬¡ä½¿ç”¨è®¡æ•°æ’åºã€‚\nfunc radixSort(nums []int) { maxVal := 0 for _, v := range nums { if v \u0026gt; maxVal { maxVal = v } } for exp := 1; maxVal/exp \u0026gt; 0; exp *= 10 { countingSortByDigit(nums, exp) } } func countingSortByDigit(nums []int, exp int) { n := len(nums) output := make([]int, n) count := make([]int, 10) for i := 0; i \u0026lt; n; i++ { digit := (nums[i] / exp) % 10 count[digit]++ } for i := 1; i \u0026lt; 10; i++ { count[i] += count[i-1] } for i := n - 1; i \u0026gt;= 0; i-- { digit := (nums[i] / exp) % 10 output[count[digit]-1] = nums[i] count[digit]-- } copy(nums, output) } é€‚ç”¨äºï¼šæ•´æ•°ã€å®šé•¿å­—ç¬¦ä¸²ã€‚\nğŸ“ˆ æ€»ç»“ ç±»åˆ« ç®—æ³• å£è¯€ O(nÂ²) ç±» å†’æ³¡ã€é€‰æ‹©ã€æ’å…¥ æ…¢ä½†ç®€å•ï¼Œå†’æ³¡æ’å…¥ç¨³ï¼Œé€‰æ‹©ä¸ç¨³ O(n log n) ç±» å½’å¹¶ã€å¿«æ’ã€å †æ’ åˆ†æ²»ä¸‰å…„å¼Ÿï¼šå½’å¹¶ç¨³ï¼Œå¿«æ’å¿«ï¼Œå †æ’çœç©ºé—´ çº¿æ€§æ’åºç±» è®¡æ•°ã€æ¡¶ã€åŸºæ•° åˆ©ç”¨æ•°æ®ç‰¹å¾æ¢å–é€Ÿåº¦ï¼Œç©ºé—´æ¢æ—¶é—´ ",
"tags":null,
"categories":null
},{
"title":"å†…å­˜åˆ†é…",
"permalink": "http://localhost:1313/posts/go/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/",
"summary": "goçš„å†…å­˜åˆ†é… æ ¹æ®å¯¹è±¡å¤§å°çš„ä¸åŒï¼Œgoçš„å†…å­˜åˆ†é…æœ‰3ç§ç±»å‹ï¼š Tiny(size \u0026lt; 16B): Objects of size less than 16 bytes are allocated using the mcacheâ€™s tiny allocator. This is efficient and multiple tiny allocations are done on a single 16-byte block. Small(size 16B ~ 32KB): Objects of size between 16 bytes and 32 Kilobytes are allocated on the corresponding size class(mspan) on mcache of the P where the G is running. In both tiny and small allocation if the mspanâ€™s list is empty the allocator will obtain a run of pages from the mheap to use for the mspan. If the mheap is empty or has no page runs large enough then it allocates a new group of pages (at least 1MB) from the OS. Large(size \u0026gt; 32KB): Objects of size greater than 32 kilobytes are allocated directly on the corresponding size class of mheap. If the mheap is empty or has no page runs large enough then it allocates a new group of pages (at least 1MB) from the OS. æ€»ç»“ä¸€ä¸‹Goæ˜¯å¦‚ä½•è¿›è¡Œå†…å­˜åˆ†é…: mcacheä¸­å¦‚æœæœ‰ç©ºé—²çš„ç©ºé—´ï¼Œ é‚£ä¹ˆç›´æ¥åœ¨mcacheåˆ†é… mcacheå¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆå°è¯•å»mcentralä¸­è·å–ä¸€ä¸ªç©ºé—²çš„mspan mcentralä¸­ä¹Ÿå’©æœ‰å¯ç”¨çš„mspanï¼Œé‚£ä¹ˆç›´æ¥å»mheapå‘æ“ä½œç³»ç»Ÿç”³è¯·å¯ç”¨çš„mspan\n",
"content": "goçš„å†…å­˜åˆ†é… æ ¹æ®å¯¹è±¡å¤§å°çš„ä¸åŒï¼Œgoçš„å†…å­˜åˆ†é…æœ‰3ç§ç±»å‹ï¼š Tiny(size \u0026lt; 16B): Objects of size less than 16 bytes are allocated using the mcacheâ€™s tiny allocator. This is efficient and multiple tiny allocations are done on a single 16-byte block. Small(size 16B ~ 32KB): Objects of size between 16 bytes and 32 Kilobytes are allocated on the corresponding size class(mspan) on mcache of the P where the G is running. In both tiny and small allocation if the mspanâ€™s list is empty the allocator will obtain a run of pages from the mheap to use for the mspan. If the mheap is empty or has no page runs large enough then it allocates a new group of pages (at least 1MB) from the OS. Large(size \u0026gt; 32KB): Objects of size greater than 32 kilobytes are allocated directly on the corresponding size class of mheap. If the mheap is empty or has no page runs large enough then it allocates a new group of pages (at least 1MB) from the OS. æ€»ç»“ä¸€ä¸‹Goæ˜¯å¦‚ä½•è¿›è¡Œå†…å­˜åˆ†é…: mcacheä¸­å¦‚æœæœ‰ç©ºé—²çš„ç©ºé—´ï¼Œ é‚£ä¹ˆç›´æ¥åœ¨mcacheåˆ†é… mcacheå¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆå°è¯•å»mcentralä¸­è·å–ä¸€ä¸ªç©ºé—²çš„mspan mcentralä¸­ä¹Ÿå’©æœ‰å¯ç”¨çš„mspanï¼Œé‚£ä¹ˆç›´æ¥å»mheapå‘æ“ä½œç³»ç»Ÿç”³è¯·å¯ç”¨çš„mspan\nå’Œ mcacheã€mcentralã€mheap ä¹‹é—´çš„è”ç³» 1. mspan ä¸å¤§å°åˆ†ç±»çš„å…³ç³» é¦–å…ˆè¦æ˜ç¡®ä¸€ç‚¹ï¼šmspan å¹¶ä¸æ˜¯ç›´æ¥å’Œæ¯ä¸ªå¯¹è±¡å¤§å°ä¸€ä¸€å¯¹åº”çš„ï¼Œè€Œæ˜¯ç”¨äºç®¡ç†ä¸€å®šèŒƒå›´å†…å¤§å°çš„å†…å­˜å—çš„ã€‚æ¯ä¸ª mspan å¯ä»¥åŒ…å«å¤šä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”ä¸€ä¸ª mspan çš„å¤§å°é€šå¸¸æ˜¯å¤šä¸ªç›¸åŒå¤§å°çš„å¯¹è±¡ä¸€èµ·æ„æˆçš„ã€‚\nå¯¹è±¡å¤§å°ä¸ mspan çš„å…³ç³»ï¼š Tiny åˆ†é…ï¼ˆå°äº 16Bï¼‰ï¼š\nå¯¹äº \u0026lt; 16B çš„å°å¯¹è±¡ï¼ŒGo ä¸ä¼šä¸ºæ¯ä¸ªå¯¹è±¡å•ç‹¬åˆ†é…ä¸€ä¸ª 8KB æˆ– 16KB çš„ mspanã€‚ç›¸åï¼Œè¿™äº›å°å¯¹è±¡ä¼šè¢« æ‰¹é‡åˆ†é…åˆ°ä¸€ä¸ªå›ºå®šå¤§å°çš„å†…å­˜åŒºåŸŸï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª 16 å­—èŠ‚çš„å—ï¼Œä¹Ÿå°±æ˜¯ tiny allocator çš„å†…å­˜æ± ã€‚ mspan å¯¹äºè¿™äº›å°å¯¹è±¡çš„ä½œç”¨æ˜¯ï¼šä¸€å—å°å†…å­˜å—å¯ä»¥åŒ…å«å¤šä¸ªå°å¯¹è±¡ï¼Œè€Œ mspan æœ¬èº«å¹¶ä¸æ˜¯ç”¨äºå­˜å‚¨å•ä¸€çš„ 16B æˆ–æ›´å°çš„å¯¹è±¡ã€‚å¤šä¸ªå°å¯¹è±¡ï¼ˆæ¯”å¦‚å¤šä¸ªå°äº 16B çš„å¯¹è±¡ï¼‰ä¼šåœ¨ä¸€ä¸ª mspan ä¸­å…±äº«è¿™å—å†…å­˜ã€‚ Small åˆ†é…ï¼ˆ16B ~ 32KBï¼‰ï¼š\nå¯¹äºè¿™ç±»å¯¹è±¡ï¼ŒGo ä¼šæ ¹æ®å¯¹è±¡å¤§å°å°†å®ƒä»¬åˆ’åˆ†åˆ°ä¸åŒçš„å¤§å°ç±»ï¼ˆsize classï¼‰ä¸­ï¼Œå¹¶ä¸ºæ¯ä¸ªå¤§å°ç±»åˆ›å»ºä¸€ä¸ª mspanã€‚æ¯”å¦‚ï¼Œ16Bã€32Bã€64B ç­‰å¯¹è±¡å¤§å°å°±ä¼šåˆ†åˆ«åˆ†é…åˆ°å¯¹åº”çš„ mspanï¼ˆæ¯ä¸ª mspan çš„å¤§å°å¯èƒ½æ˜¯ 8KBã€16KB æˆ–å…¶ä»–ï¼‰ã€‚ è¿™äº› mspan ç”¨æ¥å­˜å‚¨å¤šä¸ªç›¸åŒå¤§å°çš„å¯¹è±¡ï¼Œæ¯ä¸ª mspan ä¼šæœ‰å¤šä¸ªç©ºé—²çš„å¯¹è±¡å—ï¼Œç›´åˆ°è¿™äº› mspan è¢«å¡«æ»¡æˆ–è€…ç©ºé—²å¯¹è±¡ç”¨å®Œã€‚ Large åˆ†é…ï¼ˆå¤§äº 32KBï¼‰ï¼š\nå¯¹äºå¤§äº 32KB çš„å¯¹è±¡ï¼ŒGo ç›´æ¥åœ¨ mheap ä¸­åˆ†é…å†…å­˜ï¼Œä¸ä¼šä½¿ç”¨ mcache æˆ– mspanã€‚è¿™äº›å¯¹è±¡ä¼šç›´æ¥å‘æ“ä½œç³»ç»Ÿè¯·æ±‚å¤§çš„å†…å­˜é¡µï¼ˆé€šå¸¸æ˜¯ 4KB æˆ–æ›´å¤§çš„é¡µé¢ï¼‰ï¼Œå¹¶åœ¨ mheap ä¸­è¿›è¡Œç®¡ç†ã€‚ 2. mcacheã€mcentral å’Œ mheap çš„å…³ç³» è¿™äº›åˆ†é…åŒºåŸŸå’Œ Tinyã€Smallã€Large å†…å­˜åˆ†é…ç±»åˆ«ä¹‹é—´æœ‰å¾ˆå¤§çš„å…³ç³»ï¼Œä¸‹é¢æ˜¯å®ƒä»¬å¦‚ä½•åä½œï¼š\nmcacheï¼š\næ¯ä¸ªå¤„ç†å™¨ï¼ˆPï¼‰éƒ½æœ‰ä¸€ä¸ª mcacheï¼Œå®ƒç”¨äºå¿«é€Ÿåˆ†é…å°å¯¹è±¡ã€‚å®ƒæœ‰å¤šä¸ª mspanï¼Œè¿™äº› mspan å­˜å‚¨ç€å¤šä¸ªç›¸åŒå¤§å°çš„å¯¹è±¡ã€‚ Tiny åˆ†é…ï¼šå¦‚æœä½ åˆ†é…çš„å¯¹è±¡å°äº 16Bï¼Œmcache ä¼šç›´æ¥åœ¨ tiny allocator ä¸­åˆ†é…å†…å­˜ï¼ˆè¿™ä¸ªåŒºåŸŸç”¨äºéå¸¸å°çš„å¯¹è±¡ï¼‰ï¼Œè¿™äº›å¯¹è±¡ä¸ä¼šå ç”¨ä¸€ä¸ªå®Œæ•´çš„ mspanï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ª 16 å­—èŠ‚å¤§å°çš„å—ä¸­å…±äº«å†…å­˜ã€‚ Small åˆ†é…ï¼šå¦‚æœä½ åˆ†é…çš„å¯¹è±¡å¤§å°åœ¨ 16B åˆ° 32KB ä¹‹é—´ï¼Œmcache ä¼šæŸ¥çœ‹å…¶å¯¹åº”çš„ mspanï¼Œå¦‚æœ mspan ç©ºé—²ä¸”ç¬¦åˆæ¡ä»¶ï¼Œå®ƒä¼šç›´æ¥åˆ†é…ã€‚å¦‚æœæ²¡æœ‰ç©ºé—²çš„ mspanï¼Œmcache ä¼šè¯·æ±‚ mcentral è·å–æ–°çš„ mspanã€‚ mcentralï¼š\nmcentral æ˜¯ä¸€ä¸ªæ›´å¤§çš„ç¼“å­˜æ± ï¼Œç”¨äºå­˜å‚¨å¤šä¸ª mspanï¼Œå¦‚æœ mcache ä¸­æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å—æ¥æ»¡è¶³è¯·æ±‚ï¼Œå®ƒä¼šå‘ mcentral è¯·æ±‚æ–°çš„ mspanã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨ä¸­ç­‰å¤§å°çš„å¯¹è±¡ï¼ˆ16B ~ 32KBï¼‰åˆ†é…æ—¶ã€‚ mcentral ä¼šç¼“å­˜å„ä¸ªå¤§å°ç±»çš„ mspanï¼Œå¹¶å°†å®ƒä»¬åˆ†å‘ç»™ä¸åŒçš„ mcacheã€‚å½“ mcache çš„ç©ºé—´ä¸è¶³æ—¶ï¼Œå®ƒä¼šä» mcentral è·å–æ›´å¤šçš„ mspanã€‚ mheapï¼š\nLarge åˆ†é…ï¼šå¯¹äºå¤§äº 32KB çš„å¯¹è±¡ï¼ŒGo ä¼šç›´æ¥åœ¨ mheap ä¸­åˆ†é…å†…å­˜ï¼Œmheap ç®¡ç†çš„æ˜¯æ“ä½œç³»ç»Ÿçš„å†…å­˜é¡µï¼ˆæ¯é¡µ 4KBï¼‰ã€‚å½“ mcache å’Œ mcentral æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—²ç©ºé—´æ—¶ï¼Œmheap ä¼šå‘æ“ä½œç³»ç»Ÿç”³è¯·æ–°çš„å†…å­˜åŒºåŸŸï¼ˆé€šå¸¸è‡³å°‘ä¸º 1MBï¼‰ï¼Œå¹¶å°†è¿™äº›å†…å­˜åˆ’åˆ†ä¸ºå¤šä¸ª mspan è¿›è¡Œç®¡ç†ã€‚ 3. æ€»ç»“ ï¼š\nTiny åˆ†é…ï¼ˆ\u0026lt; 16Bï¼‰ï¼šè¿™ç±»å°å¯¹è±¡ä¼šåœ¨ mcache ä¸­çš„ tiny allocator ä¸­åˆ†é…ï¼Œè€Œä¸ä¼šç›´æ¥å ç”¨ä¸€ä¸ª 8KB çš„ mspanã€‚è¿™äº›å°å¯¹è±¡å¯ä»¥åœ¨ 16 å­—èŠ‚çš„å°å—å†…å­˜åŒºåŸŸä¸­åˆ†é…ã€‚ Small åˆ†é…ï¼ˆ16B ~ 32KBï¼‰ï¼šè¿™ç±»å¯¹è±¡ä¼šæ ¹æ®å¤§å°åˆ†é…åˆ° mcache çš„ mspan ä¸­ï¼Œmspan ä¼šç¼“å­˜å¤šä¸ªç›¸åŒå¤§å°çš„å¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰ç©ºé—²çš„ mspanï¼Œä¼šä» mcentral è·å–ã€‚ Large åˆ†é…ï¼ˆ\u0026gt; 32KBï¼‰ï¼šè¿™ç±»å¤§å¯¹è±¡ç›´æ¥åœ¨ mheap ä¸­åˆ†é…å†…å­˜ã€‚ æ€»çš„æ¥è¯´ï¼Œmspan ç”¨äºå­˜å‚¨ç›¸åŒå¤§å°çš„å¤šä¸ªå¯¹è±¡ï¼Œmcache ç”¨æ¥ç¼“å­˜å°å¯¹è±¡ï¼Œmcentral æ˜¯æ›´å¤§çš„å†…å­˜æ± ï¼Œç”¨äºç¼“å­˜å¤šä¸ª mspanï¼Œmheap æ˜¯æ•´ä¸ªå †å†…å­˜çš„ç®¡ç†åŒºã€‚\n",
"tags":null,
"categories":null
},{
"title":"Tcpä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹",
"permalink": "http://localhost:1313/posts/network/tcp%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/",
"summary": "ä¸‰æ¬¡æ¡æ‰‹ å®¢æˆ·ç«¯å‘é€synï¼Œå®¢æˆ·ç«¯ä»close-\u0026gt;syn-send synæœåŠ¡ç«¯æ”¶åˆ°syn ,åŒæ—¶å‘å®¢æˆ·ç«¯å‘é€syn.ack ï¼Œè‡ªå·±ä»listenå˜æˆ syn-recd å®¢æˆ·ç«¯æ”¶åˆ°syn-ackä¼šåœ¨å‘é€ä¸€ä¸ªack,è‡ªå·±å˜æˆestablished,æœåŠ¡ç«¯æ”¶åˆ°è¿™ä¸ªackï¼Œè‡ªå·±å˜æˆestablishedã€‚ ",
"content": "ä¸‰æ¬¡æ¡æ‰‹ å®¢æˆ·ç«¯å‘é€synï¼Œå®¢æˆ·ç«¯ä»close-\u0026gt;syn-send synæœåŠ¡ç«¯æ”¶åˆ°syn ,åŒæ—¶å‘å®¢æˆ·ç«¯å‘é€syn.ack ï¼Œè‡ªå·±ä»listenå˜æˆ syn-recd å®¢æˆ·ç«¯æ”¶åˆ°syn-ackä¼šåœ¨å‘é€ä¸€ä¸ªack,è‡ªå·±å˜æˆestablished,æœåŠ¡ç«¯æ”¶åˆ°è¿™ä¸ªackï¼Œè‡ªå·±å˜æˆestablishedã€‚ ",
"tags":null,
"categories":null
},{
"title":"sqlé«˜é¢‘é¢˜",
"permalink": "http://localhost:1313/posts/sql/%E9%AB%98%E9%A2%91%E9%A2%98/",
"summary": "åˆ†ä¸ºå…­ä¸ªç»´åº¦ï¼šåŸºç¡€èšåˆ â†’ å­æŸ¥è¯¢ â†’ TopN â†’ çª—å£å‡½æ•° â†’ ä¸šåŠ¡å»ºæ¨¡ â†’ æ€§èƒ½ä¼˜åŒ–ã€‚\nğŸ¯ é«˜é¢‘ SQL é¢˜åº“ï¼ˆå«ç­”æ¡ˆä¸æ€è·¯ï¼‰ ä¸€ã€åŸºç¡€èšåˆä¸åˆ†ç»„ï¼ˆGROUP BY / HAVINGï¼‰ ğŸ§© é¢˜ 1ï¼šæŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„ è¡¨ç»“æ„ï¼š\nemployee(emp_id, emp_name, dept_id, salary) SQLï¼š\nSELECT dept_id, AVG(salary) AS avg_salary FROM employee GROUP BY dept_id; ğŸ“˜ è€ƒç‚¹ï¼š èšåˆå‡½æ•° + åˆ†ç»„\nğŸ§© é¢˜ 2ï¼šæŸ¥è¯¢å¸¦å­¦ç”Ÿæ•°è¶…è¿‡ 10 äººçš„è€å¸ˆ teacher(teacher_id, name) student(student_id, teacher_id) SQLï¼š\nSELECT teacher_id, COUNT(*) AS student_count FROM student GROUP BY teacher_id HAVING COUNT(*) \u0026gt; 10; ğŸ“˜ è€ƒç‚¹ï¼š HAVING ä¸ WHERE çš„åŒºåˆ«ï¼ˆHAVING é’ˆå¯¹èšåˆåè¿‡æ»¤ï¼‰\näºŒã€å­æŸ¥è¯¢ï¼ˆSubqueryï¼‰ ğŸ§© é¢˜ 3ï¼šæŸ¥è¯¢å·¥èµ„é«˜äºæœ¬éƒ¨é—¨å¹³å‡å·¥èµ„çš„å‘˜å·¥ SELECT e.emp_name, e.salary FROM employee e JOIN ( SELECT dept_id, AVG(salary) AS avg_salary FROM employee GROUP BY dept_id ) d ON e.dept_id = d.dept_id WHERE e.salary \u0026gt; d.avg_salary; ğŸ“˜ è€ƒç‚¹ï¼š ç›¸å…³å­æŸ¥è¯¢ vs éç›¸å…³å­æŸ¥è¯¢\n",
"content": "åˆ†ä¸ºå…­ä¸ªç»´åº¦ï¼šåŸºç¡€èšåˆ â†’ å­æŸ¥è¯¢ â†’ TopN â†’ çª—å£å‡½æ•° â†’ ä¸šåŠ¡å»ºæ¨¡ â†’ æ€§èƒ½ä¼˜åŒ–ã€‚\nğŸ¯ é«˜é¢‘ SQL é¢˜åº“ï¼ˆå«ç­”æ¡ˆä¸æ€è·¯ï¼‰ ä¸€ã€åŸºç¡€èšåˆä¸åˆ†ç»„ï¼ˆGROUP BY / HAVINGï¼‰ ğŸ§© é¢˜ 1ï¼šæŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„ è¡¨ç»“æ„ï¼š\nemployee(emp_id, emp_name, dept_id, salary) SQLï¼š\nSELECT dept_id, AVG(salary) AS avg_salary FROM employee GROUP BY dept_id; ğŸ“˜ è€ƒç‚¹ï¼š èšåˆå‡½æ•° + åˆ†ç»„\nğŸ§© é¢˜ 2ï¼šæŸ¥è¯¢å¸¦å­¦ç”Ÿæ•°è¶…è¿‡ 10 äººçš„è€å¸ˆ teacher(teacher_id, name) student(student_id, teacher_id) SQLï¼š\nSELECT teacher_id, COUNT(*) AS student_count FROM student GROUP BY teacher_id HAVING COUNT(*) \u0026gt; 10; ğŸ“˜ è€ƒç‚¹ï¼š HAVING ä¸ WHERE çš„åŒºåˆ«ï¼ˆHAVING é’ˆå¯¹èšåˆåè¿‡æ»¤ï¼‰\näºŒã€å­æŸ¥è¯¢ï¼ˆSubqueryï¼‰ ğŸ§© é¢˜ 3ï¼šæŸ¥è¯¢å·¥èµ„é«˜äºæœ¬éƒ¨é—¨å¹³å‡å·¥èµ„çš„å‘˜å·¥ SELECT e.emp_name, e.salary FROM employee e JOIN ( SELECT dept_id, AVG(salary) AS avg_salary FROM employee GROUP BY dept_id ) d ON e.dept_id = d.dept_id WHERE e.salary \u0026gt; d.avg_salary; ğŸ“˜ è€ƒç‚¹ï¼š ç›¸å…³å­æŸ¥è¯¢ vs éç›¸å…³å­æŸ¥è¯¢\nğŸ§© é¢˜ 4ï¼šæŸ¥è¯¢è‡³å°‘æœ‰ä¸€ç¬”è®¢å•é‡‘é¢è¶…è¿‡ 1000 çš„ç”¨æˆ· SELECT user_id FROM orders WHERE amount \u0026gt; 1000 GROUP BY user_id; ğŸ“˜ å˜å½¢é¢˜ï¼š å¯ä»¥å†™æˆ EXISTSï¼š\nSELECT DISTINCT u.user_id FROM users u WHERE EXISTS ( SELECT 1 FROM orders o WHERE o.user_id = u.user_id AND o.amount \u0026gt; 1000 ); ä¸‰ã€Top N æŸ¥è¯¢ï¼ˆåˆ†ç»„å–æœ€å¤§ / æœ€å°ï¼‰ ğŸ§© é¢˜ 5ï¼šæŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥ SELECT e.* FROM employee e JOIN ( SELECT dept_id, MAX(salary) AS max_salary FROM employee GROUP BY dept_id ) t ON e.dept_id = t.dept_id AND e.salary = t.max_salary; ğŸ“˜ è€ƒç‚¹ï¼š group by + join æ‹¿åˆ†ç»„æœ€å¤§å€¼\nğŸ§© é¢˜ 6ï¼šæŸ¥è¯¢é”€å”®é¢æ’åå‰ä¸‰çš„å•†å“ SELECT product_id, SUM(amount) AS total_sales FROM orders GROUP BY product_id ORDER BY total_sales DESC LIMIT 3; ğŸ“˜ è€ƒç‚¹ï¼š èšåˆ + æ’åº + limit\nå››ã€çª—å£å‡½æ•°ï¼ˆWindow Functionï¼‰ ğŸ§© é¢˜ 7ï¼šæŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨å·¥èµ„ç¬¬äºŒé«˜çš„å‘˜å·¥ SELECT * FROM ( SELECT emp_id, dept_id, salary, ROW_NUMBER() OVER (PARTITION BY dept_id ORDER BY salary DESC) AS rn FROM employee ) t WHERE rn = 2; ğŸ“˜ è€ƒç‚¹ï¼š ROW_NUMBER() / RANK() / DENSE_RANK() åŒºåˆ«\nğŸ§© é¢˜ 8ï¼šç»Ÿè®¡ç”¨æˆ·è¿ç»­ç­¾åˆ° \u0026gt;= 3 å¤©çš„æƒ…å†µ SELECT user_id FROM ( SELECT user_id, DATE_SUB(sign_date, INTERVAL ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY sign_date) DAY) AS grp FROM sign_log ) t GROUP BY user_id, grp HAVING COUNT(*) \u0026gt;= 3; ğŸ“˜ è€ƒç‚¹ï¼š çª—å£å‡½æ•° + æ—¥æœŸå·®åˆ†è¿ç»­æ€§åˆ¤æ–­\näº”ã€ä¸šåŠ¡å»ºæ¨¡ç±»é¢˜ï¼ˆJOIN + åˆ†ç»„ + æ¡ä»¶ï¼‰ ğŸ§© é¢˜ 9ï¼šæŸ¥è¯¢æ¯ä¸ªè¯¾ç¨‹çš„å¹³å‡è¯„åˆ† SELECT course_id, AVG(score) AS avg_score FROM course_rating GROUP BY course_id ORDER BY avg_score DESC; ğŸ§© é¢˜ 10ï¼šæŸ¥è¯¢ä¸‹è¿‡è®¢å•ä½†ä»æœªä»˜æ¬¾çš„ç”¨æˆ· SELECT DISTINCT o.user_id FROM orders o LEFT JOIN payments p ON o.order_id = p.order_id WHERE p.order_id IS NULL; ğŸ“˜ è€ƒç‚¹ï¼š å·¦è¿æ¥ + null åˆ¤æ–­ï¼ˆåæŸ¥ï¼‰\nğŸ§© é¢˜ 11ï¼šæŸ¥è¯¢æ¯ä¸ªç”¨æˆ·æœ€åä¸€æ¬¡ä¸‹å•æ—¶é—´ SELECT user_id, MAX(order_time) AS last_order_time FROM orders GROUP BY user_id; ğŸ§© é¢˜ 12ï¼šæŸ¥è¯¢ä¸‹å•é‡‘é¢æœ€é«˜çš„å‰ 10 ä¸ªç”¨æˆ·åŠä»–ä»¬çš„å¹³å‡ä¸‹å•é¢ WITH ranked AS ( SELECT user_id, SUM(amount) AS total_amount FROM orders GROUP BY user_id ORDER BY total_amount DESC LIMIT 10 ) SELECT AVG(total_amount) FROM ranked; å…­ã€æ€§èƒ½ä¼˜åŒ–ä¸ç´¢å¼•è®¾è®¡ï¼ˆå¼€æ”¾é¢˜ï¼‰ ğŸ§© é¢˜ 13ï¼šä¸ºä»€ä¹ˆè¿™æ¡ SQL å¾ˆæ…¢ï¼Ÿ SELECT * FROM orders WHERE DATE(create_time) = \u0026#39;2025-10-24\u0026#39;; ğŸ“˜ åŸå› ï¼š\nä½¿ç”¨äº†å‡½æ•° DATE() å¯¼è‡´ç´¢å¼•å¤±æ•ˆã€‚ âœ… ä¼˜åŒ–ï¼š\nSELECT * FROM orders WHERE create_time \u0026gt;= \u0026#39;2025-10-24 00:00:00\u0026#39; AND create_time \u0026lt; \u0026#39;2025-10-25 00:00:00\u0026#39;; ğŸ§© é¢˜ 14ï¼šåˆ†é¡µæŸ¥è¯¢ä¼˜åŒ– é—®é¢˜ï¼š\nSELECT * FROM orders ORDER BY id LIMIT 100000, 20; å¤ªæ…¢ï¼Œå› ä¸º offset è¿‡å¤§ã€‚\nâœ… ä¼˜åŒ–æ€è·¯ï¼š\nä½¿ç”¨ã€Œæ¸¸æ ‡åˆ†é¡µã€ï¼š SELECT * FROM orders WHERE id \u0026gt; last_id ORDER BY id LIMIT 20; ğŸ§© é¢˜ 15ï¼šé«˜å¹¶å‘ä¸‹é˜²æ­¢åº“å­˜è¶…å– ğŸ“˜ æ€è·¯ï¼š\nSQL å±‚é¢ï¼š UPDATE product SET stock = stock - 1 WHERE id = 1 AND stock \u0026gt; 0; å—å½±å“è¡Œæ•° = 1 è¡¨ç¤ºæˆåŠŸï¼Œ0 è¡¨ç¤ºåº“å­˜ä¸è¶³ï¼› æ— éœ€æ˜¾å¼äº‹åŠ¡é”ã€‚ ä¸šåŠ¡å±‚ï¼š\nå¯ç»“åˆ Redis åˆ†å¸ƒå¼é” / MQ å¼‚æ­¥å‰Šå³°ã€‚ ä¸ƒã€äº‹åŠ¡ä¸é”æœºåˆ¶ï¼ˆç†è§£ç±»ï¼‰ ğŸ§© é¢˜ 16ï¼šMySQL æ­»é”çš„å¸¸è§åŸå› ï¼Ÿ å›ç­”æ€è·¯ï¼š\nä¸åŒäº‹åŠ¡è®¿é—®ç›¸åŒèµ„æºä½†é¡ºåºä¸ä¸€è‡´ï¼› é•¿äº‹åŠ¡æœªåŠæ—¶æäº¤ï¼› å¤§é‡é—´éš™é”ï¼ˆnext-key lockï¼‰ã€‚ âœ… è§£å†³ï¼š\nç¼©å°äº‹åŠ¡èŒƒå›´ï¼› å›ºå®šè®¿é—®é¡ºåºï¼› äº‹åŠ¡é‡è¯•ï¼› ä½¿ç”¨è¾ƒä½éš”ç¦»çº§åˆ«ï¼ˆå¦‚ READ COMMITTEDï¼‰ã€‚ ğŸ§© é¢˜ 17ï¼šExplain å¸¸è§å­—æ®µ å­—æ®µ è¯´æ˜ type è¿æ¥ç±»å‹ï¼ˆALL, index, range, ref, eq_ref, constï¼‰ possible_keys å¯ç”¨ç´¢å¼• key å®é™…ä½¿ç”¨çš„ç´¢å¼• rows é¢„è®¡æ‰«æè¡Œæ•° Extra é¢å¤–ä¿¡æ¯ï¼ˆUsing index, Using temporary, Using filesortï¼‰ é¢è¯•é«˜é¢‘é—®æ³•ï¼š\nâ€œExplain é‡Œå‡ºç° Using filesort æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæ€ä¹ˆä¼˜åŒ–ï¼Ÿâ€\nâœ… ç­”ï¼š æ’åºæœªèµ°ç´¢å¼•ï¼Œå¯é€šè¿‡å¤åˆç´¢å¼• (a, b) æˆ– order by é¡ºåºä¼˜åŒ–ã€‚\nâœ… å…«ã€æ€»ç»“ ç±»å‹ é«˜é¢‘è€ƒç‚¹ å»ºè®® èšåˆç»Ÿè®¡ group by + having å¤šç»ƒä¸šåŠ¡ç±»åœºæ™¯ TopN åˆ†ç»„å†…æœ€å¤§å€¼ ä¼šå†™ join + group çª—å£å‡½æ•° row_number / rank é‡ç‚¹ å­æŸ¥è¯¢ exists / not exists å¤šè¡¨æ¡ä»¶åˆ¤æ–­ æ€§èƒ½ä¼˜åŒ– explain + ç´¢å¼•å¤±æ•ˆ å¸¸è§é¢è¯• killer é¢˜ äº‹åŠ¡ç†è§£ æ­»é”ã€MVCCã€é”ç­‰å¾… äºŒé¢å¿…é—® ",
"tags":null,
"categories":null
},{
"title":"Liunxå¸¸ç”¨å‘½ä»¤",
"permalink": "http://localhost:1313/posts/cs/liunx%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/",
"summary": "Linux ä¸­éå¸¸å¸¸ç”¨å’ŒåŸºç¡€çš„å‘½ä»¤ï¼ŒæŒ‰ç…§åŠŸèƒ½è¿›è¡Œäº†åˆ†ç±»ï¼š\n1. æ–‡ä»¶å’Œç›®å½•ç®¡ç† ls (list)\nä½œç”¨ï¼šåˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š ls -lï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ˆæƒé™ã€æ‰€æœ‰è€…ã€å¤§å°ã€ä¿®æ”¹æ—¥æœŸï¼‰ã€‚ ls -aï¼šæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ï¼ˆä»¥ . å¼€å¤´çš„ï¼‰ã€‚ ls -hï¼šä¸ -l é…åˆä½¿ç”¨ï¼Œä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°ï¼ˆå¦‚ 1K, 2M, 3Gï¼‰ã€‚ ç¤ºä¾‹ï¼šls -lah /home/user cd (change directory)\nä½œç”¨ï¼šåˆ‡æ¢å½“å‰å·¥ä½œç›®å½•ã€‚ å¸¸ç”¨ç”¨æ³•ï¼š cd /var/logï¼šåˆ‡æ¢åˆ° /var/log ç›®å½•ã€‚ cd ..ï¼šåˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½•ã€‚ cd ~ æˆ– cdï¼šåˆ‡æ¢åˆ°å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚ cd -ï¼šåˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªå·¥ä½œç›®å½•ã€‚ pwd (print working directory)\nä½œç”¨ï¼šæ˜¾ç¤ºå½“å‰æ‰€åœ¨çš„ç›®å½•è·¯å¾„ã€‚ mkdir (make directory)\nä½œç”¨ï¼šåˆ›å»ºæ–°ç›®å½•ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š mkdir -p /path/to/new/dirï¼šé€’å½’åˆ›å»ºç›®å½•ï¼Œå¦‚æœçˆ¶ç›®å½•ä¸å­˜åœ¨ä¹Ÿä¼šä¸€å¹¶åˆ›å»ºã€‚ ç¤ºä¾‹ï¼šmkdir my_project rmdir (remove directory)\nä½œç”¨ï¼šåˆ é™¤ç©ºç›®å½•ã€‚ rm (remove)\nä½œç”¨ï¼šåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š rm file.txtï¼šåˆ é™¤ä¸€ä¸ªæ–‡ä»¶ã€‚ rm -r directory_nameï¼šé€’å½’åˆ é™¤ç›®å½•åŠå…¶æ‰€æœ‰å†…å®¹ã€‚ rm -f file.txtï¼šå¼ºåˆ¶åˆ é™¤ï¼Œä¸è¿›è¡Œæç¤ºã€‚ rm -rf directory_nameï¼šï¼ˆæ…ç”¨ï¼ï¼‰ å¼ºåˆ¶é€’å½’åˆ é™¤ç›®å½•ï¼Œä¸ä¼šæœ‰ä»»ä½•æç¤ºã€‚ cp (copy)\n",
"content": "Linux ä¸­éå¸¸å¸¸ç”¨å’ŒåŸºç¡€çš„å‘½ä»¤ï¼ŒæŒ‰ç…§åŠŸèƒ½è¿›è¡Œäº†åˆ†ç±»ï¼š\n1. æ–‡ä»¶å’Œç›®å½•ç®¡ç† ls (list)\nä½œç”¨ï¼šåˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š ls -lï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ˆæƒé™ã€æ‰€æœ‰è€…ã€å¤§å°ã€ä¿®æ”¹æ—¥æœŸï¼‰ã€‚ ls -aï¼šæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ï¼ˆä»¥ . å¼€å¤´çš„ï¼‰ã€‚ ls -hï¼šä¸ -l é…åˆä½¿ç”¨ï¼Œä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°ï¼ˆå¦‚ 1K, 2M, 3Gï¼‰ã€‚ ç¤ºä¾‹ï¼šls -lah /home/user cd (change directory)\nä½œç”¨ï¼šåˆ‡æ¢å½“å‰å·¥ä½œç›®å½•ã€‚ å¸¸ç”¨ç”¨æ³•ï¼š cd /var/logï¼šåˆ‡æ¢åˆ° /var/log ç›®å½•ã€‚ cd ..ï¼šåˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½•ã€‚ cd ~ æˆ– cdï¼šåˆ‡æ¢åˆ°å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚ cd -ï¼šåˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªå·¥ä½œç›®å½•ã€‚ pwd (print working directory)\nä½œç”¨ï¼šæ˜¾ç¤ºå½“å‰æ‰€åœ¨çš„ç›®å½•è·¯å¾„ã€‚ mkdir (make directory)\nä½œç”¨ï¼šåˆ›å»ºæ–°ç›®å½•ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š mkdir -p /path/to/new/dirï¼šé€’å½’åˆ›å»ºç›®å½•ï¼Œå¦‚æœçˆ¶ç›®å½•ä¸å­˜åœ¨ä¹Ÿä¼šä¸€å¹¶åˆ›å»ºã€‚ ç¤ºä¾‹ï¼šmkdir my_project rmdir (remove directory)\nä½œç”¨ï¼šåˆ é™¤ç©ºç›®å½•ã€‚ rm (remove)\nä½œç”¨ï¼šåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š rm file.txtï¼šåˆ é™¤ä¸€ä¸ªæ–‡ä»¶ã€‚ rm -r directory_nameï¼šé€’å½’åˆ é™¤ç›®å½•åŠå…¶æ‰€æœ‰å†…å®¹ã€‚ rm -f file.txtï¼šå¼ºåˆ¶åˆ é™¤ï¼Œä¸è¿›è¡Œæç¤ºã€‚ rm -rf directory_nameï¼šï¼ˆæ…ç”¨ï¼ï¼‰ å¼ºåˆ¶é€’å½’åˆ é™¤ç›®å½•ï¼Œä¸ä¼šæœ‰ä»»ä½•æç¤ºã€‚ cp (copy)\nä½œç”¨ï¼šå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•ã€‚ å¸¸ç”¨ç”¨æ³•ï¼š cp source_file destination_fileï¼šå¤åˆ¶æ–‡ä»¶ã€‚ cp source_file destination_directory/ï¼šå°†æ–‡ä»¶å¤åˆ¶åˆ°ç›®å½•ä¸­ã€‚ cp -r source_directory destination_directory/ï¼šé€’å½’å¤åˆ¶æ•´ä¸ªç›®å½•ã€‚ mv (move)\nä½œç”¨ï¼šç§»åŠ¨æ–‡ä»¶/ç›®å½•ï¼Œæˆ–è€…é‡å‘½åã€‚ å¸¸ç”¨ç”¨æ³•ï¼š mv old_name.txt new_name.txtï¼šé‡å‘½åã€‚ mv file.txt /path/to/destination/ï¼šå°†æ–‡ä»¶ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚ touch\nä½œç”¨ï¼šåˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶ï¼Œæˆ–è€…æ›´æ–°å·²æœ‰æ–‡ä»¶çš„æ—¶é—´æˆ³ã€‚ ç¤ºä¾‹ï¼štouch new_file.log find\nä½œç”¨ï¼šåœ¨æŒ‡å®šç›®å½•ä¸­æœç´¢æ–‡ä»¶ã€‚ å¸¸ç”¨ç”¨æ³•ï¼š find /home -name \u0026quot;*.txt\u0026quot;ï¼šåœ¨ /home ç›®å½•åŠå­ç›®å½•ä¸­æŸ¥æ‰¾æ‰€æœ‰ .txt æ–‡ä»¶ã€‚ find . -type d -name \u0026quot;logs\u0026quot;ï¼šåœ¨å½“å‰ç›®å½•æŸ¥æ‰¾æ‰€æœ‰åä¸º \u0026ldquo;logs\u0026rdquo; çš„ç›®å½•ã€‚ 2. æ–‡æœ¬æŸ¥çœ‹å’Œå¤„ç† cat (concatenate)\nä½œç”¨ï¼šæŸ¥çœ‹æ–‡ä»¶å†…å®¹ã€åˆå¹¶æ–‡ä»¶ã€‚ ç¤ºä¾‹ï¼šcat /etc/passwd less\nä½œç”¨ï¼šåˆ†é¡µæŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼ˆæ¯” more æ›´å¼ºå¤§ï¼Œæ”¯æŒå‰åç¿»é¡µï¼‰ã€‚ æ“ä½œï¼šæŒ‰ q é€€å‡ºï¼ŒæŒ‰ / æœç´¢ã€‚ ç¤ºä¾‹ï¼šless large_file.log head\nä½œç”¨ï¼šæ˜¾ç¤ºæ–‡ä»¶çš„å¼€å¤´å‡ è¡Œï¼ˆé»˜è®¤ 10 è¡Œï¼‰ã€‚ ç¤ºä¾‹ï¼šhead -n 20 file.txt (æ˜¾ç¤ºå‰ 20 è¡Œ) tail\nä½œç”¨ï¼šæ˜¾ç¤ºæ–‡ä»¶çš„æœ«å°¾å‡ è¡Œï¼ˆé»˜è®¤ 10 è¡Œï¼‰ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š tail -n 50 file.txt (æ˜¾ç¤ºå 50 è¡Œ) tail -f /var/log/syslogï¼šï¼ˆéå¸¸å¸¸ç”¨ï¼‰ å®æ—¶è·Ÿè¸ªæ–‡ä»¶çš„æ–°å¢å†…å®¹ï¼Œå¸¸ç”¨äºçœ‹æ—¥å¿—ã€‚ grep\nä½œç”¨ï¼šåœ¨æ–‡ä»¶ä¸­æœç´¢åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„è¡Œã€‚ å¸¸ç”¨é€‰é¡¹ï¼š grep \u0026quot;error\u0026quot; /var/log/syslogï¼šåœ¨æ–‡ä»¶ä¸­æœç´¢ \u0026ldquo;error\u0026rdquo;ã€‚ grep -r \u0026quot;my_function\u0026quot; /project/srcï¼šåœ¨ç›®å½•ä¸­é€’å½’æœç´¢ã€‚ grep -i \u0026quot;hello\u0026quot;ï¼šå¿½ç•¥å¤§å°å†™æœç´¢ã€‚ grep -v \u0026quot;debug\u0026quot;ï¼šåå‘æœç´¢ï¼Œæ˜¾ç¤ºä¸åŒ…å« \u0026ldquo;debug\u0026rdquo; çš„è¡Œã€‚ wc (word count)\nä½œç”¨ï¼šç»Ÿè®¡æ–‡ä»¶çš„è¡Œæ•°ã€å•è¯æ•°ã€å­—èŠ‚æ•°ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š wc -l file.txtï¼šåªç»Ÿè®¡è¡Œæ•°ã€‚ wc -w file.txtï¼šåªç»Ÿè®¡å•è¯æ•°ã€‚ wc -c file.txtï¼šåªç»Ÿè®¡å­—èŠ‚æ•°ã€‚ diff\nä½œç”¨ï¼šæ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å·®å¼‚ã€‚ ç¤ºä¾‹ï¼šdiff file1.txt file2.txt 3. ç³»ç»Ÿä¿¡æ¯å’Œç›‘æ§ df (disk free)\nä½œç”¨ï¼šæŸ¥çœ‹ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚ å¸¸ç”¨é€‰é¡¹ï¼šdf -h (ä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤º)ã€‚ du (disk usage)\nä½œç”¨ï¼šæŸ¥çœ‹æ–‡ä»¶æˆ–ç›®å½•å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š du -sh /path/to/directoryï¼šæŸ¥çœ‹æŒ‡å®šç›®å½•çš„æ€»å¤§å° (-s æ€»ç»“, -h äººç±»å¯è¯»)ã€‚ du -h --max-depth=1 /homeï¼šæŸ¥çœ‹ /home ç›®å½•ä¸‹ç¬¬ä¸€çº§å­ç›®å½•å„è‡ªçš„å¤§å°ã€‚ top\nä½œç”¨ï¼šå®æ—¶åŠ¨æ€åœ°æ˜¾ç¤ºç³»ç»Ÿè¿›ç¨‹å’Œèµ„æºå ç”¨æƒ…å†µï¼ˆCPUã€å†…å­˜ç­‰ï¼‰ã€‚ æ“ä½œï¼šæŒ‰ q é€€å‡ºï¼ŒæŒ‰ P æŒ‰ CPU æ’åºï¼ŒæŒ‰ M æŒ‰å†…å­˜æ’åºã€‚ htop\nä½œç”¨ï¼štop çš„å¢å¼ºç‰ˆï¼Œç•Œé¢æ›´å‹å¥½ï¼Œæ”¯æŒé¼ æ ‡æ“ä½œï¼ˆå¯èƒ½éœ€è¦é¢å¤–å®‰è£…ï¼‰ã€‚ free\nä½œç”¨ï¼šæŸ¥çœ‹å†…å­˜å’Œäº¤æ¢ç©ºé—´ï¼ˆswapï¼‰çš„ä½¿ç”¨æƒ…å†µã€‚ å¸¸ç”¨é€‰é¡¹ï¼šfree -h (ä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤º)ã€‚ ps (process status)\nä½œç”¨ï¼šæŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„è¿›ç¨‹çŠ¶æ€ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š ps auxï¼šæ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹ï¼ˆBSD é£æ ¼ï¼‰ã€‚ ps -efï¼šæ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹çš„å®Œæ•´ä¿¡æ¯ï¼ˆSystem V é£æ ¼ï¼‰ã€‚ ç»„åˆä½¿ç”¨ï¼šps aux | grep \u0026quot;nginx\u0026quot; (æŸ¥æ‰¾ nginx ç›¸å…³çš„è¿›ç¨‹)ã€‚ kill\nä½œç”¨ï¼šå‘è¿›ç¨‹å‘é€ä¿¡å·ï¼Œé€šå¸¸ç”¨äºç»ˆæ­¢è¿›ç¨‹ã€‚ å¸¸ç”¨ç”¨æ³•ï¼š kill [PID]ï¼šç»ˆæ­¢æŒ‡å®š PID çš„è¿›ç¨‹ (å‘é€ SIGTERM ä¿¡å·)ã€‚ kill -9 [PID]ï¼šï¼ˆæ…ç”¨ï¼‰ å¼ºåˆ¶æ€æ­»è¿›ç¨‹ (å‘é€ SIGKILL ä¿¡å·)ã€‚ uptime\nä½œç”¨ï¼šæ˜¾ç¤ºç³»ç»Ÿå·²è¿è¡Œæ—¶é—´ã€ç™»å½•ç”¨æˆ·æ•°ä»¥åŠç³»ç»Ÿå¹³å‡è´Ÿè½½ã€‚ uname\nä½œç”¨ï¼šæ˜¾ç¤ºç³»ç»Ÿå†…æ ¸å’Œæ“ä½œç³»ç»Ÿä¿¡æ¯ã€‚ å¸¸ç”¨é€‰é¡¹ï¼šuname -a (æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯)ã€‚ 4. æƒé™ç®¡ç† chmod (change mode)\nä½œç”¨ï¼šä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚ å¸¸ç”¨ç”¨æ³•ï¼š chmod 755 script.sh (ä½¿ç”¨æ•°å­—è®¾ç½®æƒé™ï¼šrwx r-x r-x)ã€‚ chmod +x script.sh (ç»™æ–‡ä»¶æ·»åŠ æ‰§è¡Œæƒé™)ã€‚ chmod -R 644 /path/to/dir (é€’å½’ä¿®æ”¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„æƒé™)ã€‚ chown (change owner)\nä½œç”¨ï¼šä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ã€‚ å¸¸ç”¨ç”¨æ³•ï¼š chown new_owner file.txtï¼šä¿®æ”¹æ‰€æœ‰è€…ã€‚ chown new_owner:new_group file.txtï¼šåŒæ—¶ä¿®æ”¹æ‰€æœ‰è€…å’Œç»„ã€‚ chown -R user:group /path/to/dirï¼šé€’å½’ä¿®æ”¹ã€‚ sudo\nä½œç”¨ï¼šä»¥è¶…çº§ç”¨æˆ·ï¼ˆrootï¼‰æˆ–å…¶ä»–ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ã€‚ ç¤ºä¾‹ï¼šsudo apt update (åœ¨ Ubuntu/Debian ä¸Šä»¥ root æƒé™æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨)ã€‚ 5. ç½‘ç»œå‘½ä»¤ ping\nä½œç”¨ï¼šæµ‹è¯•ä¸å¦ä¸€å°ä¸»æœºä¹‹é—´çš„ç½‘ç»œè¿æ¥ã€‚ ç¤ºä¾‹ï¼šping baidu.com curl\nä½œç”¨ï¼šä¸€ä¸ªå¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºä¼ è¾“æ•°æ®ï¼Œå¸¸ç”¨äºæµ‹è¯• HTTP è¯·æ±‚ã€‚ ç¤ºä¾‹ï¼šcurl https://api.example.com/data wget\nä½œç”¨ï¼šç”¨äºä»ç½‘ç»œä¸Šä¸‹è½½æ–‡ä»¶ã€‚ ç¤ºä¾‹ï¼šwget https://example.com/large_file.zip ip\nä½œç”¨ï¼šæ˜¾ç¤ºå’Œç®¡ç†è·¯ç”±ã€ç½‘ç»œè®¾å¤‡ã€ç­–ç•¥è·¯ç”±å’Œéš§é“ï¼ˆæ­£åœ¨å–ä»£ ifconfigï¼‰ã€‚ å¸¸ç”¨ç”¨æ³•ï¼š ip addr show æˆ– ip aï¼šæŸ¥çœ‹ IP åœ°å€ã€‚ ip route showï¼šæŸ¥çœ‹è·¯ç”±è¡¨ã€‚ netstat (æˆ– ss)\nä½œç”¨ï¼šæŸ¥çœ‹ç½‘ç»œè¿æ¥ã€è·¯ç”±è¡¨ã€æ¥å£ç»Ÿè®¡ç­‰ã€‚ å¸¸ç”¨é€‰é¡¹ï¼šnetstat -tulnp (æ˜¾ç¤º TCP/UDP çš„ç›‘å¬ç«¯å£åŠå¯¹åº”çš„ç¨‹åºå)ã€‚ ç°ä»£æ›¿ä»£ï¼šss -tulnp (åŠŸèƒ½ç±»ä¼¼ netstatï¼Œä½†æ›´é«˜æ•ˆ)ã€‚ 6. å‹ç¼©å’Œå½’æ¡£ tar\nä½œç”¨ï¼šæ‰“åŒ…å’Œè§£åŒ… .tar æ–‡ä»¶ï¼Œç»å¸¸ä¸ gzip æˆ– bzip2 é…åˆä½¿ç”¨ã€‚ å¸¸ç”¨é€‰é¡¹ï¼š tar -cvf archive.tar /path/to/dirï¼šæ‰“åŒ… (-c åˆ›å»º, -v æ˜¾ç¤ºè¿‡ç¨‹, -f æŒ‡å®šæ–‡ä»¶å)ã€‚ tar -xvf archive.tarï¼šè§£åŒ…ã€‚ tar -czvf archive.tar.gz /path/to/dirï¼šæ‰“åŒ…å¹¶ç”¨ gzip å‹ç¼© (-z)ã€‚ tar -xzvf archive.tar.gzï¼šè§£å‹ gzip å‹ç¼©åŒ…ã€‚ tar -cjvf archive.tar.bz2 /path/to/dirï¼šæ‰“åŒ…å¹¶ç”¨ bzip2 å‹ç¼© (-j)ã€‚ tar -xjvf archive.tar.bz2ï¼šè§£å‹ bzip2 å‹ç¼©åŒ…ã€‚ gzip\nä½œç”¨ï¼šå‹ç¼©æ–‡ä»¶ï¼ˆç”Ÿæˆ .gz æ–‡ä»¶ï¼‰ã€‚ ç¤ºä¾‹ï¼šgzip file.txt (ä¼šç”Ÿæˆ file.txt.gz å¹¶åˆ é™¤åŸæ–‡ä»¶)ã€‚ è§£å‹ï¼šgunzip file.txt.gz zip / unzip\nä½œç”¨ï¼šç”¨äºå¤„ç† .zip æ ¼å¼çš„å‹ç¼©æ–‡ä»¶ã€‚ ç¤ºä¾‹ï¼š zip -r archive.zip directory/ unzip archive.zip 7. å…¶ä»–å¸¸ç”¨å‘½ä»¤ man (manual)\nä½œç”¨ï¼šæŸ¥çœ‹å‘½ä»¤çš„å¸®åŠ©æ‰‹å†Œã€‚ ç¤ºä¾‹ï¼šman ls (æŸ¥çœ‹ ls å‘½ä»¤çš„ç”¨æ³•)ã€‚ history\nä½œç”¨ï¼šæ˜¾ç¤ºåœ¨ shell ä¸­æ‰§è¡Œè¿‡çš„å†å²å‘½ä»¤ã€‚ echo\nä½œç”¨ï¼šåœ¨ç»ˆç«¯æ‰“å°è¾“å‡ºæ–‡æœ¬æˆ–å˜é‡ã€‚ ç¤ºä¾‹ï¼šecho \u0026quot;Hello World\u0026quot; | (ç®¡é“ç¬¦)\nä½œç”¨ï¼šå°†ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºå¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ã€‚ ç¤ºä¾‹ï¼šps aux | grep \u0026quot;chrome\u0026quot; (å°† ps çš„è¾“å‡ºäº¤ç»™ grep æ¥è¿‡æ»¤)ã€‚ \u0026gt; å’Œ \u0026gt;\u0026gt; (é‡å®šå‘)\nä½œç”¨ï¼šå°†å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ã€‚ \u0026gt;ï¼šè¦†ç›–å†™å…¥ã€‚ls -l \u0026gt; file_list.txt \u0026gt;\u0026gt;ï¼šè¿½åŠ å†™å…¥ã€‚echo \u0026quot;New log entry\u0026quot; \u0026gt;\u0026gt; app.log æŒæ¡è¿™äº›å‘½ä»¤æ˜¯é«˜æ•ˆä½¿ç”¨ Linux ç³»ç»Ÿçš„åŸºç¡€ã€‚\n",
"tags":null,
"categories":null
},{
"title":"Go åœºæ™¯é¢˜æ¨¡ç‰ˆ",
"permalink": "http://localhost:1313/posts/scenario/%E5%9C%BA%E6%99%AF%E9%A2%98%E6%A8%A1%E7%89%88/",
"summary": "Go åœºæ™¯é¢˜è®­ç»ƒæ‰‹å†Œ â€” é¢˜ç›®ç‰ˆ ä½œè€…ï¼šcp yang è¯´æ˜ï¼šåˆ†ä¸º åˆçº§ / ä¸­çº§ / é«˜çº§ / å®æˆ˜ Debug å››ä¸ªç« èŠ‚ã€‚æ¯é¢˜ä¸ºé¢è¯•å¸¸è§åœºæ™¯é¢˜ï¼ˆç”¨äºç»ƒä¹ ï¼‰\nğŸŸ¢ åˆçº§åœºæ™¯é¢˜ï¼ˆè¯­è¨€ç‰¹æ€§ä¸é™·é˜±ï¼‰ åˆ‡ç‰‡åœ¨å‡½æ•°å‚æ•°ä¼ é€’æ—¶ï¼Œä»€ä¹ˆæ—¶å€™ä¼šå½±å“å¤–éƒ¨æ•°æ®ï¼Ÿè¯·ä¸¾ä¾‹å¹¶è§£é‡Šã€‚ for range vs for i := 0; i \u0026lt; len(slice); i++ï¼Œåœ¨ä¿®æ”¹å…ƒç´ å’Œæ•ˆç‡ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ map åˆå§‹åŒ–çš„æ­£ç¡®å†™æ³•æœ‰å“ªäº›ï¼Ÿå“ªäº›å†™æ³•ä¼šå¯¼è‡´ panicï¼Ÿ defer çš„æ‰§è¡Œé¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿreturn ä¸ defer çš„æ‰§è¡Œé¡ºåºå¦‚ä½•ï¼Ÿ append æ‰©å®¹æ—¶å¦‚ä½•å½±å“åº•å±‚æ•°ç»„ï¼Ÿå¦‚ä½•é¿å…ä¸å¿…è¦çš„å¤åˆ¶ï¼Ÿ string ä¸ []byte è½¬æ¢åœ¨é«˜é¢‘åœºæ™¯ä¸‹çš„æ€§èƒ½é—®é¢˜å¦‚ä½•ä¼˜åŒ–ï¼Ÿ å®ç°ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ç®€å• mapï¼ˆæ”¯æŒ Get/Set/Deleteï¼‰ã€‚ ğŸŸ¡ ä¸­çº§åœºæ™¯é¢˜ï¼ˆå¹¶å‘ä¸æ§åˆ¶ï¼‰ å¦‚ä½•ä½¿ç”¨ sync.WaitGroup æ§åˆ¶å¹¶å‘ä»»åŠ¡ï¼Ÿè¯·ç»™å‡ºç¤ºä¾‹ï¼Œå¹¶è¯´æ˜å¸¸è§é”™è¯¯ã€‚ è®¾è®¡ä¸€ä¸ªå›ºå®šå¤§å°çš„ goroutine æ± ï¼ˆworker poolï¼‰ï¼Œèƒ½æäº¤ä»»åŠ¡å¹¶ç­‰å¾…å®Œæˆã€‚ è®¾è®¡ä¸€ä¸ªç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼Œæ”¯æŒå¤šç”Ÿäº§è€…ã€å¤šæ¶ˆè´¹è€…ï¼Œå¹¶èƒ½ä¼˜é›…é€€å‡ºã€‚ å®ç°ä¸¤ä¸ª goroutine äº¤æ›¿æ‰“å° 1~100ï¼ˆA æ‰“å° 1ï¼ŒB æ‰“å° 2ï¼Œä¾æ¬¡äº¤æ›¿ï¼‰ã€‚ å¦‚ä½•é™åˆ¶å¹¶å‘æ•°é‡ï¼ˆä¾‹å¦‚åŒæ—¶æœ€å¤š 10 ä¸ªä»»åŠ¡ï¼‰ï¼Ÿç»™å‡ºå®ç°ã€‚ ä½¿ç”¨ context å®ç°ä»»åŠ¡è¶…æ—¶ä¸å–æ¶ˆï¼Œç»™å‡ºç¤ºä¾‹ã€‚ ğŸ”´ é«˜çº§åœºæ™¯é¢˜ï¼ˆç³»ç»Ÿè®¾è®¡ä¸æ€§èƒ½ï¼‰ è®¾è®¡ä¸€ä¸ªæœ¬åœ°ç¼“å­˜ç³»ç»Ÿï¼Œæ”¯æŒ TTLã€å¹¶å‘å®‰å…¨å’Œå®šæœŸæ¸…ç†ã€‚å†™å‡ºæ ¸å¿ƒæ¥å£ä¸å®ç°è¦ç‚¹ã€‚ è®¾è®¡å¹¶å®ç°ä¸€ä¸ª LRU ç¼“å­˜ï¼ˆmap + åŒå‘é“¾è¡¨ï¼‰ï¼Œè¦æ±‚å¹¶å‘å®‰å…¨ã€‚ è®¾è®¡ä¸€ä¸ªç®€æ˜“æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆæ”¯æŒå‘å¸ƒ/è®¢é˜…ã€å¯æŒä¹…åŒ–æ€è·¯è¯´æ˜ï¼‰ã€‚å†™å‡ºå…³é”®æ•°æ®ç»“æ„ä¸ä¼ªç ã€‚ å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜å¹¶å‘çš„ç§’æ€ç³»ç»Ÿä»¥é˜²æ­¢è¶…å–ï¼Ÿç»™å‡ºæ¶æ„æ€è·¯ä¸å…³é”®ä»£ç ç‰‡æ®µï¼ˆRedis/æœ¬åœ°é¢„å‡åº“å­˜ç­‰ï¼‰ã€‚ è®¾è®¡ä¸€ä¸ªé™æµç»„ä»¶ï¼ˆä»¤ç‰Œæ¡¶ï¼‰ï¼Œå®ç°æ¥å£å¹¶è¯´æ˜åœ¨å¾®æœåŠ¡ç½‘å…³å¦‚ä½•ä½¿ç”¨ã€‚ âš™ï¸ å®æˆ˜ Debug åœºæ™¯é¢˜ï¼ˆæ’éšœä¸ä¼˜åŒ–ï¼‰ ç¨‹åºå‡ºç°å¤§é‡ goroutine æ³„æ¼ï¼ˆæ•°é‡ä¸æ–­å¢é•¿ï¼‰ï¼Œä½ å¦‚ä½•æ’æŸ¥ï¼Ÿåˆ—å‡ºæ’æŸ¥æ­¥éª¤ä¸ pprof ä½¿ç”¨æ–¹æ³•ã€‚ å‡ºç°æ­»é”ï¼ˆç¨‹åºå¡ä½ï¼‰ï¼Œå¦‚ä½•å®šä½å’Œä¿®å¤ï¼Ÿç»™å‡ºç¤ºä¾‹ä»£ç åŠä¿®æ”¹å»ºè®®ã€‚ ç¨‹åºå†…å­˜æš´æ¶¨å¹¶è§¦å‘ GC å‹åŠ›ï¼Œå¦‚ä½•åˆ†æåŸå› å¹¶ç»™å‡ºä¼˜åŒ–æ–¹æ¡ˆï¼Ÿ é«˜å¹¶å‘ä¸‹é”ç«äº‰ä¸¥é‡ï¼ˆé€šè¿‡ Mutex çœ‹åˆ° QPS é™ä½ï¼‰ï¼Œå¦‚ä½•è¯Šæ–­å¹¶ä¼˜åŒ–ï¼Ÿ ä½¿ç”¨ pprof æ‰¾åˆ°çƒ­ç‚¹ CPU å ç”¨ç‚¹åï¼Œä½ ä¼šå¦‚ä½•æ”¹è¿›ä»£ç ï¼Ÿç»™å‡ºä¸€ä¸ªç®€å•ç¤ºä¾‹ã€‚ ",
"content": "Go åœºæ™¯é¢˜è®­ç»ƒæ‰‹å†Œ â€” é¢˜ç›®ç‰ˆ ä½œè€…ï¼šcp yang è¯´æ˜ï¼šåˆ†ä¸º åˆçº§ / ä¸­çº§ / é«˜çº§ / å®æˆ˜ Debug å››ä¸ªç« èŠ‚ã€‚æ¯é¢˜ä¸ºé¢è¯•å¸¸è§åœºæ™¯é¢˜ï¼ˆç”¨äºç»ƒä¹ ï¼‰\nğŸŸ¢ åˆçº§åœºæ™¯é¢˜ï¼ˆè¯­è¨€ç‰¹æ€§ä¸é™·é˜±ï¼‰ åˆ‡ç‰‡åœ¨å‡½æ•°å‚æ•°ä¼ é€’æ—¶ï¼Œä»€ä¹ˆæ—¶å€™ä¼šå½±å“å¤–éƒ¨æ•°æ®ï¼Ÿè¯·ä¸¾ä¾‹å¹¶è§£é‡Šã€‚ for range vs for i := 0; i \u0026lt; len(slice); i++ï¼Œåœ¨ä¿®æ”¹å…ƒç´ å’Œæ•ˆç‡ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ map åˆå§‹åŒ–çš„æ­£ç¡®å†™æ³•æœ‰å“ªäº›ï¼Ÿå“ªäº›å†™æ³•ä¼šå¯¼è‡´ panicï¼Ÿ defer çš„æ‰§è¡Œé¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿreturn ä¸ defer çš„æ‰§è¡Œé¡ºåºå¦‚ä½•ï¼Ÿ append æ‰©å®¹æ—¶å¦‚ä½•å½±å“åº•å±‚æ•°ç»„ï¼Ÿå¦‚ä½•é¿å…ä¸å¿…è¦çš„å¤åˆ¶ï¼Ÿ string ä¸ []byte è½¬æ¢åœ¨é«˜é¢‘åœºæ™¯ä¸‹çš„æ€§èƒ½é—®é¢˜å¦‚ä½•ä¼˜åŒ–ï¼Ÿ å®ç°ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ç®€å• mapï¼ˆæ”¯æŒ Get/Set/Deleteï¼‰ã€‚ ğŸŸ¡ ä¸­çº§åœºæ™¯é¢˜ï¼ˆå¹¶å‘ä¸æ§åˆ¶ï¼‰ å¦‚ä½•ä½¿ç”¨ sync.WaitGroup æ§åˆ¶å¹¶å‘ä»»åŠ¡ï¼Ÿè¯·ç»™å‡ºç¤ºä¾‹ï¼Œå¹¶è¯´æ˜å¸¸è§é”™è¯¯ã€‚ è®¾è®¡ä¸€ä¸ªå›ºå®šå¤§å°çš„ goroutine æ± ï¼ˆworker poolï¼‰ï¼Œèƒ½æäº¤ä»»åŠ¡å¹¶ç­‰å¾…å®Œæˆã€‚ è®¾è®¡ä¸€ä¸ªç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼Œæ”¯æŒå¤šç”Ÿäº§è€…ã€å¤šæ¶ˆè´¹è€…ï¼Œå¹¶èƒ½ä¼˜é›…é€€å‡ºã€‚ å®ç°ä¸¤ä¸ª goroutine äº¤æ›¿æ‰“å° 1~100ï¼ˆA æ‰“å° 1ï¼ŒB æ‰“å° 2ï¼Œä¾æ¬¡äº¤æ›¿ï¼‰ã€‚ å¦‚ä½•é™åˆ¶å¹¶å‘æ•°é‡ï¼ˆä¾‹å¦‚åŒæ—¶æœ€å¤š 10 ä¸ªä»»åŠ¡ï¼‰ï¼Ÿç»™å‡ºå®ç°ã€‚ ä½¿ç”¨ context å®ç°ä»»åŠ¡è¶…æ—¶ä¸å–æ¶ˆï¼Œç»™å‡ºç¤ºä¾‹ã€‚ ğŸ”´ é«˜çº§åœºæ™¯é¢˜ï¼ˆç³»ç»Ÿè®¾è®¡ä¸æ€§èƒ½ï¼‰ è®¾è®¡ä¸€ä¸ªæœ¬åœ°ç¼“å­˜ç³»ç»Ÿï¼Œæ”¯æŒ TTLã€å¹¶å‘å®‰å…¨å’Œå®šæœŸæ¸…ç†ã€‚å†™å‡ºæ ¸å¿ƒæ¥å£ä¸å®ç°è¦ç‚¹ã€‚ è®¾è®¡å¹¶å®ç°ä¸€ä¸ª LRU ç¼“å­˜ï¼ˆmap + åŒå‘é“¾è¡¨ï¼‰ï¼Œè¦æ±‚å¹¶å‘å®‰å…¨ã€‚ è®¾è®¡ä¸€ä¸ªç®€æ˜“æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆæ”¯æŒå‘å¸ƒ/è®¢é˜…ã€å¯æŒä¹…åŒ–æ€è·¯è¯´æ˜ï¼‰ã€‚å†™å‡ºå…³é”®æ•°æ®ç»“æ„ä¸ä¼ªç ã€‚ å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜å¹¶å‘çš„ç§’æ€ç³»ç»Ÿä»¥é˜²æ­¢è¶…å–ï¼Ÿç»™å‡ºæ¶æ„æ€è·¯ä¸å…³é”®ä»£ç ç‰‡æ®µï¼ˆRedis/æœ¬åœ°é¢„å‡åº“å­˜ç­‰ï¼‰ã€‚ è®¾è®¡ä¸€ä¸ªé™æµç»„ä»¶ï¼ˆä»¤ç‰Œæ¡¶ï¼‰ï¼Œå®ç°æ¥å£å¹¶è¯´æ˜åœ¨å¾®æœåŠ¡ç½‘å…³å¦‚ä½•ä½¿ç”¨ã€‚ âš™ï¸ å®æˆ˜ Debug åœºæ™¯é¢˜ï¼ˆæ’éšœä¸ä¼˜åŒ–ï¼‰ ç¨‹åºå‡ºç°å¤§é‡ goroutine æ³„æ¼ï¼ˆæ•°é‡ä¸æ–­å¢é•¿ï¼‰ï¼Œä½ å¦‚ä½•æ’æŸ¥ï¼Ÿåˆ—å‡ºæ’æŸ¥æ­¥éª¤ä¸ pprof ä½¿ç”¨æ–¹æ³•ã€‚ å‡ºç°æ­»é”ï¼ˆç¨‹åºå¡ä½ï¼‰ï¼Œå¦‚ä½•å®šä½å’Œä¿®å¤ï¼Ÿç»™å‡ºç¤ºä¾‹ä»£ç åŠä¿®æ”¹å»ºè®®ã€‚ ç¨‹åºå†…å­˜æš´æ¶¨å¹¶è§¦å‘ GC å‹åŠ›ï¼Œå¦‚ä½•åˆ†æåŸå› å¹¶ç»™å‡ºä¼˜åŒ–æ–¹æ¡ˆï¼Ÿ é«˜å¹¶å‘ä¸‹é”ç«äº‰ä¸¥é‡ï¼ˆé€šè¿‡ Mutex çœ‹åˆ° QPS é™ä½ï¼‰ï¼Œå¦‚ä½•è¯Šæ–­å¹¶ä¼˜åŒ–ï¼Ÿ ä½¿ç”¨ pprof æ‰¾åˆ°çƒ­ç‚¹ CPU å ç”¨ç‚¹åï¼Œä½ ä¼šå¦‚ä½•æ”¹è¿›ä»£ç ï¼Ÿç»™å‡ºä¸€ä¸ªç®€å•ç¤ºä¾‹ã€‚ ",
"tags":null,
"categories":null
},{
"title":"Go åœºæ™¯é¢˜æ¨¡ç‰ˆ â€” ç­”æ¡ˆç‰ˆ",
"permalink": "http://localhost:1313/posts/scenario/%E5%9C%BA%E6%99%AF%E9%A2%98%E6%A8%A1%E7%89%88-%E7%AD%94%E6%A1%88/",
"summary": " ğŸŸ¢ åˆçº§åœºæ™¯é¢˜ï¼ˆè¯­è¨€ç‰¹æ€§ä¸é™·é˜±ï¼‰ 1. åˆ‡ç‰‡åœ¨å‡½æ•°å‚æ•°ä¼ é€’æ—¶ï¼Œä»€ä¹ˆæ—¶å€™ä¼šå½±å“å¤–éƒ¨æ•°æ®ï¼Ÿ æ€è·¯ï¼š åˆ‡ç‰‡æ˜¯ä¸‰å…ƒç»„ï¼ˆæŒ‡é’ˆã€lenã€capï¼‰ã€‚ä¼ å‚æ—¶ä¼šæ‹·è´è¿™ä¸‰é¡¹ï¼Œä½†åº•å±‚æ•°ç»„ä»ç„¶å…±äº«ã€‚åªæœ‰å½“ append å¯¼è‡´æ‰©å®¹ï¼ˆæ–°çš„åº•å±‚æ•°ç»„åˆ†é…ï¼‰æˆ–ä¿®æ”¹é€šè¿‡ç´¢å¼•ç›´æ¥å†™å…¥æ—¶ï¼Œå¤–éƒ¨å¯è§ã€‚\nç›´æ¥ s[i] = x ä¼šå½±å“å¤–éƒ¨ï¼› s = append(s, x) å½“ cap ä¸è¶³æ—¶ä¼šåˆ†é…æ–°æ•°ç»„ï¼Œå¤–éƒ¨ä¸ä¼šçœ‹åˆ°æ–°å…ƒç´ ã€‚ ç¤ºä¾‹ä»£ç ï¼š\npackage main import \u0026#34;fmt\u0026#34; func appendMaybe(s []int) []int { s = append(s, 100) // è‹¥ cap ä¸è¶³ï¼Œè¿™é‡Œä¼šåˆ†é…æ–°åº•å±‚æ•°ç»„ return s } func modify(s []int) { if len(s) \u0026gt; 0 { s[0] = 999 // ä¿®æ”¹å…±äº«åº•å±‚æ•°ç»„ } } func main() { a := make([]int, 1, 1) a[0] = 1 b := appendMaybe(a) fmt.Println(\u0026#34;a:\u0026#34;, a) // å¦‚æœæ‰©å®¹å‘ç”Ÿï¼Œa ä¸åŒ…å« 100 fmt.Println(\u0026#34;b:\u0026#34;, b) c := make([]int, 1, 2) c[0] = 1 d := appendMaybe(c) fmt.Println(\u0026#34;c:\u0026#34;, c) // cap è¶³å¤Ÿï¼Œc ä¼šçœ‹åˆ° append çš„ç»“æœ (å¦‚æœ append reuses) fmt.Println(\u0026#34;d:\u0026#34;, d) modify(a) fmt.Println(\u0026#34;a after modify:\u0026#34;, a) // è¢«ä¿®æ”¹ } 2. for range vs for i := 0; i \u0026lt; len(slice); i++ æ€è·¯ï¼š for range ä¼šåœ¨æ¯æ¬¡è¿­ä»£æ—¶æŠŠå…ƒç´ æ‹·è´åˆ°æ–°çš„å˜é‡ï¼ˆvï¼‰ï¼Œå› æ­¤ç›´æ¥ä¿®æ”¹ v ä¸ä¼šå½±å“åˆ‡ç‰‡ã€‚ç´¢å¼•è®¿é—® slice[i] ç›´æ¥è®¿é—®åº•å±‚æ•°ç»„å¯ä»¥ä¿®æ”¹åŸå€¼ã€‚æ€§èƒ½ä¸Šä¸¤è€…å·®å¼‚å¾ˆå°ï¼Œé™¤éå…ƒç´ ä¸ºå¤§ç»“æ„ä½“ï¼Œrange ä¼šæ‹·è´æ•´ä¸ªç»“æ„ä½“ã€‚\n",
"content": " ğŸŸ¢ åˆçº§åœºæ™¯é¢˜ï¼ˆè¯­è¨€ç‰¹æ€§ä¸é™·é˜±ï¼‰ 1. åˆ‡ç‰‡åœ¨å‡½æ•°å‚æ•°ä¼ é€’æ—¶ï¼Œä»€ä¹ˆæ—¶å€™ä¼šå½±å“å¤–éƒ¨æ•°æ®ï¼Ÿ æ€è·¯ï¼š åˆ‡ç‰‡æ˜¯ä¸‰å…ƒç»„ï¼ˆæŒ‡é’ˆã€lenã€capï¼‰ã€‚ä¼ å‚æ—¶ä¼šæ‹·è´è¿™ä¸‰é¡¹ï¼Œä½†åº•å±‚æ•°ç»„ä»ç„¶å…±äº«ã€‚åªæœ‰å½“ append å¯¼è‡´æ‰©å®¹ï¼ˆæ–°çš„åº•å±‚æ•°ç»„åˆ†é…ï¼‰æˆ–ä¿®æ”¹é€šè¿‡ç´¢å¼•ç›´æ¥å†™å…¥æ—¶ï¼Œå¤–éƒ¨å¯è§ã€‚\nç›´æ¥ s[i] = x ä¼šå½±å“å¤–éƒ¨ï¼› s = append(s, x) å½“ cap ä¸è¶³æ—¶ä¼šåˆ†é…æ–°æ•°ç»„ï¼Œå¤–éƒ¨ä¸ä¼šçœ‹åˆ°æ–°å…ƒç´ ã€‚ ç¤ºä¾‹ä»£ç ï¼š\npackage main import \u0026#34;fmt\u0026#34; func appendMaybe(s []int) []int { s = append(s, 100) // è‹¥ cap ä¸è¶³ï¼Œè¿™é‡Œä¼šåˆ†é…æ–°åº•å±‚æ•°ç»„ return s } func modify(s []int) { if len(s) \u0026gt; 0 { s[0] = 999 // ä¿®æ”¹å…±äº«åº•å±‚æ•°ç»„ } } func main() { a := make([]int, 1, 1) a[0] = 1 b := appendMaybe(a) fmt.Println(\u0026#34;a:\u0026#34;, a) // å¦‚æœæ‰©å®¹å‘ç”Ÿï¼Œa ä¸åŒ…å« 100 fmt.Println(\u0026#34;b:\u0026#34;, b) c := make([]int, 1, 2) c[0] = 1 d := appendMaybe(c) fmt.Println(\u0026#34;c:\u0026#34;, c) // cap è¶³å¤Ÿï¼Œc ä¼šçœ‹åˆ° append çš„ç»“æœ (å¦‚æœ append reuses) fmt.Println(\u0026#34;d:\u0026#34;, d) modify(a) fmt.Println(\u0026#34;a after modify:\u0026#34;, a) // è¢«ä¿®æ”¹ } 2. for range vs for i := 0; i \u0026lt; len(slice); i++ æ€è·¯ï¼š for range ä¼šåœ¨æ¯æ¬¡è¿­ä»£æ—¶æŠŠå…ƒç´ æ‹·è´åˆ°æ–°çš„å˜é‡ï¼ˆvï¼‰ï¼Œå› æ­¤ç›´æ¥ä¿®æ”¹ v ä¸ä¼šå½±å“åˆ‡ç‰‡ã€‚ç´¢å¼•è®¿é—® slice[i] ç›´æ¥è®¿é—®åº•å±‚æ•°ç»„å¯ä»¥ä¿®æ”¹åŸå€¼ã€‚æ€§èƒ½ä¸Šä¸¤è€…å·®å¼‚å¾ˆå°ï¼Œé™¤éå…ƒç´ ä¸ºå¤§ç»“æ„ä½“ï¼Œrange ä¼šæ‹·è´æ•´ä¸ªç»“æ„ä½“ã€‚\nç¤ºä¾‹ï¼š\npackage main import \u0026#34;fmt\u0026#34; type Big struct{ X [100]int } func main() { s := []Big{{}, {}} for i, v := range s { v.X[0] = 1 // ä¿®æ”¹çš„æ˜¯ v çš„æ‹·è´ï¼Œä¸ä¼šå½±å“ s[i] fmt.Println(\u0026#34;range modified v:\u0026#34;, i, v.X[0]) } for i := range s { s[i].X[0] = 2 // ç›´æ¥ä¿®æ”¹åº•å±‚æ•°ç»„ fmt.Println(\u0026#34;index modified:\u0026#34;, i, s[i].X[0]) } fmt.Println(\u0026#34;final:\u0026#34;, s[0].X[0], s[1].X[0]) } 3. map åˆå§‹åŒ–çš„æ­£ç¡®å†™æ³• æ€è·¯ï¼š æœªåˆå§‹åŒ–çš„ var m map[K]V ä¸º nilï¼Œå†™å…¥ä¼š panicã€‚æ­£ç¡®æ–¹å¼ï¼šm := make(map[string]int) æˆ– m := map[string]int{}ã€‚åœ¨å¹¶å‘åœºæ™¯ä½¿ç”¨ sync.Mutex æˆ– sync.Mapã€‚\nç¤ºä¾‹ï¼š\npackage main import \u0026#34;fmt\u0026#34; func main() { var a map[string]int // a[\u0026#34;x\u0026#34;] = 1 // panic: assignment to entry in nil map b := make(map[string]int) b[\u0026#34;x\u0026#34;] = 1 fmt.Println(b) c := map[string]int{\u0026#34;y\u0026#34;:2} fmt.Println(c) } 4. defer çš„æ‰§è¡Œé¡ºåºä¸ return æ€è·¯ï¼š defer æŒ‰ LIFOï¼ˆåè¿›å…ˆå‡ºï¼‰é¡ºåºæ‰§è¡Œã€‚å‡½æ•°è¿”å›æ—¶ä¼šå…ˆè®¡ç®—è¿”å›å€¼ï¼ˆè‹¥æœ‰å‘½åè¿”å›å€¼åˆ™æ˜¯èµ‹å€¼è¿‡ç¨‹ï¼‰ï¼Œç„¶åæ‰§è¡Œ deferï¼Œæœ€åçœŸæ­£è¿”å›ã€‚è‹¥ defer ä¿®æ”¹äº†å‘½åè¿”å›å€¼ï¼Œåˆ™è¿”å›å€¼ä¼šå˜ã€‚\nç¤ºä¾‹ï¼š\npackage main import \u0026#34;fmt\u0026#34; func f() (r int) { defer func() { r += 1 // ä¿®æ”¹å‘½åè¿”å›å€¼ }() return 1 // ä¼šå…ˆå°† r=1ï¼Œç„¶åæ‰§è¡Œ deferï¼Œä½¿å¾— r=2ï¼Œæœ€ç»ˆè¿”å› 2 } func main() { fmt.Println(f()) // è¾“å‡º 2 } 5. append æ‰©å®¹ä¸é¿å…å¤åˆ¶ æ€è·¯ï¼š å½“ slice çš„ len \u0026lt; cap æ—¶ append ä¸ä¼šåˆ†é…æ–°æ•°ç»„ï¼›è‹¥éœ€è¦é¿å…å¤åˆ¶å¯ä»¥æå‰ make å‡ºåˆé€‚çš„ cap æˆ–ä½¿ç”¨ append(make([]T,0,needed), ...)ã€‚\nç¤ºä¾‹ï¼š\npackage main import \u0026#34;fmt\u0026#34; func main() { s := make([]int, 0, 5) for i := 0; i \u0026lt; 5; i++ { s = append(s, i) } fmt.Println(cap(s), s) } 6. string ä¸ []byte è½¬æ¢ä¼˜åŒ– æ€è·¯ï¼š é¢‘ç¹è½¬æ¢ä¼šäº§ç”Ÿå†…å­˜æ‹·è´ã€‚å¯ä»¥ä½¿ç”¨ strings.Builder / bytes.Buffer æ¥æ„å»ºå­—ç¬¦ä¸²ï¼Œæˆ–ç”¨ unsafe åšé›¶æ‹·è´è½¬æ¢ï¼ˆæœ‰é£é™©ï¼Œä¸æ¨èåœ¨é¢è¯•æ—¶éšæ„ä½¿ç”¨ï¼Œéœ€æ³¨æ˜å®‰å…¨æ€§é—®é¢˜ï¼‰ã€‚\nç¤ºä¾‹ï¼š\npackage main import ( \u0026#34;bytes\u0026#34; \u0026#34;fmt\u0026#34; ) func main() { var b bytes.Buffer for i := 0; i \u0026lt; 1000; i++ { b.WriteString(\u0026#34;x\u0026#34;) } s := b.String() fmt.Println(len(s)) } 7. å®ç°ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ç®€å• map æ€è·¯ï¼š ä½¿ç”¨ sync.RWMutex æä¾›å¹¶å‘å®‰å…¨çš„ Get/Set/Deleteã€‚\nç¤ºä¾‹ï¼š\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;sync\u0026#34; ) type SafeMap struct { mu sync.RWMutex m map[string]interface{} } func NewSafeMap() *SafeMap { return \u0026amp;SafeMap{m: make(map[string]interface{})} } func (s *SafeMap) Set(k string, v interface{}) { s.mu.Lock() defer s.mu.Unlock() s.m[k] = v } func (s *SafeMap) Get(k string) (interface{}, bool) { s.mu.RLock() defer s.mu.RUnlock() v, ok := s.m[k] return v, ok } func (s *SafeMap) Delete(k string) { s.mu.Lock() defer s.mu.Unlock() delete(s.m, k) } func main() { sm := NewSafeMap() sm.Set(\u0026#34;a\u0026#34;, 1) v, ok := sm.Get(\u0026#34;a\u0026#34;) fmt.Println(v, ok) sm.Delete(\u0026#34;a\u0026#34;) } ğŸŸ¡ ä¸­çº§åœºæ™¯é¢˜ï¼ˆå¹¶å‘ä¸æ§åˆ¶ï¼‰ 1. WaitGroup æ§åˆ¶å¹¶å‘ä»»åŠ¡ æ€è·¯ï¼š ä½¿ç”¨ sync.WaitGroup çš„ Add/Done/Waitã€‚æ³¨æ„ï¼šAdd åº”åœ¨å¯åŠ¨ goroutine ä¹‹å‰æˆ–åœ¨ä¸» goroutine ä¸­ï¼Œé¿å…ç«æ€ã€‚Done æ¬¡æ•°å¿…é¡»ä¸ Add å¯¹åº”ã€‚\nç¤ºä¾‹ï¼š\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;sync\u0026#34; \u0026#34;time\u0026#34; ) func worker(id int, wg *sync.WaitGroup) { defer wg.Done() time.Sleep(100 * time.Millisecond) fmt.Println(\u0026#34;worker\u0026#34;, id, \u0026#34;done\u0026#34;) } func main() { var wg sync.WaitGroup for i := 0; i \u0026lt; 5; i++ { wg.Add(1) go worker(i, \u0026amp;wg) } wg.Wait() fmt.Println(\u0026#34;all done\u0026#34;) } 2. å›ºå®šå¤§å°çš„ goroutine æ± ï¼ˆworker poolï¼‰ æ€è·¯ï¼š ä½¿ç”¨ä»»åŠ¡ channel å’Œå›ºå®šæ•°é‡çš„ worker goroutineï¼Œæä¾› Submit æ¥å£å¹¶å¯å…³é—­æ± ã€‚\nç¤ºä¾‹ï¼š\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;sync\u0026#34; ) type Task func() type Pool struct { tasks chan Task wg sync.WaitGroup } func NewPool(workerCount, queueSize int) *Pool { p := \u0026amp;Pool{tasks: make(chan Task, queueSize)} p.wg.Add(workerCount) for i := 0; i \u0026lt; workerCount; i++ { go func() { defer p.wg.Done() for t := range p.tasks { t() } }() } return p } func (p *Pool) Submit(t Task) { p.tasks \u0026lt;- t } func (p *Pool) Shutdown() { close(p.tasks) p.wg.Wait() } func main() { p := NewPool(3, 10) for i := 0; i \u0026lt; 10; i++ { n := i p.Submit(func() { fmt.Println(\u0026#34;task\u0026#34;, n) }) } p.Shutdown() fmt.Println(\u0026#34;pool shutdown\u0026#34;) } 3. ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼ˆä¼˜é›…é€€å‡ºï¼‰ æ€è·¯ï¼š ä½¿ç”¨å¸¦ç¼“å†² channelï¼Œç”Ÿäº§è€…åœ¨å…³é—­æ—¶å…³é—­ channelï¼Œæ¶ˆè´¹è€… range channel ç›´åˆ°ç»“æŸã€‚æˆ–è€…ä½¿ç”¨ context æ§åˆ¶å¤šç”Ÿäº§è€…å¤šæ¶ˆè´¹è€…çš„é€€å‡ºã€‚\nç¤ºä¾‹ï¼š\npackage main import ( \u0026#34;context\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;sync\u0026#34; \u0026#34;time\u0026#34; ) func producer(ctx context.Context, ch chan\u0026lt;- int, id int) { defer fmt.Println(\u0026#34;producer\u0026#34;, id, \u0026#34;exit\u0026#34;) for i := 0; i \u0026lt; 5; i++ { select { case \u0026lt;-ctx.Done(): return case ch \u0026lt;- i: time.Sleep(10 * time.Millisecond) } } } func consumer(ctx context.Context, ch \u0026lt;-chan int, id int, wg *sync.WaitGroup) { defer wg.Done() for { select { case \u0026lt;-ctx.Done(): return case v, ok := \u0026lt;-ch: if !ok { return } fmt.Println(\u0026#34;consumer\u0026#34;, id, \u0026#34;got\u0026#34;, v) } } } func main() { ctx, cancel := context.WithCancel(context.Background()) defer cancel() ch := make(chan int, 10) var wg sync.WaitGroup // start consumers for i := 0; i \u0026lt; 3; i++ { wg.Add(1) go consumer(ctx, ch, i, \u0026amp;wg) } // producers for i := 0; i \u0026lt; 2; i++ { go producer(ctx, ch, i) } time.Sleep(100 * time.Millisecond) cancel() // graceful shutdown close(ch) wg.Wait() fmt.Println(\u0026#34;all done\u0026#34;) } //å®Œæ•´ç‰ˆæœ¬ package main import ( \u0026#34;context\u0026#34; \u0026#34;errors\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;log\u0026#34; \u0026#34;math/rand\u0026#34; \u0026#34;os\u0026#34; \u0026#34;os/signal\u0026#34; \u0026#34;sync\u0026#34; \u0026#34;sync/atomic\u0026#34; \u0026#34;syscall\u0026#34; \u0026#34;time\u0026#34; ) // TaskFunc æ˜¯è¦æ‰§è¡Œçš„ä»»åŠ¡å‡½æ•° type TaskFunc func(ctx context.Context) error var ( ErrQueueFull = errors.New(\u0026#34;task queue is full\u0026#34;) ErrStopped = errors.New(\u0026#34;manager stopped; not accepting tasks\u0026#34;) ) // Manager ç®¡ç†ç”Ÿäº§è€…/æ¶ˆè´¹è€… type Manager struct { queue chan *taskWrapper workers int maxRetries int retryBase time.Duration // åŸºç¡€é‡è¯•å»¶è¿Ÿï¼ˆä¼šæŒ‡æ•°å¢é•¿ï¼‰ ratePerSec int // 0 è¡¨ç¤ºä¸åšé€Ÿç‡é™åˆ¶ // å†…éƒ¨æ§åˆ¶ closed uint32 // atomic flag: 1 è¡¨ç¤ºå·²å…³é—­ï¼ˆä¸å†æ¥å—ä»»åŠ¡ï¼‰ wg sync.WaitGroup // context ç”¨äºå–æ¶ˆæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼ˆå½“éœ€è¦ç«‹å³åœæ­¢ï¼‰ ctx context.Context cancel context.CancelFunc // rate limiting token channelï¼ˆå½“ ratePerSec\u0026gt;0 æ—¶ä½¿ç”¨ï¼‰ tokens chan struct{} // ç»Ÿè®¡ enqueued uint64 queuedFail uint64 processed uint64 failed uint64 retried uint64 // å¯é€‰çš„é”™è¯¯å›è°ƒ OnError func(taskID string, err error) } // taskWrapper åŒ…è£…ä»»åŠ¡ï¼Œä¾¿äºé™„å¸¦ id/info type taskWrapper struct { id string fn TaskFunc } // NewManager åˆ›å»º Manager // queueSize: é˜Ÿåˆ—ç¼“å†²é•¿åº¦ // workers: æ¶ˆè´¹è€…æ•°é‡ // maxRetries: æ¯ä¸ªä»»åŠ¡é‡è¯•æ¬¡æ•°ï¼ˆ0 è¡¨ç¤ºä¸é‡è¯•ï¼‰ // retryBase: åŸºç¡€é‡è¯•é—´éš”ï¼Œä¾‹å¦‚ 200*time.Millisecond // ratePerSec: æ¯ç§’æœ€å¤§å¤„ç†æ•°ï¼ˆ0 è¡¨ç¤ºä¸é™åˆ¶ï¼‰ func NewManager(queueSize, workers, maxRetries int, retryBase time.Duration, ratePerSec int) *Manager { ctx, cancel := context.WithCancel(context.Background()) m := \u0026amp;Manager{ queue: make(chan *taskWrapper, queueSize), workers: workers, maxRetries: maxRetries, retryBase: retryBase, ratePerSec: ratePerSec, ctx: ctx, cancel: cancel, } if ratePerSec \u0026gt; 0 { m.tokens = make(chan struct{}, ratePerSec) // å®¹é‡ä¸ºæ¯ç§’ä»¤ç‰Œä¸Šé™ interval := time.Second / time.Duration(ratePerSec) if interval \u0026lt;= 0 { interval = time.Millisecond } go func() { tk := time.NewTicker(interval) defer tk.Stop() for { select { case \u0026lt;-m.ctx.Done(): return case \u0026lt;-tk.C: // éé˜»å¡å‘é€ tokenï¼ˆä¿æŒä¸Šé™ï¼‰ select { case m.tokens \u0026lt;- struct{}{}: default: } } } }() } return m } // Start å¯åŠ¨æ‰€æœ‰ worker func (m *Manager) Start() { for i := 0; i \u0026lt; m.workers; i++ { m.wg.Add(1) go m.worker(i) } } // Enqueue å°è¯•æŠŠä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—ï¼ˆéé˜»å¡é£æ ¼ï¼‰ // å¦‚æœé˜Ÿåˆ—æ»¡ä¼šè¿”å› ErrQueueFull // å¦‚æœ manager å·²åœæ­¢åˆ™è¿”å› ErrStopped func (m *Manager) Enqueue(id string, fn TaskFunc) error { if atomic.LoadUint32(\u0026amp;m.closed) == 1 { atomic.AddUint64(\u0026amp;m.queuedFail, 1) return ErrStopped } select { case m.queue \u0026lt;- \u0026amp;taskWrapper{id: id, fn: fn}: atomic.AddUint64(\u0026amp;m.enqueued, 1) return nil default: atomic.AddUint64(\u0026amp;m.queuedFail, 1) return ErrQueueFull } } // worker æ˜¯æ¯ä¸ªæ¶ˆè´¹è€… goroutine çš„ä¸»å¾ªç¯ func (m *Manager) worker(idx int) { defer m.wg.Done() for tw := range m.queue { // å¦‚æœ tokens ä¸ä¸º nilï¼Œåˆ™åšé€Ÿç‡é™åˆ¶ if m.tokens != nil { select { case \u0026lt;-m.ctx.Done(): return case \u0026lt;-m.tokens: // got token } } m.processTask(tw) } // å½“ queue è¢« closeï¼Œrange ç»“æŸï¼Œworker é€€å‡º } // processTask æ‰§è¡Œå•ä¸ªä»»åŠ¡ï¼ŒåŒ…å«é‡è¯•ä¸ panic æ¢å¤ func (m *Manager) processTask(tw *taskWrapper) { // recover panic, è®°å½•ä¸ºå¤±è´¥ defer func() { if r := recover(); r != nil { err := fmt.Errorf(\u0026#34;panic: %v\u0026#34;, r) atomic.AddUint64(\u0026amp;m.failed, 1) if m.OnError != nil { m.OnError(tw.id, err) } } }() var attempt int for { attempt++ // å¦‚æœå…¨å±€ cancelï¼Œè¢«ç«‹å³å–æ¶ˆ -\u0026gt; æ”¾å¼ƒæˆ–è§†ä¸ºå¤±è´¥ select { case \u0026lt;-m.ctx.Done(): atomic.AddUint64(\u0026amp;m.failed, 1) if m.OnError != nil { m.OnError(tw.id, fmt.Errorf(\u0026#34;task cancelled\u0026#34;)) } return default: } // æ‰§è¡Œä»»åŠ¡ err := tw.fn(m.ctx) if err == nil { atomic.AddUint64(\u0026amp;m.processed, 1) return } // å¤±è´¥å¤„ç† atomic.AddUint64(\u0026amp;m.retried, 1) if attempt \u0026gt; m.maxRetries { atomic.AddUint64(\u0026amp;m.failed, 1) if m.OnError != nil { m.OnError(tw.id, err) } return } // æŒ‡æ•°é€€é¿ + æŠ–åŠ¨ backoff := m.retryBase * (1 \u0026lt;\u0026lt; (attempt - 1)) // æ·»åŠ å°‘é‡éšæœºæŠ–åŠ¨ jitter := time.Duration(rand.Int63n(int64(backoff)/2+1)) sleep := backoff + jitter // ä½†å¦‚æœ ctx è¢« cancelï¼Œæå‰è¿”å› select { case \u0026lt;-time.After(sleep): // å†è¯• case \u0026lt;-m.ctx.Done(): atomic.AddUint64(\u0026amp;m.failed, 1) if m.OnError != nil { m.OnError(tw.id, fmt.Errorf(\u0026#34;task cancelled during backoff\u0026#34;)) } return } } } // Shutdown ä¼˜é›…å…³é—­ï¼šåœæ­¢æ¥å—æ–°ä»»åŠ¡ã€å…³é—­é˜Ÿåˆ—å¹¶ç­‰å¾… worker å®Œæˆï¼ˆç›´åˆ°è¶…æ—¶ï¼‰ // å¦‚æœ graceful=falseï¼Œåˆ™ç«‹å³ cancel æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡å¹¶ç«‹å³å…³é—­ func (m *Manager) Shutdown(graceful bool, timeout time.Duration) error { // å…ˆè®¾ç½® closed æ ‡å¿—ï¼Œé˜»æ­¢æ–°çš„å…¥é˜Ÿ if !atomic.CompareAndSwapUint32(\u0026amp;m.closed, 0, 1) { // already closed } if !graceful { // ç«‹å³å–æ¶ˆæ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ m.cancel() // close queue to wake workers (they will exit when range ends) close(m.queue) // wait for workers done := make(chan struct{}) go func() { m.wg.Wait() close(done) }() select { case \u0026lt;-done: return nil case \u0026lt;-time.After(timeout): return errors.New(\u0026#34;timeout waiting for shutdown\u0026#34;) } } // graceful: å…³é—­é˜Ÿåˆ—ï¼Œç­‰å¾…é˜Ÿåˆ—å¤„ç†å®Œï¼ˆworkers range ç»“æŸï¼‰ close(m.queue) // ç­‰å¾… workers å®Œæˆæˆ–è¶…æ—¶ done := make(chan struct{}) go func() { m.wg.Wait() close(done) }() select { case \u0026lt;-done: return nil case \u0026lt;-time.After(timeout): // å¦‚æœè¶…æ—¶ï¼Œå¯ä»¥é€‰æ‹© cancel æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ m.cancel() return errors.New(\u0026#34;timeout waiting for graceful shutdown; cancelled running tasks\u0026#34;) } } // Stats è¿”å›å½“å‰ç»Ÿè®¡ä¿¡æ¯ type Stats struct { Enqueued uint64 EnqueueFail uint64 Processed uint64 Failed uint64 Retries uint64 QueueLen int } func (m *Manager) Stats() Stats { return Stats{ Enqueued: atomic.LoadUint64(\u0026amp;m.enqueued), EnqueueFail: atomic.LoadUint64(\u0026amp;m.queuedFail), Processed: atomic.LoadUint64(\u0026amp;m.processed), Failed: atomic.LoadUint64(\u0026amp;m.failed), Retries: atomic.LoadUint64(\u0026amp;m.retried), QueueLen: len(m.queue), } } // ------------------- æ¼”ç¤º main ------------------- func main() { // éšæœºæ•°ç§å­ï¼ˆç”¨äº jitterï¼‰ rand.Seed(time.Now().UnixNano()) // åˆ›å»º managerï¼šé˜Ÿåˆ— 100ï¼Œ5 ä¸ª workerï¼Œæ¯ä»»åŠ¡æœ€å¤š 3 æ¬¡é‡è¯•ï¼ŒåŸºæœ¬é€€é¿ 200msï¼Œé€Ÿç‡æ¯ç§’ 20 m := NewManager(100, 5, 3, 200*time.Millisecond, 20) m.OnError = func(id string, err error) { log.Printf(\u0026#34;[OnError] task %s error: %v\\n\u0026#34;, id, err) } m.Start() // æ•è·ç³»ç»Ÿä¿¡å·ç”¨äºä¼˜é›…é€€å‡º sigCh := make(chan os.Signal, 1) signal.Notify(sigCh, syscall.SIGINT, syscall.SIGTERM) // æ¨¡æ‹Ÿç”Ÿäº§è€…ï¼ˆå¹¶å‘äº§ç”Ÿä»»åŠ¡ï¼‰ producers := 3 var prodWg sync.WaitGroup prodWg.Add(producers) totalTasks := 1000 taskCounter := uint64(0) for p := 0; p \u0026lt; producers; p++ { go func(pid int) { defer prodWg.Done() for { n := atomic.AddUint64(\u0026amp;taskCounter, 1) if int(n) \u0026gt; totalTasks { return } id := fmt.Sprintf(\u0026#34;task-%d-p%d\u0026#34;, n, pid) // ä»»åŠ¡ï¼šéšæœºæˆåŠŸæˆ–å¤±è´¥ï¼Œå¤±è´¥ä¼šè§¦å‘é‡è¯• err := m.Enqueue(id, func(ctx context.Context) error { // æ¨¡æ‹Ÿå¤„ç†æ—¶é—´ select { case \u0026lt;-time.After(time.Duration(rand.Intn(200)) * time.Millisecond): case \u0026lt;-ctx.Done(): return ctx.Err() } // éšæœºå¤±è´¥æ¦‚ç‡ if rand.Intn(100) \u0026lt; 20 { return fmt.Errorf(\u0026#34;random failure for %s\u0026#34;, id) } // åšç‚¹äº‹æƒ…... //fmt.Println(\u0026#34;processed\u0026#34;, id) return nil }) if err == ErrQueueFull { // ç®€å•ï¼šé‡è¯•å…¥é˜Ÿä¸€æ¬¡å†æ”¾å¼ƒï¼ˆçœŸå®ç”Ÿäº§å¯ä»¥æ›´å¤æ‚ï¼‰ time.Sleep(50 * time.Millisecond) _ = m.Enqueue(id, func(ctx context.Context) error { time.Sleep(10 * time.Millisecond) return nil }) } } }(p) } // ç­‰å¾…ç”Ÿäº§è€…å®Œæˆæˆ–è€…æ¥æ”¶åˆ°é€€å‡ºä¿¡å· go func() { prodWg.Wait() // æ‰€æœ‰ä»»åŠ¡å·²äº§ç”Ÿï¼Œå…³é—­ managerï¼ˆgracefulï¼‰ log.Println(\u0026#34;all producers done; initiating graceful shutdown\u0026#34;) if err := m.Shutdown(true, 30*time.Second); err != nil { log.Println(\u0026#34;graceful shutdown error:\u0026#34;, err) } }() // ç›‘å¬é€€å‡ºä¿¡å·ï¼Œç”¨æˆ·å¯ä»¥ Ctrl+C æå‰åœæ­¢ï¼ˆç«‹å³ cancelï¼‰ select { case s := \u0026lt;-sigCh: log.Printf(\u0026#34;signal %v received: stopping immediately\\n\u0026#34;, s) _ = m.Shutdown(false, 5*time.Second) } // æ‰“å°ç»Ÿè®¡ fmt.Println(\u0026#34;final stats:\u0026#34;, m.Stats()) } 4. ä¸¤ä¸ª goroutine äº¤æ›¿æ‰“å° 1~100 æ€è·¯ï¼š ä½¿ç”¨ä¸¤ä¸ªæ— ç¼“å†² channel äº¤æ›¿é€šçŸ¥ï¼Œæˆ–ä½¿ç”¨ sync.Condã€‚ä¸‹é¢ç¤ºä¾‹ä½¿ç”¨ channelã€‚\nç¤ºä¾‹ï¼š\npackage main import \u0026#34;fmt\u0026#34; // äº¤æ›¿æ‰“å°1-100 func DoubleChanPrint() { chan1 := make(chan struct{}) chan2 := make(chan struct{}) wg := sync.WaitGroup{} wg.Add(2) go func() { defer wg.Done() for i := 1; i \u0026lt; 100; i += 2 { \u0026lt;-chan1 fmt.Println(\u0026#34;chan1 : \u0026#34;, i) chan2 \u0026lt;- struct{}{} } }() go func() { defer wg.Done() for i := 2; i \u0026lt;= 100; i += 2 { \u0026lt;-chan2 fmt.Println(\u0026#34;chan2 : \u0026#34;, i) if i \u0026lt; 100 { chan1 \u0026lt;- struct{}{} } } }() chan1 \u0026lt;- struct{}{} wg.Wait() close(chan1) close(chan2) } func DoubleChanPrint2() { chan1 := make(chan int) // ç”¨äºå‘é€å¥‡æ•° (1, 3, 5...) chan2 := make(chan int) // ç”¨äºå‘é€å¶æ•° (2, 4, 6...) wg := sync.WaitGroup{} wg.Add(2) go func() { defer wg.Done() for v := range chan1 { // æ¥æ”¶å¥‡æ•°ï¼Œå‘é€å¶æ•° fmt.Println(\u0026#34;chan1 : \u0026#34;, v) // æ‰“å°å¥‡æ•° if v \u0026lt; 99 { chan2 \u0026lt;- v + 1 } else { // v == 99ï¼Œå‘é€100åï¼Œå°±å¯ä»¥å…³é—­chan2äº† chan2 \u0026lt;- v + 1 // å‘é€ 100 close(chan2) } } }() go func() { defer wg.Done() for v := range chan2 { // æ¥æ”¶å¶æ•°ï¼Œå‘é€å¥‡æ•° fmt.Println(\u0026#34;chan2 : \u0026#34;, v) // æ‰“å°å¶æ•° if v \u0026lt; 100 { // v == 100æ—¶ï¼Œæ˜¯æœ€åä¸€ä¸ªæ•°å­—ï¼Œä¸åº”è¯¥å†å‘é€äº† chan1 \u0026lt;- v + 1 } else { // v == 100, æ˜¯æœ€åä¸€ä¸ªæ•°å­—ï¼Œä»€ä¹ˆéƒ½ä¸ç”¨åšï¼Œ // åªæ˜¯ç­‰å¾… chan2 è¢«å…³é—­åï¼Œå¾ªç¯è‡ªç„¶ç»“æŸã€‚ close(chan1) } } // chan2 è¢«å…³é—­åï¼Œå¾ªç¯ç»“æŸï¼Œæ‰§è¡Œ defer wg.Done() }() chan1 \u0026lt;- 1 // å¯åŠ¨ wg.Wait() //close(chan1) } 5. é™åˆ¶å¹¶å‘æ•°é‡ï¼ˆæ¯”å¦‚æœ€å¤š 10 ä¸ªä»»åŠ¡ï¼‰ æ€è·¯ï¼š ä½¿ç”¨å¸¦ç¼“å†²çš„ä¿¡å·é‡ channel æˆ–è€… sync.WaitGroup + æœ‰é™ worker poolã€‚\nç¤ºä¾‹ï¼ˆä¿¡å·é‡ï¼‰ï¼š\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;sync\u0026#34; \u0026#34;time\u0026#34; ) func main() { sem := make(chan struct{}, 10) // æœ€å¤§ 10 å¹¶å‘ var wg sync.WaitGroup for i := 0; i \u0026lt; 50; i++ { wg.Add(1) sem \u0026lt;- struct{}{} go func(n int) { defer wg.Done() defer func() { \u0026lt;-sem }() time.Sleep(50 * time.Millisecond) fmt.Println(\u0026#34;task\u0026#34;, n) }(i) } wg.Wait() fmt.Println(\u0026#34;all tasks done\u0026#34;) } 6. context æ§åˆ¶ä»»åŠ¡è¶…æ—¶ä¸å–æ¶ˆ æ€è·¯ï¼š ä½¿ç”¨ context.WithTimeout æˆ– WithCancelï¼Œåœ¨ goroutine å†…é€‰æ‹© ctx.Done()ã€‚\nç¤ºä¾‹ï¼š\npackage main import ( \u0026#34;context\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;time\u0026#34; ) func do(ctx context.Context) { select { case \u0026lt;-time.After(2 * time.Second): fmt.Println(\u0026#34;work done\u0026#34;) case \u0026lt;-ctx.Done(): fmt.Println(\u0026#34;cancelled:\u0026#34;, ctx.Err()) } } func main() { ctx, cancel := context.WithTimeout(context.Background(), 1*time.Second) defer cancel() do(ctx) } ğŸ”´ é«˜çº§åœºæ™¯é¢˜ï¼ˆç³»ç»Ÿè®¾è®¡ä¸æ€§èƒ½ï¼‰ 1. æœ¬åœ°ç¼“å­˜ç³»ç»Ÿï¼ˆTTL + å¹¶å‘å®‰å…¨ + æ¸…ç†ï¼‰ æ€è·¯ï¼š map å­˜å‚¨ key -\u0026gt; {value, expireAt}ï¼Œä½¿ç”¨ RWMutex ä¿æŠ¤ã€‚å¯åŠ¨åå° goroutine å‘¨æœŸæ€§æ¸…ç†è¿‡æœŸé¡¹ã€‚æä¾› Get/Set/Delete æ¥å£ã€‚\nç¤ºä¾‹ï¼š\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;sync\u0026#34; \u0026#34;time\u0026#34; ) type item struct { value interface{} expireAt int64 } type Cache struct { mu sync.RWMutex m map[string]*item stop chan struct{} wg sync.WaitGroup } func NewCache() *Cache { c := \u0026amp;Cache{m: make(map[string]*item), stop: make(chan struct{})} c.wg.Add(1) go c.periodicClean(1 * time.Second) return c } func (c *Cache) Set(k string, v interface{}, ttl time.Duration) { c.mu.Lock() defer c.mu.Unlock() c.m[k] = \u0026amp;item{value: v, expireAt: time.Now().Add(ttl).UnixNano()} } func (c *Cache) Get(k string) (interface{}, bool) { c.mu.RLock() it, ok := c.m[k] c.mu.RUnlock() if !ok { return nil, false } if time.Now().UnixNano() \u0026gt; it.expireAt { c.mu.Lock() delete(c.m, k) c.mu.Unlock() return nil, false } return it.value, true } func (c *Cache) periodicClean(interval time.Duration) { defer c.wg.Done() ticker := time.NewTicker(interval) defer ticker.Stop() for { select { case \u0026lt;-ticker.C: now := time.Now().UnixNano() c.mu.Lock() for k, v := range c.m { if now \u0026gt; v.expireAt { delete(c.m, k) } } c.mu.Unlock() case \u0026lt;-c.stop: return } } } func (c *Cache) Close() { close(c.stop) c.wg.Wait() } func main() { c := NewCache() c.Set(\u0026#34;a\u0026#34;, 1, 2*time.Second) v, ok := c.Get(\u0026#34;a\u0026#34;) fmt.Println(v, ok) time.Sleep(3 * time.Second) v, ok = c.Get(\u0026#34;a\u0026#34;) fmt.Println(v, ok) c.Close() } 2. LRU ç¼“å­˜ï¼ˆmap + åŒå‘é“¾è¡¨ï¼Œçº¿ç¨‹å®‰å…¨ï¼‰ æ€è·¯ï¼š ç”¨ map ä¿å­˜ key-\u0026gt;nodeï¼ŒåŒå‘é“¾è¡¨ç»´æŠ¤è®¿é—®é¡ºåºã€‚Get å°†èŠ‚ç‚¹ç§»åˆ°å¤´éƒ¨ï¼›Set æ’å…¥å¹¶åœ¨è¶…å®¹é‡æ—¶ç§»é™¤å°¾éƒ¨ã€‚åŠ é”ä¿è¯å¹¶å‘å®‰å…¨ã€‚\nç¤ºä¾‹ï¼š\npackage main func main() { } // å®ç°lru type Node struct { key, val int prev, next *Node } type LRUCache struct { capacity int head, tail *Node cache map[int]*Node } func Constructor(capacity int) LRUCache { lru := LRUCache{ capacity: capacity, head: \u0026amp;Node{}, tail: \u0026amp;Node{}, cache: make(map[int]*Node, capacity+1), } lru.head.next = lru.tail lru.tail.prev = lru.head return lru } func (l LRUCache) Get(key int) int { if node, ok := l.cache[key]; ok { l.MoveToHead(node) return node.val } return -1 } func (l LRUCache) Put(key int, value int) { if node, ok := l.cache[key]; ok { node.val = value l.MoveToHead(node) } else { node := \u0026amp;Node{key, value, nil, nil} l.cache[key] = node l.AddNodeToHead(node) if len(l.cache) \u0026gt; l.capacity { node := l.RemoveTail() delete(l.cache, node.key) } } } func (l LRUCache) MoveToHead(node *Node) { l.RemoveNode(node) l.AddNodeToHead(node) } func (l LRUCache) RemoveNode(node *Node) { node.prev.next = node.next node.next.prev = node.prev } func (l LRUCache) AddNodeToHead(node *Node) { node.prev = l.head node.next = l.head.next l.head.next.prev = node l.head.next = node } func (l LRUCache) RemoveTail() *Node { node := l.tail.prev l.RemoveNode(node) return node } 3. ç®€æ˜“æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå‘å¸ƒ/è®¢é˜…ï¼‰ æ€è·¯ï¼š ä½¿ç”¨ channel + map[channel] ä¸ºæ¯ä¸ªè®¢é˜…è€…æä¾›æ¥æ”¶é€šé“ã€‚æŒä¹…åŒ–éœ€è¦é¢å¤–å°†æ¶ˆæ¯å†™å…¥ç£ç›˜/æ•°æ®åº“å¹¶åšç¡®è®¤æœºåˆ¶ã€‚\nç¤ºä¾‹ï¼š\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;sync\u0026#34; ) type Broker struct { mu sync.RWMutex subs map[string][]chan string } func NewBroker() *Broker { return \u0026amp;Broker{subs: make(map[string][]chan string)} } func (b *Broker) Subscribe(topic string) chan string { ch := make(chan string, 10) b.mu.Lock() b.subs[topic] = append(b.subs[topic], ch) b.mu.Unlock() return ch } func (b *Broker) Publish(topic, msg string) { b.mu.RLock() subs := b.subs[topic] b.mu.RUnlock() for _, ch := range subs { select { case ch \u0026lt;- msg: default: // drop or buffer full handling } } } func (b *Broker) Unsubscribe(topic string, ch chan string) { b.mu.Lock() defer b.mu.Unlock() subs := b.subs[topic] for i, c := range subs { if c == ch { b.subs[topic] = append(subs[:i], subs[i+1:]...) close(c) break } } } func main() { b := NewBroker() ch := b.Subscribe(\u0026#34;t1\u0026#34;) go func() { for m := range ch { fmt.Println(\u0026#34;recv\u0026#34;, m) } }() b.Publish(\u0026#34;t1\u0026#34;, \u0026#34;hello\u0026#34;) b.Unsubscribe(\u0026#34;t1\u0026#34;, ch) } 4. ç§’æ€ç³»ç»Ÿé˜²è¶…å–ï¼ˆå…³é”®æ€è·¯ï¼‰ æ€è·¯ï¼š åœ¨é«˜å¹¶å‘ä¸‹é¿å…è¶…å–ï¼šä½¿ç”¨ Redis åšåº“å­˜é¢„å‡ï¼ˆLua è„šæœ¬ä¿è¯åŸå­æ€§ï¼‰ï¼Œå¼•å…¥æœ¬åœ°å†…å­˜å”®ç½„æ ‡è®° + æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥ä¸‹å•ï¼Œæ‰“æ•£å†™åº“å‹åŠ›ã€‚\nå…³é”® Lua ä¼ªç ï¼š\n-- KEYS[1] stock key -- ARGV[1] amount local stock = tonumber(redis.call(\u0026#39;get\u0026#39;, KEYS[1]) or \u0026#39;0\u0026#39;) if stock \u0026lt;= 0 then return 0 end if stock \u0026lt; tonumber(ARGV[1]) then return 0 end redis.call(\u0026#39;decrby\u0026#39;, KEYS[1], ARGV[1]) return 1 Go ç¤ºä¾‹è°ƒç”¨ï¼ˆç®€åŒ–ï¼‰ï¼š\n// çœç•¥ redis å®¢æˆ·ç«¯åˆå§‹åŒ–ï¼Œç¤ºä¾‹ä¼ªç  script := `...` // ä¸Šé¢çš„ lua res, err := redisClient.Eval(ctx, script, []string{\u0026#34;stock:1\u0026#34;}, 1).Result() if err != nil { /* handle */ } if res.(int64) == 1 { // push order info to MQ for async processing } 5. é™æµç»„ä»¶ï¼ˆä»¤ç‰Œæ¡¶ï¼‰ æ€è·¯ï¼š ç”¨ goroutine æŒç»­æŒ‰é€Ÿç‡å‘ channel æ”¾ tokenï¼Œä¸šåŠ¡å¤„ç†å‰å°è¯•å– tokenï¼Œå–ä¸åˆ°åˆ™æ‹’ç»æˆ–ç­‰å¾…ã€‚\nç¤ºä¾‹ï¼š\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;time\u0026#34; ) type TokenBucket struct { tokens chan struct{} } func NewTokenBucket(rate int, capacity int) *TokenBucket { tb := \u0026amp;TokenBucket{tokens: make(chan struct{}, capacity)} ticker := time.NewTicker(time.Second / time.Duration(rate)) // åˆå§‹æ—¶å…ˆè£…æ»¡ for i := 0; i \u0026lt; capacity; i++ { tb.tokens \u0026lt;- struct{}{} } go func() { for range ticker.C { select { case tb.tokens \u0026lt;- struct{}{}: default: } } }() return tb } func (tb *TokenBucket) Allow() bool { select { case \u0026lt;-tb.tokens: return true default: return false } } func main() { tb := NewTokenBucket(5, 10) // æ¯ç§’ 5 ä¸ªï¼Œæ¡¶å®¹é‡ 10 for i := 0; i \u0026lt; 20; i++ { if tb.Allow() { fmt.Println(\u0026#34;allowed\u0026#34;, i) } else { fmt.Println(\u0026#34;rejected\u0026#34;, i) } time.Sleep(100 * time.Millisecond) } } âš™ï¸ å®æˆ˜ Debug åœºæ™¯é¢˜ï¼ˆæ’éšœä¸ä¼˜åŒ–ï¼‰ 1. goroutine æ³„æ¼æ’æŸ¥ æ€è·¯ï¼š ä½¿ç”¨ pprof è·å– goroutine å †æ ˆï¼Œå®šä½é˜»å¡ç‚¹ï¼ˆä¾‹å¦‚ channel é˜»å¡ã€select æ²¡æœ‰ default ç­‰ï¼‰ã€‚æ£€æŸ¥æ‰€æœ‰ goroutine å¯åŠ¨ä½ç½®å¹¶ç¡®ä¿æœ‰é€€å‡ºè·¯å¾„æˆ– context æ§åˆ¶ã€‚\npprof ç¤ºä¾‹ï¼š\n// åœ¨ç¨‹åº main ä¸­å¼•å…¥ net/http/pprof import _ \u0026#34;net/http/pprof\u0026#34; import \u0026#34;net/http\u0026#34; go func() { http.ListenAndServe(\u0026#34;localhost:6060\u0026#34;, nil) }() // ç„¶ååœ¨ç»ˆç«¯ä½¿ç”¨: go tool pprof http://localhost:6060/debug/pprof/goroutine 2. æ­»é”å®šä½ä¸ä¿®å¤ ç¤ºä¾‹æ­»é”ä»£ç ï¼š\npackage main import \u0026#34;sync\u0026#34; func main() { var mu sync.Mutex mu.Lock() // do something mu.Lock() // deadlock: same goroutine locks twice } ä¿®å¤ï¼š ä¸è¦åœ¨åŒä¸€ goroutine é‡å¤åŠ æ™®é€š Mutexï¼Œæˆ–æ”¹ç”¨ sync.RWMutex/è®¾è®¡é¿å…é‡å…¥åœºæ™¯ï¼Œæˆ–ä½¿ç”¨å¯é‡å…¥é”ï¼ˆéœ€è¦è‡ªè¡Œå®ç°ï¼‰ã€‚\n3. å†…å­˜æš´æ¶¨åˆ†æä¸ä¼˜åŒ– æ€è·¯ï¼š ç”¨ pprof çš„ heap åˆ†æå“ªä¸ªå¯¹è±¡å ç”¨å†…å­˜æœ€å¤šï¼›æ£€æŸ¥åˆ‡ç‰‡/ç¼“å­˜æ˜¯å¦æ— é™åˆ¶å¢é•¿ï¼Œæ£€æŸ¥ goroutine å †æ ˆæ˜¯å¦è¿‡å¤šå¯¼è‡´å ç”¨ã€‚ä¼˜åŒ–ï¼šé™åˆ¶ç¼“å­˜å¤§å°ã€å¤ç”¨å¯¹è±¡ï¼ˆsync.Poolï¼‰ã€é¿å…å¤§å¯¹è±¡æ‹·è´ã€‚\n4. é”ç«äº‰è¯Šæ–­ä¸ä¼˜åŒ– æ€è·¯ï¼š ç”¨ pprof çš„ mutex profile æˆ– runtime/trace æ‰¾åˆ°çƒ­ç‚¹é”ï¼Œåˆ†ææ˜¯çŸ­ä¸´ç•ŒåŒºè¿˜æ˜¯é•¿ä¸´ç•ŒåŒºï¼Œè€ƒè™‘åˆ†æ®µé”ã€å‡å°‘é”æŒæœ‰æ—¶é—´ã€ä½¿ç”¨è¯»å†™é”æˆ– lock-free ç»“æ„ã€‚\n5. pprof æ‰¾åˆ°çƒ­ç‚¹åæ”¹è¿›ç¤ºä¾‹ ç¤ºä¾‹ï¼š å‡è®¾çƒ­ç‚¹åœ¨å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä¼˜åŒ–å‰ç”¨ + é¢‘ç¹æ‹¼æ¥ï¼Œä¼˜åŒ–åä½¿ç”¨ strings.Builderï¼š\n// before: using + inside loop -\u0026gt; lots of allocations // after: import \u0026#34;strings\u0026#34; var b strings.Builder for _, s := range parts { b.WriteString(s) } res := b.String() ",
"tags":null,
"categories":null
},{
"title":"é™æµç†”æ–­é™çº§",
"permalink": "http://localhost:1313/posts/microservice/%E9%99%90%E6%B5%81%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7/",
"summary": " ã€Œç†”æ–­ã€é™æµã€é™çº§ã€ å®ƒä»¬éƒ½å±äºæœåŠ¡ç¨³å®šæ€§è®¾è®¡ï¼ˆService Resilienceï¼‰çš„ä¸€éƒ¨åˆ†ã€‚\nä¸‹é¢æˆ‘ç»™ä½ ä¸€ä¸ªâ€œé¢è¯•å®˜å–œæ¬¢å¬â€çš„å›ç­”æ¡†æ¶ï¼Œä»æ¦‚å¿µ â†’ åœºæ™¯ â†’ å®ç° â†’ ä¸¾ä¾‹ å››æ­¥è®²æ¸…æ¥šï¼Œ é€‚åˆç™¾åº¦è¿™ç§ç³»ç»Ÿæ¶æ„å¯¼å‘çš„å²—ä½ ğŸ‘‡\nğŸ§© ä¸€ã€ä¸‰è€…åŒºåˆ«å’Œè”ç³»ï¼ˆé«˜å±‚ç­”æ³•ï¼‰ ä¸€å¥è¯è®°å¿†ï¼š\né™æµï¼šæ§åˆ¶è¯·æ±‚é‡ï¼Œä¸è®©ç³»ç»Ÿè¢«å‹å®ã€‚ ç†”æ–­ï¼šå‘ç°ä¸‹æ¸¸æŒ‚äº†ï¼Œåˆ«å†è¯·æ±‚å®ƒã€‚ é™çº§ï¼šèµ„æºç´§å¼ æ—¶ï¼Œä¸»åŠ¨ç‰ºç‰²éƒ¨åˆ†åŠŸèƒ½ï¼Œä¿è¯æ ¸å¿ƒå¯ç”¨ã€‚ é¢è¯•å¼€å¤´å¯ä»¥è¿™æ ·è®²ï¼š\nâ€œåœ¨å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡é™æµã€ç†”æ–­ã€é™çº§ä¸‰ç§æœºåˆ¶ä¿éšœç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚ ä¸‰è€…çš„æ ¸å¿ƒç›®æ ‡éƒ½æ˜¯é˜²æ­¢æœåŠ¡é›ªå´©ï¼Œåªæ˜¯ä»‹å…¥çš„æ—¶æœºä¸åŒï¼š\né™æµåœ¨è¯·æ±‚å…¥å£å¤„é˜²æ­¢æµé‡æ‰“çˆ†ï¼› ç†”æ–­åœ¨è°ƒç”¨é“¾ä¸­æ–­å¼€å¼‚å¸¸ä¾èµ–ï¼› é™çº§åˆ™åœ¨ç³»ç»Ÿå‹åŠ›å¤§æ—¶ä¸»åŠ¨ä¸¢å¼ƒéæ ¸å¿ƒåŠŸèƒ½ã€‚â€ âš™ï¸ äºŒã€é™æµï¼ˆRate Limitingï¼‰ ğŸ“˜ æ¦‚å¿µ é™åˆ¶ç³»ç»Ÿå•ä½æ—¶é—´å†…å¯å¤„ç†çš„è¯·æ±‚æ•°ã€‚\nğŸ“å¸¸è§ç®—æ³• å›ºå®šçª—å£ï¼ˆFixed Windowï¼‰ æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰ æ¼æ¡¶ç®—æ³•ï¼ˆLeaky Bucketï¼‰ ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆToken Bucketï¼‰âœ… å¸¸ç”¨ ä»¤ç‰Œæ¡¶ç®—æ³•åŸç†ï¼šç³»ç»ŸæŒ‰ç…§å›ºå®šé€Ÿç‡ç”Ÿæˆä»¤ç‰Œï¼Œè¯·æ±‚åªæœ‰æ‹¿åˆ°ä»¤ç‰Œæ‰èƒ½æ‰§è¡Œï¼Œå¦åˆ™æ‹’ç»æˆ–æ’é˜Ÿã€‚\nğŸ› ï¸ å®ç°æ–¹å¼ å•æœºé™æµï¼šç”¨ golang.org/x/time/rateï¼ˆGoå®˜æ–¹é™æµåŒ…ï¼‰ åˆ†å¸ƒå¼é™æµï¼šç”¨ Redis å®ç°ï¼ˆLuaè„šæœ¬ä¿è¯åŸå­æ€§ï¼‰ ç½‘å…³å±‚é™æµï¼šåœ¨ API Gatewayï¼ˆå¦‚ Kongã€Nginxã€Kratos Gatewayï¼‰é…ç½®è§„åˆ™ ğŸ’¬ ä¸¾ä¾‹ â€œæ¯”å¦‚æˆ‘åœ¨ä¸Šä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œä¸ºé˜²æ­¢çŸ­ä¿¡æ¥å£è¢«åˆ·ï¼Œæˆ‘ä»¬åœ¨ Nginx å±‚æŒ‰ IP + URI åšé™æµï¼Œç”¨ä»¤ç‰Œæ¡¶ç®—æ³•æ§åˆ¶é€Ÿç‡ä¸º 10 req/sï¼Œå¤šä½™çš„ç›´æ¥è¿”å› 429 Too Many Requestsã€‚â€\n",
"content": " ã€Œç†”æ–­ã€é™æµã€é™çº§ã€ å®ƒä»¬éƒ½å±äºæœåŠ¡ç¨³å®šæ€§è®¾è®¡ï¼ˆService Resilienceï¼‰çš„ä¸€éƒ¨åˆ†ã€‚\nä¸‹é¢æˆ‘ç»™ä½ ä¸€ä¸ªâ€œé¢è¯•å®˜å–œæ¬¢å¬â€çš„å›ç­”æ¡†æ¶ï¼Œä»æ¦‚å¿µ â†’ åœºæ™¯ â†’ å®ç° â†’ ä¸¾ä¾‹ å››æ­¥è®²æ¸…æ¥šï¼Œ é€‚åˆç™¾åº¦è¿™ç§ç³»ç»Ÿæ¶æ„å¯¼å‘çš„å²—ä½ ğŸ‘‡\nğŸ§© ä¸€ã€ä¸‰è€…åŒºåˆ«å’Œè”ç³»ï¼ˆé«˜å±‚ç­”æ³•ï¼‰ ä¸€å¥è¯è®°å¿†ï¼š\né™æµï¼šæ§åˆ¶è¯·æ±‚é‡ï¼Œä¸è®©ç³»ç»Ÿè¢«å‹å®ã€‚ ç†”æ–­ï¼šå‘ç°ä¸‹æ¸¸æŒ‚äº†ï¼Œåˆ«å†è¯·æ±‚å®ƒã€‚ é™çº§ï¼šèµ„æºç´§å¼ æ—¶ï¼Œä¸»åŠ¨ç‰ºç‰²éƒ¨åˆ†åŠŸèƒ½ï¼Œä¿è¯æ ¸å¿ƒå¯ç”¨ã€‚ é¢è¯•å¼€å¤´å¯ä»¥è¿™æ ·è®²ï¼š\nâ€œåœ¨å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡é™æµã€ç†”æ–­ã€é™çº§ä¸‰ç§æœºåˆ¶ä¿éšœç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚ ä¸‰è€…çš„æ ¸å¿ƒç›®æ ‡éƒ½æ˜¯é˜²æ­¢æœåŠ¡é›ªå´©ï¼Œåªæ˜¯ä»‹å…¥çš„æ—¶æœºä¸åŒï¼š\né™æµåœ¨è¯·æ±‚å…¥å£å¤„é˜²æ­¢æµé‡æ‰“çˆ†ï¼› ç†”æ–­åœ¨è°ƒç”¨é“¾ä¸­æ–­å¼€å¼‚å¸¸ä¾èµ–ï¼› é™çº§åˆ™åœ¨ç³»ç»Ÿå‹åŠ›å¤§æ—¶ä¸»åŠ¨ä¸¢å¼ƒéæ ¸å¿ƒåŠŸèƒ½ã€‚â€ âš™ï¸ äºŒã€é™æµï¼ˆRate Limitingï¼‰ ğŸ“˜ æ¦‚å¿µ é™åˆ¶ç³»ç»Ÿå•ä½æ—¶é—´å†…å¯å¤„ç†çš„è¯·æ±‚æ•°ã€‚\nğŸ“å¸¸è§ç®—æ³• å›ºå®šçª—å£ï¼ˆFixed Windowï¼‰ æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰ æ¼æ¡¶ç®—æ³•ï¼ˆLeaky Bucketï¼‰ ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆToken Bucketï¼‰âœ… å¸¸ç”¨ ä»¤ç‰Œæ¡¶ç®—æ³•åŸç†ï¼šç³»ç»ŸæŒ‰ç…§å›ºå®šé€Ÿç‡ç”Ÿæˆä»¤ç‰Œï¼Œè¯·æ±‚åªæœ‰æ‹¿åˆ°ä»¤ç‰Œæ‰èƒ½æ‰§è¡Œï¼Œå¦åˆ™æ‹’ç»æˆ–æ’é˜Ÿã€‚\nğŸ› ï¸ å®ç°æ–¹å¼ å•æœºé™æµï¼šç”¨ golang.org/x/time/rateï¼ˆGoå®˜æ–¹é™æµåŒ…ï¼‰ åˆ†å¸ƒå¼é™æµï¼šç”¨ Redis å®ç°ï¼ˆLuaè„šæœ¬ä¿è¯åŸå­æ€§ï¼‰ ç½‘å…³å±‚é™æµï¼šåœ¨ API Gatewayï¼ˆå¦‚ Kongã€Nginxã€Kratos Gatewayï¼‰é…ç½®è§„åˆ™ ğŸ’¬ ä¸¾ä¾‹ â€œæ¯”å¦‚æˆ‘åœ¨ä¸Šä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œä¸ºé˜²æ­¢çŸ­ä¿¡æ¥å£è¢«åˆ·ï¼Œæˆ‘ä»¬åœ¨ Nginx å±‚æŒ‰ IP + URI åšé™æµï¼Œç”¨ä»¤ç‰Œæ¡¶ç®—æ³•æ§åˆ¶é€Ÿç‡ä¸º 10 req/sï¼Œå¤šä½™çš„ç›´æ¥è¿”å› 429 Too Many Requestsã€‚â€\nâš¡ ä¸‰ã€ç†”æ–­ï¼ˆCircuit Breakerï¼‰ ğŸ“˜ æ¦‚å¿µ å½“è°ƒç”¨ä¸‹æ¸¸æœåŠ¡æŒç»­å¤±è´¥æ—¶ï¼Œè‡ªåŠ¨ä¸­æ–­è°ƒç”¨ä¸€æ®µæ—¶é—´ï¼Œé˜²æ­¢æ•´ä¸ªç³»ç»Ÿè¢«æ‹–å®ã€‚\nğŸ“å®ç°æœºåˆ¶ é€šå¸¸åŒ…å«ä¸‰ä¸ªçŠ¶æ€ï¼š\nClosedï¼ˆé—­åˆï¼‰ï¼šæ­£å¸¸è¯·æ±‚ Openï¼ˆæ‰“å¼€ï¼‰ï¼šè¾¾åˆ°å¤±è´¥é˜ˆå€¼åï¼Œç›´æ¥æ‹’ç»è¯·æ±‚ï¼ˆé¿å…é›ªå´©ï¼‰ Half-Openï¼ˆåŠå¼€ï¼‰ï¼šç­‰å¾…ä¸€éƒ¨åˆ†è¯·æ±‚æ¢æµ‹ä¸‹æ¸¸æ˜¯å¦æ¢å¤ ç†”æ–­å™¨ä¼šè®°å½•å¤±è´¥æ¬¡æ•°å’Œè¶…æ—¶ç‡ï¼Œå½“è¶…è¿‡é˜ˆå€¼æ—¶è¿›å…¥ Open çŠ¶æ€ï¼›ä¸€æ®µæ—¶é—´åå†å°è¯•â€œæ¢æµ‹è¯·æ±‚â€æ¢å¤ã€‚\nğŸ› ï¸ å®ç°æ–¹å¼ Goä¸­å¯ç”¨ï¼šsony/gobreakerã€Resilience4jï¼ˆJavaé£æ ¼ï¼‰ Kratosä¸­ï¼šåœ¨å®¢æˆ·ç«¯ä¸­é—´ä»¶é…ç½®ç†”æ–­ç­–ç•¥ åˆ†å¸ƒå¼åœºæ™¯ï¼šPrometheus + Alertmanager åšç†”æ–­è§¦å‘ ğŸ’¬ ä¸¾ä¾‹ â€œæ¯”å¦‚è°ƒç”¨AIç”ŸæˆæœåŠ¡æ—¶ï¼Œå¦‚æœQPSæ¿€å¢ï¼Œä¸‹æ¸¸ç”Ÿæˆæ¨¡å—å“åº”è¶…æ—¶ç‡è¶…è¿‡30%ï¼Œæˆ‘ä»¬è§¦å‘ç†”æ–­ï¼Œæš‚æ—¶è¿”å›å…œåº•æç¤ºâ€˜ç³»ç»Ÿç¹å¿™â€™ï¼Œç­‰è¿‡ä¸€æ®µæ—¶é—´å†åŠå¼€æ¢æµ‹ã€‚â€\nğŸª« å››ã€é™çº§ï¼ˆDegrade / Fallbackï¼‰ ğŸ“˜ æ¦‚å¿µ åœ¨ç³»ç»Ÿé«˜è´Ÿè½½ã€ä¸‹æ¸¸æ•…éšœæˆ–ç†”æ–­æ—¶ï¼Œä¸»åŠ¨å…³é—­éƒ¨åˆ†éæ ¸å¿ƒåŠŸèƒ½ï¼Œä»¥ä¿éšœä¸»æµç¨‹å¯ç”¨ã€‚\nğŸ“å…¸å‹åœºæ™¯ æ¨èç³»ç»Ÿåªè¿”å›ç¼“å­˜å†…å®¹ï¼ˆä¸å®æ—¶å¬å›ï¼‰ æœç´¢æ¥å£åªå±•ç¤ºä¸»ç»“æœï¼Œä¸å±•ç¤ºç›¸å…³æ¨è AIGCæ¥å£è¶…æ—¶åˆ™ç›´æ¥æç¤ºâ€œä»»åŠ¡æ’é˜Ÿä¸­â€ ğŸ› ï¸ å®ç°æ–¹å¼ é™æ€é™çº§ï¼šç›´æ¥è¿”å›é»˜è®¤å€¼æˆ–ç¼“å­˜ç»“æœ åŠ¨æ€é™çº§ï¼šé€šè¿‡é…ç½®ä¸­å¿ƒï¼ˆå¦‚ Apolloã€Nacosï¼‰åŠ¨æ€è°ƒæ•´ç­–ç•¥ æ™ºèƒ½é™çº§ï¼šç»“åˆç†”æ–­ + æµé‡ç›‘æ§è‡ªåŠ¨è§¦å‘ ğŸ’¬ ä¸¾ä¾‹ â€œæ¯”å¦‚åœ¨AIGCä»»åŠ¡é«˜å³°æœŸï¼Œæˆ‘ä»¬æ£€æµ‹åˆ°ç”ŸæˆæœåŠ¡CPUé£™å‡ï¼Œä¼šä¸»åŠ¨å°†ç”Ÿæˆå›¾ç‰‡åŠŸèƒ½é™çº§ä¸ºæ–‡æœ¬æè¿°ç”Ÿæˆï¼Œè®©æ ¸å¿ƒä»»åŠ¡ä¸ä¸­æ–­ã€‚â€\nğŸ”„ äº”ã€ä¸‰è€…å…³ç³»æ€»ç»“ï¼ˆé¢è¯•åŠ åˆ†æ€»ç»“ï¼‰ â€œä¸‰è€…å¸¸å¸¸é…åˆä½¿ç”¨ï¼š\né™æµä¿æŠ¤å…¥å£ï¼› ç†”æ–­éš”ç¦»æ•…éšœï¼› é™çº§å…œåº•ä½“éªŒã€‚ \u0026gt; æˆ‘ä»¬ä¼šé€šè¿‡ç›‘æ§ï¼ˆPrometheus + Grafanaï¼‰åŠ¨æ€è°ƒæ•´è¿™äº›ç­–ç•¥ï¼Œå®ç°è‡ªåŠ¨åŒ–ç¨³å®šæ€§æ§åˆ¶ã€‚â€ ğŸ§  é¢è¯•å®˜å»¶ä¼¸é—®æ³•ï¼ˆæå‰å‡†å¤‡ï¼‰ é—®é¢˜ å›ç­”æ–¹å‘ ç†”æ–­è§¦å‘åæ€ä¹ˆæ¢å¤ï¼Ÿ æœ‰ä¸ªâ€œåŠå¼€â€çŠ¶æ€ï¼Œé€šè¿‡å°‘é‡æ¢æµ‹è¯·æ±‚åˆ¤æ–­æ˜¯å¦æ¢å¤ é™æµç®—æ³•ä¸­å“ªä¸ªèƒ½åº”å¯¹çªå‘æµé‡ï¼Ÿ ä»¤ç‰Œæ¡¶æ¯”æ¼æ¡¶æ›´çµæ´»ï¼Œèƒ½çŸ­æ—¶çªå‘ å¦‚ä½•åˆ†å¸ƒå¼é™æµï¼Ÿ Redis + Luaè„šæœ¬ä¿è¯åŸå­æ“ä½œ é™çº§åå¦‚ä½•æ¢å¤ï¼Ÿ å¯é€šè¿‡é…ç½®ä¸­å¿ƒåŠ¨æ€å¼€å…³æˆ–æ ¹æ®ç›‘æ§æŒ‡æ ‡æ¢å¤ ç†”æ–­/é™æµæŒ‡æ ‡æ€ä¹ˆç›‘æ§ï¼Ÿ QPSã€å¤±è´¥ç‡ã€P99å»¶è¿Ÿã€error ratioã€CPU load âœ… æ€»ç»“ â€œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæˆ‘é€šå¸¸ä¼šé€šè¿‡é™æµã€ç†”æ–­å’Œé™çº§ä¸‰ç§æ‰‹æ®µä¿éšœç³»ç»Ÿç¨³å®šæ€§ï¼š é™æµä¸»è¦åœ¨å…¥å£å±‚æ§åˆ¶æµé‡ï¼Œæ¯”å¦‚ç”¨ä»¤ç‰Œæ¡¶ç®—æ³•é™åˆ¶è¯·æ±‚é€Ÿç‡ï¼› ç†”æ–­ç”¨äºè°ƒç”¨ä¸‹æ¸¸æ¥å£æ—¶é˜²æ­¢é›ªå´©ï¼Œæ¯”å¦‚è¿ç»­å¤±è´¥ç‡è¶…è¿‡30%å°±æš‚æ—¶ä¸­æ–­è°ƒç”¨ï¼› é™çº§åˆ™åœ¨ç³»ç»Ÿå‹åŠ›å¤§æˆ–ä¾èµ–å¼‚å¸¸æ—¶è¿”å›ç¼“å­˜æˆ–é»˜è®¤å€¼ï¼Œä¿è¯ä¸»æµç¨‹å¯ç”¨ã€‚ è¿™ä¸‰è€…é…åˆç›‘æ§ä½“ç³»ä¸€èµ·ä½¿ç”¨ï¼Œå¯ä»¥æœ‰æ•ˆæå‡ç³»ç»Ÿçš„éŸ§æ€§å’Œè‡ªæ¢å¤èƒ½åŠ›ã€‚â€\nè¿›é˜¶ ğŸ¯ é—®é¢˜æ ¸å¿ƒï¼šã€Œå¾®æœåŠ¡ä¸­çš„ç†”æ–­ã€é™æµã€é™çº§æœºåˆ¶ã€ è¿™æ˜¯åç«¯ä¸­éå¸¸é«˜é¢‘çš„ä¸­é«˜çº§é¢è¯•é¢˜ï¼Œå°¤å…¶æ˜¯ç™¾åº¦ã€å­—èŠ‚ã€ç¾å›¢ç­‰å¤§å‚å¸¸é—®ã€‚ ä»–ä»¬ä¸»è¦æƒ³è€ƒä½ ä¸‰ç‚¹ï¼š\nä½ æ˜¯å¦ç†è§£ä¸‰è€…çš„åŒºåˆ«ä¸è”ç³»ã€‚ ä½ æ˜¯å¦çŸ¥é“ä¸šç•Œå¸¸è§çš„å®ç°æ–¹å¼ã€‚ ä½ èƒ½å¦ç»“åˆå®é™…é¡¹ç›®åœºæ™¯ä¸¾ä¾‹è¯´æ˜ã€‚ ä¸€ã€å…ˆåŒºåˆ†æ¦‚å¿µï¼ˆç®€çŸ­ä½†æ¸…æ™°ï¼‰ æœºåˆ¶ ä½œç”¨ è§¦å‘æ¡ä»¶ ç›®æ ‡ é™æµ æ§åˆ¶å¹¶å‘é‡æˆ–è¯·æ±‚é€Ÿç‡ QPS è¶…è¿‡é˜ˆå€¼ é˜²æ­¢ç³»ç»Ÿè¢«å‹å® ç†”æ–­ é˜»æ­¢å¯¹ä¸‹æ¸¸æœåŠ¡çš„è®¿é—® ä¸‹æ¸¸å“åº”æ…¢/é”™è¯¯ç‡é«˜ é˜²æ­¢é›ªå´©æ•ˆåº” é™çº§ ä¸»åŠ¨å‡å°‘åŠŸèƒ½æˆ–è¿”å›å…œåº•æ•°æ® ä¸‹æ¸¸å¼‚å¸¸/é«˜å³°å‹åŠ› ä¿è¯æ ¸å¿ƒåŠŸèƒ½å¯ç”¨ ä¸€å¥è¯æ€»ç»“ï¼š\né™æµæ˜¯â€œé˜²æ´ªåâ€ï¼Œç†”æ–­æ˜¯â€œä¿é™©ä¸â€ï¼Œé™çº§æ˜¯â€œå¤‡ç”¨æ–¹æ¡ˆâ€ã€‚\näºŒã€åŸç†ä¸å®ç°æ–¹å¼ 1ï¸âƒ£ é™æµ å¸¸è§ç®—æ³•\nå›ºå®šçª—å£ï¼šæ¯ç§’æœ€å¤š N æ¬¡è¯·æ±‚ã€‚ æ»‘åŠ¨çª—å£ï¼šæ›´å¹³æ»‘æ§åˆ¶ã€‚ ä»¤ç‰Œæ¡¶ / æ¼æ¡¶ç®—æ³•ï¼šæ§åˆ¶é€Ÿç‡ + å…è®¸çªå‘ã€‚ å®ç°\næœåŠ¡å†…ï¼ˆå¦‚ Go é¡¹ç›®ä¸­ç”¨ golang.org/x/time/rateï¼‰ æˆ–å€ŸåŠ©ä¸­é—´ä»¶ï¼ˆå¦‚ Nginxã€Envoyã€Kongã€Sentinelï¼‰ ä¸¾ä¾‹\nlimiter := rate.NewLimiter(10, 20) // æ¯ç§’ 10 æ¬¡ï¼Œæœ€å¤§çªå‘ 20 if !limiter.Allow() { return errors.New(\u0026#34;rate limit exceeded\u0026#34;) } 2ï¸âƒ£ ç†”æ–­ æ ¸å¿ƒæ€æƒ³ï¼šå½“ä¾èµ–æœåŠ¡é•¿æ—¶é—´å¤±è´¥ï¼Œå°±â€œæ–­å¼€ç”µè·¯â€ï¼Œç›´æ¥è¿”å›é”™è¯¯æˆ–èµ°é™çº§é€»è¾‘ã€‚\nçŠ¶æ€æœºæ¨¡å‹ï¼š\nClosedï¼ˆé—­åˆï¼‰ï¼šæ­£å¸¸è°ƒç”¨ï¼› Openï¼ˆæ–­å¼€ï¼‰ï¼šæ‹’ç»è¯·æ±‚ï¼› Half-Openï¼ˆåŠå¼€ï¼‰ï¼šå°è¯•æ¢å¤ï¼› å®ç°æ–¹å¼\nä½¿ç”¨åº“ï¼šafex/hystrix-goã€go-resilienceã€Sentinel Go åœ¨ç½‘å…³å±‚å®ç°ï¼ˆå¦‚ Nacosã€Envoy ç»“åˆç†”æ–­ç­–ç•¥ï¼‰ ç¤ºä¾‹\ncb := gobreaker.NewCircuitBreaker(gobreaker.Settings{ Name: \u0026#34;user-service\u0026#34;, Timeout: 5 * time.Second, ReadyToTrip: func(counts gobreaker.Counts) bool { return counts.ConsecutiveFailures \u0026gt; 5 }, }) result, err := cb.Execute(func() (interface{}, error) { return callUserService() }) 3ï¸âƒ£ é™çº§ åœºæ™¯\nä¾èµ–è¶…æ—¶æˆ–ç†”æ–­æ—¶ â†’ ä½¿ç”¨ç¼“å­˜ / å…œåº•é€»è¾‘ã€‚ é«˜å³°æ—¶ä¸»åŠ¨å…³é—­éæ ¸å¿ƒåŠŸèƒ½ã€‚ ç­–ç•¥\né™æ€é™çº§ï¼ˆç›´æ¥è¿”å›é»˜è®¤å€¼ï¼‰ ç¼“å­˜é™çº§ï¼ˆä½¿ç”¨ä¸Šæ¬¡æˆåŠŸæ•°æ®ï¼‰ å¼‚æ­¥é™çº§ï¼ˆå†™å…¥ MQ åå¼‚æ­¥å¤„ç†ï¼‰ ç¤ºä¾‹\nuser, err := getUserFromRemote() if err != nil { // é™çº§æ–¹æ¡ˆï¼šè¿”å›ç¼“å­˜æˆ–é»˜è®¤æ•°æ® user = cache.Get(\u0026#34;user_backup\u0026#34;) } ä¸‰ã€ç­”é¢˜æ¨¡æ¿ï¼ˆé¢è¯•æ—¶è¿™æ ·è¯´ï¼‰ æˆ‘ä»¬åœ¨å¾®æœåŠ¡ä¸­ä¸€èˆ¬ä¼šé€šè¿‡ã€Œé™æµã€ç†”æ–­ã€é™çº§ã€ä¸‰ç§æ‰‹æ®µæ¥ä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚\né™æµç”¨äºé˜²æ­¢ç¬æ—¶é«˜å¹¶å‘å‹å®ç³»ç»Ÿï¼Œæˆ‘åœ¨é¡¹ç›®ä¸­é€šå¸¸ç”¨ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆGo ä¸­çš„ rate.Limiterï¼‰æ¥æ§åˆ¶æ¥å£çš„ QPSã€‚\nç†”æ–­ä¸»è¦æ˜¯é˜²æ­¢ä¸‹æ¸¸é›ªå´©ï¼Œå½“æŸä¸ªä¾èµ–æœåŠ¡é”™è¯¯ç‡é«˜æˆ–å“åº”æ…¢æ—¶ï¼Œé€šè¿‡åƒ gobreaker è¿™æ ·çš„åº“è‡ªåŠ¨æ‰“å¼€ç†”æ–­å™¨ï¼Œç›´æ¥è¿”å›å¿«é€Ÿå¤±è´¥ã€‚\né™çº§åˆ™æ˜¯æä¾›å…œåº•æ–¹æ¡ˆï¼Œæ¯”å¦‚ä¸‹æ¸¸ä¸å¯ç”¨æ—¶ï¼Œæˆ‘ä»¬ä¼šè¿”å›ç¼“å­˜æ•°æ®æˆ–æç¤ºâ€œç³»ç»Ÿç¹å¿™â€ï¼Œä»¥ä¿è¯æ ¸å¿ƒè·¯å¾„å¯ç”¨ã€‚\nå®é™…é¡¹ç›®ä¸­æˆ‘ä»¬ä¹Ÿä¼šç»“åˆç›‘æ§ï¼ˆPrometheus + Grafanaï¼‰å’ŒæŠ¥è­¦æ¥åŠ¨æ€è°ƒæ•´è¿™äº›ç­–ç•¥ã€‚\nå››ã€è¿›é˜¶åŠ åˆ†ç‚¹ é™æµåœ¨å…¥å£å±‚ï¼ˆç½‘å…³ï¼‰åšå…¨å±€æ§åˆ¶ï¼Œç†”æ–­å’Œé™çº§åœ¨æœåŠ¡å±‚åšç»†ç²’åº¦æ§åˆ¶ã€‚ ç›‘æ§é“¾è·¯ï¼šPrometheus â†’ Grafana â†’ Alertmanagerã€‚ ç†”æ–­ä¸é™æµç­–ç•¥é€šå¸¸æ˜¯åŠ¨æ€é…ç½®ï¼ˆé€šè¿‡ Apollo/Nacos é…ç½®ä¸­å¿ƒçƒ­æ›´æ–°ï¼‰ã€‚ ",
"tags":null,
"categories":null
},{
"title":"Init",
"permalink": "http://localhost:1313/posts/go/init/",
"summary": "âœ… ä¸€ã€init() æ˜¯ä»€ä¹ˆ init() æ˜¯ Go çš„ç‰¹æ®Šå‡½æ•°ï¼Œç”¨äºåœ¨åŒ…è¢«åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œåˆå§‹åŒ–é€»è¾‘ã€‚ å®ƒä¸éœ€è¦æ˜¾å¼è°ƒç”¨ï¼Œä¹Ÿä¸èƒ½è¢«å…¶ä»–ä»£ç è°ƒç”¨ã€‚\nâœ… äºŒã€init() çš„åŸºæœ¬ç‰¹æ€§ ç‰¹æ€§ è¯´æ˜ è§¦å‘æ—¶æœº åœ¨åŒ…è¢«ç¬¬ä¸€æ¬¡å¯¼å…¥æ—¶è‡ªåŠ¨æ‰§è¡Œï¼ˆåªæ‰§è¡Œä¸€æ¬¡ï¼‰ è°ƒç”¨æ–¹å¼ Go runtime è‡ªåŠ¨è°ƒç”¨ï¼Œä¸èƒ½æ‰‹åŠ¨è°ƒç”¨ å‚æ•° æ— å‚æ•° è¿”å›å€¼ æ— è¿”å›å€¼ ä½œç”¨èŒƒå›´ æ¯ä¸ªåŒ…å¯ä»¥å®šä¹‰å¤šä¸ª init() å‡½æ•° æ‰§è¡Œé¡ºåº æŒ‰ç…§å¯¼å…¥ä¾èµ–å…³ç³»å’Œæºç å‡ºç°é¡ºåºæ‰§è¡Œ âœ… ä¸‰ã€æœ€åŸºæœ¬çš„ä¾‹å­ package main import \u0026#34;fmt\u0026#34; func init() { fmt.Println(\u0026#34;init() called\u0026#34;) } func main() { fmt.Println(\u0026#34;main() called\u0026#34;) } è¾“å‡ºï¼š\ninit() called main() called âœ… init() æ€»æ˜¯åœ¨ main() ä¹‹å‰æ‰§è¡Œã€‚\nâœ… å››ã€åŒ…åˆå§‹åŒ–é¡ºåºï¼ˆé‡ç‚¹ï¼‰ Go ç¨‹åºå¯åŠ¨æ—¶ä¼šæŒ‰å¦‚ä¸‹é¡ºåºæ‰§è¡Œï¼š\nå¯¼å…¥ä¾èµ–åŒ… åˆå§‹åŒ–ä¾èµ–åŒ…çš„å¸¸é‡å’Œå˜é‡ æ‰§è¡Œä¾èµ–åŒ…çš„ init() å‡½æ•° æ‰§è¡Œå½“å‰åŒ…çš„å¸¸é‡ã€å˜é‡åˆå§‹åŒ– æ‰§è¡Œå½“å‰åŒ…çš„ init() å‡½æ•° æ‰§è¡Œ main.main() ç¤ºä¾‹ï¼š // file: a.go package a import \u0026#34;fmt\u0026#34; var V = initVar() func initVar() int { fmt.Println(\u0026#34;a.initVar()\u0026#34;) return 42 } func init() { fmt.Println(\u0026#34;a.init()\u0026#34;) } // file: main.go package main import ( \u0026#34;fmt\u0026#34; \u0026#34;example/a\u0026#34; ) func init() { fmt.Println(\u0026#34;main.init()\u0026#34;) } func main() { fmt.Println(\u0026#34;main.main()\u0026#34;, a.V) } è¾“å‡ºï¼š\n",
"content": "âœ… ä¸€ã€init() æ˜¯ä»€ä¹ˆ init() æ˜¯ Go çš„ç‰¹æ®Šå‡½æ•°ï¼Œç”¨äºåœ¨åŒ…è¢«åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œåˆå§‹åŒ–é€»è¾‘ã€‚ å®ƒä¸éœ€è¦æ˜¾å¼è°ƒç”¨ï¼Œä¹Ÿä¸èƒ½è¢«å…¶ä»–ä»£ç è°ƒç”¨ã€‚\nâœ… äºŒã€init() çš„åŸºæœ¬ç‰¹æ€§ ç‰¹æ€§ è¯´æ˜ è§¦å‘æ—¶æœº åœ¨åŒ…è¢«ç¬¬ä¸€æ¬¡å¯¼å…¥æ—¶è‡ªåŠ¨æ‰§è¡Œï¼ˆåªæ‰§è¡Œä¸€æ¬¡ï¼‰ è°ƒç”¨æ–¹å¼ Go runtime è‡ªåŠ¨è°ƒç”¨ï¼Œä¸èƒ½æ‰‹åŠ¨è°ƒç”¨ å‚æ•° æ— å‚æ•° è¿”å›å€¼ æ— è¿”å›å€¼ ä½œç”¨èŒƒå›´ æ¯ä¸ªåŒ…å¯ä»¥å®šä¹‰å¤šä¸ª init() å‡½æ•° æ‰§è¡Œé¡ºåº æŒ‰ç…§å¯¼å…¥ä¾èµ–å…³ç³»å’Œæºç å‡ºç°é¡ºåºæ‰§è¡Œ âœ… ä¸‰ã€æœ€åŸºæœ¬çš„ä¾‹å­ package main import \u0026#34;fmt\u0026#34; func init() { fmt.Println(\u0026#34;init() called\u0026#34;) } func main() { fmt.Println(\u0026#34;main() called\u0026#34;) } è¾“å‡ºï¼š\ninit() called main() called âœ… init() æ€»æ˜¯åœ¨ main() ä¹‹å‰æ‰§è¡Œã€‚\nâœ… å››ã€åŒ…åˆå§‹åŒ–é¡ºåºï¼ˆé‡ç‚¹ï¼‰ Go ç¨‹åºå¯åŠ¨æ—¶ä¼šæŒ‰å¦‚ä¸‹é¡ºåºæ‰§è¡Œï¼š\nå¯¼å…¥ä¾èµ–åŒ… åˆå§‹åŒ–ä¾èµ–åŒ…çš„å¸¸é‡å’Œå˜é‡ æ‰§è¡Œä¾èµ–åŒ…çš„ init() å‡½æ•° æ‰§è¡Œå½“å‰åŒ…çš„å¸¸é‡ã€å˜é‡åˆå§‹åŒ– æ‰§è¡Œå½“å‰åŒ…çš„ init() å‡½æ•° æ‰§è¡Œ main.main() ç¤ºä¾‹ï¼š // file: a.go package a import \u0026#34;fmt\u0026#34; var V = initVar() func initVar() int { fmt.Println(\u0026#34;a.initVar()\u0026#34;) return 42 } func init() { fmt.Println(\u0026#34;a.init()\u0026#34;) } // file: main.go package main import ( \u0026#34;fmt\u0026#34; \u0026#34;example/a\u0026#34; ) func init() { fmt.Println(\u0026#34;main.init()\u0026#34;) } func main() { fmt.Println(\u0026#34;main.main()\u0026#34;, a.V) } è¾“å‡ºï¼š\na.initVar() a.init() main.init() main.main() 42 å…ˆåˆå§‹åŒ–åŒ… aï¼Œå†åˆå§‹åŒ– mainã€‚ åŒ…çš„å˜é‡åˆå§‹åŒ–åœ¨ init() ä¹‹å‰ã€‚\nâœ… äº”ã€å¤šä¸ª init() çš„æ‰§è¡Œé¡ºåº ä½ å¯ä»¥åœ¨åŒä¸€ä¸ªåŒ…é‡Œå†™å¤šä¸ª init()ï¼Œä¾‹å¦‚ï¼š\npackage main import \u0026#34;fmt\u0026#34; func init() { fmt.Println(\u0026#34;init 1\u0026#34;) } func init() { fmt.Println(\u0026#34;init 2\u0026#34;) } func main() { fmt.Println(\u0026#34;main\u0026#34;) } è¾“å‡ºï¼š\ninit 1 init 2 main é¡ºåºç”±æºç ä¸­çš„å‡ºç°é¡ºåºå†³å®šã€‚\nâœ… å…­ã€å¤šä¸ªåŒ…çš„ init() æ‰§è¡Œé¡ºåº å‡è®¾é¡¹ç›®ç»“æ„ï¼š\nmain.go pkg/ â”œâ”€ a.go â””â”€ b.go pkg/a.go package pkg import \u0026#34;fmt\u0026#34; func init() { fmt.Println(\u0026#34;pkg.a.init()\u0026#34;) } pkg/b.go package pkg import \u0026#34;fmt\u0026#34; func init() { fmt.Println(\u0026#34;pkg.b.init()\u0026#34;) } main.go package main import ( \u0026#34;fmt\u0026#34; \u0026#34;example/pkg\u0026#34; ) func init() { fmt.Println(\u0026#34;main.init()\u0026#34;) } func main() { fmt.Println(\u0026#34;main.main()\u0026#34;) } è¾“å‡ºï¼š\npkg.a.init() pkg.b.init() main.init() main.main() åŒä¸€ä¸ªåŒ…å†…ï¼ŒæŒ‰æ–‡ä»¶åï¼ˆå­—æ¯é¡ºåºï¼‰å’Œå£°æ˜é¡ºåºæ‰§è¡Œï¼› è¢«å¯¼å…¥åŒ…æ€»æ˜¯å…ˆäºå¯¼å…¥è€…æ‰§è¡Œã€‚\nâœ… ä¸ƒã€å¸¸è§ç”¨é€” ä½¿ç”¨åœºæ™¯ ç¤ºä¾‹ æ³¨å†Œé©±åŠ¨ æ•°æ®åº“é©±åŠ¨åŒ…å¸¸ç”¨ï¼š _ \u0026quot;github.com/go-sql-driver/mysql\u0026quot; åˆå§‹åŒ–é…ç½® ä»é…ç½®æ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡ æ³¨å†Œæ’ä»¶ å¦‚ init() ä¸­è°ƒç”¨ plugin.Register() å¯åŠ¨æ—¥å¿—ç³»ç»Ÿ åˆå§‹åŒ–æ—¥å¿—è¾“å‡ºæ ¼å¼ åˆå§‹åŒ–å…¨å±€å˜é‡ æ¯”å¦‚ç¼“å­˜ã€æ˜ å°„è¡¨ã€è¿æ¥æ±  âœ… å…«ã€init() vs main() å¯¹æ¯”é¡¹ init() main() è°ƒç”¨æ–¹å¼ è‡ªåŠ¨ æ‰‹åŠ¨ï¼ˆç¨‹åºå…¥å£ï¼‰ æ¯åŒ…æ‰§è¡Œæ¬¡æ•° ä¸€æ¬¡ ä¸€æ¬¡ï¼ˆä»… main åŒ…ï¼‰ è¿”å›å€¼ æ—  æœ‰ æ‰§è¡Œæ—¶æœº ç¨‹åºåŠ è½½é˜¶æ®µ ç¨‹åºè¿è¡Œé˜¶æ®µ ä¸»è¦ç”¨é€” åˆå§‹åŒ– ä¸šåŠ¡é€»è¾‘æ‰§è¡Œ âœ… ä¹ã€æ³¨æ„äº‹é¡¹ï¼ˆå®¹æ˜“è¸©å‘ï¼‰ âš ï¸ æ³¨æ„ è¯´æ˜ ä¸å¯ä¾èµ–æ‰§è¡Œé¡ºåºè·¨åŒ…è°ƒç”¨ init é¡ºåºå—ä¾èµ–å…³ç³»å½±å“ï¼Œä¸é€‚åˆåšå¤æ‚é€»è¾‘ ä¸å»ºè®®å¤æ‚é€»è¾‘ ä¿æŒè½»é‡ï¼šç”¨äºåˆå§‹åŒ–ï¼Œä¸è¦å†™è€—æ—¶æ“ä½œ ä¸è¦ panic å¦‚æœ init() panicï¼Œä¼šå¯¼è‡´æ•´ä¸ªç¨‹åºæ— æ³•å¯åŠ¨ åŒ…çš„ init åªæ‰§è¡Œä¸€æ¬¡ å³ä½¿å¤šæ¬¡ importï¼ŒåŒä¸€ä¸ªåŒ…åªåˆå§‹åŒ–ä¸€æ¬¡ âœ… åã€æœ€ä½³å®è·µå»ºè®® âœ… é€‚åˆåšï¼š\næ³¨å†Œï¼ˆpluginã€driverã€handlerï¼‰ åˆå§‹åŒ–å…¨å±€çŠ¶æ€ï¼ˆä¸€æ¬¡æ€§ï¼‰ é…ç½®åŠ è½½æˆ–ç¯å¢ƒæ£€æµ‹ ğŸš« ä¸é€‚åˆåšï¼š\nç½‘ç»œè¯·æ±‚ã€å¤æ‚è¿ç®— å¯åŠ¨ goroutine åŠ¨æ€ä¾èµ–å…¶ä»–åŒ…æ‰§è¡Œé¡ºåº ğŸ§© Bonusï¼š_ åŒ¿åå¯¼å…¥ä¸ init() import _ \u0026#34;github.com/go-sql-driver/mysql\u0026#34; è™½ç„¶æ²¡æœ‰æ˜¾å¼ä½¿ç”¨ mysql åŒ…ï¼Œä½†ï¼š\nåŒ…ä»ç„¶ä¼šè¢«ç¼–è¯‘ï¼› å…¶ init() ä¼šæ‰§è¡Œï¼› ç”¨äºæ³¨å†Œ MySQL é©±åŠ¨ã€‚ âœ… æ€»ç»“ ç‰¹æ€§ è¯´æ˜ æ‰§è¡Œæ—¶æœº åŒ…åŠ è½½é˜¶æ®µ æ‰§è¡Œæ¬¡æ•° æ¯åŒ…ä¸€æ¬¡ è°ƒç”¨æ–¹å¼ è‡ªåŠ¨è°ƒç”¨ æ‰§è¡Œé¡ºåº ä¾èµ–é¡ºåº â†’ æºç é¡ºåº å‚æ•°å’Œè¿”å› æ—  å¸¸è§ç”¨é€” æ³¨å†Œã€åˆå§‹åŒ–ã€åŠ è½½é…ç½® æ³¨æ„äº‹é¡¹ ä¸è¦å†™è€—æ—¶é€»è¾‘ï¼Œä¸è¦ä¾èµ–è·¨åŒ…é¡ºåº ",
"tags":null,
"categories":null
},{
"title":"Defer",
"permalink": "http://localhost:1313/posts/go/defer/",
"summary": "âœ… ä¸€ã€defer çš„åŸºæœ¬ä½œç”¨ defer ç”¨æ¥å»¶è¿Ÿæ‰§è¡Œä¸€æ®µå‡½æ•°è°ƒç”¨ï¼Œç›´åˆ°å½“å‰å‡½æ•°è¿”å›æ—¶æ‰æ‰§è¡Œï¼ˆæ— è®ºæ˜¯æ­£å¸¸è¿”å›è¿˜æ˜¯é‡åˆ° panicï¼‰ã€‚\nç¤ºä¾‹ï¼š func main() { fmt.Println(\u0026#34;A\u0026#34;) defer fmt.Println(\u0026#34;B\u0026#34;) fmt.Println(\u0026#34;C\u0026#34;) } è¾“å‡ºï¼š\nA C B ğŸ‘‰ defer çš„è°ƒç”¨ä¼šåœ¨å‡½æ•°é€€å‡ºæ—¶æ‰§è¡Œã€‚\nâœ… äºŒã€å¤šä¸ª defer çš„æ‰§è¡Œé¡ºåºï¼šåè¿›å…ˆå‡º (LIFO) func main() { defer fmt.Println(\u0026#34;1\u0026#34;) defer fmt.Println(\u0026#34;2\u0026#34;) defer fmt.Println(\u0026#34;3\u0026#34;) } è¾“å‡ºï¼š\n3 2 1 å°±åƒæ ˆä¸€æ ·ï¼Œæœ€åæ³¨å†Œçš„ defer æœ€å…ˆæ‰§è¡Œã€‚\nâœ… ä¸‰ã€å‚æ•°æ±‚å€¼æ—¶æœºï¼šdefer å®šä¹‰æ—¶å°±æ±‚å€¼ è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç»†èŠ‚ï¼\nfunc main() { x := 10 defer fmt.Println(\u0026#34;defer:\u0026#34;, x) x = 20 fmt.Println(\u0026#34;x =\u0026#34;, x) } è¾“å‡ºï¼š\nx = 20 defer: 10 ğŸ”¹ åŸå› ï¼š defer çš„å‚æ•°ä¼šåœ¨æ³¨å†Œ defer æ—¶ç«‹åˆ»æ±‚å€¼ï¼Œè€Œä¸æ˜¯åœ¨æ‰§è¡Œæ—¶æ±‚å€¼ã€‚\nâœ… å››ã€é—­åŒ… deferï¼šå¼•ç”¨å¤–éƒ¨å˜é‡æ—¶ä¼šå®æ—¶è¯»å– func main() { x := 10 defer func() { fmt.Println(\u0026#34;defer:\u0026#34;, x) }() x = 20 fmt.Println(\u0026#34;x =\u0026#34;, x) } è¾“å‡ºï¼š\n",
"content": "âœ… ä¸€ã€defer çš„åŸºæœ¬ä½œç”¨ defer ç”¨æ¥å»¶è¿Ÿæ‰§è¡Œä¸€æ®µå‡½æ•°è°ƒç”¨ï¼Œç›´åˆ°å½“å‰å‡½æ•°è¿”å›æ—¶æ‰æ‰§è¡Œï¼ˆæ— è®ºæ˜¯æ­£å¸¸è¿”å›è¿˜æ˜¯é‡åˆ° panicï¼‰ã€‚\nç¤ºä¾‹ï¼š func main() { fmt.Println(\u0026#34;A\u0026#34;) defer fmt.Println(\u0026#34;B\u0026#34;) fmt.Println(\u0026#34;C\u0026#34;) } è¾“å‡ºï¼š\nA C B ğŸ‘‰ defer çš„è°ƒç”¨ä¼šåœ¨å‡½æ•°é€€å‡ºæ—¶æ‰§è¡Œã€‚\nâœ… äºŒã€å¤šä¸ª defer çš„æ‰§è¡Œé¡ºåºï¼šåè¿›å…ˆå‡º (LIFO) func main() { defer fmt.Println(\u0026#34;1\u0026#34;) defer fmt.Println(\u0026#34;2\u0026#34;) defer fmt.Println(\u0026#34;3\u0026#34;) } è¾“å‡ºï¼š\n3 2 1 å°±åƒæ ˆä¸€æ ·ï¼Œæœ€åæ³¨å†Œçš„ defer æœ€å…ˆæ‰§è¡Œã€‚\nâœ… ä¸‰ã€å‚æ•°æ±‚å€¼æ—¶æœºï¼šdefer å®šä¹‰æ—¶å°±æ±‚å€¼ è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç»†èŠ‚ï¼\nfunc main() { x := 10 defer fmt.Println(\u0026#34;defer:\u0026#34;, x) x = 20 fmt.Println(\u0026#34;x =\u0026#34;, x) } è¾“å‡ºï¼š\nx = 20 defer: 10 ğŸ”¹ åŸå› ï¼š defer çš„å‚æ•°ä¼šåœ¨æ³¨å†Œ defer æ—¶ç«‹åˆ»æ±‚å€¼ï¼Œè€Œä¸æ˜¯åœ¨æ‰§è¡Œæ—¶æ±‚å€¼ã€‚\nâœ… å››ã€é—­åŒ… deferï¼šå¼•ç”¨å¤–éƒ¨å˜é‡æ—¶ä¼šå®æ—¶è¯»å– func main() { x := 10 defer func() { fmt.Println(\u0026#34;defer:\u0026#34;, x) }() x = 20 fmt.Println(\u0026#34;x =\u0026#34;, x) } è¾“å‡ºï¼š\nx = 20 defer: 20 ğŸ‘‰ å› ä¸ºè¿™é‡Œ defer å»¶è¿Ÿçš„æ˜¯åŒ¿åå‡½æ•°ï¼Œå®ƒæŒæœ‰ x çš„å¼•ç”¨ï¼ˆé—­åŒ…ï¼‰ï¼Œæ‰€ä»¥æ‰§è¡Œæ—¶è¯»åˆ°çš„æ˜¯æœ€æ–°å€¼ã€‚\nâœ… äº”ã€defer ä¸è¿”å›å€¼çš„å…³ç³» æƒ…å†µ1ï¼šå‘½åè¿”å›å€¼ï¼ˆå¯è¢«ä¿®æ”¹ï¼‰ func demo() (x int) { defer func() { x++ // ä¿®æ”¹å‘½åè¿”å›å€¼ }() return 1 } func main() { fmt.Println(demo()) // è¾“å‡º 2 } è§£é‡Šï¼š\nreturn 1 ä¼šå…ˆç»™ x = 1 ç„¶åæ‰§è¡Œ defer æœ€åè¿”å›ä¿®æ”¹åçš„ x = 2 æƒ…å†µ2ï¼šéå‘½åè¿”å›å€¼ï¼ˆä¸ä¼šä¿®æ”¹ï¼‰ func demo() int { x := 1 defer func() { x++ }() return x } func main() { fmt.Println(demo()) // è¾“å‡º 1 } è¿”å›å€¼ä¸æ˜¯å‘½åè¿”å›å€¼ï¼Œdefer é‡Œä¿®æ”¹ x ä¸å½±å“è¿”å›ã€‚\nâœ… å…­ã€defer å³ä½¿é‡åˆ° panic ä¹Ÿä¼šæ‰§è¡Œ func main() { defer fmt.Println(\u0026#34;defer executed\u0026#34;) panic(\u0026#34;something went wrong\u0026#34;) } è¾“å‡ºï¼š\ndefer executed panic: something went wrong âœ… ä¸ƒã€defer å¸¸è§çš„ä½¿ç”¨åœºæ™¯ åœºæ™¯ ç¤ºä¾‹ æ–‡ä»¶å…³é—­ defer file.Close() æ•°æ®åº“è¿æ¥å…³é—­ defer db.Close() ç½‘ç»œè¿æ¥å…³é—­ defer conn.Close() é”é‡Šæ”¾ mu.Lock(); defer mu.Unlock() panic æ¢å¤ defer func(){ if err := recover(); err != nil {...} }() æ€§èƒ½ç»Ÿè®¡ start := time.Now(); defer func(){ fmt.Println(time.Since(start)) }() âš ï¸ å…«ã€æ€§èƒ½æ³¨æ„äº‹é¡¹ defer åœ¨ Go 1.14 ä¹‹åæ€§èƒ½å·²æ˜¾è‘—æå‡ï¼Œä½†ä»æœ‰ä¸€äº›æ³¨æ„ç‚¹ï¼š\nåœºæ™¯ å»ºè®® é«˜é¢‘å¾ªç¯å†…è°ƒç”¨ defer âŒ å°½é‡é¿å…ï¼ˆå¯æ‰‹åŠ¨è°ƒç”¨ï¼‰ æ™®é€šå‡½æ•°ä¸­ä½¿ç”¨ 1~3 ä¸ª defer âœ… å®Œå…¨æ²¡é—®é¢˜ Go 1.14+ âœ… defer æ€§èƒ½å‡ ä¹ç­‰ä»·äºæ‰‹åŠ¨è°ƒç”¨ âœ… ä¹ã€å‡½æ•°æ‰§è¡Œé¡ºåºæ€»ç»“ï¼ˆè¶…æ¸…ç‰ˆï¼‰ func example() (result int) { defer fmt.Println(\u0026#34;1\u0026#34;) defer func() { fmt.Println(\u0026#34;2, result =\u0026#34;, result) }() defer func(r int) { fmt.Println(\u0026#34;3, r =\u0026#34;, r) }(result) result = 100 return } è¾“å‡ºï¼š\n3, r = 0 2, result = 100 1 æ‰§è¡Œé€»è¾‘ï¼š\ndefer å‚æ•°æ±‚å€¼é¡ºåºï¼šç«‹å³æ‰§è¡Œï¼ˆr = 0ï¼‰ return æ‰§è¡Œï¼šèµ‹å€¼ result = 100 æŒ‰ LIFO é¡ºåºæ‰§è¡Œ defer å‡½æ•°è¿”å› âœ… åã€æ€»ç»“ ç‰¹æ€§ è¯´æ˜ æ‰§è¡Œæ—¶æœº å‡½æ•°è¿”å›å‰æ‰§è¡Œï¼ˆæ­£å¸¸è¿”å›æˆ– panicï¼‰ æ‰§è¡Œé¡ºåº åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰ å‚æ•°æ±‚å€¼æ—¶æœº æ³¨å†Œæ—¶æ±‚å€¼ æ”¯æŒé—­åŒ… å¯ä»¥è®¿é—®å¤–éƒ¨å˜é‡ å‘½åè¿”å›å€¼å¯ä¿®æ”¹ æ˜¯ panic ä»æ‰§è¡Œ æ˜¯ æ€§èƒ½ Go1.14+ å·²å¤§å¹…ä¼˜åŒ– ",
"tags":null,
"categories":null
},{
"title":"ç®—æ³•é¢˜è§£é¢˜æ€è·¯",
"permalink": "http://localhost:1313/posts/datastructalgorithm/%E7%AE%97%E6%B3%95%E9%A2%98%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/",
"summary": "ä¸€ã€å¸¸è§é¢˜å‹ä¸æ ¸å¿ƒè§£æ³•å¯¹åº”è¡¨ é¢˜å‹ç±»åˆ« å¸¸ç”¨è§£æ³• å…³é”®æ€ç»´ å¸¸è§é¢˜ä¾‹ æ•°ç»„ / åºåˆ—ç±» åŒæŒ‡é’ˆã€æ»‘åŠ¨çª—å£ã€å‰ç¼€å’Œã€å•è°ƒæ ˆ å®šé•¿çª—å£ / ä¸å®šé•¿çª—å£ ä¸‰æ•°ä¹‹å’Œã€æœ€å¤§å­åºå’Œã€æ¯æ—¥æ¸©åº¦ã€æ¥é›¨æ°´ æ’åº / æŸ¥æ‰¾ç±» å¿«æ’ã€å½’å¹¶ã€äºŒåˆ†æŸ¥æ‰¾ æœ‰åºæ€§ + åŒºé—´åˆ†æ²» æœç´¢æ’å…¥ä½ç½®ã€æ—‹è½¬æ•°ç»„æœ€å°å€¼ åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰ç±» çŠ¶æ€è½¬ç§» + å­é—®é¢˜åˆ’åˆ† â€œå‰ i ä¸ªâ€¦â€ã€â€œä»¥ i ç»“å°¾â€¦â€ æ‰“å®¶åŠ«èˆã€æœ€å¤§å­åºå’Œã€å•è¯æ‹†åˆ†ã€çˆ¬æ¥¼æ¢¯ å­—ç¬¦ä¸²ç±» DPã€åŒæŒ‡é’ˆã€å“ˆå¸Œ å­ä¸²ã€å›æ–‡ã€åŒ¹é… æœ€é•¿å›æ–‡å­ä¸²ã€æ— é‡å¤å­ä¸²é•¿åº¦ å“ˆå¸Œ / é›†åˆç±» map + æ»‘åŠ¨çª—å£ å­˜åœ¨æ€§åˆ¤æ–­ ä¸¤æ•°ä¹‹å’Œã€æœ€é•¿ä¸é‡å¤å­ä¸² æ ˆ / é˜Ÿåˆ—ç±» å•è°ƒæ ˆã€è¾…åŠ©æ ˆã€é˜Ÿåˆ—ä¼˜åŒ– â€œä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ â€ æœ‰æ•ˆæ‹¬å·ã€æ¯æ—¥æ¸©åº¦ã€æ¥é›¨æ°´ æ ‘ / å›¾ç±» DFS / BFSã€é€’å½’ / é˜Ÿåˆ— éå† + çŠ¶æ€ä¼ é€’ äºŒå‰æ ‘æœ€å¤§æ·±åº¦ã€å²›å±¿æ•°é‡ã€æœ€çŸ­è·¯å¾„ è´ªå¿ƒç±» å±€éƒ¨æœ€ä¼˜ â†’ å…¨å±€æœ€ä¼˜ æ’åº + é€‰æ‹© åŒºé—´åˆå¹¶ã€è·³è·ƒæ¸¸æˆã€åˆ†å‘ç³–æœ æ•°å­¦ç±» æ¨¡æ‹Ÿã€æ•´é™¤ã€å¿«é€Ÿå¹‚ æ•°å­¦è§„å¾‹åŒ–ç®€ æ•´æ•°åè½¬ã€Pow(x,n)ã€ç½—é©¬æ•°å­—è½¬æ•´æ•° äºŒã€é™Œç”Ÿé¢˜åˆ†ææ¡†æ¶ï¼ˆæ ¸å¿ƒåº”å¯¹æ¨¡æ¿ï¼‰ ğŸ§© Step 1ï¼šå…ˆææ¸…é—®é¢˜ç±»å‹ æ˜¯å¦è¦æ±‚æœ€å€¼ï¼Ÿ\n",
"content": "ä¸€ã€å¸¸è§é¢˜å‹ä¸æ ¸å¿ƒè§£æ³•å¯¹åº”è¡¨ é¢˜å‹ç±»åˆ« å¸¸ç”¨è§£æ³• å…³é”®æ€ç»´ å¸¸è§é¢˜ä¾‹ æ•°ç»„ / åºåˆ—ç±» åŒæŒ‡é’ˆã€æ»‘åŠ¨çª—å£ã€å‰ç¼€å’Œã€å•è°ƒæ ˆ å®šé•¿çª—å£ / ä¸å®šé•¿çª—å£ ä¸‰æ•°ä¹‹å’Œã€æœ€å¤§å­åºå’Œã€æ¯æ—¥æ¸©åº¦ã€æ¥é›¨æ°´ æ’åº / æŸ¥æ‰¾ç±» å¿«æ’ã€å½’å¹¶ã€äºŒåˆ†æŸ¥æ‰¾ æœ‰åºæ€§ + åŒºé—´åˆ†æ²» æœç´¢æ’å…¥ä½ç½®ã€æ—‹è½¬æ•°ç»„æœ€å°å€¼ åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰ç±» çŠ¶æ€è½¬ç§» + å­é—®é¢˜åˆ’åˆ† â€œå‰ i ä¸ªâ€¦â€ã€â€œä»¥ i ç»“å°¾â€¦â€ æ‰“å®¶åŠ«èˆã€æœ€å¤§å­åºå’Œã€å•è¯æ‹†åˆ†ã€çˆ¬æ¥¼æ¢¯ å­—ç¬¦ä¸²ç±» DPã€åŒæŒ‡é’ˆã€å“ˆå¸Œ å­ä¸²ã€å›æ–‡ã€åŒ¹é… æœ€é•¿å›æ–‡å­ä¸²ã€æ— é‡å¤å­ä¸²é•¿åº¦ å“ˆå¸Œ / é›†åˆç±» map + æ»‘åŠ¨çª—å£ å­˜åœ¨æ€§åˆ¤æ–­ ä¸¤æ•°ä¹‹å’Œã€æœ€é•¿ä¸é‡å¤å­ä¸² æ ˆ / é˜Ÿåˆ—ç±» å•è°ƒæ ˆã€è¾…åŠ©æ ˆã€é˜Ÿåˆ—ä¼˜åŒ– â€œä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ â€ æœ‰æ•ˆæ‹¬å·ã€æ¯æ—¥æ¸©åº¦ã€æ¥é›¨æ°´ æ ‘ / å›¾ç±» DFS / BFSã€é€’å½’ / é˜Ÿåˆ— éå† + çŠ¶æ€ä¼ é€’ äºŒå‰æ ‘æœ€å¤§æ·±åº¦ã€å²›å±¿æ•°é‡ã€æœ€çŸ­è·¯å¾„ è´ªå¿ƒç±» å±€éƒ¨æœ€ä¼˜ â†’ å…¨å±€æœ€ä¼˜ æ’åº + é€‰æ‹© åŒºé—´åˆå¹¶ã€è·³è·ƒæ¸¸æˆã€åˆ†å‘ç³–æœ æ•°å­¦ç±» æ¨¡æ‹Ÿã€æ•´é™¤ã€å¿«é€Ÿå¹‚ æ•°å­¦è§„å¾‹åŒ–ç®€ æ•´æ•°åè½¬ã€Pow(x,n)ã€ç½—é©¬æ•°å­—è½¬æ•´æ•° äºŒã€é™Œç”Ÿé¢˜åˆ†ææ¡†æ¶ï¼ˆæ ¸å¿ƒåº”å¯¹æ¨¡æ¿ï¼‰ ğŸ§© Step 1ï¼šå…ˆææ¸…é—®é¢˜ç±»å‹ æ˜¯å¦è¦æ±‚æœ€å€¼ï¼Ÿ\næ˜¯ â†’ åŠ¨æ€è§„åˆ’ / è´ªå¿ƒ å¦ â†’ ç»§ç»­å¾€ä¸‹åˆ†æ æ˜¯å¦æ¶‰åŠæŸ¥æ‰¾ / å­˜åœ¨ï¼Ÿ\næ˜¯ â†’ å“ˆå¸Œ / äºŒåˆ† æ˜¯å¦æ¶‰åŠè¿ç»­åŒºé—´æˆ–é…å¯¹ï¼Ÿ\næ˜¯ â†’ åŒæŒ‡é’ˆ / æ»‘åŠ¨çª—å£ æ˜¯å¦éœ€è¦è·¯å¾„ã€å±‚æ¬¡æˆ–è¿é€šæ€§ï¼Ÿ\næ˜¯ â†’ DFS / BFS æ˜¯å¦å­˜åœ¨â€œå­é—®é¢˜ä¾èµ–å…³ç³»â€ï¼Ÿ\næ˜¯ â†’ åŠ¨æ€è§„åˆ’ æ˜¯å¦æ¶‰åŠæ ‘æˆ–å›¾ç»“æ„ï¼Ÿ\næ˜¯ â†’ é€’å½’ / é˜Ÿåˆ— / æ ˆ æ˜¯å¦æ˜¯ç»„åˆæšä¸¾ç±»ï¼Ÿ\næ˜¯ â†’ å›æº¯ / DFS ğŸ§  Step 2ï¼šå¤æ‚åº¦é¢„ä¼° + æš´åŠ›æ€è·¯ å…ˆå†™æœ€ç›´æ¥çš„æš´åŠ›è§£ï¼Œå†åˆ†æå¤æ‚åº¦ï¼š\nåˆ†æé¡¹ ç¤ºä¾‹ æ—¶é—´å¤æ‚åº¦ O(nÂ²) / O(nÂ³) / O(2â¿) ç©ºé—´å¤æ‚åº¦ O(n) / O(1) ä¼˜åŒ–æ–¹å‘ æ’åº â†’ åŒæŒ‡é’ˆï¼› æš´åŠ› â†’ DPï¼› æš´åŠ›åŒ¹é… â†’ å“ˆå¸Œï¼› éå† â†’ å•è°ƒæ ˆ æš´åŠ›è§£æ˜¯ fallbackï¼Œæ˜¯ä½ æ€è€ƒæ¸…æ™°çš„è¯æ˜ã€‚ ä½ å¯ä»¥å…ˆè¯´ï¼š\nâ€œæˆ‘å…ˆè€ƒè™‘æš´åŠ›è§£ O(nÂ²)ï¼Œç„¶åä¼˜åŒ–ä¸ºåŒæŒ‡é’ˆ O(n)ã€‚â€\nğŸ§® Step 3ï¼šçŠ¶æ€ / åŒºé—´åˆ’åˆ†ï¼ˆDP æˆ–æ»‘çª—æ ¸å¿ƒï¼‰ å¦‚æœæ˜¯ DPï¼š\næ˜ç¡®çŠ¶æ€ï¼šdp[i] / dp[i][j] å†™è½¬ç§»æ–¹ç¨‹ï¼šdp[i] = max/min/sum(...) åˆå§‹åŒ–è¾¹ç•Œæ¡ä»¶ é¡ºåºéå†ï¼ˆç”±å°åˆ°å¤§ï¼‰ å¦‚æœæ˜¯æ»‘åŠ¨çª—å£ï¼š\nå·¦å³æŒ‡é’ˆ + ä¸æ–­è°ƒæ•´çª—å£ æ»¡è¶³æ¡ä»¶æ—¶ç§»åŠ¨å·¦æŒ‡é’ˆæ”¶ç¼© é€šå¸¸ç»´æŠ¤æœ€å¤§ / æœ€å° / æœ€é•¿åŒºé—´ âš™ï¸ Step 4ï¼šéªŒè¯æ ·ä¾‹ \u0026amp; æç«¯æƒ…å†µ âœ… åŸºç¡€æ ·ä¾‹ï¼ˆé¢˜ç›®ç»™çš„ï¼‰ âš ï¸ è¾¹ç•Œæµ‹è¯•ï¼š\nç©ºæ•°ç»„ / ç©ºå­—ç¬¦ä¸² å…¨éƒ¨è´Ÿæ•° / é‡å¤å€¼ åªæœ‰ä¸€ä¸ªå…ƒç´  è¶…å¤§è§„æ¨¡ n = 10âµ çº§åˆ« ğŸ’¬ Step 5ï¼šé¢è¯•æ—¶æ²Ÿé€šç­–ç•¥ â€œæˆ‘å…ˆè®²ä¸‹æˆ‘çš„æ€è€ƒè·¯å¾„ï¼š æˆ‘å‘ç°è¿™æ˜¯ä¸ªæ±‚æœ€å€¼çš„é—®é¢˜ï¼Œæœ‰é‡å å­é—®é¢˜ï¼Œå› æ­¤è€ƒè™‘ DPã€‚ æˆ‘å…ˆå†™ä¸ªæš´åŠ›ç‰ˆæœ¬éªŒè¯æ€è·¯ï¼Œç„¶åå†ä¼˜åŒ–åˆ° O(n)\u0026hellip;â€\nè¿™å¥è¯éå¸¸åŠ åˆ†ã€‚ å³ä½¿å†™ä¸å®Œä»£ç ï¼Œä¹Ÿèƒ½è®©é¢è¯•å®˜è§‰å¾—ä½ å…·å¤‡ç»“æ„åŒ–æ€ç»´ã€‚\nä¸‰ã€ç»¼åˆæ¨¡æ¿ï¼šé™Œç”Ÿé¢˜åº”å¯¹ 5 æ­¥æ³• æ­¥éª¤ é—®é¢˜ ç›®æ ‡ ğŸ§© Step 1 è¯†åˆ«é¢˜å‹ åˆ¤æ–­æ˜¯ DPã€æ»‘çª—ã€DFSã€è´ªå¿ƒï¼Ÿ ğŸ’¡ Step 2 æš´åŠ›å»ºæ¨¡ æ˜ç¡®çŠ¶æ€ã€å˜é‡ã€è¾¹ç•Œ âš™ï¸ Step 3 ä¼˜åŒ–æ€è·¯ æ‰¾é‡å¤å­é—®é¢˜ / å•è°ƒæ€§ / å¯å‰ªæ ğŸ§® Step 4 å†™ä¼ªä»£ç  ä¿è¯é€»è¾‘é—­ç¯ï¼Œå¤æ‚åº¦æ¸…æ™° ğŸ§  Step 5 ä¸¾ä¾‹éªŒè¯ æ ¸æŸ¥è¾¹ç•Œä¸æ­£ç¡®æ€§ ğŸ”¥ ç¤ºä¾‹å¯¹æ¯”ï¼šä¸‰æ•°ä¹‹å’Œ vs æœ€å¤§å­åºå’Œ é¢˜ç›® æ€è·¯å½’ç±» æ ¸å¿ƒç®—æ³• å…³é”®è¯ ä¸‰æ•°ä¹‹å’Œ æ•°ç»„ + æ’åº + åŒæŒ‡é’ˆ æ’åº + å»é‡ + å·¦å³å¤¹é€¼ æ’åº â†’ åŒæŒ‡é’ˆ æœ€å¤§å­åºå’Œ åºåˆ— + æ±‚æœ€å€¼ åŠ¨æ€è§„åˆ’ å±€éƒ¨æœ€ä¼˜è½¬å…¨å±€æœ€ä¼˜ æ”¹è¿›ç‰ˆæœ¬ ã€Œçœ‹åˆ°é¢˜ â†’ çŸ¥é“å±äºå“ªç±»é—®é¢˜ â†’ çŸ¥é“æœ‰å“ªäº›å…¸å‹è§£æ³• â†’ çŸ¥é“ä»å“ªå¼€å§‹åˆ†æã€ã€‚\nğŸ§­ ä¸€ã€è§£é¢˜é€šç”¨åˆ†ææµç¨‹ æ­¥éª¤ æ€è€ƒæ–¹å‘ è¯´æ˜ â‘  çœ‹è¾“å…¥ç»“æ„ æ•°ç»„ / å­—ç¬¦ä¸² / é“¾è¡¨ / æ ‘ / å›¾ / çŸ©é˜µ / ç‰¹æ®Šçº¦æŸ â‘¡ çœ‹é—®é¢˜ç±»å‹ æ±‚æœ€å€¼ / è®¡æ•° / åˆ¤æ–­å­˜åœ¨ / æ’åº / åŒ¹é… / è·¯å¾„ / ç»„åˆç­‰ â‘¢ æ˜¯å¦æœ‰â€œé‡å å­é—®é¢˜â€ æœ‰åˆ™åŠ¨æ€è§„åˆ’ï¼Œæ²¡æœ‰å¯å°è¯•è´ªå¿ƒæˆ–åŒæŒ‡é’ˆä¼˜åŒ– â‘£ æ˜¯å¦æœ‰â€œå•è°ƒæ€§â€æˆ–â€œåŒºé—´æ€§è´¨â€ æœ‰åˆ™è€ƒè™‘åŒæŒ‡é’ˆ / å•è°ƒæ ˆ / äºŒåˆ† â‘¤ è¾“å‡ºç›®æ ‡ è¿”å›æ•°å€¼ / åºåˆ— / ç´¢å¼• / è·¯å¾„ / å¸ƒå°”å€¼ï¼Œä¸åŒç±»å‹æœ‰ä¸åŒå¥—è·¯ â‘¥ æ˜¯å¦å¯ä»¥é¢„å¤„ç† æ’åºã€å‰ç¼€å’Œã€å“ˆå¸Œè¡¨ã€çŠ¶æ€å‹ç¼©ã€å›¾çš„é¢„å»ºç­‰ â‘¦ å¤æ‚åº¦åˆ†æ O(nÂ²) èƒ½ä¸èƒ½ä¼˜åŒ–åˆ° O(n log n) æˆ– O(n) ğŸ§© äºŒã€æŒ‰è¾“å…¥ç»“æ„åˆ†ç±»çš„å¸¸è§ç®—æ³•æ€è·¯ è¾“å…¥ç±»å‹ å¸¸ç”¨ç®—æ³• å…¸å‹é¢˜ç›® æ•°ç»„ æ’åº / åŒæŒ‡é’ˆ / æ»‘åŠ¨çª—å£ / å‰ç¼€å’Œ / å•è°ƒæ ˆ ä¸‰æ•°ä¹‹å’Œã€æ¥é›¨æ°´ã€æ¯æ—¥æ¸©åº¦ã€æœ€å¤§å­åºå’Œ å­—ç¬¦ä¸² åŒæŒ‡é’ˆ / åŠ¨æ€è§„åˆ’ / å“ˆå¸Œè®¡æ•° / KMP / å›æ–‡ä¸­å¿ƒæ‰©å±• æœ€é•¿å­ä¸²ã€ç¼–è¾‘è·ç¦»ã€å•è¯æ‹†åˆ† é“¾è¡¨ å¿«æ…¢æŒ‡é’ˆ / åè½¬ / åˆå¹¶ / ç¯æ£€æµ‹ / é€’å½’ åè½¬é“¾è¡¨ã€ä¸¤ä¸¤äº¤æ¢ã€ç¯å½¢é“¾è¡¨ äºŒå‰æ ‘ DFS / BFS / é€’å½’ / åŠ¨æ€è§„åˆ’ / æ ˆæ¨¡æ‹Ÿ äºŒå‰æ ‘éå†ã€æœ€å¤§è·¯å¾„å’Œã€å¯¹ç§°æ ‘ å›¾ BFS / DFS / æ‹“æ‰‘æ’åº / Dijkstra / å¹¶æŸ¥é›† å²›å±¿æ•°é‡ã€è¯¾ç¨‹è¡¨ã€æœ€çŸ­è·¯å¾„ çŸ©é˜µ DFS / BFS / åŠ¨æ€è§„åˆ’ / äºŒåˆ†æœç´¢ å²›å±¿æ•°é‡ã€æœ€å°è·¯å¾„å’Œã€æœç´¢äºŒç»´çŸ©é˜µ å †/ä¼˜å…ˆé˜Ÿåˆ— è·å–ç¬¬kå¤§ / åˆå¹¶åŒºé—´ / å»¶è¿Ÿåˆ é™¤ æ•°æ®æµä¸­ä½æ•°ã€å‰Kä¸ªå…ƒç´  å“ˆå¸Œè¡¨ / é›†åˆ è®¡æ•° / å¿«é€ŸæŸ¥æ‰¾å­˜åœ¨æ€§ / å‰ç¼€åŒ¹é… ä¸¤æ•°ä¹‹å’Œã€æœ€é•¿ä¸é‡å¤å­ä¸² ğŸ¯ ä¸‰ã€æŒ‰é—®é¢˜ç±»å‹åˆ†ç±»çš„å¸¸è§å¥—è·¯ é—®é¢˜ç±»å‹ å¸¸è§æ€è·¯ ç»å…¸ä¾‹é¢˜ æ±‚æœ€å€¼ï¼ˆæœ€å¤§/æœ€å°ï¼‰ åŠ¨æ€è§„åˆ’ / è´ªå¿ƒ / å•è°ƒæ ˆ / åˆ†æ²» æœ€å¤§å­åºå’Œã€æ‰“å®¶åŠ«èˆã€è‚¡ç¥¨ä¹°å– æ±‚æ˜¯å¦å­˜åœ¨ å“ˆå¸Œè¡¨ / åŒæŒ‡é’ˆ / äºŒåˆ†æœç´¢ ä¸¤æ•°ä¹‹å’Œã€å¹³æ–¹æ•°åˆ¤å®š æ±‚é…å¯¹/ç»„åˆ æ’åº+åŒæŒ‡é’ˆ / å›æº¯ / ä½è¿ç®— ä¸‰æ•°ä¹‹å’Œã€å­é›†ã€å…¨æ’åˆ— æ±‚è·¯å¾„/è¿é€šæ€§ DFS / BFS / å¹¶æŸ¥é›† å²›å±¿æ•°é‡ã€æœ€çŸ­è·¯å¾„ æ±‚æ’å/ç¬¬Kå¤§ å¿«æ’ / å † / äºŒåˆ† ç¬¬Kå¤§å…ƒç´ ã€æ»‘åŠ¨çª—å£æœ€å¤§å€¼ åŒºé—´é—®é¢˜ æ’åº + åˆå¹¶ / å‰ç¼€å’Œ / å·®åˆ†æ•°ç»„ åŒºé—´åˆå¹¶ã€å­æ•°ç»„å’Œç­‰äºK çŠ¶æ€è½¬ç§»ï¼ˆæœ‰ä¾èµ–ï¼‰ åŠ¨æ€è§„åˆ’ æ‰“å®¶åŠ«èˆã€æœ€é•¿é€’å¢å­åºåˆ— æ‹¬å·/ç»“æ„åŒ¹é… æ ˆ / è®¡æ•° æœ‰æ•ˆæ‹¬å·ã€é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼ å›æ–‡/å­ä¸²é—®é¢˜ åŒæŒ‡é’ˆ / åŠ¨æ€è§„åˆ’ / ä¸­å¿ƒæ‰©å±• æœ€é•¿å›æ–‡å­ä¸²ã€å›æ–‡åˆ†å‰² ğŸ§  å››ã€é™Œç”Ÿé¢˜ç›®åˆ†ææ¨¡æ¿ï¼ˆä¸‡èƒ½äº”é—®æ³•ï¼‰ é¢è¯•æ—¶ä¸æ…Œï¼ŒæŒ‰ç…§è¿™ä¸ªæ¨¡æ¿åˆ†æå³å¯ã€‚\nè¾“å…¥ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ\næ•°ç»„ / å­—ç¬¦ä¸² / é“¾è¡¨ / æ ‘ / å›¾ï¼Ÿ é—®é¢˜ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ\næ±‚æœ€å€¼ï¼Ÿåˆ¤æ–­å­˜åœ¨ï¼Ÿè®¡æ•°ï¼Ÿè·¯å¾„ï¼Ÿ èƒ½å¦æ’åºæˆ–é¢„å¤„ç†ï¼Ÿ\næ’åºååŒæŒ‡é’ˆ / å“ˆå¸Œè®¡æ•° / å‰ç¼€å’Œç­‰ã€‚ æ˜¯å¦æœ‰é‡å å­é—®é¢˜æˆ–é€’æ¨å…³ç³»ï¼Ÿ\nåŠ¨æ€è§„åˆ’å¯è¡Œï¼ŸçŠ¶æ€æ€ä¹ˆå®šä¹‰ï¼Ÿ æ˜¯å¦èƒ½ç”¨å•è°ƒæ€§ã€æ»‘åŠ¨çª—å£æˆ–è´ªå¿ƒï¼Ÿ\nä¾‹å¦‚â€œæ¯æ—¥æ¸©åº¦â€â€œæ¥é›¨æ°´â€â€œè‚¡ç¥¨ä¹°å–â€éƒ½å¯ä»¥ç”¨å•è°ƒæ ˆã€‚ ğŸ§© äº”ã€é¢˜å‹ â†’ å…¸å‹è§£æ³•é€ŸæŸ¥è¡¨ é¢˜å‹ æ ¸å¿ƒè§£æ³• æ¨¡æ¿å‡½æ•° åŒæŒ‡é’ˆ æœ‰åºæ•°ç»„æ‰¾é…å¯¹ã€æ»‘åŠ¨çª—å£ã€å¿«æ…¢æŒ‡é’ˆ for i, j := 0, 0; j \u0026lt; n; j++ {} åŠ¨æ€è§„åˆ’ å­é—®é¢˜é€’æ¨ã€æ‰“å®¶åŠ«èˆã€èƒŒåŒ…ã€ç¼–è¾‘è·ç¦» dp[i] = max(dp[i-1], dp[i-2]+nums[i]) å•è°ƒæ ˆ ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ã€æ¯æ—¥æ¸©åº¦ã€æ¥é›¨æ°´ æ ˆä¸­ä¿æŒå•è°ƒé€’å‡æˆ–é€’å¢åºåˆ— BFS æœ€çŸ­è·¯å¾„ã€æœ€å°‘æ­¥æ•°ã€å±‚åºéå† queue := [][]int{{start}} DFS å…¨æ’åˆ—ã€è¿é€šå—ã€é€’å½’éå† func dfs(i int) { ... dfs(next) ... } å“ˆå¸Œè¡¨ å¿«é€Ÿåˆ¤æ–­å­˜åœ¨æ€§ã€å»é‡ m := make(map[int]bool) äºŒåˆ† æœ‰åºåŒºé—´æŸ¥æ‰¾ / æœ€å°æ»¡è¶³æ¡ä»¶ for l \u0026lt; r { mid := (l+r)/2 } ğŸ’¡ å…­ã€ä¸¾ä¾‹ï¼šæ‹¿åˆ°ä¸€é“é¢˜ä½ å¯ä»¥è¿™æ ·æƒ³ æ¯”å¦‚é¢˜ç›®ï¼š\nâ€œä¸‰æ•°ä¹‹å’Œï¼Œæ‰¾å‡ºæ‰€æœ‰å’Œä¸º 0 çš„ä¸‰å…ƒç»„ã€‚â€\n1ï¸âƒ£ è¾“å…¥æ˜¯ æ•°ç»„ â†’ ä¼˜å…ˆè€ƒè™‘æ’åº + åŒæŒ‡é’ˆã€‚ 2ï¸âƒ£ é—®é¢˜æ˜¯ æ±‚é…å¯¹/ç»„åˆ â†’ åŒæŒ‡é’ˆæ˜¯å¸¸è§å¥—è·¯ã€‚ 3ï¸âƒ£ æ’åºåå»é‡ï¼Œå·¦æŒ‡é’ˆ l å³æŒ‡é’ˆ rï¼Œæ ¹æ® sum è°ƒæ•´ã€‚ 4ï¸âƒ£ å±äº â€œæ’åº + åŒæŒ‡é’ˆâ€ æ¨¡æ¿é¢˜ã€‚\n",
"tags":null,
"categories":null
},{
"title":"é¢è¯•é¢˜æ¨¡æ¿",
"permalink": "http://localhost:1313/posts/sql/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%A8%A1%E6%9D%BF/",
"summary": "SQL é¢è¯•é¢˜æ¨¡æ¿ï¼ˆç»¼åˆï¼‰ æ¨¡æ‹Ÿæ•°æ®è¡¨ åœ¨å¤§å¤šæ•°é¢è¯•ä¸­ï¼Œé¢è¯•å®˜ä¼šå‡è®¾æœ‰å‡ ä¸ªç»å…¸çš„æ•°æ®è¡¨ã€‚æˆ‘ä»¬ä»¥æ­¤ä¸ºåŸºç¡€ï¼š\nEmployees (å‘˜å·¥è¡¨)\nemp_id (INT, Primary Key) - å‘˜å·¥ ID emp_name (VARCHAR) - å‘˜å·¥å§“å salary (DECIMAL) - è–ªæ°´ dept_id (INT, Foreign Key) - éƒ¨é—¨ ID Departments (éƒ¨é—¨è¡¨)\ndept_id (INT, Primary Key) - éƒ¨é—¨ ID dept_name (VARCHAR) - éƒ¨é—¨åç§° æ¨¡å—ä¸€ï¼šåŸºç¡€æŸ¥è¯¢ (SELECT, WHERE, ORDER BY) è€ƒå¯Ÿç‚¹ï¼šæ•°æ®ç­›é€‰ã€æ’åºã€é™åˆ¶çš„åŸºæœ¬åŠŸã€‚\n[ç­›é€‰] æŸ¥æ‰¾ Employees è¡¨ä¸­è–ªæ°´ (salary) é«˜äº 80000 çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ã€‚ [å¤šæ¡ä»¶] æŸ¥æ‰¾ \u0026lsquo;Sales\u0026rsquo; (é”€å”®) éƒ¨é—¨ä¸­ï¼Œè–ªæ°´ä½äº 60000 çš„å‘˜å·¥ã€‚ [æ¨¡ç³ŠæŸ¥è¯¢] æŸ¥æ‰¾æ‰€æœ‰å§“ \u0026lsquo;ç‹\u0026rsquo; çš„å‘˜å·¥ (ä½¿ç”¨ LIKE 'ç‹%')ã€‚ [ç©ºå€¼å¤„ç†] æŸ¥æ‰¾æ‰€æœ‰å°šæœªåˆ†é…éƒ¨é—¨ï¼ˆdept_id ä¸º NULLï¼‰çš„å‘˜å·¥ã€‚ [æ’åºä¸é™åˆ¶] æŸ¥æ‰¾å…¬å¸è–ªæ°´æœ€é«˜çš„ 5 åå‘˜å·¥çš„ä¿¡æ¯ (ä½¿ç”¨ ORDER BY ... DESC å’Œ LIMIT ...)ã€‚ æ¨¡å—äºŒï¼šèšåˆä¸åˆ†ç»„ (GROUP BY, HAVING) è€ƒå¯Ÿç‚¹ï¼šæ•°æ®æ±‡æ€»ã€åˆ†ç»„ç»Ÿè®¡çš„èƒ½åŠ›ã€‚\n",
"content": "SQL é¢è¯•é¢˜æ¨¡æ¿ï¼ˆç»¼åˆï¼‰ æ¨¡æ‹Ÿæ•°æ®è¡¨ åœ¨å¤§å¤šæ•°é¢è¯•ä¸­ï¼Œé¢è¯•å®˜ä¼šå‡è®¾æœ‰å‡ ä¸ªç»å…¸çš„æ•°æ®è¡¨ã€‚æˆ‘ä»¬ä»¥æ­¤ä¸ºåŸºç¡€ï¼š\nEmployees (å‘˜å·¥è¡¨)\nemp_id (INT, Primary Key) - å‘˜å·¥ ID emp_name (VARCHAR) - å‘˜å·¥å§“å salary (DECIMAL) - è–ªæ°´ dept_id (INT, Foreign Key) - éƒ¨é—¨ ID Departments (éƒ¨é—¨è¡¨)\ndept_id (INT, Primary Key) - éƒ¨é—¨ ID dept_name (VARCHAR) - éƒ¨é—¨åç§° æ¨¡å—ä¸€ï¼šåŸºç¡€æŸ¥è¯¢ (SELECT, WHERE, ORDER BY) è€ƒå¯Ÿç‚¹ï¼šæ•°æ®ç­›é€‰ã€æ’åºã€é™åˆ¶çš„åŸºæœ¬åŠŸã€‚\n[ç­›é€‰] æŸ¥æ‰¾ Employees è¡¨ä¸­è–ªæ°´ (salary) é«˜äº 80000 çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ã€‚ [å¤šæ¡ä»¶] æŸ¥æ‰¾ \u0026lsquo;Sales\u0026rsquo; (é”€å”®) éƒ¨é—¨ä¸­ï¼Œè–ªæ°´ä½äº 60000 çš„å‘˜å·¥ã€‚ [æ¨¡ç³ŠæŸ¥è¯¢] æŸ¥æ‰¾æ‰€æœ‰å§“ \u0026lsquo;ç‹\u0026rsquo; çš„å‘˜å·¥ (ä½¿ç”¨ LIKE 'ç‹%')ã€‚ [ç©ºå€¼å¤„ç†] æŸ¥æ‰¾æ‰€æœ‰å°šæœªåˆ†é…éƒ¨é—¨ï¼ˆdept_id ä¸º NULLï¼‰çš„å‘˜å·¥ã€‚ [æ’åºä¸é™åˆ¶] æŸ¥æ‰¾å…¬å¸è–ªæ°´æœ€é«˜çš„ 5 åå‘˜å·¥çš„ä¿¡æ¯ (ä½¿ç”¨ ORDER BY ... DESC å’Œ LIMIT ...)ã€‚ æ¨¡å—äºŒï¼šèšåˆä¸åˆ†ç»„ (GROUP BY, HAVING) è€ƒå¯Ÿç‚¹ï¼šæ•°æ®æ±‡æ€»ã€åˆ†ç»„ç»Ÿè®¡çš„èƒ½åŠ›ã€‚\n[åŸºç¡€èšåˆ] è®¡ç®— Employees è¡¨ä¸­çš„æ€»å‘˜å·¥æ•°ã€å¹³å‡è–ªæ°´å’Œæœ€é«˜è–ªæ°´ã€‚ [åˆ†ç»„] ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨ï¼ˆdept_idï¼‰æœ‰å¤šå°‘åå‘˜å·¥ï¼Ÿ [HAVING ç­›é€‰] æ‰¾å‡ºå¹³å‡è–ªæ°´è¶…è¿‡ 70000 çš„éƒ¨é—¨ã€‚ [å¿…è€ƒæ¦‚å¿µ] WHERE å’Œ HAVING çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ WHERE åœ¨ GROUP BY ä¹‹å‰æ‰§è¡Œï¼Œç”¨äºç­›é€‰åŸå§‹è¡Œã€‚ HAVING åœ¨ GROUP BY ä¹‹åæ‰§è¡Œï¼Œç”¨äºç­›é€‰èšåˆåçš„åˆ†ç»„ã€‚ [å»é‡] COUNT(col) å’Œ COUNT(DISTINCT col) æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ æ¨¡å—ä¸‰ï¼šè¿æ¥æŸ¥è¯¢ (JOIN) è€ƒå¯Ÿç‚¹ï¼šå¤„ç†å¤šè¡¨å…³ç³»çš„èƒ½åŠ›ï¼Œè¿™æ˜¯ SQL çš„æ ¸å¿ƒã€‚\n[INNER JOIN] æŸ¥æ‰¾æ‰€æœ‰å‘˜å·¥åŠå…¶å¯¹åº”çš„éƒ¨é—¨åç§°ã€‚ [LEFT JOIN] æŸ¥æ‰¾æ‰€æœ‰éƒ¨é—¨ï¼Œä»¥åŠè¿™äº›éƒ¨é—¨ä¸‹çš„å‘˜å·¥ã€‚è¦æ±‚ï¼šå³ä½¿æŸä¸ªéƒ¨é—¨æ²¡æœ‰å‘˜å·¥ï¼Œä¹Ÿè¦æ˜¾ç¤ºè¯¥éƒ¨é—¨åç§°ã€‚ [å¿…è€ƒæ¦‚å¿µ] INNER JOIN å’Œ LEFT JOIN çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ INNER JOIN (å†…è¿æ¥) åªè¿”å›ä¸¤ä¸ªè¡¨ä¸­éƒ½èƒ½åŒ¹é…ä¸Šçš„è¡Œã€‚ LEFT JOIN (å·¦è¿æ¥) è¿”å›å·¦è¡¨çš„æ‰€æœ‰è¡Œï¼Œä»¥åŠå³è¡¨ä¸­èƒ½åŒ¹é…ä¸Šçš„è¡Œï¼ˆåŒ¹é…ä¸ä¸Šçš„ç”¨ NULL å¡«å……ï¼‰ã€‚ [RIGHT/FULL JOIN] RIGHT JOIN å’Œ FULL OUTER JOIN åˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä½¿ç”¨ï¼Ÿï¼ˆRIGHT JOIN å‡ ä¹ç­‰åŒäºåå‘çš„ LEFT JOINï¼ŒFULL JOIN è¿”å›ä¸¤ä¸ªè¡¨çš„æ‰€æœ‰è¡Œï¼Œæ— è®ºæ˜¯å¦åŒ¹é…ï¼‰ã€‚ [è‡ªè¿æ¥ Self-Join] (å‡è®¾ Employees è¡¨ä¸­è¿˜æœ‰ä¸€åˆ— manager_id æŒ‡å‘ emp_id) å¦‚ä½•æŸ¥æ‰¾æ¯ä¸ªå‘˜å·¥åŠå…¶ç›´å±ç»ç†çš„å§“åï¼Ÿ æ¨¡å—å››ï¼šå­æŸ¥è¯¢ (Subquery) è€ƒå¯Ÿç‚¹ï¼šå¤æ‚æŸ¥è¯¢çš„æ„å»ºèƒ½åŠ›ï¼Œå°†ä¸€ä¸ªæŸ¥è¯¢çš„ç»“æœä½œä¸ºå¦ä¸€ä¸ªæŸ¥è¯¢çš„è¾“å…¥ã€‚\n[WHERE å­æŸ¥è¯¢] æŸ¥æ‰¾è–ªæ°´é«˜äºå…¬å¸å¹³å‡è–ªæ°´çš„å‘˜å·¥ã€‚ [IN / NOT IN] æŸ¥æ‰¾æ‰€æœ‰åœ¨ \u0026lsquo;Engineering\u0026rsquo; (å·¥ç¨‹) éƒ¨é—¨å·¥ä½œçš„å‘˜å·¥ä¿¡æ¯ï¼ˆå‡è®¾ä½ åªçŸ¥é“éƒ¨é—¨åå« \u0026lsquo;Engineering\u0026rsquo;ï¼Œä¸çŸ¥é“ dept_idï¼‰ã€‚ [NOT EXISTS] æŸ¥æ‰¾æ‰€æœ‰æ²¡æœ‰å‘˜å·¥çš„éƒ¨é—¨ã€‚ [ç›¸å…³å­æŸ¥è¯¢] æŸ¥æ‰¾æ¯ä¸ªéƒ¨é—¨ä¸­è–ªæ°´æœ€é«˜çš„å‘˜å·¥ã€‚ (è§£æ³• 1: ç›¸å…³å­æŸ¥è¯¢) SELECT * FROM Employees e1 WHERE e1.salary = (SELECT MAX(salary) FROM Employees e2 WHERE e2.dept_id = e1.dept_id) (è§£æ³• 2: çª—å£å‡½æ•°ï¼Œè§æ¨¡å—äº”) æ¨¡å—äº”ï¼šçª—å£å‡½æ•° (Window Functions) è€ƒå¯Ÿç‚¹ï¼šç°ä»£ SQL çš„é«˜çº§åˆ†æèƒ½åŠ›ï¼Œå¸¸ç”¨äºæ’åå’ŒTop-Né—®é¢˜ã€‚ï¼ˆè¿™æ˜¯æ‹‰å¼€å·®è·çš„å…³é”®ï¼‰\n[æ’å] æŸ¥æ‰¾æ¯ä¸ªéƒ¨é—¨ä¸­è–ªæ°´æœ€é«˜çš„ 3 åå‘˜å·¥ã€‚ [å¿…è€ƒæ¦‚å¿µ] ROW_NUMBER(), RANK(), DENSE_RANK() çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ ROW_NUMBER(): 1, 2, 3, 4 (ä¸å¹¶åˆ—) RANK(): 1, 2, 2, 4 (å¹¶åˆ—è·³å·) DENSE_RANK(): 1, 2, 2, 3 (å¹¶åˆ—ä¸è·³å·) SELECT * FROM ( SELECT emp_id, name, dept_id, salary, ROW_NUMBER() OVER (PARTITION BY dept_id ORDER BY salary DESC) AS rn FROM employees ) t WHERE rn \u0026lt;= 3; # RANK()ï¼ˆå¹¶åˆ—è·³å·ï¼‰ SELECT * FROM ( SELECT emp_id, name, dept_id, salary, RANK() OVER (PARTITION BY dept_id ORDER BY salary DESC) AS rk FROM employees ) t WHERE rk \u0026lt;= 3; # DENSE_RANK()ï¼ˆå¹¶åˆ—ä¸è·³å·ï¼‰ SELECT * FROM ( SELECT emp_id, name, dept_id, salary, DENSE_RANK() OVER (PARTITION BY dept_id ORDER BY salary DESC) AS drk FROM employees ) t WHERE drk \u0026lt;= 3; [PARTITION BY] å¦‚ä½•åœ¨ä¸ä½¿ç”¨ GROUP BY çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—æ¯ä¸ªå‘˜å·¥çš„è–ªæ°´å å…¶æ‰€åœ¨éƒ¨é—¨æ€»è–ªæ°´çš„ç™¾åˆ†æ¯”ï¼Ÿ SELECT emp_id, name, dept_id, salary, ROUND(salary / SUM(salary) OVER (PARTITION BY dept_id) * 100, 2) AS salary_pct FROM employees; [LEAD / LAG] (å‡è®¾æœ‰ Orders è®¢å•è¡¨) å¦‚ä½•è®¡ç®—æ¯ç¬”è®¢å•ä¸è¯¥å®¢æˆ·ä¸Šä¸€ç¬”è®¢å•ä¹‹é—´çš„æ—¶é—´å·®ï¼Ÿ SELECT user_id, order_id, order_time, LAG(order_time) OVER (PARTITION BY user_id ORDER BY order_time) AS prev_order_time, TIMESTAMPDIFF(HOUR, LAG(order_time) OVER (PARTITION BY user_id ORDER BY order_time), order_time) AS diff_hours FROM orders; ğŸ§  å°ç»“ï¼šç°ä»£ SQL ä¸‰å¤§ã€Œé«˜çº§åˆ†æã€åŠŸèƒ½ åŠŸèƒ½ å…³é”®å‡½æ•° å¸¸è§è€ƒç‚¹ ç¤ºä¾‹ æ’å ROW_NUMBER, RANK, DENSE_RANK Top-Nã€å»é‡æ’å â€œæ¯éƒ¨é—¨å‰3é«˜è–ªâ€ åˆ†ç»„åˆ†æ PARTITION BY + èšåˆ ç™¾åˆ†æ¯”ã€å æ¯” â€œè–ªæ°´å éƒ¨é—¨æ€»è–ªæ¯”â€ åºåˆ—åˆ†æ LAG, LEAD æ—¶é—´å·®ã€æ¶¨è·Œè¶‹åŠ¿ â€œæ¯æ¬¡è®¢å•é—´éš”â€ æ¨¡å—å…­ï¼šæ•°æ®æ“ä½œä¸å®šä¹‰ (DML/DDL) è€ƒå¯Ÿç‚¹ï¼šæ˜¯å¦å…·å¤‡ä¿®æ”¹æ•°æ®å’Œè¡¨ç»“æ„çš„èƒ½åŠ›ã€‚\n[INSERT] å¦‚ä½•å‘ Employees è¡¨ä¸­æ·»åŠ ä¸€åæ–°å‘˜å·¥ï¼Ÿ [UPDATE] å¦‚ä½•ç»™ \u0026lsquo;Sales\u0026rsquo; éƒ¨é—¨çš„æ‰€æœ‰å‘˜å·¥åŠ è–ª 10%ï¼Ÿ [DELETE] å¦‚ä½•åˆ é™¤ dept_id ä¸º 5 çš„æ‰€æœ‰å‘˜å·¥ï¼Ÿ [å¿…è€ƒæ¦‚å¿µ] DELETE, TRUNCATE, DROP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ DELETE: DML, é€è¡Œåˆ é™¤, å¯å›æ»š, è§¦å‘è§¦å‘å™¨ã€‚ TRUNCATE: DDL, åˆ é™¤æ‰€æœ‰è¡Œï¼ˆé€šå¸¸æ˜¯é‡Šæ”¾æ•°æ®é¡µï¼‰, ä¸å¯å›æ»šï¼ˆæˆ–å›æ»šå¤æ‚ï¼‰, é€Ÿåº¦å¿«ã€‚ DROP: DDL, ç›´æ¥åˆ é™¤æ•´ä¸ªè¡¨ç»“æ„å’Œæ•°æ®ã€‚ [ALTER] å¦‚ä½•å‘ Employees è¡¨æ·»åŠ ä¸€ä¸ª hire_date (DATE ç±»å‹) çš„æ–°åˆ—ï¼Ÿ æ¨¡å—ä¸ƒï¼šäº‹åŠ¡ä¸æ€§èƒ½ (Transaction \u0026amp; Optimization) è€ƒå¯Ÿç‚¹ï¼šå¯¹æ•°æ®åº“åŸç†å’Œæ€§èƒ½è°ƒä¼˜çš„ç†è§£ã€‚\n[äº‹åŠ¡] ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Ÿ [ACID] ä»€ä¹ˆæ˜¯ ACIDï¼Ÿï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰ [ç´¢å¼•] ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç´¢å¼•ï¼Ÿ [è¿½é—®] ç´¢å¼•çš„ä¼˜ç‚¹å’Œç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä¼˜ç‚¹ï¼šæŸ¥è¯¢å¿«ï¼›ç¼ºç‚¹ï¼šå†™æ“ä½œå˜æ…¢ã€å ç”¨ç©ºé—´ï¼‰ [è¿½é—®] åœ¨ Employees è¡¨çš„ salary åˆ—ä¸Šåˆ›å»ºç´¢å¼•æ˜¯å¦åˆé€‚ï¼Ÿï¼ˆé€šå¸¸ä¸åˆé€‚ï¼Œå› ä¸º \u0026ldquo;åŸºæ•°\u0026rdquo; (Cardinality) å¯èƒ½ä¸é«˜ï¼Œä¸”èŒƒå›´æŸ¥è¯¢å¤šã€‚åœ¨ emp_name æˆ– dept_id ä¸Šå¯èƒ½æ›´åˆé€‚ï¼‰ã€‚ [è¿½é—®] ä»€ä¹ˆæ˜¯ \u0026ldquo;è¦†ç›–ç´¢å¼•\u0026rdquo; (Covering Index)ï¼Ÿ [EXPLAIN] ä½ å¦‚ä½•åˆ†æä¸€ä¸ªæ…¢æŸ¥è¯¢ï¼Ÿï¼ˆä½¿ç”¨ EXPLAIN æˆ– EXPLAIN ANALYZE æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼Œæ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†ç´¢å¼•ã€æ˜¯å¦è¿›è¡Œäº†å…¨è¡¨æ‰«æç­‰ï¼‰ã€‚ ",
"tags":null,
"categories":null
},{
"title":"å¸¸è§ç®—æ³•æ¨¡æ¿",
"permalink": "http://localhost:1313/posts/datastructalgorithm/%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95%E6%A8%A1%E6%9D%BF/",
"summary": " å¸¸è§ç®—æ³•æ¨¡æ¿ ç¬¬ä¸€éƒ¨åˆ†ï¼šæ ¸å¿ƒç®—æ³•æ€æƒ³ 1. äºŒåˆ†æŸ¥æ‰¾ (Binary Search) é€‚ç”¨äºæœ‰åºåºåˆ—çš„æŸ¥æ‰¾ã€‚\n// åŸºç¡€ç‰ˆæœ¬ï¼šæŸ¥æ‰¾ç‰¹å®šå€¼ func binarySearch(nums []int, target int) int { left, right := 0, len(nums)-1 for left \u0026lt;= right { mid := left + (right-left)/2 // é˜²æº¢å‡º if nums[mid] == target { return mid } else if nums[mid] \u0026lt; target { left = mid + 1 } else { right = mid - 1 } } return -1 // æœªæ‰¾åˆ° } // å˜ä½“ï¼šæŸ¥æ‰¾å·¦ä¾§è¾¹ç•Œï¼ˆç¬¬ä¸€ä¸ª \u0026gt;= target çš„ä½ç½®ï¼‰ func lowerBound(nums []int, target int) int { left, right := 0, len(nums) // æ³¨æ„ right çš„å–å€¼ for left \u0026lt; right { mid := left + (right-left)/2 if nums[mid] \u0026gt;= target { right = mid } else { left = mid + 1 } } return left } 2. åŒæŒ‡é’ˆ (Two Pointers) å¿«æ…¢æŒ‡é’ˆ å¸¸ç”¨äºé“¾è¡¨ï¼ˆåˆ¤æ–­ç¯ã€æ‰¾ä¸­ç‚¹ï¼‰æˆ–æ•°ç»„ï¼ˆåŸåœ°ä¿®æ”¹ï¼‰ã€‚\n",
"content": " å¸¸è§ç®—æ³•æ¨¡æ¿ ç¬¬ä¸€éƒ¨åˆ†ï¼šæ ¸å¿ƒç®—æ³•æ€æƒ³ 1. äºŒåˆ†æŸ¥æ‰¾ (Binary Search) é€‚ç”¨äºæœ‰åºåºåˆ—çš„æŸ¥æ‰¾ã€‚\n// åŸºç¡€ç‰ˆæœ¬ï¼šæŸ¥æ‰¾ç‰¹å®šå€¼ func binarySearch(nums []int, target int) int { left, right := 0, len(nums)-1 for left \u0026lt;= right { mid := left + (right-left)/2 // é˜²æº¢å‡º if nums[mid] == target { return mid } else if nums[mid] \u0026lt; target { left = mid + 1 } else { right = mid - 1 } } return -1 // æœªæ‰¾åˆ° } // å˜ä½“ï¼šæŸ¥æ‰¾å·¦ä¾§è¾¹ç•Œï¼ˆç¬¬ä¸€ä¸ª \u0026gt;= target çš„ä½ç½®ï¼‰ func lowerBound(nums []int, target int) int { left, right := 0, len(nums) // æ³¨æ„ right çš„å–å€¼ for left \u0026lt; right { mid := left + (right-left)/2 if nums[mid] \u0026gt;= target { right = mid } else { left = mid + 1 } } return left } 2. åŒæŒ‡é’ˆ (Two Pointers) å¿«æ…¢æŒ‡é’ˆ å¸¸ç”¨äºé“¾è¡¨ï¼ˆåˆ¤æ–­ç¯ã€æ‰¾ä¸­ç‚¹ï¼‰æˆ–æ•°ç»„ï¼ˆåŸåœ°ä¿®æ”¹ï¼‰ã€‚\n// é“¾è¡¨ç¯æ£€æµ‹ï¼ˆå·²åœ¨ä¸‹æ–¹é“¾è¡¨éƒ¨åˆ†æä¾›ï¼‰ func hasCycle(head *ListNode) bool { slow, fast := head, head for fast != nil \u0026amp;\u0026amp; fast.Next != nil { slow = slow.Next fast = fast.Next.Next if slow == fast { return true } } return false } åŒæŒ‡é’ˆï¼ˆå·¦å³æŒ‡é’ˆï¼‰ å¸¸ç”¨äºæœ‰åºæ•°ç»„ï¼Œä»ä¸¤ç«¯å‘ä¸­é—´é€¼è¿‘ã€‚\n// ç¤ºä¾‹ï¼šæœ‰åºæ•°ç»„çš„ä¸¤æ•°ä¹‹å’Œ func twoSumSorted(nums []int, target int) []int { left, right := 0, len(nums)-1 for left \u0026lt; right { sum := nums[left] + nums[right] if sum == target { return []int{left, right} } else if sum \u0026lt; target { left++ } else { right-- } } return []int{-1, -1} // æœªæ‰¾åˆ° } func twoSumSortedV2(nums []int, target int) []int { m := make return []int{-1, -1} // æœªæ‰¾åˆ° } 3. æ»‘åŠ¨çª—å£ (Sliding Window) ç”¨äºè§£å†³å­æ•°ç»„/å­å­—ç¬¦ä¸²é—®é¢˜ã€‚ç»´æŠ¤ä¸€ä¸ª [left, right) åŒºé—´çš„çª—å£ã€‚\n// ç¤ºä¾‹ï¼šå¯»æ‰¾æœ€å°è¦†ç›–å­ä¸²ï¼ˆä¼ªä»£ç æ¡†æ¶ï¼‰ func minWindow(s, t string) string { need := make(map[byte]int) window := make(map[byte]int) for i := range t { need[t[i]]++ } left, right := 0, 0 valid := 0 // çª—å£ä¸­æ»¡è¶³ need æ¡ä»¶çš„å­—ç¬¦ä¸ªæ•° // ç»“æœèµ·å§‹ç´¢å¼•å’Œé•¿åº¦ start, minLen := 0, len(s)+1 for right \u0026lt; len(s) { // c æ˜¯å°†ç§»å…¥çª—å£çš„å­—ç¬¦ c := s[right] right++ // ... è¿›è¡Œçª—å£å†…æ•°æ®æ›´æ–° ... if _, ok := need[c]; ok { window[c]++ if window[c] == need[c] { valid++ } } // åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼© for valid == len(need) { // åœ¨è¿™é‡Œæ›´æ–°æœ€å°è¦†ç›–å­ä¸² if right-left \u0026lt; minLen { start = left minLen = right - left } // d æ˜¯å°†ç§»å‡ºçª—å£çš„å­—ç¬¦ d := s[left] left++ // ... è¿›è¡Œçª—å£å†…æ•°æ®æ›´æ–° ... if _, ok := need[d]; ok { if window[d] == need[d] { valid-- } window[d]-- } } } if minLen == len(s)+1 { return \u0026#34;\u0026#34; } return s[start : start+minLen] } 4. å›æº¯ç®—æ³• (Backtracking) / DFS ç”¨äºè§£å†³ç»„åˆã€æ’åˆ—ã€å­é›†ã€Nçš‡åç­‰é—®é¢˜ã€‚æœ¬è´¨æ˜¯æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ã€‚\n// ç¤ºä¾‹ï¼šå…¨æ’åˆ— func permute(nums []int) [][]int { res := [][]int{} path := []int{} used := make(map[int]bool) // è®°å½•è·¯å¾„ä¸Šå·²ä½¿ç”¨çš„å…ƒç´  var backtrack func() backtrack = func() { // ç»“æŸæ¡ä»¶ if len(path) == len(nums) { temp := make([]int, len(path)) copy(temp, path) res = append(res, temp) return } for i := 0; i \u0026lt; len(nums); i++ { // å‰ªæï¼šå·²ä½¿ç”¨è¿‡çš„å…ƒç´  if used[i] { continue } // åšé€‰æ‹© path = append(path, nums[i]) used[i] = true // è¿›å…¥ä¸‹ä¸€å±‚å†³ç­– backtrack() // æ’¤é”€é€‰æ‹© path = path[:len(path)-1] used[i] = false } } backtrack() return res } 5. å¹¿åº¦ä¼˜å…ˆæœç´¢ (BFS) å¸¸ç”¨äºå¯»æ‰¾æœ€çŸ­è·¯å¾„ã€å±‚åºéå†ç­‰ã€‚æ ¸å¿ƒæ˜¯é˜Ÿåˆ—ã€‚\n// ç¤ºä¾‹ï¼šäºŒå‰æ ‘å±‚åºéå†ï¼ˆå·²åœ¨ä¸‹æ–¹äºŒå‰æ ‘éƒ¨åˆ†æä¾›ï¼‰ // ç¤ºä¾‹ï¼šå›¾çš„æœ€çŸ­è·¯å¾„ï¼ˆä¼ªä»£ç ï¼‰ func bfsShortestPath(start, end *GraphNode) int { queue := []*GraphNode{start} visited := make(map[*GraphNode]bool) visited[start] = true level := 0 // è·ç¦» for len(queue) \u0026gt; 0 { size := len(queue) for i := 0; i \u0026lt; size; i++ { node := queue[0] queue = queue[1:] if node == end { return level } for _, neighbor := range node.Neighbors { if !visited[neighbor] { visited[neighbor] = true queue = append(queue, neighbor) } } } level++ } return -1 // ä¸å¯è¾¾ } 6. åŠ¨æ€è§„åˆ’ (Dynamic Programming) æ ¸å¿ƒæ€æƒ³ï¼šå®šä¹‰çŠ¶æ€ã€æ‰¾å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€ç¡®å®š base caseã€‚\n// ç¤ºä¾‹ï¼šçˆ¬æ¥¼æ¢¯ // çŠ¶æ€å®šä¹‰ï¼šdp[i] è¡¨ç¤ºçˆ¬åˆ°ç¬¬ i é˜¶æ¥¼æ¢¯çš„æ–¹æ³•æ•° // çŠ¶æ€è½¬ç§»ï¼šdp[i] = dp[i-1] + dp[i-2] // Base Case: dp[0] = 1, dp[1] = 1 (æˆ– dp[1]=1, dp[2]=2) func climbStairs(n int) int { if n \u0026lt;= 1 { return 1 } dp := make([]int, n+1) dp[0] = 1 dp[1] = 1 for i := 2; i \u0026lt;= n; i++ { dp[i] = dp[i-1] + dp[i-2] } return dp[n] } // ç©ºé—´ä¼˜åŒ–ï¼ˆæ»šåŠ¨æ•°ç»„ï¼‰ func climbStairsOptimized(n int) int { if n \u0026lt;= 1 { return 1 } prev2, prev1 := 1, 1 // å¯¹åº” dp[i-2] å’Œ dp[i-1] for i := 2; i \u0026lt;= n; i++ { curr := prev1 + prev2 // dp[i] prev2 = prev1 prev1 = curr } return prev1 } ç¬¬äºŒéƒ¨åˆ†ï¼šæ•°æ®ç»“æ„ç›¸å…³æ¨¡æ¿ (è¿™éƒ¨åˆ†æ˜¯æ‚¨ä¸Šæ¬¡æä¾›çš„å†…å®¹ï¼Œæˆ‘å°†å…¶æ•´åˆåˆ°æ­¤å¤„)\n7. é“¾è¡¨ç®—æ³• (éœ€è¦ ListNode ç»“æ„å®šä¹‰)\ntype ListNode struct { Val int Next *ListNode } åè½¬é“¾è¡¨ func reverseList(head *ListNode) *ListNode { var prev *ListNode for head != nil { next := head.Next head.Next = prev prev = head head = next } return prev } åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ func mergeTwoLists(l1, l2 *ListNode) *ListNode { dummy := \u0026amp;ListNode{} cur := dummy for l1 != nil \u0026amp;\u0026amp; l2 != nil { if l1.Val \u0026lt; l2.Val { cur.Next = l1 l1 = l1.Next } else { cur.Next = l2 l2 = l2.Next } cur = cur.Next } if l1 != nil { cur.Next = l1 } if l2 != nil { cur.Next = l2 } return dummy.Next } é“¾è¡¨ä¸­ç¯çš„æ£€æµ‹ï¼ˆå¿«æ…¢æŒ‡é’ˆåº”ç”¨ï¼‰ func hasCycle(head *ListNode) bool { slow, fast := head, head for fast != nil \u0026amp;\u0026amp; fast.Next != nil { slow = slow.Next fast = fast.Next.Next if slow == fast { return true } } return false } 8. äºŒå‰æ ‘éå† (éœ€è¦ TreeNode ç»“æ„å®šä¹‰)\ntype TreeNode struct { Val int Left *TreeNode Right *TreeNode } å‰åºéå†ï¼ˆé€’å½’ï¼‰ import \u0026#34;fmt\u0026#34; func preorder(root *TreeNode) { if root == nil { return } fmt.Println(root.Val) preorder(root.Left) preorder(root.Right) } ä¸­åºéå†ï¼ˆé€’å½’ï¼‰ import \u0026#34;fmt\u0026#34; func inorder(root *TreeNode) { if root == nil { return } inorder(root.Left) fmt.Println(root.Val) inorder(root.Right) } ååºéå†ï¼ˆé€’å½’ï¼‰ import \u0026#34;fmt\u0026#34; func postorder(root *TreeNode) { if root == nil { return } postorder(root.Left) postorder(root.Right) fmt.Println(root.Val) } å±‚åºéå†ï¼ˆBFS åº”ç”¨ï¼‰ func levelOrder(root *TreeNode) [][]int { if root == nil { return nil } queue := []*TreeNode{root} res := [][]int{} for len(queue) \u0026gt; 0 { level := []int{} levelSize := len(queue) // å›ºå®šå½“å‰å±‚çš„èŠ‚ç‚¹æ•° for i := 0; i \u0026lt; levelSize; i++ { node := queue[0] queue = queue[1:] level = append(level, node.Val) if node.Left != nil { queue = append(queue, node.Left) } if node.Right != nil { queue = append(queue, node.Right) } } res = append(res, level) } return res } 9. å›¾éå† (å‡å®š Graph æ˜¯é‚»æ¥è¡¨ map[int][]int æˆ– [][]int)\nDFS éå† import \u0026#34;fmt\u0026#34; func dfs(graph Graph, node int, visited map[int]bool) { if visited[node] { return } visited[node] = true fmt.Println(node) for _, nei := range graph[node] { dfs(graph, nei, visited) } } BFS éå† func bfs(graph Graph, start int) []int { visited := make(map[int]bool) queue := []int{start} res := []int{} for len(queue) \u0026gt; 0 { node := queue[0] queue = queue[1:] if visited[node] { continue } visited[node] = true res = append(res, node) for _, nei := range graph[node] { if !visited[nei] { queue = append(queue, nei) } } } return res } 10. å¹¶æŸ¥é›† (Union-Find) type UnionFind struct { Parent []int Rank []int // æˆ– Size } func NewUnionFind(n int) *UnionFind { parent := make([]int, n) rank := make([]int, n) for i := 0; i \u0026lt; n; i++ { parent[i] = i rank[i] = 1 } return \u0026amp;UnionFind{Parent: parent, Rank: rank} } func (uf *UnionFind) Find(x int) int { if uf.Parent[x] != x { uf.Parent[x] = uf.Find(uf.Parent[x]) // è·¯å¾„å‹ç¼© } return uf.Parent[x] } func (uf *UnionFind) Union(x, y int) bool { rootX := uf.Find(x) rootY := uf.Find(y) if rootX == rootY { return false // å·²åœ¨åŒä¸€é›†åˆ } // æŒ‰ç§©åˆå¹¶ if uf.Rank[rootX] \u0026lt; uf.Rank[rootY] { uf.Parent[rootX] = rootY } else if uf.Rank[rootX] \u0026gt; uf.Rank[rootY] { uf.Parent[rootY] = rootX } else { uf.Parent[rootY] = rootX uf.Rank[rootX]++ } return true } 11. å †æ“ä½œ (container/heap) import \u0026#34;container/heap\u0026#34; // ç¤ºä¾‹ï¼šå°é¡¶å † type Item struct { Val int } type IntHeap []Item func (h IntHeap) Len() int { return len(h) } func (h IntHeap) Less(i, j int) bool { return h[i].Val \u0026lt; h[j].Val } // å°é¡¶å † func (h IntHeap) Swap(i, j int) { h[i], h[j] = h[j], h[i] } func (h *IntHeap) Push(x any) { *h = append(*h, x.(Item)) } func (h *IntHeap) Pop() any { old := *h n := len(old) x := old[n-1] *h = old[:n-1] return x } /* // ä½¿ç”¨ç¤ºä¾‹ï¼š h := \u0026amp;IntHeap{Item{Val: 2}, Item{Val: 1}, Item{Val: 5}} heap.Init(h) heap.Push(h, Item{Val: 3}) fmt.Printf(\u0026#34;min: %d\\n\u0026#34;, (*h)[0].Val) for h.Len() \u0026gt; 0 { fmt.Printf(\u0026#34;%d \\n\u0026#34;, heap.Pop(h).(Item).Val) } */ 12. Trie (å‰ç¼€æ ‘) type TrieNode struct { Children map[rune]*TrieNode IsEnd bool } func NewTrieNode() *TrieNode { return \u0026amp;TrieNode{Children: make(map[rune]*TrieNode)} } type Trie struct { Root *TrieNode } func Constructor() Trie { return Trie{Root: NewTrieNode()} } func (t *Trie) Insert(word string) { node := t.Root for _, ch := range word { if node.Children[ch] == nil { node.Children[ch] = NewTrieNode() } node = node.Children[ch] } node.IsEnd = true } func (t *Trie) Search(word string) bool { node := t.Root for _, ch := range word { if node.Children[ch] == nil { return false } node = node.Children[ch] } return node.IsEnd } 13. LRU ç¼“å­˜ ä½¿ç”¨ container/list å’Œ map å®ç°ã€‚\nimport \u0026#34;container/list\u0026#34; type LRUCache struct { capacity int cache map[int]*list.Element // å­˜å‚¨ key åˆ° list èŠ‚ç‚¹çš„æ˜ å°„ list *list.List // åŒå‘é“¾è¡¨ } // é“¾è¡¨ä¸­å­˜å‚¨çš„å…ƒç´  type pair struct { key, value int } func ConstructorLRU(capacity int) LRUCache { return LRUCache{ capacity: capacity, cache: make(map[int]*list.Element), list: list.New(), } } func (c *LRUCache) Get(key int) int { if node, ok := c.cache[key]; ok { // è®¿é—®åˆ°äº†ï¼Œç§»åˆ°é˜Ÿå¤´ c.list.MoveToFront(node) return node.Value.(pair).value } return -1 } func (c *LRUCache) Put(key, value int) { if node, ok := c.cache[key]; ok { // å·²å­˜åœ¨ï¼Œæ›´æ–°å€¼å¹¶ç§»åˆ°é˜Ÿå¤´ c.list.MoveToFront(node) node.Value = pair{key, value} return } // ä¸å­˜åœ¨ï¼Œæ˜¯æ–°å…ƒç´  if c.list.Len() == c.capacity { // æ»¡äº†ï¼Œæ·˜æ±°é˜Ÿå°¾å…ƒç´  back := c.list.Back() if back != nil { c.list.Remove(back) delete(c.cache, back.Value.(pair).key) } } // æ’å…¥æ–°èŠ‚ç‚¹åˆ°é˜Ÿå¤´ node := c.list.PushFront(pair{key, value}) c.cache[key] = node } 14. æ ˆä¸é˜Ÿåˆ—æ“ä½œ ï¼ˆä½¿ç”¨åˆ‡ç‰‡ []int å®ç°ï¼‰\n// æ ˆ (Stack) type Stack struct { data []int } func (s *Stack) Push(x int) { s.data = append(s.data, x) } func (s *Stack) Pop() int { n := len(s.data) if n == 0 { return -1 } val := s.data[n-1] s.data = s.data[:n-1] return val } func (s *Stack) Top() int { if len(s.data) == 0 { return -1 } return s.data[len(s.data)-1] } // é˜Ÿåˆ— (Queue) type Queue struct { data []int } func (q *Queue) Enqueue(x int) { q.data = append(q.data, x) } func (q *Queue) Dequeue() int { if len(q.data) == 0 { return -1 } val := q.data[0] q.data = q.data[1:] return val } å…¶ä»–çš„ ä¸€ã€æ•°ç»„ \u0026amp; å­—ç¬¦ä¸²\nåŒæŒ‡é’ˆ æ»‘åŠ¨çª—å£ å‰ç¼€å’Œ \u0026amp; å·®åˆ† KMP / å­—ç¬¦åŒ¹é…ï¼ˆå¯é€‰ï¼‰ Trie å­—å…¸æ ‘ äºŒã€æŸ¥æ‰¾ \u0026amp; æ’åº\nå¿«æ’ / å½’å¹¶ äºŒåˆ†æŸ¥æ‰¾ å † / ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆTopKï¼‰ ä¸‰ã€æ ˆ \u0026amp; é˜Ÿåˆ—\nå•è°ƒæ ˆï¼ˆä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  / ç››æ°´ / æ¯æ—¥æ¸©åº¦ï¼‰ BFS/DFSï¼ˆå«å¤šæº BFS \u0026amp; åˆ†å±‚ BFSï¼‰ æ‹“æ‰‘æ’åº å››ã€é“¾è¡¨\nç¿»è½¬ / åˆå¹¶ / ç¯æ£€æµ‹ / K ä¸ªä¸€ç»„åè½¬ äº”ã€å“ˆå¸Œ \u0026amp; é›†åˆ\nä¸¤æ•°ä¹‹å’Œ LRU è·³è¡¨ï¼ˆå¯é€‰ï¼‰ å…­ã€æ ‘ \u0026amp; å›¾\næœ€è¿‘å…¬å…±ç¥–å…ˆ LCAï¼ˆå€å¢æ³•ï¼‰ æœ€å¤§è·¯å¾„å’Œ æ ‘çš„æ·±åº¦ / ç›´å¾„ å¹¶æŸ¥é›†è§£å†³è¿é€šæ€§ å›¾æœ€çŸ­è·¯å¾„ Dijkstraï¼ˆå¸¦æƒï¼‰ BFS æœ€çŸ­è·¯å¾„ï¼ˆæ— æƒï¼‰ ä¸ƒã€å›æº¯ \u0026amp; é€’å½’\nå…¨æ’åˆ— / ç»„åˆ / å­é›† N çš‡å å‰ªææŠ€å·§ å…«ã€åŠ¨æ€è§„åˆ’ DP\næ–æ³¢é‚£å¥‘ / å°é˜¶ èƒŒåŒ…ï¼ˆ01/å®Œå…¨/å¤šé‡ï¼‰ æœ€å¤§å­æ•°ç»„å’Œ æ‰“å®¶åŠ«èˆç³»åˆ— å•è¯æ‹†åˆ† çŠ¶æ€å‹ç¼© DPï¼ˆé‡è¦è¡¥å……ï¼‰ ä¹ã€æ•°å­¦\nå¿«é€Ÿå¹‚ æœ€å¤§å…¬çº¦æ•° / æœ€å°å…¬å€æ•° ç»„åˆæ•° / é€†å…ƒï¼ˆå¦‚æœæ¶‰åŠç¬”è¯•ï¼‰ ",
"tags":null,
"categories":null
},{
"title":"è¿›ç¨‹é—´é€šä¿¡",
"permalink": "http://localhost:1313/posts/cs/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/",
"summary": "",
"content": "",
"tags":null,
"categories":null
},{
"title":"å¸¸ç”¨æ•°æ®ç»“æ„",
"permalink": "http://localhost:1313/posts/datastructalgorithm/%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/",
"summary": "å¸¸ç”¨æ•°æ®ç»“æ„å®šä¹‰ 1. é“¾è¡¨ï¼ˆLinked Listï¼‰ type ListNode struct { Val int Next *ListNode } 2. åŒå‘é“¾è¡¨ï¼ˆDoubly Linked Listï¼‰ type DListNode struct { Val int Prev *DListNode Next *DListNode } 3. æ ˆï¼ˆStackï¼‰ type Stack struct { data []int } 4. é˜Ÿåˆ—ï¼ˆQueueï¼‰ type Queue struct { data []int } 5. äºŒå‰æ ‘ï¼ˆBinary Treeï¼‰ type TreeNode struct { Val int Left *TreeNode Right *TreeNode } 6. Nå‰æ ‘ï¼ˆN-ary Treeï¼‰ type NTreeNode struct { Val int Children []*NTreeNode } 7. å›¾ï¼ˆGraphï¼‰ type GraphNode struct { Val int Neighbors []*GraphNode } 8. å“ˆå¸Œè¡¨ï¼ˆHashMapï¼‰ m := make(map[string]int) 9. å †ï¼ˆHeap / Priority Queueï¼‰ type Item struct { Val int } type IntHeap []Item 10. çŸ©é˜µï¼ˆMatrixï¼‰ matrix := [][]int{ {1, 2, 3}, {4, 5, 6}, {7, 8, 9}, } 11. Trieï¼ˆå‰ç¼€æ ‘ï¼‰ type TrieNode struct { Children map[rune]*TrieNode IsEnd bool } type Trie struct { Root *TrieNode } 12. å¹¶æŸ¥é›†ï¼ˆUnion-Findï¼‰ type UnionFind struct { Parent []int Rank []int } 13. LRU ç¼“å­˜ï¼ˆLeast Recently Used Cacheï¼‰ type pair struct { key, value int } type LRUCache struct { capacity int cache map[int]*list.Element list *list.List } è¿›é˜¶ å›¾ ğŸ§  ä¸€ã€å›¾çš„åŸºæœ¬æ¦‚å¿µ å›¾ç”±ï¼š\n",
"content": "å¸¸ç”¨æ•°æ®ç»“æ„å®šä¹‰ 1. é“¾è¡¨ï¼ˆLinked Listï¼‰ type ListNode struct { Val int Next *ListNode } 2. åŒå‘é“¾è¡¨ï¼ˆDoubly Linked Listï¼‰ type DListNode struct { Val int Prev *DListNode Next *DListNode } 3. æ ˆï¼ˆStackï¼‰ type Stack struct { data []int } 4. é˜Ÿåˆ—ï¼ˆQueueï¼‰ type Queue struct { data []int } 5. äºŒå‰æ ‘ï¼ˆBinary Treeï¼‰ type TreeNode struct { Val int Left *TreeNode Right *TreeNode } 6. Nå‰æ ‘ï¼ˆN-ary Treeï¼‰ type NTreeNode struct { Val int Children []*NTreeNode } 7. å›¾ï¼ˆGraphï¼‰ type GraphNode struct { Val int Neighbors []*GraphNode } 8. å“ˆå¸Œè¡¨ï¼ˆHashMapï¼‰ m := make(map[string]int) 9. å †ï¼ˆHeap / Priority Queueï¼‰ type Item struct { Val int } type IntHeap []Item 10. çŸ©é˜µï¼ˆMatrixï¼‰ matrix := [][]int{ {1, 2, 3}, {4, 5, 6}, {7, 8, 9}, } 11. Trieï¼ˆå‰ç¼€æ ‘ï¼‰ type TrieNode struct { Children map[rune]*TrieNode IsEnd bool } type Trie struct { Root *TrieNode } 12. å¹¶æŸ¥é›†ï¼ˆUnion-Findï¼‰ type UnionFind struct { Parent []int Rank []int } 13. LRU ç¼“å­˜ï¼ˆLeast Recently Used Cacheï¼‰ type pair struct { key, value int } type LRUCache struct { capacity int cache map[int]*list.Element list *list.List } è¿›é˜¶ å›¾ ğŸ§  ä¸€ã€å›¾çš„åŸºæœ¬æ¦‚å¿µ å›¾ç”±ï¼š\né¡¶ç‚¹ï¼ˆVertexï¼‰ï¼šèŠ‚ç‚¹ï¼ˆå¦‚åŸå¸‚ã€ç”¨æˆ·ã€ç½‘é¡µç­‰ï¼‰ è¾¹ï¼ˆEdgeï¼‰ï¼šèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥å…³ç³»ï¼ˆå¦‚èˆªçº¿ã€å¥½å‹å…³ç³»ã€é“¾æ¥ï¼‰ æ ¹æ®è¾¹çš„æ–¹å‘ï¼Œå¯ä»¥åˆ†ä¸ºï¼š\nç±»å‹ è¯´æ˜ ä¸¾ä¾‹ æ— å‘å›¾ è¾¹æ²¡æœ‰æ–¹å‘ å¥½å‹å…³ç³»ï¼ˆAâ†”Bï¼‰ æœ‰å‘å›¾ è¾¹æœ‰æ–¹å‘ å…³æ³¨å…³ç³»ï¼ˆAâ†’Bï¼‰ è¾¹è¿˜å¯ä»¥æœ‰ï¼š\næƒé‡ï¼ˆWeightï¼‰ï¼šè¡¨ç¤ºè·ç¦»ã€è´¹ç”¨ã€å¼ºåº¦ç­‰ï¼ˆæ¯”å¦‚èˆªç­è·ç¦»ã€ä¼ è¾“æ—¶é—´ï¼‰ ğŸ§© äºŒã€å›¾çš„å­˜å‚¨æ–¹å¼ï¼ˆä¸¤ç§æ ¸å¿ƒç»“æ„ï¼‰ 1ï¸âƒ£ é‚»æ¥çŸ©é˜µï¼ˆAdjacency Matrixï¼‰ ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„ matrix[i][j] è¡¨ç¤ºæ˜¯å¦å­˜åœ¨è¾¹ã€‚\nä¾‹å¦‚ï¼š\n0 1 2 A B C è¾¹ï¼š\nA â†’ B B â†’ C A â†’ C åˆ™é‚»æ¥çŸ©é˜µä¸ºï¼š\nA B C A [0, 1, 1] B [0, 0, 1] C [0, 0, 0] ğŸ‘‰ é€‚åˆç¨ å¯†å›¾ï¼ˆè¾¹å¤šï¼‰ï¼Œåˆ¤æ–­è¿æ¥å¿«ï¼ˆO(1)ï¼‰ï¼Œä½†å å†…å­˜å¤§ï¼ˆO(nÂ²)ï¼‰ã€‚\n2ï¸âƒ£ é‚»æ¥è¡¨ï¼ˆAdjacency Listï¼‰ æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ªâ€œé‚»å±…åˆ—è¡¨â€ã€‚\nä¾‹å¦‚åŒæ ·çš„å›¾ï¼š\nA: [B, C] B: [C] C: [] ğŸ‘‰ é€‚åˆç¨€ç–å›¾ï¼ˆè¾¹å°‘ï¼‰ï¼Œå­˜å‚¨æ•ˆç‡é«˜ã€‚\nğŸ§° ä¸‰ã€Go ä¸­çš„è¡¨ç¤ºæ–¹å¼ âœ… é‚»æ¥è¡¨ï¼ˆæ¨èæ–¹å¼ï¼‰ type Graph struct { edges map[string][]string } func NewGraph() *Graph { return \u0026amp;Graph{edges: make(map[string][]string)} } func (g *Graph) AddEdge(from, to string) { g.edges[from] = append(g.edges[from], to) } ä½¿ç”¨ç¤ºä¾‹ï¼š\nfunc main() { g := NewGraph() g.AddEdge(\u0026#34;A\u0026#34;, \u0026#34;B\u0026#34;) g.AddEdge(\u0026#34;A\u0026#34;, \u0026#34;C\u0026#34;) g.AddEdge(\u0026#34;B\u0026#34;, \u0026#34;C\u0026#34;) fmt.Println(g.edges) // map[A:[B C] B:[C]] } âœ… å¸¦æƒå›¾ï¼ˆWeighted Graphï¼‰ type Graph struct { edges map[string]map[string]int } func NewGraph() *Graph { return \u0026amp;Graph{edges: make(map[string]map[string]int)} } func (g *Graph) AddEdge(from, to string, weight int) { if g.edges[from] == nil { g.edges[from] = make(map[string]int) } g.edges[from][to] = weight } ä½¿ç”¨ç¤ºä¾‹ï¼š\nfunc main() { g := NewGraph() g.AddEdge(\u0026#34;A\u0026#34;, \u0026#34;B\u0026#34;, 5) g.AddEdge(\u0026#34;A\u0026#34;, \u0026#34;C\u0026#34;, 2) g.AddEdge(\u0026#34;B\u0026#34;, \u0026#34;C\u0026#34;, 1) fmt.Println(g.edges) // map[A:map[B:5 C:2] B:map[C:1]] } ğŸ” å››ã€å›¾çš„éå†ï¼ˆåŸºç¡€æ¨¡æ¿ï¼‰ DFS æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆé€’å½’ï¼‰ func (g *Graph) DFS(start string, visited map[string]bool) { if visited[start] { return } visited[start] = true fmt.Println(\u0026#34;visit:\u0026#34;, start) for _, neighbor := range g.edges[start] { g.DFS(neighbor, visited) } } BFS å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆé˜Ÿåˆ—ï¼‰ func (g *Graph) BFS(start string) { visited := make(map[string]bool) queue := []string{start} visited[start] = true for len(queue) \u0026gt; 0 { node := queue[0] queue = queue[1:] fmt.Println(\u0026#34;visit:\u0026#34;, node) for _, neighbor := range g.edges[node] { if !visited[neighbor] { visited[neighbor] = true queue = append(queue, neighbor) } } } } ğŸŒ äº”ã€å¸¸è§åº”ç”¨ç±»å‹ é—®é¢˜ ä½¿ç”¨ç®—æ³• è¯´æ˜ åˆ¤æ–­æ˜¯å¦è¿é€š DFS / BFS å²›å±¿æ•°é‡ã€æœ‹å‹åœˆ æœ€çŸ­è·¯å¾„ BFS / Dijkstra æœ€çŸ­è·¯å¾„é—®é¢˜ æ£€æµ‹ç¯ DFS / æ‹“æ‰‘æ’åº ä»»åŠ¡ä¾èµ–æ£€æµ‹ æ‹“æ‰‘æ’åº Kahnç®—æ³• / DFS ç¼–è¯‘ä¾èµ–ã€ä»»åŠ¡æ‰§è¡Œé¡ºåº æœ€å°ç”Ÿæˆæ ‘ Kruskal / Prim ç½‘ç»œå¸ƒçº¿ã€æœ€å°ä»£ä»·è¿æ¥ å¼ºè¿é€šåˆ†é‡ Tarjanç®—æ³• ç¤¾äº¤åœˆã€å­ç³»ç»Ÿåˆ†ç»„ ğŸ’¡ å°ç»“ å­˜å‚¨æ–¹å¼ ä¼˜ç‚¹ ç¼ºç‚¹ é€‚ç”¨åœºæ™¯ é‚»æ¥çŸ©é˜µ åˆ¤æ–­è¿æ¥å¿« å ç©ºé—´å¤§ ç¨ å¯†å›¾ é‚»æ¥è¡¨ èŠ‚çœç©ºé—´ åˆ¤æ–­æ…¢ ç¨€ç–å›¾ï¼ˆå¸¸è§ï¼‰ ",
"tags":null,
"categories":null
},{
"title":"æ‰“å¡è®¡åˆ’è¡¨",
"permalink": "http://localhost:1313/posts/datastructalgorithm/%E6%89%93%E5%8D%A1%E8%AE%A1%E5%88%92%E8%A1%A8/",
"summary": "å¼€å¯æ‰“å¡è®¡åˆ’ æ—¥æœŸ é¢˜ç›® æ¨¡æ¿ äºŒåˆ·ç»“æœ è¿ç§»ç»ƒä¹  å¤‡æ³¨ 10/16 15. ä¸‰æ•°ä¹‹å’Œ åŒæŒ‡é’ˆ âœ… ä¸‰æ•°å·®å€¼æœ€æ¥è¿‘ å®Œæ•´å¤ç›˜ï¼Œå†™æ¨¡æ¿ç¬”è®° 10/17 11. ç››æœ€å¤šæ°´çš„å®¹å™¨ åŒæŒ‡é’ˆ âœ… è‚¡ç¥¨æœ€å¤§åˆ©æ¶¦ è®¡æ—¶ 25 åˆ†é’Ÿ 10/18 3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æ»‘åŠ¨çª—å£ âœ… æœ€é•¿å…è®¸1é‡å¤å­—ç¬¦ æ¨¡æ‹Ÿé¢è¯•è¯´æ€è·¯ 10/19 1. ä¸¤æ•°ä¹‹å’Œ å“ˆå¸Œ âœ… ä¸‰æ•°ä¹‹å’Œã€è·¯å¾„æ±‚å’Œ å¼ºåŒ–è¿ç§»èƒ½åŠ› 10/20 20. æœ‰æ•ˆæ‹¬å· æ ˆ âœ… HTMLæ ‡ç­¾éªŒè¯ äºŒåˆ·å®Œæˆ 10/21 739. æ¯æ—¥æ¸©åº¦ å•è°ƒæ ˆ âœ… ä¸‹ä¸€ä¸ªæ›´å°å…ƒç´  äºŒåˆ· + è¿ç§» 10/22 206. åè½¬é“¾è¡¨ é“¾è¡¨ âœ… kç»„åè½¬ã€å›æ–‡é“¾è¡¨ æ¨¡æ¿ç¬”è®° 10/23 141. ç¯å½¢é“¾è¡¨ é“¾è¡¨ âœ… ç›¸äº¤é“¾è¡¨æ£€æµ‹ äºŒåˆ·å®Œæˆ 10/24 53. æœ€å¤§å­åºå’Œ åŠ¨æ€è§„åˆ’ âœ… è‚¡ç¥¨æœ€å¤§åˆ©æ¶¦ è®¡æ—¶ç»ƒä¹  10/25 198. æ‰“å®¶åŠ«èˆ åŠ¨æ€è§„åˆ’ âœ… ç¯å½¢æ‰“å®¶åŠ«èˆ äºŒåˆ·å®Œæˆ 10/26 139. å•è¯æ‹†åˆ† åŠ¨æ€è§„åˆ’ âœ… æ‰€æœ‰æ‹†åˆ†æ–¹å¼ å†™è¿ç§»ç¬”è®° 10/27 33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ äºŒåˆ† æœç´¢å³°å€¼ è®¡æ—¶ç»ƒä¹  10/28 200. å²›å±¿æ•°é‡ DFS/BFS å°é—­åŒºåŸŸè®¡æ•° äºŒåˆ· + è¿ç§» 10/29 104. äºŒå‰æ ‘æœ€å¤§æ·±åº¦ æ ‘ åˆ¤æ–­å¹³è¡¡äºŒå‰æ ‘ æ¨¡æ¿ç¬”è®° 10/30 236. æœ€è¿‘å…¬å…±ç¥–å…ˆ æ ‘ Nå‰æ ‘ç‰ˆæœ¬ äºŒåˆ·å®Œæˆ ",
"content": "å¼€å¯æ‰“å¡è®¡åˆ’ æ—¥æœŸ é¢˜ç›® æ¨¡æ¿ äºŒåˆ·ç»“æœ è¿ç§»ç»ƒä¹  å¤‡æ³¨ 10/16 15. ä¸‰æ•°ä¹‹å’Œ åŒæŒ‡é’ˆ âœ… ä¸‰æ•°å·®å€¼æœ€æ¥è¿‘ å®Œæ•´å¤ç›˜ï¼Œå†™æ¨¡æ¿ç¬”è®° 10/17 11. ç››æœ€å¤šæ°´çš„å®¹å™¨ åŒæŒ‡é’ˆ âœ… è‚¡ç¥¨æœ€å¤§åˆ©æ¶¦ è®¡æ—¶ 25 åˆ†é’Ÿ 10/18 3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æ»‘åŠ¨çª—å£ âœ… æœ€é•¿å…è®¸1é‡å¤å­—ç¬¦ æ¨¡æ‹Ÿé¢è¯•è¯´æ€è·¯ 10/19 1. ä¸¤æ•°ä¹‹å’Œ å“ˆå¸Œ âœ… ä¸‰æ•°ä¹‹å’Œã€è·¯å¾„æ±‚å’Œ å¼ºåŒ–è¿ç§»èƒ½åŠ› 10/20 20. æœ‰æ•ˆæ‹¬å· æ ˆ âœ… HTMLæ ‡ç­¾éªŒè¯ äºŒåˆ·å®Œæˆ 10/21 739. æ¯æ—¥æ¸©åº¦ å•è°ƒæ ˆ âœ… ä¸‹ä¸€ä¸ªæ›´å°å…ƒç´  äºŒåˆ· + è¿ç§» 10/22 206. åè½¬é“¾è¡¨ é“¾è¡¨ âœ… kç»„åè½¬ã€å›æ–‡é“¾è¡¨ æ¨¡æ¿ç¬”è®° 10/23 141. ç¯å½¢é“¾è¡¨ é“¾è¡¨ âœ… ç›¸äº¤é“¾è¡¨æ£€æµ‹ äºŒåˆ·å®Œæˆ 10/24 53. æœ€å¤§å­åºå’Œ åŠ¨æ€è§„åˆ’ âœ… è‚¡ç¥¨æœ€å¤§åˆ©æ¶¦ è®¡æ—¶ç»ƒä¹  10/25 198. æ‰“å®¶åŠ«èˆ åŠ¨æ€è§„åˆ’ âœ… ç¯å½¢æ‰“å®¶åŠ«èˆ äºŒåˆ·å®Œæˆ 10/26 139. å•è¯æ‹†åˆ† åŠ¨æ€è§„åˆ’ âœ… æ‰€æœ‰æ‹†åˆ†æ–¹å¼ å†™è¿ç§»ç¬”è®° 10/27 33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ äºŒåˆ† æœç´¢å³°å€¼ è®¡æ—¶ç»ƒä¹  10/28 200. å²›å±¿æ•°é‡ DFS/BFS å°é—­åŒºåŸŸè®¡æ•° äºŒåˆ· + è¿ç§» 10/29 104. äºŒå‰æ ‘æœ€å¤§æ·±åº¦ æ ‘ åˆ¤æ–­å¹³è¡¡äºŒå‰æ ‘ æ¨¡æ¿ç¬”è®° 10/30 236. æœ€è¿‘å…¬å…±ç¥–å…ˆ æ ‘ Nå‰æ ‘ç‰ˆæœ¬ äºŒåˆ·å®Œæˆ ",
"tags":null,
"categories":null
},{
"title":"åˆ·é¢˜æ–¹æ³•",
"permalink": "http://localhost:1313/posts/datastructalgorithm/%E5%88%B7%E9%A2%98%E6%96%B9%E6%B3%95/",
"summary": "ä¸ªäººæ„Ÿæ‚Ÿå’Œå‰è¨€ åˆ·äº†å¾ˆå¤šé¢˜ï¼ˆå…¶å®ä¹Ÿä¸æ˜¯å¾ˆå¤šï¼Œä½†å´æ˜¯æ¯å¤©åšæŒåŠå°æ—¶åšæŒäº†ä¸€å¹´å¤šäº†ï¼‰ï¼Œ ä½†æ˜¯è€æ˜¯é¢è¯•çš„æ—¶å€™åšä¸å‡ºæ¥ï¼Œæˆ–è€…è¦èŠ±å¾ˆé•¿æ—¶é—´æ‰èƒ½åšå‡ºæ¥ã€‚æˆ‘éƒ½äº§ç”Ÿè‡ªæˆ‘æ€€ç–‘äº†ï¼Œæˆ‘è§‰å¾—æ˜¯æ—¶å€™æ¢ä¸ªæ–¹å¼äº†ã€‚ æˆ‘é—®äº†gpt,å®ƒç»™äº†æˆ‘å¾ˆå¤šå»ºè®®ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šæŒ‰ç…§ä¸‹é¢çš„æ–¹å¼é‡æ–°è§„åˆ’æˆ‘çš„å­¦ä¹ æ–¹æ³•\nä»¥ä¸‹å¤§å¤šæ•°å‚è€ƒäº†gpt\nå…·ä½“çš„åšæ³• æ ¸å¿ƒç›®æ ‡ ä¸€ã€æ ¸å¿ƒç›®æ ‡ ç”¨æœ€å°‘çš„é¢˜ï¼Œå»ºç«‹æœ€å¤§è¿ç§»åŠ›ã€‚ ç†Ÿç»ƒè¯†åˆ«æ¨¡æ¿ï¼Œèƒ½ä¸¾ä¸€åä¸‰ã€‚ é¢è¯•æ—¶ 3 åˆ†é’Ÿå†…èƒ½è®²æ¸…æ€è·¯ã€‚ é‡ç‚¹åœ¨æ¨¡å¼è¯†åˆ« + æ¨¡æ¿è¿ç§»ï¼Œä¸è¿½æ•°é‡ã€‚ äºŒã€15 é“æœ€å€¼å¾—å¤ç›˜çš„æ¨¡æ¿é¢˜ ç±»åˆ« LeetCodeé¢˜ç›® æ ¸å¿ƒæ¨¡æ¿ å¯è¿ç§»æ–¹å‘ åŒæŒ‡é’ˆ 15. ä¸‰æ•°ä¹‹å’Œ æ’åº + å»é‡ + å·¦å³å¤¹é€¼ kæ•°ä¹‹å’Œ / å·®å€¼æœ€æ¥è¿‘ / åˆ é™¤ä¸€ä¸ªå­—ç¬¦å˜å›æ–‡ åŒæŒ‡é’ˆ 11. ç››æœ€å¤šæ°´çš„å®¹å™¨ å·¦å³å¤¹é€¼å–æœ€å¤§é¢ç§¯ è‚¡ç¥¨ä¹°å–ã€æœ€ä¼˜åŒºé—´ç±»é—®é¢˜ æ»‘åŠ¨çª—å£ 3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æ‰©å±•çª—å£ + æ”¶ç¼©çª—å£ æœ€å°è¦†ç›–å­ä¸²ã€æœ€é•¿Kä¸ªä¸åŒå­—ç¬¦å­ä¸² å“ˆå¸Œ 1. ä¸¤æ•°ä¹‹å’Œ å“ˆå¸ŒåæŸ¥ ä¸‰æ•°ä¹‹å’Œã€å››æ•°ä¹‹å’Œã€è·¯å¾„æ±‚å’Œ æ ˆ 20. æœ‰æ•ˆçš„æ‹¬å· æ ˆåŒ¹é… HTMLæ ‡ç­¾éªŒè¯ã€æ ˆé€†åº å•è°ƒæ ˆ 739. æ¯æ—¥æ¸©åº¦ å•è°ƒé€’å‡æ ˆ ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ã€æŸ±çŠ¶å›¾æœ€å¤§çŸ©å½¢ é“¾è¡¨ 206. åè½¬é“¾è¡¨ æŒ‡é’ˆå‰ååè½¬ kç»„åè½¬ã€å›æ–‡é“¾è¡¨æ£€æµ‹ é“¾è¡¨ 141. ç¯å½¢é“¾è¡¨ å¿«æ…¢æŒ‡é’ˆ ç›¸äº¤é“¾è¡¨æ£€æµ‹ã€å¯»æ‰¾ç¯å…¥å£ åŠ¨æ€è§„åˆ’ 53. æœ€å¤§å­åºå’Œ dp[i] = max(nums[i], dp[i-1]+nums[i]) è‚¡ç¥¨æœ€å¤§åˆ©æ¶¦ã€å­æ•°ç»„å’Œé—®é¢˜ åŠ¨æ€è§„åˆ’ 198. æ‰“å®¶åŠ«èˆ dp[i] = max(dp[i-1], dp[i-2]+nums[i]) ç¯å½¢æ‰“å®¶åŠ«èˆã€çˆ¬æ¥¼æ¢¯å˜ä½“ åŠ¨æ€è§„åˆ’ 139. å•è¯æ‹†åˆ† dp[i] = dp[j] \u0026amp;\u0026amp; wordDict[j:i] å¥å­æ‹¼æ¥ã€åˆ†å‰²å­—ç¬¦ä¸²æœ€å°‘æ¬¡æ•° äºŒåˆ†æŸ¥æ‰¾ 33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ äºŒåˆ†åˆ¤å®šåŒºé—´æœ‰åºæ€§ æœç´¢å³°å€¼ã€æœ€å°å·®è·å€¼ DFS/BFS 200. å²›å±¿æ•°é‡ éå†è¿é€šå— å›¾éå†ã€å°é—­åŒºåŸŸæ•°é‡ã€æœ‹å‹åœˆé—®é¢˜ æ ‘ 104. äºŒå‰æ ‘æœ€å¤§æ·±åº¦ é€’å½’ DFS å¹³è¡¡äºŒå‰æ ‘ã€è·¯å¾„å’Œ æ ‘ 236. æœ€è¿‘å…¬å…±ç¥–å…ˆ ååºé€’å½’ ç›®å½•æ ‘è·¯å¾„ã€æœ€å°å…¬å…±èŠ‚ç‚¹ç±»é—®é¢˜ ä¸‰ã€åé¢˜è¿ç§»ç¤ºä¾‹ åŸé¢˜æ¨¡æ¿ é¢è¯•åé¢˜ä¸¾ä¾‹ è¿ç§»æ€è·¯ æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æœ€å¤šå…è®¸ä¸€ä¸ªé‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æ»‘åŠ¨çª—å£ + è®¡æ•°å¢åŠ ä¸€å±‚åˆ¤æ–­ ä¸‰æ•°ä¹‹å’Œ æ‰¾å‡ºæ‰€æœ‰å’Œä¸ºç›®æ ‡å€¼çš„ä¸‰å…ƒç»„ æ’åº + å»é‡ + åŒæŒ‡é’ˆï¼Œåªæ”¹ç›®æ ‡å€¼é€»è¾‘ æœ‰æ•ˆæ‹¬å· å­—ç¬¦ä¸²é‡Œåªæœ‰ \u0026lt; \u0026gt;ï¼Œè§„åˆ™ä¸åŒ æ›¿æ¢åŒ¹é…è§„åˆ™å³å¯ï¼Œæ ¸å¿ƒä»æ˜¯æ ˆ æ¯æ—¥æ¸©åº¦ æ±‚æ¯ä¸ªå…ƒç´ å³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„å…ƒç´  å•è°ƒé€’å¢æ ˆï¼Œæ–¹å‘åè½¬ æ‰“å®¶åŠ«èˆ ç¯å½¢æ’åˆ—çš„æˆ¿å±‹ æ‹†æˆä¸¤ç§æƒ…å†µï¼šä¸å·ç¬¬ä¸€ vs ä¸å·æœ€å å•è¯æ‹†åˆ† è®¡ç®—æ‰€æœ‰å¯è¡Œçš„æ‹†åˆ†æ–¹å¼ dp[i] çš„åŸºç¡€ä¸Šè®¡æ•°æˆ–å›æº¯ äºŒå‰æ ‘æœ€å¤§æ·±åº¦ åˆ¤æ–­æ˜¯å¦å¹³è¡¡äºŒå‰æ ‘ åœ¨è¿”å›æ·±åº¦çš„åŒæ—¶åˆ¤æ–­å·®å€¼ æœ€è¿‘å…¬å…±ç¥–å…ˆ N å‰æ ‘ç‰ˆæœ¬ é€’å½’é€»è¾‘ç›¸åŒï¼Œéå†å­èŠ‚ç‚¹ä»£æ›¿å·¦å³å­æ ‘ å››ã€é™Œç”Ÿé¢˜åˆ†ææ¡†æ¶ï¼ˆé¢è¯•å¿…å¤‡ï¼‰ æ±‚æœ€å€¼ â†’ è´ªå¿ƒ / åŠ¨æ€è§„åˆ’ æ±‚å­˜åœ¨ â†’ å“ˆå¸Œ / äºŒåˆ† æ±‚è·¯å¾„ / è¿é€š â†’ DFS / BFS æ±‚é…å¯¹ / åŒºé—´ â†’ åŒæŒ‡é’ˆ / æ»‘åŠ¨çª—å£ æš´åŠ›è§£ \u0026amp; å¤æ‚åº¦ å…ˆå†™æœ€ç›´æ¥æš´åŠ›è§£ï¼Œä½œä¸º fallback è€ƒè™‘ä¼˜åŒ–æ–¹å‘ï¼ˆæ’åº / å“ˆå¸Œ / åŒæŒ‡é’ˆï¼‰ æ˜¯å¦æœ‰é‡å¤å­é—®é¢˜ æœ‰ â†’ åŠ¨æ€è§„åˆ’ æ²¡æœ‰ â†’ è´ªå¿ƒæˆ–æš´åŠ›ä¼˜åŒ– è¾“å…¥ç»“æ„ æ•°ç»„ â†’ æ’åº / åŒæŒ‡é’ˆ çŸ©é˜µ â†’ DFS / BFS æ ‘ / å›¾ â†’ é€’å½’ / é˜Ÿåˆ— å†™ä¼ªä»£ç  å…ˆè®²æ€è·¯ï¼Œä»£ç åªæ˜¯å½¢å¼ é¢è¯•å®˜æ›´å…³æ³¨åˆ†æèƒ½åŠ› äº”ã€å¤ç›˜è®¡åˆ’ï¼ˆ3 å‘¨å‘¨æœŸï¼‰ å‘¨æ•° ç›®æ ‡ å†…å®¹ ç¬¬1å‘¨ æ¨¡æ¿å·©å›º å‰8é¢˜ï¼ˆæ•°ç»„ã€é“¾è¡¨ã€å“ˆå¸Œã€æ ˆï¼‰äºŒåˆ·ï¼Œå†™æ¨¡æ¿ç¬”è®° ç¬¬2å‘¨ åŠ¨æ€è§„åˆ’ \u0026amp; æ ‘ å7é¢˜äºŒåˆ·ï¼Œå½¢æˆ dp / æ ‘æ¨¡æ¿æ€»ç»“ ç¬¬3å‘¨ åé¢˜è¿ç§»è®­ç»ƒ æ¯å¤©æŠ½ä¸€é“é™Œç”Ÿé¢˜ï¼Œç”¨é™Œç”Ÿé¢˜åˆ†ææ¡†æ¶è§£é¢˜ï¼Œé‡ç‚¹ç»ƒæ€è·¯ï¼Œä¸è¿½å®Œç¾ å…­ã€Go å¼€å‘è€…æ¨¡æ¿ä»£ç ç¤ºä¾‹ // åŒæŒ‡é’ˆæ¨¡æ¿ func twoSum(nums []int, target int) []int { m := make(map[int]int) for i, v := range nums { if j, ok := m[target-v]; ok { return []int{j, i} } m[v] = i } return nil } // æ»‘åŠ¨çª—å£æ¨¡æ¿ func lengthOfLongestSubstring(s string) int { window := make(map[byte]int) left, right, res := 0, 0, 0 for right \u0026lt; len(s) { c := s[right] right++ window[c]++ for window[c] \u0026gt; 1 { d := s[left] left++ window[d]-- } if res \u0026lt; right-left { res = right - left } } return res } // map åˆå§‹åŒ– m := make(map[int]int) // set ç”¨æ³• set := map[int]bool{} set[x] = true if set[y] { ... } // priority queue æ¨¡æ¿ type Item struct{ value, priority int } type PQ []Item func (pq PQ) Len() int { return len(pq) } func (pq PQ) Less(i, j int) bool { return pq[i].priority \u0026lt; pq[j].priority } func (pq PQ) Swap(i, j int) { pq[i], pq[j] = pq[j], pq[i] } func (pq *PQ) Push(x any) { *pq = append(*pq, x.(Item)) } func (pq *PQ) Pop() any { old := *pq n := len(old) x := old[n-1] *pq = old[:n-1] return x } ä¸ƒã€æœ€ç»ˆç›®æ ‡ ä¸é â€œè®°é¢˜â€ï¼Œé â€œè¯†åˆ«ç»“æ„ + å¥—æ¨¡æ¿ + ä¸´åœºåˆ†æâ€ã€‚ åé¢˜ä¹Ÿèƒ½å¿«é€Ÿè¿ç§»æ€è·¯ï¼Œä¸æ…Œå¼ ã€‚ é¢è¯•æ—¶æœ‰åº•æ°”ï¼Œ3 åˆ†é’Ÿå°±èƒ½è®²æ¸…è§£é¢˜æ€è·¯ã€‚ ",
"content": "ä¸ªäººæ„Ÿæ‚Ÿå’Œå‰è¨€ åˆ·äº†å¾ˆå¤šé¢˜ï¼ˆå…¶å®ä¹Ÿä¸æ˜¯å¾ˆå¤šï¼Œä½†å´æ˜¯æ¯å¤©åšæŒåŠå°æ—¶åšæŒäº†ä¸€å¹´å¤šäº†ï¼‰ï¼Œ ä½†æ˜¯è€æ˜¯é¢è¯•çš„æ—¶å€™åšä¸å‡ºæ¥ï¼Œæˆ–è€…è¦èŠ±å¾ˆé•¿æ—¶é—´æ‰èƒ½åšå‡ºæ¥ã€‚æˆ‘éƒ½äº§ç”Ÿè‡ªæˆ‘æ€€ç–‘äº†ï¼Œæˆ‘è§‰å¾—æ˜¯æ—¶å€™æ¢ä¸ªæ–¹å¼äº†ã€‚ æˆ‘é—®äº†gpt,å®ƒç»™äº†æˆ‘å¾ˆå¤šå»ºè®®ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šæŒ‰ç…§ä¸‹é¢çš„æ–¹å¼é‡æ–°è§„åˆ’æˆ‘çš„å­¦ä¹ æ–¹æ³•\nä»¥ä¸‹å¤§å¤šæ•°å‚è€ƒäº†gpt\nå…·ä½“çš„åšæ³• æ ¸å¿ƒç›®æ ‡ ä¸€ã€æ ¸å¿ƒç›®æ ‡ ç”¨æœ€å°‘çš„é¢˜ï¼Œå»ºç«‹æœ€å¤§è¿ç§»åŠ›ã€‚ ç†Ÿç»ƒè¯†åˆ«æ¨¡æ¿ï¼Œèƒ½ä¸¾ä¸€åä¸‰ã€‚ é¢è¯•æ—¶ 3 åˆ†é’Ÿå†…èƒ½è®²æ¸…æ€è·¯ã€‚ é‡ç‚¹åœ¨æ¨¡å¼è¯†åˆ« + æ¨¡æ¿è¿ç§»ï¼Œä¸è¿½æ•°é‡ã€‚ äºŒã€15 é“æœ€å€¼å¾—å¤ç›˜çš„æ¨¡æ¿é¢˜ ç±»åˆ« LeetCodeé¢˜ç›® æ ¸å¿ƒæ¨¡æ¿ å¯è¿ç§»æ–¹å‘ åŒæŒ‡é’ˆ 15. ä¸‰æ•°ä¹‹å’Œ æ’åº + å»é‡ + å·¦å³å¤¹é€¼ kæ•°ä¹‹å’Œ / å·®å€¼æœ€æ¥è¿‘ / åˆ é™¤ä¸€ä¸ªå­—ç¬¦å˜å›æ–‡ åŒæŒ‡é’ˆ 11. ç››æœ€å¤šæ°´çš„å®¹å™¨ å·¦å³å¤¹é€¼å–æœ€å¤§é¢ç§¯ è‚¡ç¥¨ä¹°å–ã€æœ€ä¼˜åŒºé—´ç±»é—®é¢˜ æ»‘åŠ¨çª—å£ 3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æ‰©å±•çª—å£ + æ”¶ç¼©çª—å£ æœ€å°è¦†ç›–å­ä¸²ã€æœ€é•¿Kä¸ªä¸åŒå­—ç¬¦å­ä¸² å“ˆå¸Œ 1. ä¸¤æ•°ä¹‹å’Œ å“ˆå¸ŒåæŸ¥ ä¸‰æ•°ä¹‹å’Œã€å››æ•°ä¹‹å’Œã€è·¯å¾„æ±‚å’Œ æ ˆ 20. æœ‰æ•ˆçš„æ‹¬å· æ ˆåŒ¹é… HTMLæ ‡ç­¾éªŒè¯ã€æ ˆé€†åº å•è°ƒæ ˆ 739. æ¯æ—¥æ¸©åº¦ å•è°ƒé€’å‡æ ˆ ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ã€æŸ±çŠ¶å›¾æœ€å¤§çŸ©å½¢ é“¾è¡¨ 206. åè½¬é“¾è¡¨ æŒ‡é’ˆå‰ååè½¬ kç»„åè½¬ã€å›æ–‡é“¾è¡¨æ£€æµ‹ é“¾è¡¨ 141. ç¯å½¢é“¾è¡¨ å¿«æ…¢æŒ‡é’ˆ ç›¸äº¤é“¾è¡¨æ£€æµ‹ã€å¯»æ‰¾ç¯å…¥å£ åŠ¨æ€è§„åˆ’ 53. æœ€å¤§å­åºå’Œ dp[i] = max(nums[i], dp[i-1]+nums[i]) è‚¡ç¥¨æœ€å¤§åˆ©æ¶¦ã€å­æ•°ç»„å’Œé—®é¢˜ åŠ¨æ€è§„åˆ’ 198. æ‰“å®¶åŠ«èˆ dp[i] = max(dp[i-1], dp[i-2]+nums[i]) ç¯å½¢æ‰“å®¶åŠ«èˆã€çˆ¬æ¥¼æ¢¯å˜ä½“ åŠ¨æ€è§„åˆ’ 139. å•è¯æ‹†åˆ† dp[i] = dp[j] \u0026amp;\u0026amp; wordDict[j:i] å¥å­æ‹¼æ¥ã€åˆ†å‰²å­—ç¬¦ä¸²æœ€å°‘æ¬¡æ•° äºŒåˆ†æŸ¥æ‰¾ 33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ äºŒåˆ†åˆ¤å®šåŒºé—´æœ‰åºæ€§ æœç´¢å³°å€¼ã€æœ€å°å·®è·å€¼ DFS/BFS 200. å²›å±¿æ•°é‡ éå†è¿é€šå— å›¾éå†ã€å°é—­åŒºåŸŸæ•°é‡ã€æœ‹å‹åœˆé—®é¢˜ æ ‘ 104. äºŒå‰æ ‘æœ€å¤§æ·±åº¦ é€’å½’ DFS å¹³è¡¡äºŒå‰æ ‘ã€è·¯å¾„å’Œ æ ‘ 236. æœ€è¿‘å…¬å…±ç¥–å…ˆ ååºé€’å½’ ç›®å½•æ ‘è·¯å¾„ã€æœ€å°å…¬å…±èŠ‚ç‚¹ç±»é—®é¢˜ ä¸‰ã€åé¢˜è¿ç§»ç¤ºä¾‹ åŸé¢˜æ¨¡æ¿ é¢è¯•åé¢˜ä¸¾ä¾‹ è¿ç§»æ€è·¯ æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æœ€å¤šå…è®¸ä¸€ä¸ªé‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æ»‘åŠ¨çª—å£ + è®¡æ•°å¢åŠ ä¸€å±‚åˆ¤æ–­ ä¸‰æ•°ä¹‹å’Œ æ‰¾å‡ºæ‰€æœ‰å’Œä¸ºç›®æ ‡å€¼çš„ä¸‰å…ƒç»„ æ’åº + å»é‡ + åŒæŒ‡é’ˆï¼Œåªæ”¹ç›®æ ‡å€¼é€»è¾‘ æœ‰æ•ˆæ‹¬å· å­—ç¬¦ä¸²é‡Œåªæœ‰ \u0026lt; \u0026gt;ï¼Œè§„åˆ™ä¸åŒ æ›¿æ¢åŒ¹é…è§„åˆ™å³å¯ï¼Œæ ¸å¿ƒä»æ˜¯æ ˆ æ¯æ—¥æ¸©åº¦ æ±‚æ¯ä¸ªå…ƒç´ å³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„å…ƒç´  å•è°ƒé€’å¢æ ˆï¼Œæ–¹å‘åè½¬ æ‰“å®¶åŠ«èˆ ç¯å½¢æ’åˆ—çš„æˆ¿å±‹ æ‹†æˆä¸¤ç§æƒ…å†µï¼šä¸å·ç¬¬ä¸€ vs ä¸å·æœ€å å•è¯æ‹†åˆ† è®¡ç®—æ‰€æœ‰å¯è¡Œçš„æ‹†åˆ†æ–¹å¼ dp[i] çš„åŸºç¡€ä¸Šè®¡æ•°æˆ–å›æº¯ äºŒå‰æ ‘æœ€å¤§æ·±åº¦ åˆ¤æ–­æ˜¯å¦å¹³è¡¡äºŒå‰æ ‘ åœ¨è¿”å›æ·±åº¦çš„åŒæ—¶åˆ¤æ–­å·®å€¼ æœ€è¿‘å…¬å…±ç¥–å…ˆ N å‰æ ‘ç‰ˆæœ¬ é€’å½’é€»è¾‘ç›¸åŒï¼Œéå†å­èŠ‚ç‚¹ä»£æ›¿å·¦å³å­æ ‘ å››ã€é™Œç”Ÿé¢˜åˆ†ææ¡†æ¶ï¼ˆé¢è¯•å¿…å¤‡ï¼‰ æ±‚æœ€å€¼ â†’ è´ªå¿ƒ / åŠ¨æ€è§„åˆ’ æ±‚å­˜åœ¨ â†’ å“ˆå¸Œ / äºŒåˆ† æ±‚è·¯å¾„ / è¿é€š â†’ DFS / BFS æ±‚é…å¯¹ / åŒºé—´ â†’ åŒæŒ‡é’ˆ / æ»‘åŠ¨çª—å£ æš´åŠ›è§£ \u0026amp; å¤æ‚åº¦ å…ˆå†™æœ€ç›´æ¥æš´åŠ›è§£ï¼Œä½œä¸º fallback è€ƒè™‘ä¼˜åŒ–æ–¹å‘ï¼ˆæ’åº / å“ˆå¸Œ / åŒæŒ‡é’ˆï¼‰ æ˜¯å¦æœ‰é‡å¤å­é—®é¢˜ æœ‰ â†’ åŠ¨æ€è§„åˆ’ æ²¡æœ‰ â†’ è´ªå¿ƒæˆ–æš´åŠ›ä¼˜åŒ– è¾“å…¥ç»“æ„ æ•°ç»„ â†’ æ’åº / åŒæŒ‡é’ˆ çŸ©é˜µ â†’ DFS / BFS æ ‘ / å›¾ â†’ é€’å½’ / é˜Ÿåˆ— å†™ä¼ªä»£ç  å…ˆè®²æ€è·¯ï¼Œä»£ç åªæ˜¯å½¢å¼ é¢è¯•å®˜æ›´å…³æ³¨åˆ†æèƒ½åŠ› äº”ã€å¤ç›˜è®¡åˆ’ï¼ˆ3 å‘¨å‘¨æœŸï¼‰ å‘¨æ•° ç›®æ ‡ å†…å®¹ ç¬¬1å‘¨ æ¨¡æ¿å·©å›º å‰8é¢˜ï¼ˆæ•°ç»„ã€é“¾è¡¨ã€å“ˆå¸Œã€æ ˆï¼‰äºŒåˆ·ï¼Œå†™æ¨¡æ¿ç¬”è®° ç¬¬2å‘¨ åŠ¨æ€è§„åˆ’ \u0026amp; æ ‘ å7é¢˜äºŒåˆ·ï¼Œå½¢æˆ dp / æ ‘æ¨¡æ¿æ€»ç»“ ç¬¬3å‘¨ åé¢˜è¿ç§»è®­ç»ƒ æ¯å¤©æŠ½ä¸€é“é™Œç”Ÿé¢˜ï¼Œç”¨é™Œç”Ÿé¢˜åˆ†ææ¡†æ¶è§£é¢˜ï¼Œé‡ç‚¹ç»ƒæ€è·¯ï¼Œä¸è¿½å®Œç¾ å…­ã€Go å¼€å‘è€…æ¨¡æ¿ä»£ç ç¤ºä¾‹ // åŒæŒ‡é’ˆæ¨¡æ¿ func twoSum(nums []int, target int) []int { m := make(map[int]int) for i, v := range nums { if j, ok := m[target-v]; ok { return []int{j, i} } m[v] = i } return nil } // æ»‘åŠ¨çª—å£æ¨¡æ¿ func lengthOfLongestSubstring(s string) int { window := make(map[byte]int) left, right, res := 0, 0, 0 for right \u0026lt; len(s) { c := s[right] right++ window[c]++ for window[c] \u0026gt; 1 { d := s[left] left++ window[d]-- } if res \u0026lt; right-left { res = right - left } } return res } // map åˆå§‹åŒ– m := make(map[int]int) // set ç”¨æ³• set := map[int]bool{} set[x] = true if set[y] { ... } // priority queue æ¨¡æ¿ type Item struct{ value, priority int } type PQ []Item func (pq PQ) Len() int { return len(pq) } func (pq PQ) Less(i, j int) bool { return pq[i].priority \u0026lt; pq[j].priority } func (pq PQ) Swap(i, j int) { pq[i], pq[j] = pq[j], pq[i] } func (pq *PQ) Push(x any) { *pq = append(*pq, x.(Item)) } func (pq *PQ) Pop() any { old := *pq n := len(old) x := old[n-1] *pq = old[:n-1] return x } ä¸ƒã€æœ€ç»ˆç›®æ ‡ ä¸é â€œè®°é¢˜â€ï¼Œé â€œè¯†åˆ«ç»“æ„ + å¥—æ¨¡æ¿ + ä¸´åœºåˆ†æâ€ã€‚ åé¢˜ä¹Ÿèƒ½å¿«é€Ÿè¿ç§»æ€è·¯ï¼Œä¸æ…Œå¼ ã€‚ é¢è¯•æ—¶æœ‰åº•æ°”ï¼Œ3 åˆ†é’Ÿå°±èƒ½è®²æ¸…è§£é¢˜æ€è·¯ã€‚ ",
"tags":null,
"categories":null
},{
"title":"å¦‚ä½•åˆ¤æ–­ç½‘ç»œçŠ¶å†µ",
"permalink": "http://localhost:1313/posts/scenario/%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E7%BD%91%E7%BB%9C%E7%8A%B6%E5%86%B5/",
"summary": "",
"content": "",
"tags":null,
"categories":null
},{
"title":"Sqlè°ƒä¼˜",
"permalink": "http://localhost:1313/posts/scenario/sql%E8%B0%83%E4%BC%98/",
"summary": "mySqlè°ƒä¼˜ å‚è€ƒèµ„æ–™ https://www.yuque.com/everglow-8bs2d/ka5fze/inbyrpn5weudx226?singleDoc# ",
"content": "mySqlè°ƒä¼˜ å‚è€ƒèµ„æ–™ https://www.yuque.com/everglow-8bs2d/ka5fze/inbyrpn5weudx226?singleDoc# ",
"tags":null,
"categories":null
},{
"title":"Link_åˆå¹¶å‡åºé“¾è¡¨",
"permalink": "http://localhost:1313/posts/datastructalgorithm/link_%E5%90%88%E5%B9%B6%E5%8D%87%E5%BA%8F%E9%93%BE%E8%A1%A8/",
"summary": "package main import \u0026#34;fmt\u0026#34; func main() { //ä¸¤ä¸ªå‡åºé“¾è¡¨åˆå¹¶ä¸€ä¸ªæ–°çš„å‡åºé“¾è¡¨ link1 := NewLink() link1.head.next = \u0026amp;node{ value: 1, next: \u0026amp;node{next: \u0026amp;node{ value: 4, }, value: 3}, } link2 := NewLink() link2.head.next = \u0026amp;node{ value: 2, next: \u0026amp;node{next: \u0026amp;node{ value: 6, }, value: 5}, } newLink := mergerSortLink(link1, link2) fmt.Println(newLink) head := newLink.head.next for head != nil { fmt.Println(head.value) head = head.next } } func mergerSortLink(link1, link2 *Link) *Link { // æ’å…¥ newNode := \u0026amp;node{} newLink := \u0026amp;Link{ head: newNode, } head1 := link1.head.next head2 := link2.head.next for head1 != nil \u0026amp;\u0026amp; head2 != nil { if head1.value \u0026lt; head2.value { newNode.next = head1 newNode = head1 head1 = head1.next } else { newNode.next = head2 newNode = head2 head2 = head2.next } } // if head1 != nil { newNode.next = head1 } if head2 != nil { newNode.next = head2 } return newLink } type Link struct { head *node } type node struct { value int next *node } func NewLink() *Link { return \u0026amp;Link{ head: \u0026amp;node{}, } } ``` ",
"content": "package main import \u0026#34;fmt\u0026#34; func main() { //ä¸¤ä¸ªå‡åºé“¾è¡¨åˆå¹¶ä¸€ä¸ªæ–°çš„å‡åºé“¾è¡¨ link1 := NewLink() link1.head.next = \u0026amp;node{ value: 1, next: \u0026amp;node{next: \u0026amp;node{ value: 4, }, value: 3}, } link2 := NewLink() link2.head.next = \u0026amp;node{ value: 2, next: \u0026amp;node{next: \u0026amp;node{ value: 6, }, value: 5}, } newLink := mergerSortLink(link1, link2) fmt.Println(newLink) head := newLink.head.next for head != nil { fmt.Println(head.value) head = head.next } } func mergerSortLink(link1, link2 *Link) *Link { // æ’å…¥ newNode := \u0026amp;node{} newLink := \u0026amp;Link{ head: newNode, } head1 := link1.head.next head2 := link2.head.next for head1 != nil \u0026amp;\u0026amp; head2 != nil { if head1.value \u0026lt; head2.value { newNode.next = head1 newNode = head1 head1 = head1.next } else { newNode.next = head2 newNode = head2 head2 = head2.next } } // if head1 != nil { newNode.next = head1 } if head2 != nil { newNode.next = head2 } return newLink } type Link struct { head *node } type node struct { value int next *node } func NewLink() *Link { return \u0026amp;Link{ head: \u0026amp;node{}, } } ``` ",
"tags":null,
"categories":null
},{
"title":"Str_æ»‘åŠ¨çª—å£",
"permalink": "http://localhost:1313/posts/datastructalgorithm/str_%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/",
"summary": "ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦\npackage main import ( \u0026#34;fmt\u0026#34; ) func main() { //ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦ã€‚ //è¾“å…¥: s = \u0026#34;abcabcbb\u0026#34; //è¾“å‡º: 3 //è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ \u0026#34;abc\u0026#34;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚ s := \u0026#34;abcabcbb\u0026#34; //s := \u0026#34;abcbcbb\u0026#34; res := getSubStr(s) fmt.Println(res) } func getSubStr(s string) int { res, left := 0, 0 check := make(map[byte]int) n := len(s) for right := 0; right \u0026lt; n; right++ { if index, ok := check[s[right]]; ok \u0026amp;\u0026amp; index \u0026gt;= left { left = index + 1 } check[s[right]] = right res = Max(res, right-left+1) } return res } func Max(a, b int) int { if a \u0026gt; b { return a } return b } ``` ",
"content": "ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦\npackage main import ( \u0026#34;fmt\u0026#34; ) func main() { //ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦ã€‚ //è¾“å…¥: s = \u0026#34;abcabcbb\u0026#34; //è¾“å‡º: 3 //è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ \u0026#34;abc\u0026#34;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚ s := \u0026#34;abcabcbb\u0026#34; //s := \u0026#34;abcbcbb\u0026#34; res := getSubStr(s) fmt.Println(res) } func getSubStr(s string) int { res, left := 0, 0 check := make(map[byte]int) n := len(s) for right := 0; right \u0026lt; n; right++ { if index, ok := check[s[right]]; ok \u0026amp;\u0026amp; index \u0026gt;= left { left = index + 1 } check[s[right]] = right res = Max(res, right-left+1) } return res } func Max(a, b int) int { if a \u0026gt; b { return a } return b } ``` ",
"tags":null,
"categories":null
},{
"title":"GMP",
"permalink": "http://localhost:1313/posts/go/gmp/",
"summary": "ä»€ä¹ˆæ˜¯GMP æ¦‚å¿µ GMPæ˜¯goçš„åç¨‹è°ƒåº¦æ¨¡å‹ï¼Œgoä»£ç çš„ç¨‹åºæœ‰è¿è¡Œæ—¶runtimeè¿›è¡Œè°ƒåº¦ï¼Œgoå¯ä»¥é€šè¿‡è¿è¡Œæ—¶è¿›è¡Œå†…å­˜çš„åˆ†é…ï¼Œé€šè¿‡channelè¿›è¡Œåç¨‹é—´é€šä¿¡ï¼Œé€šè¿‡goå…³é”®å­—åˆ›å»ºåç¨‹ã€‚ è€ŒGMPæ­£æ˜¯åç¨‹è°ƒåº¦çš„æ ¸å¿ƒã€‚\nGä»£è¡¨goçš„goroutine,åç¨‹æ˜¯ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œåˆ›å»ºé”€æ¯çš„æˆæœ¬éå¸¸å°ï¼Œåªéœ€è¦å¤§çº¦2kbï¼Œè€Œçº¿ç¨‹åˆ™éœ€è¦2m,æ‰€ä»¥goçš„åç¨‹éå¸¸é€‚åˆå¤„ç†IOå¯†é›†å‹ä»»åŠ¡ã€‚ Mä»£è¡¨ç³»ç»Ÿçº§çº¿ç¨‹ï¼Œgoçš„åç¨‹å¹¶ä¸çœŸæ­£æ‰§è¡Œä»£ç ï¼Œå®ƒéœ€è¦å°†åç¨‹è°ƒåº¦åˆ°å’Œå†…æ ¸ç»‘å®šçš„ç³»ç»Ÿçº§çº¿ç¨‹ä¸Šè¿›è¡Œå®é™…çš„è¿è¡Œã€‚ Pä»£è¡¨é€»è¾‘å¤„ç†å•å…ƒï¼ŒåŒ…å«äº†å¾…è¿è¡Œçš„åç¨‹å’Œä¸€äº›ä¸Šä¸‹æ–‡ã€‚påˆå¯ä»¥åˆ†ä¸ºæœ¬åœ°é˜Ÿåˆ—å’Œå…¨å±€é˜Ÿåˆ—ã€‚ è°ƒåº¦è¿‡ç¨‹ goçš„ç¨‹åºé€šè¿‡runtimeåˆ›å»ºåç¨‹\nå°†åç¨‹æ”¾åˆ°æœ¬åœ°é˜Ÿåˆ—p på’Œmç»‘å®š måœ¨æ“ä½œç³»ç»Ÿä¸Šæ‰§è¡Œ æ ¸å¿ƒè°ƒåº¦æ—¶æœº ç”¨æˆ·æ€æ€é˜»å¡ï¼Œæ¯”å¦‚channelã€mutexï¼Œè¿™ä¸ªæ—¶å€™pä¼šå’Œmè„±ç¦»ï¼Œpä¼šæ”¾å…¥åˆ°å¾…è¿è¡Œé˜Ÿåˆ—ï¼Œæˆ–è€…é‡æ–°ç»‘å®šå…¶ä»–m å†…æ ¸æ€é˜»å¡ï¼Œæ¯”å¦‚å‘ç”Ÿäº†ç³»ç»Ÿè°ƒç”¨ï¼Œioæ“ä½œç­‰ï¼Œmä¼šè¢«æ ‡è®°æˆé˜»å¡çŠ¶æ€ï¼Œgoä¼šé‡æ–°åˆ›å»ºåè€…å”¤é†’ä¸€ä¸ªmï¼Œä¿è¯å¹¶å‘åº¦ å…¶ä»–æ ¸å¿ƒæ¦‚å¿µ ruetime.GOMAXPROCS() ä¼˜åŒ–æ‰‹æ®µ è¿›é˜¶ï¼ˆgptç‰ˆæœ¬ï¼‰ GMP è°ƒåº¦çš„å®Œæ•´æµç¨‹ã€è®¾è®¡æ€æƒ³ï¼Œä»¥åŠå®ƒå¦‚ä½•è§£å†³äº†å…³é”®é—®é¢˜ï¼ˆå¦‚é˜»å¡ã€æŠ¢å ï¼‰ã€‚\nä¸€ã€ ä»€ä¹ˆæ˜¯ GMP æ¨¡å‹ï¼Ÿï¼ˆé«˜å±‚æ¦‚æ‹¬ï¼‰ é¢è¯•å®˜é—®â€œè¯´ä¸‹GMPâ€ï¼Œä½ å¯ä»¥å…ˆç»™ä¸€ä¸ªé«˜å±‚å®šä¹‰ï¼Œç‚¹å‡ºå®ƒçš„æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼šè§£è€¦å’Œå¤ç”¨ã€‚\nå›ç­”èŒƒä¾‹ï¼š\nGMP æ˜¯ Go è¯­è¨€è¿è¡Œæ—¶çš„æ ¸å¿ƒè°ƒåº¦æ¨¡å‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨æˆ·æ€çš„ã€M:N çš„å¹¶å‘è°ƒåº¦å™¨ã€‚\nM:N æŒ‡çš„æ˜¯å®ƒå°† M ä¸ª Goroutineï¼ˆGï¼‰è°ƒåº¦åˆ° N ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼ˆMï¼‰ä¸Šæ‰§è¡Œã€‚ å®ƒçš„æ ¸å¿ƒè®¾è®¡æ€æƒ³æ˜¯è§£è€¦ï¼š Gï¼ˆGoroutineï¼‰ï¼š ä»£è¡¨ä¸€ä¸ªå¹¶å‘ä»»åŠ¡ã€‚å®ƒéå¸¸è½»é‡ï¼ˆåˆå§‹æ ˆ 2KBï¼‰ï¼Œç”± Go Runtime ç®¡ç†ï¼Œåˆ‡æ¢æˆæœ¬è¿œä½äºçº¿ç¨‹ã€‚ Mï¼ˆMachineï¼‰ï¼š ä»£è¡¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚å®ƒæ˜¯çœŸæ­£æ‰§è¡Œè®¡ç®—çš„â€œå·¥äººâ€ã€‚ Pï¼ˆProcessorï¼‰ï¼š ä»£è¡¨ä¸€ä¸ªé€»è¾‘å¤„ç†å™¨ï¼Œæˆ–è€…è¯´æ˜¯â€œCPU æ ¸å¿ƒâ€ã€‚P æ˜¯ G å’Œ M ä¹‹é—´çš„â€œä¸Šä¸‹æ–‡â€æˆ–â€œè°ƒåº¦å™¨â€ã€‚M å¿…é¡»æŒæœ‰ P æ‰èƒ½æ‰§è¡Œ Gã€‚ GMP æ¨¡å‹çš„ç²¾å¦™ä¹‹å¤„åœ¨äº Pï¼Œå®ƒä½œä¸ºä¸­é—´å±‚ï¼Œå®ç°äº† Goroutine å’Œ OS çº¿ç¨‹çš„è§£è€¦ã€‚è¿™å¸¦æ¥äº†ä¸¤å¤§å¥½å¤„ï¼š\né«˜æ•ˆå¤ç”¨ï¼ˆM:Nï¼‰ï¼š Mï¼ˆçº¿ç¨‹ï¼‰çš„æ•°é‡å¯ä»¥è¿œå°äº Gï¼ˆä»»åŠ¡ï¼‰çš„æ•°é‡ã€‚Go é»˜è®¤è®© P çš„æ•°é‡ï¼ˆGOMAXPROCSï¼‰ç­‰äº CPU æ ¸å¿ƒæ•°ï¼Œä½¿å¾— M:N è°ƒåº¦èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸ï¼ŒåŒæ—¶é¿å…äº†å¤§é‡çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ã€‚ æ™ºèƒ½è°ƒåº¦ï¼š é€šè¿‡ P çš„æœ¬åœ°é˜Ÿåˆ—å’Œ P ä¹‹é—´çš„å·¥ä½œçªƒå– (Work Stealing) æœºåˆ¶ï¼Œå®ç°äº†é«˜æ•ˆçš„è´Ÿè½½å‡è¡¡ã€‚ äºŒã€ GMP è°ƒåº¦çš„æ ¸å¿ƒæµç¨‹ï¼ˆé¢è¯•é‡ç‚¹ï¼‰ è¿™éƒ¨åˆ†æ˜¯é¢è¯•çš„â€œæ·±æ°´åŒºâ€ï¼Œä½ éœ€è¦æ¸…æ™°åœ°æè¿° Gã€Mã€P æ˜¯å¦‚ä½•ååŒå·¥ä½œçš„ã€‚\n",
"content": "ä»€ä¹ˆæ˜¯GMP æ¦‚å¿µ GMPæ˜¯goçš„åç¨‹è°ƒåº¦æ¨¡å‹ï¼Œgoä»£ç çš„ç¨‹åºæœ‰è¿è¡Œæ—¶runtimeè¿›è¡Œè°ƒåº¦ï¼Œgoå¯ä»¥é€šè¿‡è¿è¡Œæ—¶è¿›è¡Œå†…å­˜çš„åˆ†é…ï¼Œé€šè¿‡channelè¿›è¡Œåç¨‹é—´é€šä¿¡ï¼Œé€šè¿‡goå…³é”®å­—åˆ›å»ºåç¨‹ã€‚ è€ŒGMPæ­£æ˜¯åç¨‹è°ƒåº¦çš„æ ¸å¿ƒã€‚\nGä»£è¡¨goçš„goroutine,åç¨‹æ˜¯ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œåˆ›å»ºé”€æ¯çš„æˆæœ¬éå¸¸å°ï¼Œåªéœ€è¦å¤§çº¦2kbï¼Œè€Œçº¿ç¨‹åˆ™éœ€è¦2m,æ‰€ä»¥goçš„åç¨‹éå¸¸é€‚åˆå¤„ç†IOå¯†é›†å‹ä»»åŠ¡ã€‚ Mä»£è¡¨ç³»ç»Ÿçº§çº¿ç¨‹ï¼Œgoçš„åç¨‹å¹¶ä¸çœŸæ­£æ‰§è¡Œä»£ç ï¼Œå®ƒéœ€è¦å°†åç¨‹è°ƒåº¦åˆ°å’Œå†…æ ¸ç»‘å®šçš„ç³»ç»Ÿçº§çº¿ç¨‹ä¸Šè¿›è¡Œå®é™…çš„è¿è¡Œã€‚ Pä»£è¡¨é€»è¾‘å¤„ç†å•å…ƒï¼ŒåŒ…å«äº†å¾…è¿è¡Œçš„åç¨‹å’Œä¸€äº›ä¸Šä¸‹æ–‡ã€‚påˆå¯ä»¥åˆ†ä¸ºæœ¬åœ°é˜Ÿåˆ—å’Œå…¨å±€é˜Ÿåˆ—ã€‚ è°ƒåº¦è¿‡ç¨‹ goçš„ç¨‹åºé€šè¿‡runtimeåˆ›å»ºåç¨‹\nå°†åç¨‹æ”¾åˆ°æœ¬åœ°é˜Ÿåˆ—p på’Œmç»‘å®š måœ¨æ“ä½œç³»ç»Ÿä¸Šæ‰§è¡Œ æ ¸å¿ƒè°ƒåº¦æ—¶æœº ç”¨æˆ·æ€æ€é˜»å¡ï¼Œæ¯”å¦‚channelã€mutexï¼Œè¿™ä¸ªæ—¶å€™pä¼šå’Œmè„±ç¦»ï¼Œpä¼šæ”¾å…¥åˆ°å¾…è¿è¡Œé˜Ÿåˆ—ï¼Œæˆ–è€…é‡æ–°ç»‘å®šå…¶ä»–m å†…æ ¸æ€é˜»å¡ï¼Œæ¯”å¦‚å‘ç”Ÿäº†ç³»ç»Ÿè°ƒç”¨ï¼Œioæ“ä½œç­‰ï¼Œmä¼šè¢«æ ‡è®°æˆé˜»å¡çŠ¶æ€ï¼Œgoä¼šé‡æ–°åˆ›å»ºåè€…å”¤é†’ä¸€ä¸ªmï¼Œä¿è¯å¹¶å‘åº¦ å…¶ä»–æ ¸å¿ƒæ¦‚å¿µ ruetime.GOMAXPROCS() ä¼˜åŒ–æ‰‹æ®µ è¿›é˜¶ï¼ˆgptç‰ˆæœ¬ï¼‰ GMP è°ƒåº¦çš„å®Œæ•´æµç¨‹ã€è®¾è®¡æ€æƒ³ï¼Œä»¥åŠå®ƒå¦‚ä½•è§£å†³äº†å…³é”®é—®é¢˜ï¼ˆå¦‚é˜»å¡ã€æŠ¢å ï¼‰ã€‚\nä¸€ã€ ä»€ä¹ˆæ˜¯ GMP æ¨¡å‹ï¼Ÿï¼ˆé«˜å±‚æ¦‚æ‹¬ï¼‰ é¢è¯•å®˜é—®â€œè¯´ä¸‹GMPâ€ï¼Œä½ å¯ä»¥å…ˆç»™ä¸€ä¸ªé«˜å±‚å®šä¹‰ï¼Œç‚¹å‡ºå®ƒçš„æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼šè§£è€¦å’Œå¤ç”¨ã€‚\nå›ç­”èŒƒä¾‹ï¼š\nGMP æ˜¯ Go è¯­è¨€è¿è¡Œæ—¶çš„æ ¸å¿ƒè°ƒåº¦æ¨¡å‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨æˆ·æ€çš„ã€M:N çš„å¹¶å‘è°ƒåº¦å™¨ã€‚\nM:N æŒ‡çš„æ˜¯å®ƒå°† M ä¸ª Goroutineï¼ˆGï¼‰è°ƒåº¦åˆ° N ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼ˆMï¼‰ä¸Šæ‰§è¡Œã€‚ å®ƒçš„æ ¸å¿ƒè®¾è®¡æ€æƒ³æ˜¯è§£è€¦ï¼š Gï¼ˆGoroutineï¼‰ï¼š ä»£è¡¨ä¸€ä¸ªå¹¶å‘ä»»åŠ¡ã€‚å®ƒéå¸¸è½»é‡ï¼ˆåˆå§‹æ ˆ 2KBï¼‰ï¼Œç”± Go Runtime ç®¡ç†ï¼Œåˆ‡æ¢æˆæœ¬è¿œä½äºçº¿ç¨‹ã€‚ Mï¼ˆMachineï¼‰ï¼š ä»£è¡¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚å®ƒæ˜¯çœŸæ­£æ‰§è¡Œè®¡ç®—çš„â€œå·¥äººâ€ã€‚ Pï¼ˆProcessorï¼‰ï¼š ä»£è¡¨ä¸€ä¸ªé€»è¾‘å¤„ç†å™¨ï¼Œæˆ–è€…è¯´æ˜¯â€œCPU æ ¸å¿ƒâ€ã€‚P æ˜¯ G å’Œ M ä¹‹é—´çš„â€œä¸Šä¸‹æ–‡â€æˆ–â€œè°ƒåº¦å™¨â€ã€‚M å¿…é¡»æŒæœ‰ P æ‰èƒ½æ‰§è¡Œ Gã€‚ GMP æ¨¡å‹çš„ç²¾å¦™ä¹‹å¤„åœ¨äº Pï¼Œå®ƒä½œä¸ºä¸­é—´å±‚ï¼Œå®ç°äº† Goroutine å’Œ OS çº¿ç¨‹çš„è§£è€¦ã€‚è¿™å¸¦æ¥äº†ä¸¤å¤§å¥½å¤„ï¼š\né«˜æ•ˆå¤ç”¨ï¼ˆM:Nï¼‰ï¼š Mï¼ˆçº¿ç¨‹ï¼‰çš„æ•°é‡å¯ä»¥è¿œå°äº Gï¼ˆä»»åŠ¡ï¼‰çš„æ•°é‡ã€‚Go é»˜è®¤è®© P çš„æ•°é‡ï¼ˆGOMAXPROCSï¼‰ç­‰äº CPU æ ¸å¿ƒæ•°ï¼Œä½¿å¾— M:N è°ƒåº¦èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸ï¼ŒåŒæ—¶é¿å…äº†å¤§é‡çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ã€‚ æ™ºèƒ½è°ƒåº¦ï¼š é€šè¿‡ P çš„æœ¬åœ°é˜Ÿåˆ—å’Œ P ä¹‹é—´çš„å·¥ä½œçªƒå– (Work Stealing) æœºåˆ¶ï¼Œå®ç°äº†é«˜æ•ˆçš„è´Ÿè½½å‡è¡¡ã€‚ äºŒã€ GMP è°ƒåº¦çš„æ ¸å¿ƒæµç¨‹ï¼ˆé¢è¯•é‡ç‚¹ï¼‰ è¿™éƒ¨åˆ†æ˜¯é¢è¯•çš„â€œæ·±æ°´åŒºâ€ï¼Œä½ éœ€è¦æ¸…æ™°åœ°æè¿° Gã€Mã€P æ˜¯å¦‚ä½•ååŒå·¥ä½œçš„ã€‚\n1. æ­£å¸¸æ‰§è¡Œä¸åˆ›å»º (Happy Path) å¯åŠ¨ï¼š Go Runtime ä¼šåˆ›å»º GOMAXPROCS ä¸ª Pã€‚ ç»‘å®šï¼š ä¸€ä¸ª M å¿…é¡»è·å–ä¸€ä¸ª P æ‰èƒ½å¼€å§‹æ‰§è¡Œã€‚ æ‰¾ä»»åŠ¡ï¼š M ä¼šä»å®ƒç»‘å®šçš„ P çš„æœ¬åœ°å¯è¿è¡Œé˜Ÿåˆ—ï¼ˆLRQ, Local Run Queueï¼‰ ä¸­å¼¹å‡ºä¸€ä¸ª Gã€‚ æ‰§è¡Œï¼š M æ‰§è¡Œè¿™ä¸ª Gã€‚ go func()ï¼š å½“ä¸€ä¸ª G æ‰§è¡Œ go func() åˆ›å»ºæ–° G æ—¶ï¼Œè¿™ä¸ªæ–° G ä¼˜å…ˆè¢«æ”¾å…¥å½“å‰ P çš„ LRQã€‚å¦‚æœ LRQ æ»¡äº†ï¼Œæ‰ä¼šæº¢å‡ºåˆ°å…¨å±€é˜Ÿåˆ—ï¼ˆGRQ, Global Run Queueï¼‰ã€‚ 2. å·¥ä½œçªƒå– (Work Stealing)ï¼ˆè§£å†³Pé¥¥é¥¿ï¼‰ é¢è¯•å®˜è¿½é—®ï¼š â€œå¦‚æœä¸€ä¸ª P çš„æœ¬åœ°é˜Ÿåˆ—ç©ºäº†ï¼Œå®ƒç»‘å®šçš„ M ä¼šåšä»€ä¹ˆï¼Ÿâ€\nå›ç­”ï¼š è¿™ä¼šè§¦å‘å·¥ä½œçªƒå–ï¼ˆWork Stealingï¼‰ï¼š\nå½“å‰ Mï¼ˆæŒæœ‰ P1ï¼‰å‘ç° P1 çš„ LRQ ä¸ºç©ºã€‚ M ä¸ä¼šä¼‘çœ ï¼Œå®ƒä¼šä»£è¡¨ P1 å»éšæœºåœ°â€œå·â€å¦ä¸€ä¸ª Pï¼ˆæ¯”å¦‚ P2ï¼‰çš„ LRQã€‚ å®ƒä¼šå°è¯•ä» P2 çš„ LRQ é˜Ÿå°¾ï¼ˆæ³¨æ„ï¼šæ˜¯é˜Ÿå°¾ï¼Œä¿è¯å…¬å¹³æ€§ï¼‰å·èµ°ä¸€åŠçš„ G æ”¾åˆ° P1 çš„ LRQ ä¸­ã€‚ å¦‚æœå·ä¸åˆ°ï¼ˆæ‰€æœ‰ P éƒ½ç©ºäº†ï¼‰ï¼Œå®ƒä¼šå°è¯•ä» GRQ è·å–ä»»åŠ¡ã€‚ å¦‚æœ GRQ ä¹Ÿä¸ºç©ºï¼ŒM æœ€ç»ˆä¼šæ”¾å¼ƒ Pï¼ŒM è‡ªèº«è¿›å…¥ä¼‘çœ ï¼ˆè‡ªæ—‹ç­‰å¾…æˆ–æŒ‚èµ·ï¼‰ï¼ŒP è¢«æ ‡è®°ä¸ºç©ºé—²ã€‚ è®¾è®¡æ€æƒ³ï¼š å·¥ä½œçªƒå–æ˜¯ GMP å®ç°é«˜ååå’Œè´Ÿè½½å‡è¡¡çš„å…³é”®ã€‚å®ƒè®© M å§‹ç»ˆä¿æŒâ€œå¿™ç¢Œâ€ï¼Œé¿å…äº† CPU èµ„æºçš„æµªè´¹ã€‚\n3. é˜»å¡å¤„ç† (Syscall)ï¼ˆGMPæœ€ç²¾å¦™çš„è®¾è®¡ä¹‹ä¸€ï¼‰ é¢è¯•å®˜é«˜é¢‘è¿½é—®ï¼š â€œå¦‚æœä¸€ä¸ª G å‘ç”Ÿäº†é˜»å¡çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆæ¯”å¦‚ CGO æˆ–æ–‡ä»¶ IOï¼‰ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä¼šé˜»å¡ M å—ï¼Ÿâ€\nå›ç­”ï¼š è¿™æ˜¯ GMP æ¨¡å‹çš„å…³é”®ä¼˜åŠ¿ã€‚Go å°†ç³»ç»Ÿè°ƒç”¨åˆ†ä¸ºé˜»å¡å‹å’Œéé˜»å¡å‹ï¼ˆå¦‚ç½‘ç»œ IOï¼Œç”± netpoller å†…éƒ¨å¤„ç†ï¼ŒG ä¼šè¢«æŒ‚èµ·ï¼ŒM ä¸é˜»å¡ï¼‰ã€‚\nå¯¹äºé˜»å¡å‹ç³»ç»Ÿè°ƒç”¨ (Blocking Syscall)ï¼š\nGï¼ˆG1ï¼‰åœ¨ M1 ä¸Šæ‰§è¡Œï¼Œå³å°†å‘ç”Ÿé˜»å¡ã€‚ Go Runtime ä¼šæ£€æµ‹åˆ°è¿™ä¸ªé˜»å¡ã€‚ å…³é”®æ“ä½œï¼šM1 ä¼šä¸ P è§£ç»‘ (M-P detachment)ã€‚ M1 ä¼šå¸¦ç€ G1 ä¸€èµ·è¿›å…¥é˜»å¡çŠ¶æ€ï¼ˆç­‰å¾… syscall è¿”å›ï¼‰ã€‚ Runtime ä¼šç«‹å³å”¤é†’æˆ–åˆ›å»ºä¸€ä¸ªæ–°çš„ Mï¼ˆM2ï¼‰ æ¥æ¥ç®¡è¿™ä¸ª Pã€‚ M2 ç»‘å®š Pï¼Œç„¶åç»§ç»­ä» P çš„ LRQ ä¸­å–å‡ºä¸‹ä¸€ä¸ª Gï¼ˆG2ï¼‰æ¥æ‰§è¡Œã€‚ ç»“æœï¼š åªæœ‰ M1 å’Œ G1 è¢«é˜»å¡äº†ï¼Œè€Œ Pï¼ˆä»£è¡¨çš„ CPU æ ¸å¿ƒï¼‰æ²¡æœ‰è¢«é˜»å¡ï¼Œå®ƒç«‹åˆ»è¢« M2 å¤ç”¨å»æ‰§è¡Œå…¶ä»– Gã€‚\nè¿½é—®ï¼š â€œå½“ G1 çš„ syscall è¿”å›åå‘¢ï¼Ÿâ€\nG1 å˜ä¸ºå¯è¿è¡ŒçŠ¶æ€ã€‚ M1 ä¼šå°è¯•**â€œæ‰‹æŒâ€**ï¼ˆHand Offï¼‰G1ï¼š å¦‚æœèƒ½ç«‹å³æ‰¾åˆ°ä¸€ä¸ªç©ºé—²çš„ Pï¼ŒM1 å°±ç»‘å®š P å¹¶ç»§ç»­æ‰§è¡Œ G1ã€‚ å¦‚æœæ‰¾ä¸åˆ°ç©ºé—²çš„ Pï¼ŒM1 ä¼šå°† G1 æ”¾å…¥ GRQï¼Œç„¶å M1 è‡ªèº«è¿›å…¥ä¼‘çœ ã€‚ è®¾è®¡æ€æƒ³ï¼š è¿™ç§ M-P è§£ç»‘æœºåˆ¶ï¼Œä¿è¯äº† GOMAXPROCS ä¸ª Pï¼ˆå³ CPU æ ¸å¿ƒï¼‰å§‹ç»ˆåœ¨æ»¡è´Ÿè·å·¥ä½œï¼Œä¸ä¼šå› ä¸ºä¸ªåˆ« G çš„é˜»å¡è€Œå¯¼è‡´æ•´ä¸ª M é“¾æ¡ï¼ˆPï¼‰çš„é—²ç½®ã€‚\n4. æŠ¢å è°ƒåº¦ï¼ˆè§£å†³Gé¥¥é¥¿ï¼‰ é¢è¯•å®˜è¿½é—®ï¼š â€œå¦‚æœä¸€ä¸ª G æ¶æ„æ‰§è¡Œ for {} æ­»å¾ªç¯ï¼Œå®ƒä¼šå æ»¡ P å—ï¼Ÿå…¶ä»– G æ€ä¹ˆåŠï¼Ÿâ€\nå›ç­”ï¼š Go è°ƒåº¦å™¨æ˜¯æŠ¢å å¼çš„ã€‚å¦‚æœä¸€ä¸ª G è¿è¡Œæ—¶é—´è¿‡é•¿ï¼ˆç›®å‰æ˜¯ 10msï¼‰ï¼Œè°ƒåº¦å™¨ä¼šå¼ºåˆ¶å®ƒè®©å‡º CPUã€‚Go 1.14 ä»¥åå®ç°äº†åŸºäºä¿¡å·çš„å¼‚æ­¥æŠ¢å ï¼Œè§£å†³äº†æ—©æœŸåä½œå¼æŠ¢å çš„ç—›ç‚¹ã€‚\nåä½œå¼æŠ¢å ï¼ˆæ—§ï¼Œä½†ä»åœ¨ç”¨ï¼‰ï¼š Go ç¼–è¯‘å™¨ä¼šåœ¨å‡½æ•°è°ƒç”¨çš„å…¥å£å¤„æ’å…¥â€œæ ˆæ£€æŸ¥â€æŒ‡ä»¤ã€‚è¿™ä¸ªæ£€æŸ¥ä¸ä»…çœ‹æ ˆæ˜¯å¦æº¢å‡ºï¼Œä¹Ÿæ£€æŸ¥å…¨å±€çš„â€œæŠ¢å æ ‡è®°â€ã€‚å¦‚æœå‘ç°è‡ªå·±éœ€è¦è¢«æŠ¢å ï¼ŒG ä¼šä¸»åŠ¨è®©å‡ºï¼ˆåˆ‡æ¢åˆ° G0 è°ƒåº¦æ ˆï¼‰ã€‚\nç¼ºç‚¹ï¼š å¦‚æœ G æ‰§è¡Œä¸€ä¸ªæ²¡æœ‰å‡½æ•°è°ƒç”¨çš„çº¯è®¡ç®— for {}ï¼Œåä½œå¼æŠ¢å ä¼šå¤±æ•ˆã€‚ å¼‚æ­¥æŠ¢å ï¼ˆGo 1.14+ï¼ŒåŸºäºä¿¡å·ï¼‰ï¼š\nGo Runtime æœ‰ä¸€ä¸ªç³»ç»Ÿç›‘æ§çº¿ç¨‹ï¼ˆsysmonï¼‰ã€‚ sysmon ä¼šç›‘æ§æ‰€æœ‰ P ä¸Šçš„ G æ˜¯å¦è¿è¡Œæ—¶é—´è¿‡é•¿ï¼ˆ\u0026gt;10msï¼‰ã€‚ å¦‚æœå‘ç° G1 è¿è¡Œè¶…æ—¶ï¼Œsysmon ä¼šå‘è¿è¡Œ G1 çš„ M å‘é€ä¸€ä¸ª SIGURG ä¿¡å·ã€‚ M æ¥æ”¶åˆ°ä¿¡å·åï¼Œä¼šä¸­æ–­ G1 çš„æ‰§è¡Œï¼Œå°† G1 çš„çŠ¶æ€æ”¹ä¸º runnable å¹¶å°†å…¶æ’å…¥ GRQï¼ˆä½¿å…¶æ’åˆ°é˜Ÿå°¾ï¼Œé˜²æ­¢å…¶ç«‹å³å†æ¬¡æ‰§è¡Œï¼‰ã€‚ M éšåä» P çš„ LRQ ä¸­å¯»æ‰¾ä¸‹ä¸€ä¸ª G æ¥æ‰§è¡Œã€‚ è®¾è®¡æ€æƒ³ï¼š å¼‚æ­¥æŠ¢å ä¿è¯äº†è°ƒåº¦å™¨çš„å…¬å¹³æ€§ï¼Œé˜²æ­¢äº†æ¶æ„æˆ–æœ‰ Bug çš„ G é¥¿æ­»å…¶ä»– Gã€‚\n5. æŒ‚èµ·ä¸æ¢å¤ â€œè¢«æŒ‚èµ·çš„ G ä¸è¿è¡Œäº†ï¼Œé‚£å®ƒæ”¾åˆ°å“ªé‡Œå»äº†ï¼Ÿâ€\næ­£å¥½æ˜¯ Go è°ƒåº¦å™¨ï¼ˆGMP æ¨¡å‹ï¼‰é‡Œæœ€å…³é”®çš„â€œé˜»å¡ä¸ç­‰å¾…é˜Ÿåˆ—æœºåˆ¶â€ä¹‹ä¸€ã€‚ æˆ‘ä»¬æ¥å®Œæ•´æ‹†è§£ã€‚\nğŸ§© ä¸€ã€å‰æï¼šGï¼ˆgoroutineï¼‰çš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ åœ¨ Go çš„è¿è¡Œæ—¶ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ª goroutineï¼ˆGï¼‰æœ‰ä¸€ä¸ªçŠ¶æ€ï¼ˆgstatusï¼‰ï¼Œ å…¶ä¸­å‡ ä¸ªå…³é”®çŠ¶æ€å¦‚ä¸‹ ğŸ‘‡\nçŠ¶æ€å å«ä¹‰ _Grunnable å°±ç»ªæ€ï¼Œå¯è¢«è°ƒåº¦æ‰§è¡Œ _Grunning æ­£åœ¨æ‰§è¡Œ _Gwaiting ç­‰å¾…ä¸­ï¼ˆè¢«æŒ‚èµ·ï¼‰ _Gsyscall å¤„äºç³»ç»Ÿè°ƒç”¨ä¸­ï¼ˆM é˜»å¡ï¼‰ _Gdead å·²é€€å‡ºæˆ–æœªåˆå§‹åŒ– ğŸ§  äºŒã€å½“ G è¢«æŒ‚èµ·æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å½“ä¸€ä¸ª goroutine å› ä¸º channelã€mutexã€selectã€cond ç­‰åŸå› é˜»å¡ æ—¶ï¼š\n1ï¸âƒ£ runtime æ£€æµ‹åˆ°å®ƒä¸èƒ½ç»§ç»­æ‰§è¡Œ 2ï¸âƒ£ æŠŠ G çš„çŠ¶æ€ä» _Grunning æ”¹ä¸º _Gwaiting 3ï¸âƒ£ å°†å®ƒåŠ å…¥ç›¸åº”çš„ ç­‰å¾…é˜Ÿåˆ—ï¼ˆwait queueï¼‰ 4ï¸âƒ£ å½“å‰ M ç»§ç»­æ‰§è¡Œå…¶ä»–å¯è¿è¡Œçš„ Gï¼ˆä¸ handoff Pï¼‰\nğŸ“¦ ä¸‰ã€æŒ‚èµ·çš„ G è¢«æ”¾åˆ°å“ªé‡Œï¼Ÿ è¿™å–å†³äºå®ƒè¢«ä»€ä¹ˆé˜»å¡ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹å‡ ä¸ªå¸¸è§åœºæ™¯ï¼š\nâœ… åœºæ™¯ 1ï¼šChannel é˜»å¡ ch := make(chan int) \u0026lt;-ch // æ— æ•°æ®å¯è¯»ï¼Œè¢«æŒ‚èµ· æ‰§è¡Œ \u0026lt;-ch æ—¶ï¼š\nruntime å‘ç° channel æ²¡æœ‰å¯è¯»æ•°æ®ï¼› å½“å‰ Gï¼ˆæ¯”å¦‚ G1ï¼‰è¢«æ”¾å…¥ ch.recvq ç­‰å¾…é˜Ÿåˆ—ï¼› G1 çŠ¶æ€ç½®ä¸º _Gwaitingï¼› è°ƒåº¦å™¨ç«‹å³è®©å‡º M æ‰§è¡Œå…¶ä»– Gã€‚ ğŸ“¦ å­˜æ”¾ä½ç½®ï¼šchan.recvqï¼ˆé“¾è¡¨æˆ–é˜Ÿåˆ—ç»“æ„ï¼‰\nå½“å¦ä¸€ä¸ª G2 å‘ channel å‘é€æ•°æ®æ—¶ï¼š\nruntime ä¼šä» recvq ä¸­å–å‡ºä¸€ä¸ªç­‰å¾…çš„ Gï¼› æŠŠå®ƒçŠ¶æ€æ”¹å› _Grunnableï¼› æ”¾å…¥ P çš„æœ¬åœ°å¯è¿è¡Œé˜Ÿåˆ—ï¼ˆrunqï¼‰ï¼› ç­‰å¾…è¢«è°ƒåº¦æ‰§è¡Œã€‚ âœ… åœºæ™¯ 2ï¼šMutex é˜»å¡ var mu sync.Mutex mu.Lock() mu.Lock() // ç¬¬äºŒæ¬¡é˜»å¡ ç¬¬ä¸€ä¸ª G1 è·å¾—é”ï¼› ç¬¬äºŒä¸ª G2 è°ƒç”¨ Lock() æ—¶å‘ç°é”è¢«å ç”¨ï¼› runtime æŠŠ G2 æŒ‚å…¥ mutex çš„ç­‰å¾…é˜Ÿåˆ—ï¼ˆsudog ç»“æ„ï¼‰ï¼› G2 çŠ¶æ€ _Gwaitingï¼› å½“å‰ M å»æ‰§è¡Œåˆ«çš„ Gã€‚ ğŸ“¦ å­˜æ”¾ä½ç½®ï¼šé”çš„ç­‰å¾…é˜Ÿåˆ—ï¼ˆsudogï¼‰\nå½“ G1 è°ƒç”¨ Unlock() æ—¶ï¼š\nruntime ä¼šå”¤é†’ä¸€ä¸ªç­‰å¾…çš„ Gï¼ˆä» sudog æ‹¿å‡ºï¼‰ï¼› æ”¹çŠ¶æ€ä¸º _Grunnableï¼› æ”¾å…¥å½“å‰ P çš„ run queueã€‚ âœ… åœºæ™¯ 3ï¼šCond é˜»å¡ï¼ˆç±»ä¼¼ WaitGroupï¼‰ cond.L.Lock() cond.Wait() // é˜»å¡ runtime æŠŠå½“å‰ G æ”¾å…¥ cond çš„ç­‰å¾…é˜Ÿåˆ—ï¼› æ”¹ä¸º _Gwaitingï¼› unlock äº’æ–¥é”ï¼› å½“å‰ M ç»§ç»­æ‰§è¡Œå…¶ä»– Gã€‚ ğŸ“¦ å­˜æ”¾ä½ç½®ï¼šCond çš„ç­‰å¾…é˜Ÿåˆ—\nå½“ Signal() æˆ– Broadcast() è°ƒç”¨ï¼š\nruntime å–å‡ºç­‰å¾…çš„ Gï¼› æ”¹çŠ¶æ€ _Grunnableï¼› æ”¾å…¥ run queueã€‚ âœ… åœºæ™¯ 4ï¼šselect é˜»å¡ï¼ˆå¤šä¸ª channel éƒ½æ²¡å°±ç»ªï¼‰ select { case \u0026lt;-ch1: case \u0026lt;-ch2: default: // ä¸ä¼šé˜»å¡ } å¦‚æœæ‰€æœ‰ case éƒ½é˜»å¡ï¼š\nruntime æŠŠ G åŠ å…¥æ‰€æœ‰ç›¸å…³ channel çš„ç­‰å¾…é˜Ÿåˆ—ï¼› å½“ä»»æ„ä¸€ä¸ª channel å°±ç»ªæ—¶ï¼Œå”¤é†’å®ƒï¼› å…¶ä»–ç­‰å¾…ä½ç½®çš„ entry ä¼šè¢«æ¸…ç†ã€‚ ğŸ“¦ å­˜æ”¾ä½ç½®ï¼šå¤šä¸ª channel çš„ç­‰å¾…é˜Ÿåˆ—ï¼ˆsudog é“¾è¡¨ï¼‰\nâš™ï¸ å››ã€å”¤é†’è¿‡ç¨‹ï¼ˆè¢«æŒ‚èµ·çš„ G é‡æ–°è¿è¡Œï¼‰ å½“å¯¹åº”äº‹ä»¶ï¼ˆå¦‚æ•°æ®åˆ°è¾¾ã€é”é‡Šæ”¾ï¼‰å‘ç”Ÿæ—¶ï¼š\n1ï¸âƒ£ runtime æŠŠç­‰å¾…é˜Ÿåˆ—ä¸­çš„ G æ‹¿å‡ºæ¥ï¼› 2ï¸âƒ£ æ”¹çŠ¶æ€ _Grunnableï¼› 3ï¸âƒ£ æ”¾å…¥ P çš„æœ¬åœ° run queue æˆ–å…¨å±€ run queueï¼› 4ï¸âƒ£ è¢«æŸä¸ª M æ‰§è¡Œã€‚\nğŸ§© ç¤ºæ„ï¼š\nè¢«æŒ‚èµ·çš„ G â€”â€”\u0026gt; ç­‰å¾…é˜Ÿåˆ— â€”â€”\u0026gt; äº‹ä»¶è§¦å‘å”¤é†’ â€”â€”\u0026gt; run queue â€”â€”\u0026gt; M æ‰§è¡Œ ğŸ” äº”ã€æ€»ç»“å›¾ç¤º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ P (Processor) â”‚ â”‚ â”‚ â”‚ æœ¬åœ° run queue â”‚ â”‚ [G2][G3][G4] â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”‚ é˜»å¡äº‹ä»¶ â”‚ â”‚ (chan/mutex)â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚ æŒ‚èµ·çš„ G1 çŠ¶æ€: _Gwaiting å­˜æ”¾äºç­‰å¾…é˜Ÿåˆ— å”¤é†’åï¼š\nwait queue â†’ G1 çŠ¶æ€å˜ä¸º _Grunnable â†’ æ”¾å…¥ P.runq â†’ ç­‰å¾…è°ƒåº¦æ‰§è¡Œ âœ… å…­ã€æ€»ç»“ä¸€å¥è¯ è¢«æŒ‚èµ·çš„ G ä¸ä¼šè¿è¡Œï¼Œå®ƒè¢«æ”¾å…¥å¯¹åº”èµ„æºçš„ç­‰å¾…é˜Ÿåˆ—ï¼ˆchanã€mutexã€cond ç­‰ï¼‰ã€‚ ç­‰å¾…èµ„æºå¯ç”¨æ—¶ï¼Œruntime æŠŠå®ƒå”¤é†’ã€æ”¹ä¸º _Grunnableï¼Œæ”¾å› P çš„ run queue ç­‰å¾…æ‰§è¡Œã€‚ æ•´ä¸ªè¿‡ç¨‹ M ä¸ P ä¸è§£ç»‘ï¼ˆä¸ä¼š handoffï¼‰ï¼ŒM ä¼šå»è·‘å…¶ä»– Gã€‚\n",
"tags":null,
"categories":null
},{
"title":"å¦‚ä½•ä¿è¯æ•°æ®å½•å…¥ä¸æ··ä¹±",
"permalink": "http://localhost:1313/posts/scenario/%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5%E4%B8%8D%E6%B7%B7%E4%B9%B1/",
"summary": "å¦‚ä½•ä¿è¯æ•°æ®å½•å…¥ä¸æ··ä¹± æ•°æ®å¹¶å‘ å¯ä»¥é‡‡ç”¨goçš„sync.mutex/æ•°æ®åº“çš„é”/åˆ†å¸ƒå¼é”æ¥å®ç°å¹¶å‘è®¿é—®æ§åˆ¶ï¼Œåœ¨å•æœºæœåŠ¡ä¸‹ï¼Œå¯ä»¥é‡‡ç”¨goçš„äº’æ–¥é”ä¿æŠ¤ä¸´ç•Œèµ„æºã€‚åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œå¹¶å‘é‡ä¸é«˜çš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨ æ•°æ®åº“çš„è¡Œé”ï¼Œè¡Œé”ä»é€»è¾‘ä¸Šå¯ä»¥åˆ†ä¸ºæ‚²è§‚é”å’Œä¹è§‚é”ï¼Œæ‚²è§‚é”é€šè¿‡ç›´æ¥for update è¯­å¥åŠ äº’æ–¥é”ï¼Œåœ¨æœ¬æ¬¡äº‹åŠ¡æœªæäº¤ä¹‹å‰ï¼Œå…¶ä»–äº‹åŠ¡éƒ½ä¸èƒ½è¯»å†™å½“å‰çš„ä¸´ç•Œèµ„æºã€‚ä¹è§‚é”å¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ï¼Œ å…ˆæŸ¥è¯¢ç‰ˆæœ¬å·ï¼Œåœ¨å†™å…¥æ•°æ®çš„æ—¶å€™å†æ¬¡éªŒè¯ç‰ˆæœ¬å·ï¼Œå¦‚æœç›¸åŒå†æ›´æ–°ã€‚\n",
"content": "å¦‚ä½•ä¿è¯æ•°æ®å½•å…¥ä¸æ··ä¹± æ•°æ®å¹¶å‘ å¯ä»¥é‡‡ç”¨goçš„sync.mutex/æ•°æ®åº“çš„é”/åˆ†å¸ƒå¼é”æ¥å®ç°å¹¶å‘è®¿é—®æ§åˆ¶ï¼Œåœ¨å•æœºæœåŠ¡ä¸‹ï¼Œå¯ä»¥é‡‡ç”¨goçš„äº’æ–¥é”ä¿æŠ¤ä¸´ç•Œèµ„æºã€‚åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œå¹¶å‘é‡ä¸é«˜çš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨ æ•°æ®åº“çš„è¡Œé”ï¼Œè¡Œé”ä»é€»è¾‘ä¸Šå¯ä»¥åˆ†ä¸ºæ‚²è§‚é”å’Œä¹è§‚é”ï¼Œæ‚²è§‚é”é€šè¿‡ç›´æ¥for update è¯­å¥åŠ äº’æ–¥é”ï¼Œåœ¨æœ¬æ¬¡äº‹åŠ¡æœªæäº¤ä¹‹å‰ï¼Œå…¶ä»–äº‹åŠ¡éƒ½ä¸èƒ½è¯»å†™å½“å‰çš„ä¸´ç•Œèµ„æºã€‚ä¹è§‚é”å¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ï¼Œ å…ˆæŸ¥è¯¢ç‰ˆæœ¬å·ï¼Œåœ¨å†™å…¥æ•°æ®çš„æ—¶å€™å†æ¬¡éªŒè¯ç‰ˆæœ¬å·ï¼Œå¦‚æœç›¸åŒå†æ›´æ–°ã€‚\n",
"tags":null,
"categories":null
},{
"title":"ä¸€æ¬¡mysqlçš„æ‰§è¡Œè¿‡ç¨‹",
"permalink": "http://localhost:1313/posts/database/%E4%B8%80%E6%AC%A1mysql%E7%9A%84%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B/",
"summary": "ä¸€æ¬¡mysqlçš„æ‰§è¡Œè¿‡ç¨‹ è¿æ¥å™¨ å®¢æˆ·ç«¯éœ€è¦å…ˆå’ŒæœåŠ¡å™¨è¿æ¥ï¼Œæ£€æŸ¥å¸å·å¯†ç ã€æƒé™ï¼Œå»ºç«‹è¿æ¥ã€‚ åˆ†æå™¨ å°†å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„sqlè¯­å¥è¿›è¡Œåˆ†æï¼Œåˆ†ä¸ºè¯æ³•åˆ†æï¼Œå°†å…³é”®è¯æå–å‡ºæ¥ï¼Œè¿›è¡Œè¯­æ³•åˆ†æï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ è¯­æ³•é”™è¯¯ï¼Œæœ€åå¯¹è¯­å¥è¿›è¡Œè¯­ä¹‰åˆ†æã€‚ ä¼˜åŒ–å™¨ æ ¹æ®ç”¨æˆ·çš„sql æ‰§è¡ŒæŸ¥è¯¢è®¡åˆ’ï¼Œé€‰æ‹©æˆæœ¬å’Œæ—¶é—´æœ€å°çš„æ–¹æ¡ˆæ‰§è¡Œã€‚ æ‰§è¡Œå™¨ å‘å­˜å‚¨å¼•æ“å‘é€è¯·æ±‚ï¼Œæ‰§è¡Œå…·ä½“çš„sqlæ‰§è¡Œ ",
"content": "ä¸€æ¬¡mysqlçš„æ‰§è¡Œè¿‡ç¨‹ è¿æ¥å™¨ å®¢æˆ·ç«¯éœ€è¦å…ˆå’ŒæœåŠ¡å™¨è¿æ¥ï¼Œæ£€æŸ¥å¸å·å¯†ç ã€æƒé™ï¼Œå»ºç«‹è¿æ¥ã€‚ åˆ†æå™¨ å°†å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„sqlè¯­å¥è¿›è¡Œåˆ†æï¼Œåˆ†ä¸ºè¯æ³•åˆ†æï¼Œå°†å…³é”®è¯æå–å‡ºæ¥ï¼Œè¿›è¡Œè¯­æ³•åˆ†æï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ è¯­æ³•é”™è¯¯ï¼Œæœ€åå¯¹è¯­å¥è¿›è¡Œè¯­ä¹‰åˆ†æã€‚ ä¼˜åŒ–å™¨ æ ¹æ®ç”¨æˆ·çš„sql æ‰§è¡ŒæŸ¥è¯¢è®¡åˆ’ï¼Œé€‰æ‹©æˆæœ¬å’Œæ—¶é—´æœ€å°çš„æ–¹æ¡ˆæ‰§è¡Œã€‚ æ‰§è¡Œå™¨ å‘å­˜å‚¨å¼•æ“å‘é€è¯·æ±‚ï¼Œæ‰§è¡Œå…·ä½“çš„sqlæ‰§è¡Œ ",
"tags":null,
"categories":null
},{
"title":"Mysql_åˆ†ç»„ç»Ÿè®¡æ’åº",
"permalink": "http://localhost:1313/posts/interview_code/mysql_%E5%88%86%E7%BB%84%E7%BB%9F%E8%AE%A1%E6%8E%92%E5%BA%8F/",
"summary": "è®°å½•ä¸€äº›é¢è¯•é‡åˆ°çš„é¢˜ç›®\nCREATE TABLE students ( id INT AUTO_INCREMENT PRIMARY KEY, name VARCHAR(50), age INT, sex CHAR(1), class VARCHAR(50) ); INSERT INTO students (name, age, sex, class) VALUES (\u0026#39;æ²‰é»˜ç‹äºŒ\u0026#39;, 18, \u0026#39;å¥³\u0026#39;, \u0026#39;ä¸‰å¹´äºŒç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹ä¸€\u0026#39;, 20, \u0026#39;ç”·\u0026#39;, \u0026#39;ä¸‰å¹´äºŒç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹ä¸‰\u0026#39;, 19, \u0026#39;ç”·\u0026#39;, \u0026#39;ä¸‰å¹´ä¸‰ç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹å››\u0026#39;, 17, \u0026#39;ç”·\u0026#39;, \u0026#39;ä¸‰å¹´ä¸‰ç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹äº”\u0026#39;, 20, \u0026#39;å¥³\u0026#39;, \u0026#39;ä¸‰å¹´å››ç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹å…­\u0026#39;, 21, \u0026#39;ç”·\u0026#39;, \u0026#39;ä¸‰å¹´å››ç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹ä¸ƒ\u0026#39;, 18, \u0026#39;å¥³\u0026#39;, \u0026#39;ä¸‰å¹´å››ç­\u0026#39;); select * from students s1 join ( select id, row_number() over (partition by class order by age) as rank_num from students ) s2 on s2.id = s1.id where s2.rank_num \u0026lt;= 2 ",
"content": "è®°å½•ä¸€äº›é¢è¯•é‡åˆ°çš„é¢˜ç›®\nCREATE TABLE students ( id INT AUTO_INCREMENT PRIMARY KEY, name VARCHAR(50), age INT, sex CHAR(1), class VARCHAR(50) ); INSERT INTO students (name, age, sex, class) VALUES (\u0026#39;æ²‰é»˜ç‹äºŒ\u0026#39;, 18, \u0026#39;å¥³\u0026#39;, \u0026#39;ä¸‰å¹´äºŒç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹ä¸€\u0026#39;, 20, \u0026#39;ç”·\u0026#39;, \u0026#39;ä¸‰å¹´äºŒç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹ä¸‰\u0026#39;, 19, \u0026#39;ç”·\u0026#39;, \u0026#39;ä¸‰å¹´ä¸‰ç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹å››\u0026#39;, 17, \u0026#39;ç”·\u0026#39;, \u0026#39;ä¸‰å¹´ä¸‰ç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹äº”\u0026#39;, 20, \u0026#39;å¥³\u0026#39;, \u0026#39;ä¸‰å¹´å››ç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹å…­\u0026#39;, 21, \u0026#39;ç”·\u0026#39;, \u0026#39;ä¸‰å¹´å››ç­\u0026#39;), (\u0026#39;æ²‰é»˜ç‹ä¸ƒ\u0026#39;, 18, \u0026#39;å¥³\u0026#39;, \u0026#39;ä¸‰å¹´å››ç­\u0026#39;); select * from students s1 join ( select id, row_number() over (partition by class order by age) as rank_num from students ) s2 on s2.id = s1.id where s2.rank_num \u0026lt;= 2 ",
"tags":null,
"categories":null
},{
"title":"æ•°ç»„äº¤é›†",
"permalink": "http://localhost:1313/posts/datastructalgorithm/slice_%E6%95%B0%E7%BB%84%E4%BA%A4%E9%9B%86/",
"summary": " package main import \u0026#34;fmt\u0026#34; func main() { //4.1 å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥è®¡ç®—è¿”å›å¤šä¸ªåˆ‡ç‰‡å…ƒç´ äº¤é›†ï¼Œå¦‚å…¥å‚[1,2,3],[2,3,4] è¿”å› [2,3] arrays := make([][]int, 0) arrays = append(arrays, []int{1, 2, 3}) arrays = append(arrays, []int{2, 3, 4}) arrays = append(arrays, []int{3, 4}) res := calMerge(arrays...) fmt.Println(res) } func calMerge(arrays ...[]int) []int { // æ•°ç»„å…ˆå»é‡ï¼Œå°±ä¸å®ç°äº† check := make(map[int]int) for i := 0; i \u0026lt; len(arrays); i++ { for j := 0; j \u0026lt; len(arrays[i]); j++ { check[arrays[i][j]] += 1 } } newArray := make([]int, 0) for k, val := range check { if val \u0026gt;= len(arrays) { newArray = append(newArray, k) } } return newArray } ",
"content": " package main import \u0026#34;fmt\u0026#34; func main() { //4.1 å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥è®¡ç®—è¿”å›å¤šä¸ªåˆ‡ç‰‡å…ƒç´ äº¤é›†ï¼Œå¦‚å…¥å‚[1,2,3],[2,3,4] è¿”å› [2,3] arrays := make([][]int, 0) arrays = append(arrays, []int{1, 2, 3}) arrays = append(arrays, []int{2, 3, 4}) arrays = append(arrays, []int{3, 4}) res := calMerge(arrays...) fmt.Println(res) } func calMerge(arrays ...[]int) []int { // æ•°ç»„å…ˆå»é‡ï¼Œå°±ä¸å®ç°äº† check := make(map[int]int) for i := 0; i \u0026lt; len(arrays); i++ { for j := 0; j \u0026lt; len(arrays[i]); j++ { check[arrays[i][j]] += 1 } } newArray := make([]int, 0) for k, val := range check { if val \u0026gt;= len(arrays) { newArray = append(newArray, k) } } return newArray } ",
"tags":null,
"categories":null
},{
"title":"åˆ†å¸ƒå¼é”çš„å®ç°",
"permalink": "http://localhost:1313/posts/scenario/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E7%9A%84%E5%AE%9E%E7%8E%B0/",
"summary": "åˆ†å¸ƒå¼é”çš„å®ç° åˆ†å¸ƒå¼é”éœ€è¦æ»¡è¶³å‡ ä¸ªè¦ç‚¹\né«˜æ€§èƒ½ã€äº’æ–¥ï¼Œredisé«˜æ€§èƒ½ï¼Œå¤„ç†æ¨¡å‹å•çº¿ç¨‹å¤©ç„¶æ”¯æŒäº’æ–¥ åŸå­æ€§æ“ä½œï¼ˆä¸»è¦æ˜¯redisï¼‰ï¼Œé«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œéœ€è¦ä¿è¯åŠ é”ã€åˆ é™¤ã€è‡ªåŠ¨ç»­æœŸçš„å¹¶å‘å®‰å…¨ï¼Œæ‰€ä»¥éœ€è¦åŸå­æ€§ä¿è¯ å®‰å…¨é‡Šæ”¾é”ã€é”çš„åˆ é™¤ï¼Œåœ¨å¹¶å‘æƒ…å†µä¸‹ï¼Œå¯èƒ½å‡ºç°Aæ‰§è¡Œä»»åŠ¡è¿‡é•¿ï¼Œé”å·²ç»è‡ªåŠ¨è¿‡æœŸäº†ï¼ŒBæ‹¿åˆ°é”åœ¨æ‰§è¡Œäº†ï¼ŒAæ‰§è¡Œå®Œæ¯•ï¼Œé‡Šæ”¾é”ï¼Œå¦‚æœä¸è¿›è¡Œé”çš„Valåˆ¤æ–­ï¼Œä¼šå¯¼è‡´é”çš„å¼‚å¸¸é‡Šæ”¾ã€‚ è‡ªåŠ¨è¿‡æœŸ/è‡ªåŠ¨ç»­æœŸ,ä½¿ç”¨set nx px è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä½¿ç”¨çœ‹é—¨ç‹—æœºåˆ¶å®ç°è‡ªåŠ¨ç»­æœŸï¼Œåœ¨é‡Šæ”¾é”çš„æ—¶å€™ï¼Œä½¿ç”¨context,cancelåç¨‹ã€‚ å¯é‡å…¥ åŸºäºredisçš„å®ç° cache.go\npackage cache import ( \u0026#34;context\u0026#34; \u0026#34;github.com/redis/go-redis/v9\u0026#34; \u0026#34;time\u0026#34; ) type Cache interface { // é€šç”¨å°è£… éœ€è¦è§£å†³ //ï¼ˆ1ï¼‰ç¼“å­˜ä¸‰å¤§é—®é¢˜ a ç©¿é€ b å‡»ç©¿ c ç¼“å­˜é›ªå´© //ï¼ˆ2ï¼‰ç¼“å­˜ä¸ä¸€è‡´çš„é—®é¢˜ //ï¼ˆ3ï¼‰åˆ†å¸ƒå¼é” // è®¾ç½®é€šç”¨å‰ç¼€ app_name , æ•°æ®ç±»å‹ data, æ¨¡å—åå­— ï¼Œ SetPrefix(prefix ...string) Cache Set(ctx context.Context, key, value string, short bool) error Get(ctx context.Context, key string, handler func(context.Context) (string, error)) (string, error) // å¢åŠ  åˆ é™¤ ä¿®æ”¹çš„æ—¶å€™è°ƒç”¨ Flush(ctx context.Context, handler func(context.Context) error) error FlushWithConsistency(ctx context.Context, handler func(context.Context) error) error // ä»¥ä¸‹æ˜¯ç®€å•å°è£… SimpleSet(ctx context.Context, key string, data any, expiration time.Duration) (err error) SimpleGet(ctx context.Context, key string) (data string, err error) SimpleIncr(ctx context.Context, key string) (count int64, err error) SimpleDel(ctx context.Context, keys ...string) (deletedCount int64, err error) Pipelined(ctx context.Context, callback func(redis.Pipeliner) error) (cmder []redis.Cmder, err error) // æ‰¹é‡åˆ é™¤ key æ¯”å¦‚ app_name:* DeleteKeysByPattern(ctx context.Context, pattern string) (err error) // é›†åˆæ“ä½œ SAdd(ctx context.Context, key string, members ...string) (err error) SMembers(ctx context.Context, key string) (members []string, err error) // è¿‡æœŸé›†åˆ è®¾ç½®è·å– AddMemberWithTTL(ctx context.Context, setKey, member string, ttl time.Duration) error GetValidMembers(ctx context.Context, setKey string) ([]string, error) RemoveMember(ctx context.Context, setKey string, members ...string) (int64, error) // åˆ†å¸ƒå¼åŠ è§£é” DistributedLock(ctx context.Context, key string, ttl time.Duration) error DistributedUnlock(ctx context.Context, key string) error } redis.go\n",
"content": "åˆ†å¸ƒå¼é”çš„å®ç° åˆ†å¸ƒå¼é”éœ€è¦æ»¡è¶³å‡ ä¸ªè¦ç‚¹\né«˜æ€§èƒ½ã€äº’æ–¥ï¼Œredisé«˜æ€§èƒ½ï¼Œå¤„ç†æ¨¡å‹å•çº¿ç¨‹å¤©ç„¶æ”¯æŒäº’æ–¥ åŸå­æ€§æ“ä½œï¼ˆä¸»è¦æ˜¯redisï¼‰ï¼Œé«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œéœ€è¦ä¿è¯åŠ é”ã€åˆ é™¤ã€è‡ªåŠ¨ç»­æœŸçš„å¹¶å‘å®‰å…¨ï¼Œæ‰€ä»¥éœ€è¦åŸå­æ€§ä¿è¯ å®‰å…¨é‡Šæ”¾é”ã€é”çš„åˆ é™¤ï¼Œåœ¨å¹¶å‘æƒ…å†µä¸‹ï¼Œå¯èƒ½å‡ºç°Aæ‰§è¡Œä»»åŠ¡è¿‡é•¿ï¼Œé”å·²ç»è‡ªåŠ¨è¿‡æœŸäº†ï¼ŒBæ‹¿åˆ°é”åœ¨æ‰§è¡Œäº†ï¼ŒAæ‰§è¡Œå®Œæ¯•ï¼Œé‡Šæ”¾é”ï¼Œå¦‚æœä¸è¿›è¡Œé”çš„Valåˆ¤æ–­ï¼Œä¼šå¯¼è‡´é”çš„å¼‚å¸¸é‡Šæ”¾ã€‚ è‡ªåŠ¨è¿‡æœŸ/è‡ªåŠ¨ç»­æœŸ,ä½¿ç”¨set nx px è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä½¿ç”¨çœ‹é—¨ç‹—æœºåˆ¶å®ç°è‡ªåŠ¨ç»­æœŸï¼Œåœ¨é‡Šæ”¾é”çš„æ—¶å€™ï¼Œä½¿ç”¨context,cancelåç¨‹ã€‚ å¯é‡å…¥ åŸºäºredisçš„å®ç° cache.go\npackage cache import ( \u0026#34;context\u0026#34; \u0026#34;github.com/redis/go-redis/v9\u0026#34; \u0026#34;time\u0026#34; ) type Cache interface { // é€šç”¨å°è£… éœ€è¦è§£å†³ //ï¼ˆ1ï¼‰ç¼“å­˜ä¸‰å¤§é—®é¢˜ a ç©¿é€ b å‡»ç©¿ c ç¼“å­˜é›ªå´© //ï¼ˆ2ï¼‰ç¼“å­˜ä¸ä¸€è‡´çš„é—®é¢˜ //ï¼ˆ3ï¼‰åˆ†å¸ƒå¼é” // è®¾ç½®é€šç”¨å‰ç¼€ app_name , æ•°æ®ç±»å‹ data, æ¨¡å—åå­— ï¼Œ SetPrefix(prefix ...string) Cache Set(ctx context.Context, key, value string, short bool) error Get(ctx context.Context, key string, handler func(context.Context) (string, error)) (string, error) // å¢åŠ  åˆ é™¤ ä¿®æ”¹çš„æ—¶å€™è°ƒç”¨ Flush(ctx context.Context, handler func(context.Context) error) error FlushWithConsistency(ctx context.Context, handler func(context.Context) error) error // ä»¥ä¸‹æ˜¯ç®€å•å°è£… SimpleSet(ctx context.Context, key string, data any, expiration time.Duration) (err error) SimpleGet(ctx context.Context, key string) (data string, err error) SimpleIncr(ctx context.Context, key string) (count int64, err error) SimpleDel(ctx context.Context, keys ...string) (deletedCount int64, err error) Pipelined(ctx context.Context, callback func(redis.Pipeliner) error) (cmder []redis.Cmder, err error) // æ‰¹é‡åˆ é™¤ key æ¯”å¦‚ app_name:* DeleteKeysByPattern(ctx context.Context, pattern string) (err error) // é›†åˆæ“ä½œ SAdd(ctx context.Context, key string, members ...string) (err error) SMembers(ctx context.Context, key string) (members []string, err error) // è¿‡æœŸé›†åˆ è®¾ç½®è·å– AddMemberWithTTL(ctx context.Context, setKey, member string, ttl time.Duration) error GetValidMembers(ctx context.Context, setKey string) ([]string, error) RemoveMember(ctx context.Context, setKey string, members ...string) (int64, error) // åˆ†å¸ƒå¼åŠ è§£é” DistributedLock(ctx context.Context, key string, ttl time.Duration) error DistributedUnlock(ctx context.Context, key string) error } redis.go\npackage cache import ( \u0026#34;codeup.aliyun.com/619b3cb12f595dbd1b9b0b3e/go/common.git/log\u0026#34; \u0026#34;context\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;github.com/go-kratos/kratos/v2/errors\u0026#34; \u0026#34;github.com/redis/go-redis/v9\u0026#34; \u0026#34;math/rand\u0026#34; \u0026#34;strings\u0026#34; \u0026#34;time\u0026#34; ) type RedisCache struct { Redis redis.UniversalClient Prefix []string RootPrefix []string Locks map[string]*Lock // key: ä¸šåŠ¡é”å, value: Lockå®ä¾‹ } func (c *RedisCache) DistributedLock(ctx context.Context, key string, ttl time.Duration) error { if c.Locks == nil { c.Locks = make(map[string]*Lock) } lockKey := c.getKey(key) lock := NewLock(c.Redis, lockKey) err := lock.Lock(ctx, ttl) if err != nil { return err } c.Locks[lockKey] = lock return nil } func (c *RedisCache) DistributedUnlock(ctx context.Context, key string) error { if c.Locks == nil { return fmt.Errorf(\u0026#34;no lock map found\u0026#34;) } lockKey := c.getKey(key) lock, ok := c.Locks[lockKey] if !ok || lock == nil { return fmt.Errorf(\u0026#34;no lock found for key: %s\u0026#34;, lockKey) } err := lock.UnLock(ctx) if err != nil { return err } delete(c.Locks, lockKey) return nil } func (c *RedisCache) SetPrefix(prefix ...string) Cache { return \u0026amp;RedisCache{ Redis: c.Redis, Prefix: prefix, RootPrefix: c.RootPrefix, Locks: c.Locks, } } func (c *RedisCache) Set(ctx context.Context, key, value string, short bool) error { // é»˜è®¤äº”åˆ†é’Ÿ å¦‚æœç©ºæ•°æ® è®¾ç½® 1 åˆ†é’Ÿ // set random expiration avoid a large number of keys expire at the same time seconds := rand.New(rand.NewSource(time.Now().UnixNano())).Int63n(300) + 300 if short { // é˜²æ­¢ç¼“å­˜ç©¿é€ // if record not found, set a short expiration seconds = 60 + rand.New(rand.NewSource(time.Now().UnixNano())).Int63n(60) } return c.Redis.Set(ctx, c.getKey(key), value, time.Duration(seconds)*time.Second).Err() } func (c *RedisCache) Get(ctx context.Context, key string, handler func(context.Context) (string, error)) (result string, err error) { // åˆ†å¸ƒå¼é”è§£å†³ ç¼“å­˜å‡»ç©¿ currentKey := c.getKey(key) result, err = c.Redis.Get(ctx, currentKey).Result() if err == nil { return } // åŠ é” å» æ•°æ®åº“ è¯» æ•°æ® lock := NewLock(c.Redis, currentKey) err = c.GetLock(ctx, lock, currentKey) if err != nil { return \u0026#34;\u0026#34;, err } defer lock.UnLock(ctx) // åŒé‡æ£€æµ‹ result, err = c.Redis.Get(ctx, currentKey).Result() if err == nil { return } // result, err = handler(ctx) if err != nil { return \u0026#34;\u0026#34;, err } // æ•°æ®å›å¡« if result == \u0026#34;\u0026#34; { err = c.Set(ctx, key, result, true) } else { err = c.Set(ctx, key, result, false) } if err != nil { return \u0026#34;\u0026#34;, err } return } func (c *RedisCache) GetLock(ctx context.Context, lock *Lock, key string) (err error) { // è‡ªæ—‹ 1s retry := 0 for retry \u0026lt; 20 { err = lock.Lock(ctx, 5*time.Second) if err == nil { return } time.Sleep(50 * time.Millisecond) retry++ if err := ctx.Err(); err != nil { return err } } return errors.Errorf(500, \u0026#34;not get lock\u0026#34;, \u0026#34;\u0026#34;) } func (c *RedisCache) Flush(ctx context.Context, handler func(context.Context) error) error { err := c.DeleteKeysByPattern(ctx, c.getKey(\u0026#34;*\u0026#34;)) if err != nil { return err } return handler(ctx) } func (c *RedisCache) getKey(key string) string { temp := append(c.RootPrefix, c.Prefix...) if key != \u0026#34;\u0026#34; { temp = append(temp, key) } return strings.Join(temp, \u0026#34;:\u0026#34;) } // FlushWithConsistency ç¼“å­˜åŒåˆ  func (c *RedisCache) FlushWithConsistency(ctx context.Context, handler func(context.Context) error) (err error) { err = c.DeleteKeysByPattern(ctx, c.getKey(\u0026#34;*\u0026#34;)) if err != nil { return err } err = handler(ctx) if err != nil { return err } go func() { ctx, cancel := context.WithTimeout(context.Background(), 2*time.Second) defer cancel() time.Sleep(1 * time.Second) err = c.DeleteKeysByPattern(ctx, c.getKey(\u0026#34;*\u0026#34;)) if err != nil { log.Info(err.Error()) } }() return } func NewRedisCache(redis redis.UniversalClient, prefix string) Cache { return \u0026amp;RedisCache{ Redis: redis, Prefix: []string{prefix}, RootPrefix: []string{prefix}, } } func (c *RedisCache) Pipelined(ctx context.Context, callback func(redis.Pipeliner) error) (cmder []redis.Cmder, err error) { return c.Redis.Pipelined(ctx, callback) } func (c *RedisCache) DeleteKeysByPattern(ctx context.Context, pattern string) (err error) { iter := c.Redis.Scan(ctx, 0, pattern, 0).Iterator() // åˆ é™¤è®¡æ•°å™¨ deleted := 0 // åˆ†æ‰¹åˆ é™¤é”®ä»¥é¿å…ä¸€æ¬¡åˆ é™¤å¤ªå¤šé”® var keys []string pipe := c.Redis.Pipeline() for iter.Next(ctx) { keys = append(keys, iter.Val()) // æ¯ç§¯ç´¯100ä¸ªé”®æ‰§è¡Œä¸€æ¬¡åˆ é™¤æ“ä½œ if len(keys) \u0026gt;= 100 { for _, k := range keys { pipe.Unlink(ctx, k) } _, err := pipe.Exec(ctx) if err != nil { return err } deleted += len(keys) keys = []string{} } } // åˆ é™¤å‰©ä½™çš„é”® if len(keys) \u0026gt; 0 { for _, k := range keys { pipe.Unlink(ctx, k) } _, err := pipe.Exec(ctx) if err != nil { return err } deleted += len(keys) } // æ£€æŸ¥è¿­ä»£è¿‡ç¨‹ä¸­æ˜¯å¦æœ‰é”™è¯¯ if err := iter.Err(); err != nil { return err } log.Info(\u0026#34;æˆåŠŸåˆ é™¤ %d ä¸ªåŒ¹é… \u0026#39;%s\u0026#39; çš„é”®\\n\u0026#34;, deleted, pattern) return nil } func (c *RedisCache) RemoveMember(ctx context.Context, setKey string, members ...string) (int64, error) { // è¿”å›æˆåŠŸåˆ é™¤çš„æˆå‘˜æ•°é‡ return c.Redis.ZRem(ctx, setKey, members).Result() } func (c *RedisCache) AddMemberWithTTL(ctx context.Context, setKey, member string, ttl time.Duration) error { expireTs := time.Now().Add(ttl).Unix() // è¿‡æœŸæ—¶é—´æˆ³ï¼ˆç§’ï¼‰ // ZADD myzset expireTs member if err := c.Redis.ZAdd(ctx, setKey, redis.Z{ Score: float64(expireTs), Member: member, }).Err(); err != nil { return err } return nil } func (c *RedisCache) GetValidMembers(ctx context.Context, setKey string) ([]string, error) { now := time.Now().Unix() // åªå– score \u0026gt; now çš„æˆå‘˜ members, err := c.Redis.ZRangeByScore(ctx, setKey, \u0026amp;redis.ZRangeBy{ Min: fmt.Sprintf(\u0026#34;(%d\u0026#34;, now), // (now è¡¨ç¤ºä¸¥æ ¼å¤§äº now Max: \u0026#34;+inf\u0026#34;, }).Result() if err != nil { return nil, err } go func() { subCtx, cancel := context.WithTimeout(context.Background(), 5*time.Second) defer cancel() err := c.CleanupExpired(subCtx, setKey) if err != nil { log.Info(err) } }() return members, nil } func (c *RedisCache) CleanupExpired(ctx context.Context, setKey string) error { now := time.Now().Unix() // åˆ é™¤æ‰€æœ‰ score â‰¤ now çš„æˆå‘˜ _, err := c.Redis.ZRemRangeByScore(ctx, setKey, \u0026#34;-inf\u0026#34;, fmt.Sprintf(\u0026#34;%d\u0026#34;, now)).Result() return err } func (c *RedisCache) SAdd(ctx context.Context, key string, members ...string) (err error) { return c.Redis.SAdd(ctx, key, members).Err() } func (c *RedisCache) SMembers(ctx context.Context, key string) (members []string, err error) { return c.Redis.SMembers(ctx, key).Result() } func (c *RedisCache) SimpleDel(ctx context.Context, keys ...string) (deletedCount int64, err error) { // 7. Del: åˆ é™¤é”® return c.Redis.Del(ctx, keys...).Result() } func (c *RedisCache) SimpleIncr(ctx context.Context, key string) (count int64, err error) { // 6. Incr: å¯¹æ•°å­—è¿›è¡ŒåŸå­é€’å¢ return c.Redis.Incr(ctx, key).Result() } func (c *RedisCache) SimpleSet(ctx context.Context, key string, data any, expiration time.Duration) (err error) { // 2. Set: è®¾ç½®é”®å€¼å¯¹ (key: \u0026#34;mykey\u0026#34;, value: \u0026#34;hello Redis\u0026#34;)ï¼Œæ²¡æœ‰è¿‡æœŸæ—¶é—´ return c.Redis.Set(ctx, key, data, expiration).Err() } func (c *RedisCache) SimpleGet(ctx context.Context, key string) (data string, err error) { // 4. Get: è·å–é”®çš„å€¼ data, err = c.Redis.Get(ctx, key).Result() if errors.Is(err, redis.Nil) || err != nil { return \u0026#34;\u0026#34;, err } else { return data, nil } } redislock.go\npackage cache import ( //\u0026#34;codeup.aliyun.com/619b3cb12f595dbd1b9b0b3e/go/common.git/id\u0026#34; \u0026#34;codeup.aliyun.com/619b3cb12f595dbd1b9b0b3e/go/common.git/log\u0026#34; \u0026#34;context\u0026#34; \u0026#34;github.com/google/uuid\u0026#34; \u0026#34;github.com/pkg/errors\u0026#34; \u0026#34;github.com/redis/go-redis/v9\u0026#34; \u0026#34;sync\u0026#34; \u0026#34;time\u0026#34; ) // å®ç°åˆ†å¸ƒå¼é” // å‡ ä¸ª è¦ç‚¹ // äº’æ–¥ redis å¤©ç„¶æ”¯æŒ // 1.set nx px è®¾ç½®è¿‡æœŸæ—¶é—´ 5.0ä¹‹åå¯ä»¥ä¸€æ¡å‘½ä»¤è®¾ç½® // 2.é‡Šæ”¾é”çš„æ—¶å€™éœ€è¦åˆ¤æ–­ï¼Œçº¿ç¨‹å¡ä½ï¼Œè‡ªåŠ¨è¿‡æœŸï¼Œå…¶ä»–çº¿ç¨‹åŠ é”ï¼Œä½ å†åˆ é™¤ä¹äº”åˆ é™¤äº† // 3.éœ€è¦ lua è„šæœ¬ æ‰§è¡Œåˆ é™¤æ“ä½œ å› ä¸ºåˆ¤æ–­å’Œåˆ é™¤æ˜¯2ä¸ªæ“ä½œ ã€‚ åˆ¤æ–­å’Œåˆ é™¤çš„è¿‡ç¨‹ä¸­ï¼Œé”è¿‡æœŸï¼Œåˆšå¥½å…¶ä»–çº¿ç¨‹ä¸Šé”ï¼Œ // å°±ä¼šå¯¼è‡´è¯¯åˆ é™¤ã€‚ // 4.å¯é‡å…¥ï¼ˆçœ‹å…·ä½“ä¸šåŠ¡ï¼‰ã€ è‡ªåŠ¨ç»­æœŸï¼ˆçœ‹é—¨ç‹—ï¼‰ type Lock struct { client redis.UniversalClient key string uuID string MaxTtl int wg *sync.WaitGroup cancel context.CancelFunc } func NewLock(client redis.UniversalClient, key string) *Lock { //sf := id.NewSonyflake() uuID := uuid.NewString() return \u0026amp;Lock{ client: client, uuID: uuID, MaxTtl: 5, key: key + \u0026#34;:lock\u0026#34;, wg: \u0026amp;sync.WaitGroup{}, } } func (l *Lock) Lock(ctx context.Context, expire time.Duration) (err error) { ok, _ := l.client.SetNX(ctx, l.key, l.uuID, expire).Result() if !ok { return errors.New(\u0026#34;lock failed\u0026#34;) } // è®¾ç½®æœ€å¤§å»¶æœŸæ—¶é—´ // åœ¨ Lock æ–¹æ³•ä¸­ä¿®æ­£ maxTtl çš„è®¡ç®— maxTtl := time.Duration(l.MaxTtl) * expire ctx, cancel := context.WithCancel(ctx) l.cancel = cancel go l.startWatchdog(ctx, expire, maxTtl) return } func (l *Lock) startWatchdog(ctx context.Context, expire time.Duration, maxTtl time.Duration) { l.wg.Add(1) defer l.wg.Done() ctx, cancel := context.WithTimeout(ctx, maxTtl) defer cancel() timer := time.NewTicker(expire / 3) defer timer.Stop() for { select { case \u0026lt;-timer.C: // å»¶æœŸ extensionScript := ` if redis.call(\u0026#34;GET\u0026#34;, KEYS[1]) == ARGV[1] then return redis.call(\u0026#34;PEXPIRE\u0026#34;, KEYS[1], ARGV[2]) else return 0 end ` expireMs := int64(expire.Milliseconds()) err := l.client.Eval(ctx, extensionScript, []string{l.key}, l.uuID, expireMs).Err() if err != nil { log.Info(err.Error()) return } case \u0026lt;-ctx.Done(): return } } } func (l *Lock) UnLock(ctx context.Context) (err error) { if l.cancel == nil { return errors.New(\u0026#34;lock not held\u0026#34;) } // é‡Šæ”¾watchdog l.cancel() l.wg.Wait() script := ` if redis.call(\u0026#34;GET\u0026#34;, KEYS[1]) == ARGV[1] then return redis.call(\u0026#34;DEL\u0026#34;, KEYS[1]) else return 0 end ` ok, err := l.client.Eval(ctx, script, []string{l.key}, l.uuID).Result() if err != nil { return err } if ok.(int64) != 1 { return errors.New(\u0026#34;unlock failed: lock not held\u0026#34;) } return nil } ",
"tags":null,
"categories":null
},{
"title":"é›¶æ‹·è´",
"permalink": "http://localhost:1313/posts/cs/%E9%9B%B6%E6%8B%B7%E8%B4%9D/",
"summary": "é›¶æ‹·è´æŠ€æœ¯ é€šè¿‡sendfile ç­‰å‡½æ•°å‡å°‘ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢ï¼Œå‡å°‘æ‹·è´æ¬¡æ•°ï¼ŒåŠ å¿«æ–‡ä»¶ä¼ è¾“é€Ÿåº¦ï¼Œä½†åªé€‚ç”¨äºåŸæ ·ä¼ è¾“çš„åœºæ™¯ï¼Œæ¯”å¦‚é™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼Œæ¯”å¦‚mysql ä¹Ÿæ˜¯ç£ç›˜åŠ è½½æ•°æ®ï¼Œä½†æ˜¯éœ€è¦å¯¹å–å‡ºæ¥çš„æ•°æ®åšå„ç§å¤„ç†å°±ä¸é€‚åˆè¿™ç§åœºæ™¯ã€‚\n",
"content": "é›¶æ‹·è´æŠ€æœ¯ é€šè¿‡sendfile ç­‰å‡½æ•°å‡å°‘ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢ï¼Œå‡å°‘æ‹·è´æ¬¡æ•°ï¼ŒåŠ å¿«æ–‡ä»¶ä¼ è¾“é€Ÿåº¦ï¼Œä½†åªé€‚ç”¨äºåŸæ ·ä¼ è¾“çš„åœºæ™¯ï¼Œæ¯”å¦‚é™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼Œæ¯”å¦‚mysql ä¹Ÿæ˜¯ç£ç›˜åŠ è½½æ•°æ®ï¼Œä½†æ˜¯éœ€è¦å¯¹å–å‡ºæ¥çš„æ•°æ®åšå„ç§å¤„ç†å°±ä¸é€‚åˆè¿™ç§åœºæ™¯ã€‚\n",
"tags":null,
"categories":null
},{
"title":"Str_ç™¾åº¦çœŸé¢˜åŸåœ°ç½®æ¢å¤§å°å†™",
"permalink": "http://localhost:1313/posts/datastructalgorithm/str_%E7%99%BE%E5%BA%A6%E7%9C%9F%E9%A2%98%E5%8E%9F%E5%9C%B0%E7%BD%AE%E6%8D%A2%E5%A4%A7%E5%B0%8F%E5%86%99/",
"summary": "ä»£ç å®ç° package test3 import ( \u0026#34;fmt\u0026#34; \u0026#34;unicode\u0026#34; ) func main() { //è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‡Œé¢æœ‰å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ï¼Œ //å¤„ç†ç»“æŸåï¼Œå¤§å†™å­—æ¯åœ¨å‰ï¼Œç„¶åæ˜¯å°å†™å­—æ¯ï¼Œæœ€åæ˜¯æ•°å­—ï¼Œ //è¦æ±‚ï¼šåœ¨åŸæœ‰å­—ç¬¦ä¸²ä¸Šåšäº¤æ¢å®ç°ï¼Œä¸è¦å»ºæ–°çš„æ•°æ®ç»“æ„ã€‚ //mN1oO2pP3 //Nm1oO2pP3 str := []rune(\u0026#34;mN1oO2pP3\u0026#34;) // AbcafafaaFAs exchangePos(str) fmt.Println(string(str)) } func exchangePos(str []rune) { // i æ‰¾éå¤§å†™å­—æ¯ j æ‰¾å¤§å†™å­—æ¯ å¦‚æœ i ï¼= j äº¤æ¢ length := len(str) i, j := 0, 0 for i \u0026lt; length \u0026amp;\u0026amp; j \u0026lt; length { if isUper(str[j]) { //\u0026amp;\u0026amp; !isUper(rune(str[i])) if i != j { str[i], str[j] = str[j], str[i] i++ } } if isUper(str[i]) { i++ } j++ } // i ä»ä¸Šä¸€æ¬¡ç»“æŸä¸ºæ­¢å¼€å§‹ï¼Œæ‰¾ æ•°å­—ï¼Œ j æ‰¾å°å†™å­—æ¯ å¦‚æœ i ï¼= j äº¤æ¢ j = i //fmt.Println(string(str), i, j) for i \u0026lt; length \u0026amp;\u0026amp; j \u0026lt; length { if isLower(str[j]) { //\u0026amp;\u0026amp; !isUper(rune(str[i])) if i != j { str[i], str[j] = str[j], str[i] i++ } } if isLower(str[i]) { i++ } j++ } return } func isUper(s rune) bool { return unicode.IsUpper(s) } func isLower(s rune) bool { return unicode.IsLower(s) } æµ‹è¯•ç”¨ä¾‹ package test3 import ( \u0026#34;testing\u0026#34; ) func TestExchangePos(t *testing.T) { cases := []struct { input string expected string }{ // åŸºç¡€æƒ…å†µ {\u0026#34;\u0026#34;, \u0026#34;\u0026#34;}, {\u0026#34;A\u0026#34;, \u0026#34;A\u0026#34;}, {\u0026#34;a\u0026#34;, \u0026#34;a\u0026#34;}, {\u0026#34;1\u0026#34;, \u0026#34;1\u0026#34;}, // å·²ç»æœ‰åº {\u0026#34;ABCabc123\u0026#34;, \u0026#34;ABCabc123\u0026#34;}, // å®Œå…¨é€†åº {\u0026#34;123cbaCBA\u0026#34;, \u0026#34;CBAcba123\u0026#34;}, // æ··åˆ {\u0026#34;aA1\u0026#34;, \u0026#34;Aa1\u0026#34;}, {\u0026#34;1aA\u0026#34;, \u0026#34;Aa1\u0026#34;}, {\u0026#34;Aa1Bb2Cc3\u0026#34;, \u0026#34;ABCabc123\u0026#34;}, // ä¸¤ç±»å­—ç¬¦ {\u0026#34;abc123\u0026#34;, \u0026#34;abc123\u0026#34;}, {\u0026#34;ABC123\u0026#34;, \u0026#34;ABC123\u0026#34;}, {\u0026#34;ABCabc\u0026#34;, \u0026#34;ABCabc\u0026#34;}, // å…¨éƒ¨åŒç±» {\u0026#34;ABCDEF\u0026#34;, \u0026#34;ABCDEF\u0026#34;}, {\u0026#34;abcdef\u0026#34;, \u0026#34;abcdef\u0026#34;}, {\u0026#34;123456\u0026#34;, \u0026#34;123456\u0026#34;}, // éšæœºæ··ä¹± {\u0026#34;Zy9Xx8Ww7\u0026#34;, \u0026#34;ZXWyxw987\u0026#34;}, {\u0026#34;mN1oO2pP3\u0026#34;, \u0026#34;NOPomp213\u0026#34;}, // è¾¹ç•Œ {\u0026#34;A1a\u0026#34;, \u0026#34;Aa1\u0026#34;}, {\u0026#34;1A1aA1\u0026#34;, \u0026#34;AAa111\u0026#34;}, {\u0026#34;zZ9zZ9\u0026#34;, \u0026#34;ZZzz99\u0026#34;}, // é‡å¤æ¨¡å¼ / é•¿åº¦è¾ƒå¤§ {\u0026#34;Aa1Aa1Aa1Aa1\u0026#34;, \u0026#34;AAAAaaaa1111\u0026#34;}, {\u0026#34;987ZYXcba654\u0026#34;, \u0026#34;ZYXcba987654\u0026#34;}, } for _, c := range cases { runes := []rune(c.input) exchangePos(runes) got := string(runes) if got != c.expected { t.Errorf(\u0026#34;exchangePos(%q) = %q; expected %q\u0026#34;, c.input, got, c.expected) } } } ",
"content": "ä»£ç å®ç° package test3 import ( \u0026#34;fmt\u0026#34; \u0026#34;unicode\u0026#34; ) func main() { //è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‡Œé¢æœ‰å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ï¼Œ //å¤„ç†ç»“æŸåï¼Œå¤§å†™å­—æ¯åœ¨å‰ï¼Œç„¶åæ˜¯å°å†™å­—æ¯ï¼Œæœ€åæ˜¯æ•°å­—ï¼Œ //è¦æ±‚ï¼šåœ¨åŸæœ‰å­—ç¬¦ä¸²ä¸Šåšäº¤æ¢å®ç°ï¼Œä¸è¦å»ºæ–°çš„æ•°æ®ç»“æ„ã€‚ //mN1oO2pP3 //Nm1oO2pP3 str := []rune(\u0026#34;mN1oO2pP3\u0026#34;) // AbcafafaaFAs exchangePos(str) fmt.Println(string(str)) } func exchangePos(str []rune) { // i æ‰¾éå¤§å†™å­—æ¯ j æ‰¾å¤§å†™å­—æ¯ å¦‚æœ i ï¼= j äº¤æ¢ length := len(str) i, j := 0, 0 for i \u0026lt; length \u0026amp;\u0026amp; j \u0026lt; length { if isUper(str[j]) { //\u0026amp;\u0026amp; !isUper(rune(str[i])) if i != j { str[i], str[j] = str[j], str[i] i++ } } if isUper(str[i]) { i++ } j++ } // i ä»ä¸Šä¸€æ¬¡ç»“æŸä¸ºæ­¢å¼€å§‹ï¼Œæ‰¾ æ•°å­—ï¼Œ j æ‰¾å°å†™å­—æ¯ å¦‚æœ i ï¼= j äº¤æ¢ j = i //fmt.Println(string(str), i, j) for i \u0026lt; length \u0026amp;\u0026amp; j \u0026lt; length { if isLower(str[j]) { //\u0026amp;\u0026amp; !isUper(rune(str[i])) if i != j { str[i], str[j] = str[j], str[i] i++ } } if isLower(str[i]) { i++ } j++ } return } func isUper(s rune) bool { return unicode.IsUpper(s) } func isLower(s rune) bool { return unicode.IsLower(s) } æµ‹è¯•ç”¨ä¾‹ package test3 import ( \u0026#34;testing\u0026#34; ) func TestExchangePos(t *testing.T) { cases := []struct { input string expected string }{ // åŸºç¡€æƒ…å†µ {\u0026#34;\u0026#34;, \u0026#34;\u0026#34;}, {\u0026#34;A\u0026#34;, \u0026#34;A\u0026#34;}, {\u0026#34;a\u0026#34;, \u0026#34;a\u0026#34;}, {\u0026#34;1\u0026#34;, \u0026#34;1\u0026#34;}, // å·²ç»æœ‰åº {\u0026#34;ABCabc123\u0026#34;, \u0026#34;ABCabc123\u0026#34;}, // å®Œå…¨é€†åº {\u0026#34;123cbaCBA\u0026#34;, \u0026#34;CBAcba123\u0026#34;}, // æ··åˆ {\u0026#34;aA1\u0026#34;, \u0026#34;Aa1\u0026#34;}, {\u0026#34;1aA\u0026#34;, \u0026#34;Aa1\u0026#34;}, {\u0026#34;Aa1Bb2Cc3\u0026#34;, \u0026#34;ABCabc123\u0026#34;}, // ä¸¤ç±»å­—ç¬¦ {\u0026#34;abc123\u0026#34;, \u0026#34;abc123\u0026#34;}, {\u0026#34;ABC123\u0026#34;, \u0026#34;ABC123\u0026#34;}, {\u0026#34;ABCabc\u0026#34;, \u0026#34;ABCabc\u0026#34;}, // å…¨éƒ¨åŒç±» {\u0026#34;ABCDEF\u0026#34;, \u0026#34;ABCDEF\u0026#34;}, {\u0026#34;abcdef\u0026#34;, \u0026#34;abcdef\u0026#34;}, {\u0026#34;123456\u0026#34;, \u0026#34;123456\u0026#34;}, // éšæœºæ··ä¹± {\u0026#34;Zy9Xx8Ww7\u0026#34;, \u0026#34;ZXWyxw987\u0026#34;}, {\u0026#34;mN1oO2pP3\u0026#34;, \u0026#34;NOPomp213\u0026#34;}, // è¾¹ç•Œ {\u0026#34;A1a\u0026#34;, \u0026#34;Aa1\u0026#34;}, {\u0026#34;1A1aA1\u0026#34;, \u0026#34;AAa111\u0026#34;}, {\u0026#34;zZ9zZ9\u0026#34;, \u0026#34;ZZzz99\u0026#34;}, // é‡å¤æ¨¡å¼ / é•¿åº¦è¾ƒå¤§ {\u0026#34;Aa1Aa1Aa1Aa1\u0026#34;, \u0026#34;AAAAaaaa1111\u0026#34;}, {\u0026#34;987ZYXcba654\u0026#34;, \u0026#34;ZYXcba987654\u0026#34;}, } for _, c := range cases { runes := []rune(c.input) exchangePos(runes) got := string(runes) if got != c.expected { t.Errorf(\u0026#34;exchangePos(%q) = %q; expected %q\u0026#34;, c.input, got, c.expected) } } } ",
"tags":null,
"categories":null
},{
"title":"Matrix_å¤šæºæ‰©æ•£",
"permalink": "http://localhost:1313/posts/datastructalgorithm/matrix_%E5%A4%9A%E6%BA%90%E6%89%A9%E6%95%A3/",
"summary": "package main import ( \u0026#34;bufio\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;os\u0026#34; \u0026#34;strconv\u0026#34; \u0026#34;strings\u0026#34; ) // é¢˜ç›®æè¿° // // å­˜åœ¨ä¸€ä¸ªmxnçš„äºŒç»´æ•°ç»„ï¼Œå…¶æˆå‘˜å–å€¼èŒƒå›´ä¸º0æˆ–1ï¼Œå…¶ä¸­å€¼ä¸º1çš„æˆå‘˜å…·å¤‡æ‰©æ•£æ€§ï¼Œæ¯ç»è¿‡1Sï¼Œå°†ä¸Šä¸‹å·¦å³å€¼ä¸º0çš„æˆå‘˜åŒåŒ–ä¸º1ï¼ŒäºŒç»´æ•°ç»„çš„æˆå‘˜åˆå§‹å€¼éƒ½ä¸º0ï¼Œå°†ç¬¬[i,j]å’Œ[k,l]ä¸¤ä¸ªä¸ªä½ç½®ä¸Šå…ƒç´ ä¿®æ”¹æˆ1åï¼Œæ±‚çŸ©é˜µçš„æ‰€æœ‰ï¼Œå…ƒç´ å˜ä¸º1éœ€è¦å¤šé•¿æ—¶é—´ // // è¾“å…¥æè¿° // // è¾“å…¥æ•°æ®ä¸­çš„å‰2ä¸ªæ•°å­—è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªmxnçš„çŸ©é˜µï¼Œmå’Œnä¸ä¼šè¶…è¿‡1024å¤§å°; // // ä¸­é—´ä¸¤ä¸ªæ•°å­—è¡¨ç¤ºä¸€ä¸ªåˆå§‹æ‰©æ•£ç‚¹ä½ç½®ä¸ºI,j // // æœ€å2ä¸ªæ•°å­—è¡¨ç¤ºå¦ä¸€ä¸ªæ‰©æ•£ç‚¹ä½ç½®ä¸ºk,l // // è¾“å‡ºæè¿° // // è¾“å‡ºçŸ©é˜µçš„æ‰€æœ‰å…ƒç´ å˜ä¸º1æ‰€éœ€è¦ç§’æ•° // // ç”¨ä¾‹ func main() { input := bufio.NewScanner(os.Stdin) input.Scan() str := input.Text() strArr := strings.Split(str, \u0026#34;,\u0026#34;) m, n := Atoi(strArr[0]), Atoi(strArr[1]) pos1, pos2, pos3, pos4 := Atoi(strArr[2]), Atoi(strArr[3]), Atoi(strArr[4]), Atoi(strArr[5]) time := getMatrixBroadcastTime(m, n, pos1, pos2, pos3, pos4) fmt.Println(time) } func getMatrixBroadcastTime(m, n, pos1, pos2, pos3, pos4 int) (res int) { path := make([]string, 0) path = append(path, getPos(pos1, pos2)) path = append(path, getPos(pos3, pos4)) check := make(map[string]bool) check[getPos(pos1, pos2)] = true check[getPos(pos3, pos4)] = true count := 2 for len(path) \u0026gt; 0 { length := len(path) for i := 0; i \u0026lt; length; i++ { pos := strings.Split(path[i], \u0026#34;_\u0026#34;) x, y := Atoi(pos[0]), Atoi(pos[1]) // ä¸Š if x-1 \u0026gt;= 0 \u0026amp;\u0026amp; check[getPos(x-1, y)] != true { path = append(path, getPos(x-1, y)) check[getPos(x-1, y)] = true count++ } // ä¸‹ if x+1 \u0026lt; m \u0026amp;\u0026amp; check[getPos(x+1, y)] != true { path = append(path, getPos(x+1, y)) check[getPos(x+1, y)] = true count++ } // å·¦ if y-1 \u0026gt;= 0 \u0026amp;\u0026amp; check[getPos(x, y-1)] != true { path = append(path, getPos(x, y-1)) check[getPos(x, y-1)] = true count++ } // å³ if y+1 \u0026lt; n \u0026amp;\u0026amp; check[getPos(x, y+1)] != true { path = append(path, getPos(x, y+1)) check[getPos(x, y+1)] = true count++ } } res++ if count \u0026gt;= m*n { return } } return } func getPos(x, y int) string { return fmt.Sprintf(\u0026#34;%d_%d\u0026#34;, x, y) } func Atoi(str string) int { res, _ := strconv.Atoi(str) return res } ",
"content": "package main import ( \u0026#34;bufio\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;os\u0026#34; \u0026#34;strconv\u0026#34; \u0026#34;strings\u0026#34; ) // é¢˜ç›®æè¿° // // å­˜åœ¨ä¸€ä¸ªmxnçš„äºŒç»´æ•°ç»„ï¼Œå…¶æˆå‘˜å–å€¼èŒƒå›´ä¸º0æˆ–1ï¼Œå…¶ä¸­å€¼ä¸º1çš„æˆå‘˜å…·å¤‡æ‰©æ•£æ€§ï¼Œæ¯ç»è¿‡1Sï¼Œå°†ä¸Šä¸‹å·¦å³å€¼ä¸º0çš„æˆå‘˜åŒåŒ–ä¸º1ï¼ŒäºŒç»´æ•°ç»„çš„æˆå‘˜åˆå§‹å€¼éƒ½ä¸º0ï¼Œå°†ç¬¬[i,j]å’Œ[k,l]ä¸¤ä¸ªä¸ªä½ç½®ä¸Šå…ƒç´ ä¿®æ”¹æˆ1åï¼Œæ±‚çŸ©é˜µçš„æ‰€æœ‰ï¼Œå…ƒç´ å˜ä¸º1éœ€è¦å¤šé•¿æ—¶é—´ // // è¾“å…¥æè¿° // // è¾“å…¥æ•°æ®ä¸­çš„å‰2ä¸ªæ•°å­—è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªmxnçš„çŸ©é˜µï¼Œmå’Œnä¸ä¼šè¶…è¿‡1024å¤§å°; // // ä¸­é—´ä¸¤ä¸ªæ•°å­—è¡¨ç¤ºä¸€ä¸ªåˆå§‹æ‰©æ•£ç‚¹ä½ç½®ä¸ºI,j // // æœ€å2ä¸ªæ•°å­—è¡¨ç¤ºå¦ä¸€ä¸ªæ‰©æ•£ç‚¹ä½ç½®ä¸ºk,l // // è¾“å‡ºæè¿° // // è¾“å‡ºçŸ©é˜µçš„æ‰€æœ‰å…ƒç´ å˜ä¸º1æ‰€éœ€è¦ç§’æ•° // // ç”¨ä¾‹ func main() { input := bufio.NewScanner(os.Stdin) input.Scan() str := input.Text() strArr := strings.Split(str, \u0026#34;,\u0026#34;) m, n := Atoi(strArr[0]), Atoi(strArr[1]) pos1, pos2, pos3, pos4 := Atoi(strArr[2]), Atoi(strArr[3]), Atoi(strArr[4]), Atoi(strArr[5]) time := getMatrixBroadcastTime(m, n, pos1, pos2, pos3, pos4) fmt.Println(time) } func getMatrixBroadcastTime(m, n, pos1, pos2, pos3, pos4 int) (res int) { path := make([]string, 0) path = append(path, getPos(pos1, pos2)) path = append(path, getPos(pos3, pos4)) check := make(map[string]bool) check[getPos(pos1, pos2)] = true check[getPos(pos3, pos4)] = true count := 2 for len(path) \u0026gt; 0 { length := len(path) for i := 0; i \u0026lt; length; i++ { pos := strings.Split(path[i], \u0026#34;_\u0026#34;) x, y := Atoi(pos[0]), Atoi(pos[1]) // ä¸Š if x-1 \u0026gt;= 0 \u0026amp;\u0026amp; check[getPos(x-1, y)] != true { path = append(path, getPos(x-1, y)) check[getPos(x-1, y)] = true count++ } // ä¸‹ if x+1 \u0026lt; m \u0026amp;\u0026amp; check[getPos(x+1, y)] != true { path = append(path, getPos(x+1, y)) check[getPos(x+1, y)] = true count++ } // å·¦ if y-1 \u0026gt;= 0 \u0026amp;\u0026amp; check[getPos(x, y-1)] != true { path = append(path, getPos(x, y-1)) check[getPos(x, y-1)] = true count++ } // å³ if y+1 \u0026lt; n \u0026amp;\u0026amp; check[getPos(x, y+1)] != true { path = append(path, getPos(x, y+1)) check[getPos(x, y+1)] = true count++ } } res++ if count \u0026gt;= m*n { return } } return } func getPos(x, y int) string { return fmt.Sprintf(\u0026#34;%d_%d\u0026#34;, x, y) } func Atoi(str string) int { res, _ := strconv.Atoi(str) return res } ",
"tags":null,
"categories":null
},{
"title":"Str_åˆ¤æ–­å­—ç¬¦é¡ºåºå’Œå­˜åœ¨",
"permalink": "http://localhost:1313/posts/datastructalgorithm/str_%E5%88%A4%E6%96%AD%E5%AD%97%E7%AC%A6%E9%A1%BA%E5%BA%8F%E5%92%8C%E5%AD%98%E5%9C%A8/",
"summary": "package test1 import \u0026#34;sort\u0026#34; //é¢˜ç›® // é¢˜ç›®æè¿°è¾“å…¥ä¸¤ä¸ªå­—ç¬¦ä¸²Så’ŒLï¼Œéƒ½åªåŒ…å«è‹±æ–‡å°å†™å­—æ¯ã€‚Sé•¿åº¦\u0026lt;=100ï¼ŒLé•¿åº¦\u0026lt;=500,000ã€‚ //åˆ¤å®šSæ˜¯å¦æ˜¯Lçš„æœ‰æ•ˆå­ä¸²ã€‚åˆ¤å®šè§„åˆ™ï¼šSä¸­çš„æ¯ä¸ªå­—ç¬¦åœ¨Lä¸­éƒ½èƒ½æ‰¾åˆ°ï¼ˆå¯ä»¥ä¸è¿ç»­ï¼‰ï¼Œä¸”Såœ¨ï¼¬ä¸­å­—ç¬¦çš„å‰åé¡ºåºä¸Sä¸­é¡ºåºè¦ä¿æŒä¸€è‡´ã€‚ //ï¼ˆä¾‹å¦‚ï¼ŒS=â€aceâ€æ˜¯L=â€abcdeâ€çš„ä¸€ä¸ªå­åºåˆ—ä¸”æœ‰æ•ˆå­—ç¬¦æ˜¯aã€cã€eï¼Œè€Œâ€aecâ€ä¸æ˜¯æœ‰æ•ˆå­åºåˆ—ï¼Œä¸”æœ‰æ•ˆå­—ç¬¦åªæœ‰aã€eï¼‰ //è¾“å…¥è¾“å‡º //è¾“å…¥è¾“å…¥ä¸¤ä¸ªå­—ç¬¦ä¸²Så’ŒLï¼Œéƒ½åªåŒ…å«è‹±æ–‡å°å†™å­—æ¯ã€‚Sé•¿åº¦\u0026lt;=100ï¼ŒLé•¿åº¦\u0026lt;=500,000ã€‚ //å…ˆè¾“å…¥Sï¼Œå†è¾“å…¥Lï¼Œæ¯ä¸ªå­—ç¬¦ä¸²å ä¸€è¡Œã€‚è¾“å‡ºSä¸²æœ€åä¸€ä¸ªæœ‰æ•ˆå­—ç¬¦åœ¨Lä¸­çš„ä½ç½®ã€‚ //ï¼ˆé¦–ä½ä»0å¼€å§‹è®¡ç®—ï¼Œæ— æœ‰æ•ˆå­—ç¬¦è¿”å›-1ï¼‰ func SubStrLasPos(str string, sub string) int { // aabcdabc 8 // abc findKey := -1 // å¾ªç¯æ‰¾åˆ°æ‰€æœ‰çš„å­—ç¬¦åœ¨strä¸­çš„ä½ç½® é¢„å¤„ç† strPos := make(map[byte][]int) for i := 0; i \u0026lt; len(str); i++ { strPos[str[i]] = append(strPos[str[i]], i) } // limit é™åˆ¶æ¯ä¸ªå­—ç¬¦çš„ä½ç½® å½“å‰å€¼æ¯”åä¸€ä¸ªå€¼çš„æœ€å¤§ä½ç½®è¦å°æ‰è¡Œ limit := len(str) for i := len(sub) - 1; i \u0026gt;= 0; i-- { if _, ok := strPos[sub[i]]; !ok { return -1 } else { subArr := strPos[sub[i]] //sort.SearchInts() // å¦‚æœæ»¡è¶³å­æ•°ç»„çš„ä½ç½®æ¯”Limit å° å°±ok key := sort.SearchInts(subArr, limit) if key == 0 { return -1 } limit = subArr[key-1] if i == len(sub)-1 { findKey = limit } } // æ’åºæ‹¿åˆ°æœ€å¤§çš„å€¼ //sort.Slice(strPos[sub[i]], func(i, j int) bool { //\treturn strPos[sub[i]][i] \u0026lt; strPos[sub[i]][j] //}) } return findKey } func search(arr []int, limit int) int { low, high := 0, len(arr)-1 for low \u0026lt;= high { mid := low + (high-low)/2 if arr[mid] == limit { return mid } else if arr[mid] \u0026gt; limit { high = mid - 1 } else { low = mid + 1 } } return -1 } ",
"content": "package test1 import \u0026#34;sort\u0026#34; //é¢˜ç›® // é¢˜ç›®æè¿°è¾“å…¥ä¸¤ä¸ªå­—ç¬¦ä¸²Så’ŒLï¼Œéƒ½åªåŒ…å«è‹±æ–‡å°å†™å­—æ¯ã€‚Sé•¿åº¦\u0026lt;=100ï¼ŒLé•¿åº¦\u0026lt;=500,000ã€‚ //åˆ¤å®šSæ˜¯å¦æ˜¯Lçš„æœ‰æ•ˆå­ä¸²ã€‚åˆ¤å®šè§„åˆ™ï¼šSä¸­çš„æ¯ä¸ªå­—ç¬¦åœ¨Lä¸­éƒ½èƒ½æ‰¾åˆ°ï¼ˆå¯ä»¥ä¸è¿ç»­ï¼‰ï¼Œä¸”Såœ¨ï¼¬ä¸­å­—ç¬¦çš„å‰åé¡ºåºä¸Sä¸­é¡ºåºè¦ä¿æŒä¸€è‡´ã€‚ //ï¼ˆä¾‹å¦‚ï¼ŒS=â€aceâ€æ˜¯L=â€abcdeâ€çš„ä¸€ä¸ªå­åºåˆ—ä¸”æœ‰æ•ˆå­—ç¬¦æ˜¯aã€cã€eï¼Œè€Œâ€aecâ€ä¸æ˜¯æœ‰æ•ˆå­åºåˆ—ï¼Œä¸”æœ‰æ•ˆå­—ç¬¦åªæœ‰aã€eï¼‰ //è¾“å…¥è¾“å‡º //è¾“å…¥è¾“å…¥ä¸¤ä¸ªå­—ç¬¦ä¸²Så’ŒLï¼Œéƒ½åªåŒ…å«è‹±æ–‡å°å†™å­—æ¯ã€‚Sé•¿åº¦\u0026lt;=100ï¼ŒLé•¿åº¦\u0026lt;=500,000ã€‚ //å…ˆè¾“å…¥Sï¼Œå†è¾“å…¥Lï¼Œæ¯ä¸ªå­—ç¬¦ä¸²å ä¸€è¡Œã€‚è¾“å‡ºSä¸²æœ€åä¸€ä¸ªæœ‰æ•ˆå­—ç¬¦åœ¨Lä¸­çš„ä½ç½®ã€‚ //ï¼ˆé¦–ä½ä»0å¼€å§‹è®¡ç®—ï¼Œæ— æœ‰æ•ˆå­—ç¬¦è¿”å›-1ï¼‰ func SubStrLasPos(str string, sub string) int { // aabcdabc 8 // abc findKey := -1 // å¾ªç¯æ‰¾åˆ°æ‰€æœ‰çš„å­—ç¬¦åœ¨strä¸­çš„ä½ç½® é¢„å¤„ç† strPos := make(map[byte][]int) for i := 0; i \u0026lt; len(str); i++ { strPos[str[i]] = append(strPos[str[i]], i) } // limit é™åˆ¶æ¯ä¸ªå­—ç¬¦çš„ä½ç½® å½“å‰å€¼æ¯”åä¸€ä¸ªå€¼çš„æœ€å¤§ä½ç½®è¦å°æ‰è¡Œ limit := len(str) for i := len(sub) - 1; i \u0026gt;= 0; i-- { if _, ok := strPos[sub[i]]; !ok { return -1 } else { subArr := strPos[sub[i]] //sort.SearchInts() // å¦‚æœæ»¡è¶³å­æ•°ç»„çš„ä½ç½®æ¯”Limit å° å°±ok key := sort.SearchInts(subArr, limit) if key == 0 { return -1 } limit = subArr[key-1] if i == len(sub)-1 { findKey = limit } } // æ’åºæ‹¿åˆ°æœ€å¤§çš„å€¼ //sort.Slice(strPos[sub[i]], func(i, j int) bool { //\treturn strPos[sub[i]][i] \u0026lt; strPos[sub[i]][j] //}) } return findKey } func search(arr []int, limit int) int { low, high := 0, len(arr)-1 for low \u0026lt;= high { mid := low + (high-low)/2 if arr[mid] == limit { return mid } else if arr[mid] \u0026gt; limit { high = mid - 1 } else { low = mid + 1 } } return -1 } ",
"tags":null,
"categories":null
},{
"title":"è¿‡æœŸç­–ç•¥ä¸å†…å­˜æ·˜æ±°ç­–ç•¥",
"permalink": "http://localhost:1313/posts/cache/%E8%BF%87%E6%9C%9F%E7%AD%96%E7%95%A5%E4%B8%8E%E5%86%85%E5%AD%98%E6%B7%98%E6%B1%B0%E7%AD%96%E7%95%A5/",
"summary": " ä¸€ã€Redis çš„é”®è¿‡æœŸæœºåˆ¶ Redis å¯ä»¥å¯¹æ¯ä¸ª key è®¾ç½®ä¸€ä¸ª è¿‡æœŸæ—¶é—´ï¼ˆTTL, Time To Liveï¼‰ï¼Œè¿‡æœŸå key ä¼šè¢«åˆ é™¤ã€‚\n1. è¿‡æœŸç­–ç•¥ Redis å¯¹ key çš„è¿‡æœŸæœ‰ä¸¤ç§ç­–ç•¥ï¼š\n(1) æƒ°æ€§åˆ é™¤ï¼ˆLazy Expirationï¼‰ åŸç†ï¼šåªæœ‰å½“ key è¢«è®¿é—®æ—¶ï¼ŒRedis æ‰æ£€æŸ¥å®ƒæ˜¯å¦è¿‡æœŸã€‚ ä¼˜ç‚¹ï¼šé¿å…äº†ä¸å¿…è¦çš„ CPU æ¶ˆè€—ã€‚ ç¼ºç‚¹ï¼šè¿‡æœŸ key å¦‚æœé•¿æ—¶é—´ä¸è®¿é—®ï¼Œä¼šå ç”¨å†…å­˜ã€‚ (2) å®šæœŸåˆ é™¤ï¼ˆPeriodic Expirationï¼‰ åŸç†ï¼šRedis ä¼šå‘¨æœŸæ€§ï¼ˆé»˜è®¤æ¯ 100msï¼‰éšæœºæ£€æŸ¥ä¸€äº›å¸¦è¿‡æœŸæ—¶é—´çš„ keyï¼Œå¹¶åˆ é™¤è¿‡æœŸ keyã€‚\nå®ç°ï¼š\næ¯æ¬¡æ£€æŸ¥ 20 ä¸ª keyã€‚ å¦‚æœè¿‡æœŸæ•°é‡ \u0026gt; 25%ï¼Œç»§ç»­æ£€æŸ¥ä¸‹ä¸€æ‰¹ keyã€‚ æ¯æ¬¡æ£€æŸ¥è€—æ—¶ä¸è¶…è¿‡ 1msã€‚ ä¼˜ç‚¹ï¼šå¯ä»¥åŠæ—¶å›æ”¶å†…å­˜ã€‚\nç¼ºç‚¹ï¼šä¸èƒ½ä¿è¯æ‰€æœ‰è¿‡æœŸ key ç«‹å³åˆ é™¤ï¼Œå¯èƒ½å»¶è¿Ÿã€‚\nRedis ç»¼åˆä½¿ç”¨äº†æƒ°æ€§åˆ é™¤å’Œå®šæœŸåˆ é™¤ï¼Œä¿è¯æ€§èƒ½å’ŒåŠæ—¶æ€§ä¹‹é—´çš„å¹³è¡¡ã€‚\n2. TTL å‘½ä»¤ EXPIRE key seconds è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ EXPIREAT key timestamp æŒ‰æ—¶é—´æˆ³è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ TTL key æŸ¥çœ‹å‰©ä½™æ—¶é—´ã€‚ PTTL key æŸ¥çœ‹æ¯«ç§’çº§ TTLã€‚ äºŒã€Redis çš„æ·˜æ±°ç­–ç•¥ï¼ˆå†…å­˜ä¸è¶³æ—¶ï¼‰ å½“ Redis è®¾ç½®äº† maxmemory é™åˆ¶ï¼Œå¹¶ä¸”å†…å­˜è¾¾åˆ°ä¸Šé™æ—¶ï¼Œéœ€è¦ æ·˜æ±°æ—§æ•°æ®ã€‚\n",
"content": " ä¸€ã€Redis çš„é”®è¿‡æœŸæœºåˆ¶ Redis å¯ä»¥å¯¹æ¯ä¸ª key è®¾ç½®ä¸€ä¸ª è¿‡æœŸæ—¶é—´ï¼ˆTTL, Time To Liveï¼‰ï¼Œè¿‡æœŸå key ä¼šè¢«åˆ é™¤ã€‚\n1. è¿‡æœŸç­–ç•¥ Redis å¯¹ key çš„è¿‡æœŸæœ‰ä¸¤ç§ç­–ç•¥ï¼š\n(1) æƒ°æ€§åˆ é™¤ï¼ˆLazy Expirationï¼‰ åŸç†ï¼šåªæœ‰å½“ key è¢«è®¿é—®æ—¶ï¼ŒRedis æ‰æ£€æŸ¥å®ƒæ˜¯å¦è¿‡æœŸã€‚ ä¼˜ç‚¹ï¼šé¿å…äº†ä¸å¿…è¦çš„ CPU æ¶ˆè€—ã€‚ ç¼ºç‚¹ï¼šè¿‡æœŸ key å¦‚æœé•¿æ—¶é—´ä¸è®¿é—®ï¼Œä¼šå ç”¨å†…å­˜ã€‚ (2) å®šæœŸåˆ é™¤ï¼ˆPeriodic Expirationï¼‰ åŸç†ï¼šRedis ä¼šå‘¨æœŸæ€§ï¼ˆé»˜è®¤æ¯ 100msï¼‰éšæœºæ£€æŸ¥ä¸€äº›å¸¦è¿‡æœŸæ—¶é—´çš„ keyï¼Œå¹¶åˆ é™¤è¿‡æœŸ keyã€‚\nå®ç°ï¼š\næ¯æ¬¡æ£€æŸ¥ 20 ä¸ª keyã€‚ å¦‚æœè¿‡æœŸæ•°é‡ \u0026gt; 25%ï¼Œç»§ç»­æ£€æŸ¥ä¸‹ä¸€æ‰¹ keyã€‚ æ¯æ¬¡æ£€æŸ¥è€—æ—¶ä¸è¶…è¿‡ 1msã€‚ ä¼˜ç‚¹ï¼šå¯ä»¥åŠæ—¶å›æ”¶å†…å­˜ã€‚\nç¼ºç‚¹ï¼šä¸èƒ½ä¿è¯æ‰€æœ‰è¿‡æœŸ key ç«‹å³åˆ é™¤ï¼Œå¯èƒ½å»¶è¿Ÿã€‚\nRedis ç»¼åˆä½¿ç”¨äº†æƒ°æ€§åˆ é™¤å’Œå®šæœŸåˆ é™¤ï¼Œä¿è¯æ€§èƒ½å’ŒåŠæ—¶æ€§ä¹‹é—´çš„å¹³è¡¡ã€‚\n2. TTL å‘½ä»¤ EXPIRE key seconds è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ EXPIREAT key timestamp æŒ‰æ—¶é—´æˆ³è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ TTL key æŸ¥çœ‹å‰©ä½™æ—¶é—´ã€‚ PTTL key æŸ¥çœ‹æ¯«ç§’çº§ TTLã€‚ äºŒã€Redis çš„æ·˜æ±°ç­–ç•¥ï¼ˆå†…å­˜ä¸è¶³æ—¶ï¼‰ å½“ Redis è®¾ç½®äº† maxmemory é™åˆ¶ï¼Œå¹¶ä¸”å†…å­˜è¾¾åˆ°ä¸Šé™æ—¶ï¼Œéœ€è¦ æ·˜æ±°æ—§æ•°æ®ã€‚\nRedis æ”¯æŒä»¥ä¸‹å‡ ç§æ·˜æ±°ç­–ç•¥ï¼š\nç­–ç•¥ è¡Œä¸º noeviction ä¸æ·˜æ±°ï¼Œç›´æ¥è¿”å›é”™è¯¯ï¼ˆå†™å‘½ä»¤å¤±è´¥ï¼‰ allkeys-lru å¯¹æ‰€æœ‰ key ä½¿ç”¨ LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç­–ç•¥ volatile-lru å¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ key ä½¿ç”¨ LRU allkeys-random éšæœºæ·˜æ±°ä»»æ„ key volatile-random éšæœºæ·˜æ±°æœ‰è¿‡æœŸæ—¶é—´çš„ key volatile-ttl ä¼˜å…ˆæ·˜æ±° TTL æœ€çŸ­çš„ key æ³¨æ„ï¼š\nallkeys è¡¨ç¤ºä»æ‰€æœ‰ key ä¸­é€‰æ‹©ã€‚ volatile è¡¨ç¤ºåªä»å¸¦è¿‡æœŸæ—¶é—´çš„ key ä¸­é€‰æ‹©ã€‚ 1. LRU æ·˜æ±°æœºåˆ¶ Redis ä¼šç»´æŠ¤ä¸€ä¸ª è¿‘ä¼¼ LRU æ•°æ®ç»“æ„ã€‚ å®ç°ä¸Šå¹¶ä¸æ˜¯å¯¹æ‰€æœ‰ key å®Œå…¨æ’åºï¼Œè€Œæ˜¯éšæœºæŠ½æ ·ï¼ˆé»˜è®¤ 5 ä¸ª keyï¼‰é€‰æ‹©æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ key æ·˜æ±°ã€‚ æ—¶é—´å¤æ‚åº¦ï¼šO(1)ï¼ˆè¿‘ä¼¼ LRUï¼‰ 2. LFU æ·˜æ±°æœºåˆ¶ï¼ˆRedis 4.0+ï¼‰ LFU = Least Frequently Usedï¼Œæ·˜æ±°ä½¿ç”¨é¢‘ç‡æœ€ä½çš„ keyã€‚\nRedis ç»´æŠ¤è®¿é—®é¢‘ç‡è®¡æ•°å™¨ï¼Œå®šæœŸè¡°å‡ã€‚\nç­–ç•¥ï¼š\nallkeys-lfuï¼šæ‰€æœ‰ key ä½¿ç”¨ LFUã€‚ volatile-lfuï¼šä»…å¯¹å¸¦ TTL çš„ key ä½¿ç”¨ LFUã€‚ 3. éšæœºæ·˜æ±° éšæœºé€‰æ‹© key æ·˜æ±°ï¼Œç®—æ³•ç®€å•ï¼Œä½†å¯èƒ½ä¼šæ·˜æ±°çƒ­æ•°æ®ã€‚ ä½¿ç”¨åœºæ™¯ï¼šä¸å…³å¿ƒå“ªäº›æ•°æ®æ›´é‡è¦çš„æƒ…å†µã€‚ 4. TTL æ·˜æ±° ä¼˜å…ˆæ·˜æ±°è¿‡æœŸæ—¶é—´æœ€çŸ­çš„ keyã€‚ ç”¨äºå¯¹æ•°æ®æ—¶æ•ˆæ€§æ•æ„Ÿçš„åœºæ™¯ã€‚ ä¸‰ã€Redis å†…å­˜å›æ”¶æ€»ç»“ è¿‡æœŸåˆ é™¤ï¼š\næƒ°æ€§åˆ é™¤ + å®šæœŸåˆ é™¤ å†…å­˜æ·˜æ±°ï¼ˆmaxmemory è¾¾åˆ°é™åˆ¶ï¼‰ï¼š\né…ç½® maxmemory-policyï¼ˆå¦‚ allkeys-lruã€volatile-lfu ç­‰ï¼‰ å…³é”®ç‚¹ï¼š\nRedis ä¸ä¼šæ¯ç§’æ‰«ææ‰€æœ‰ keyã€‚ æ·˜æ±°ç­–ç•¥æ˜¯ è¿‘ä¼¼ç®—æ³•ï¼Œå…¼é¡¾æ€§èƒ½å’Œå†…å­˜æ§åˆ¶ã€‚ å¯¹æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨ LRU/LFUã€‚ å¯¹è¿‡æœŸæ—¶é—´æ•æ„Ÿçš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨ TTL ç­–ç•¥ã€‚ ",
"tags":null,
"categories":null
},{
"title":"Goå®ç°lru",
"permalink": "http://localhost:1313/posts/datastructalgorithm/go%E5%AE%9E%E7%8E%B0lru/",
"summary": "package main import \u0026#34;fmt\u0026#34; // func main() { // //\t//LRU //\t//å®ç°ä¸€ä¸ª LRU ç¼“å­˜ï¼Œè¦æ±‚æ”¯æŒä»¥ä¸‹æ“ä½œï¼š //\t//- Get(key int)(int, bool)ï¼šå¦‚æœç¼“å­˜ä¸­å­˜åœ¨è¯¥ keyï¼Œè¿”å›å…¶å¯¹åº”çš„å€¼ï¼Œå¦åˆ™è¿”å› 0,falseã€‚ //\t//- Put(key, value int)ï¼šå°†ä¸€ä¸ª key-value å¯¹æ’å…¥ç¼“å­˜ã€‚å¦‚æœç¼“å­˜å·²ç»æ»¡äº†ï¼Œæ·˜æ±°æœ€ä¹…æœªä½¿ç”¨çš„å…ƒç´ ã€‚ //\t// //\t//ç¤ºä¾‹ï¼š //\t//func main() { //\t// // æ„é€  ä¸€ä¸ª LRU cache //\t// cache := Constructor(2) //\t// cache.Put(1, 1) //\t// cache.Put(2, 2) //\t// //\t// // æµ‹è¯•ç¼“å­˜è·å– //\t// fmt.Println(cache.Get(1)) // è¾“å‡º: 1 true //\t// fmt.Println(cache.Get(3)) // è¾“å‡º: 0 false //\t// //\t// cache.Put(3, 3) //\t// fmt.Println(cache.Get(2)) // è¾“å‡º: 0 false //\t// //\t// cache.Put(4, 4) //\t// fmt.Println(cache.Get(1)) // è¾“å‡º: 0 false //\t// fmt.Println(cache.Get(3)) // è¾“å‡º: 3 true //\t// fmt.Println(cache.Get(4)) // è¾“å‡º: 4 true //\t//} //\t} func main() { // æ„é€  ä¸€ä¸ª LRU cache cache := Constructor(2) cache.Put(2, 1) cache.Put(1, 1) cache.Put(2, 3) cache.Put(4, 1) fmt.Println(cache.Get(1)) fmt.Println(cache.Get(2)) } type Node struct { next *Node pre *Node val int key int } type LRUCache struct { capacity int size int cache map[int]*Node head, tail *Node } func Constructor(capacity int) LRUCache { l := LRUCache{ capacity: capacity, cache: make(map[int]*Node, capacity), head: \u0026amp;Node{}, tail: \u0026amp;Node{}, } l.head.next = l.tail l.tail.pre = l.head return l } // 1 2 3 4 func (l *LRUCache) Get(key int) int { // ä»mapæ‹¿æ•°æ® if _, ok := l.cache[key]; !ok { return -1 } node := l.cache[key] l.MoveToHead(node) return node.val } func (l *LRUCache) Put(key int, val int) { if _, ok := l.cache[key]; ok { l.cache[key].val = val l.MoveToHead(l.cache[key]) } else { l.size++ node := InitNode(key, val) l.cache[key] = node l.AddToHead(node) if l.size \u0026gt; l.capacity { node := l.RemoveTail() l.size-- delete(l.cache, node.key) } } } func InitNode(key, val int) *Node { return \u0026amp;Node{ key: key, val: val, } } // æ·»åŠ åˆ°å¤´èŠ‚ç‚¹ func (l *LRUCache) AddToHead(newNode *Node) *Node { newNode.next = l.head.next newNode.pre = l.head l.head.next.pre = newNode l.head.next = newNode return newNode } func (l *LRUCache) RemoveNode(node *Node) { node.pre.next = node.next node.next.pre = node.pre } func (l *LRUCache) RemoveTail() *Node { node := l.tail.pre //l.tail.pre = node.pre l.RemoveNode(node) return node } func (l *LRUCache) MoveToHead(node *Node) { l.RemoveNode(node) l.AddToHead(node) } ",
"content": "package main import \u0026#34;fmt\u0026#34; // func main() { // //\t//LRU //\t//å®ç°ä¸€ä¸ª LRU ç¼“å­˜ï¼Œè¦æ±‚æ”¯æŒä»¥ä¸‹æ“ä½œï¼š //\t//- Get(key int)(int, bool)ï¼šå¦‚æœç¼“å­˜ä¸­å­˜åœ¨è¯¥ keyï¼Œè¿”å›å…¶å¯¹åº”çš„å€¼ï¼Œå¦åˆ™è¿”å› 0,falseã€‚ //\t//- Put(key, value int)ï¼šå°†ä¸€ä¸ª key-value å¯¹æ’å…¥ç¼“å­˜ã€‚å¦‚æœç¼“å­˜å·²ç»æ»¡äº†ï¼Œæ·˜æ±°æœ€ä¹…æœªä½¿ç”¨çš„å…ƒç´ ã€‚ //\t// //\t//ç¤ºä¾‹ï¼š //\t//func main() { //\t// // æ„é€  ä¸€ä¸ª LRU cache //\t// cache := Constructor(2) //\t// cache.Put(1, 1) //\t// cache.Put(2, 2) //\t// //\t// // æµ‹è¯•ç¼“å­˜è·å– //\t// fmt.Println(cache.Get(1)) // è¾“å‡º: 1 true //\t// fmt.Println(cache.Get(3)) // è¾“å‡º: 0 false //\t// //\t// cache.Put(3, 3) //\t// fmt.Println(cache.Get(2)) // è¾“å‡º: 0 false //\t// //\t// cache.Put(4, 4) //\t// fmt.Println(cache.Get(1)) // è¾“å‡º: 0 false //\t// fmt.Println(cache.Get(3)) // è¾“å‡º: 3 true //\t// fmt.Println(cache.Get(4)) // è¾“å‡º: 4 true //\t//} //\t} func main() { // æ„é€  ä¸€ä¸ª LRU cache cache := Constructor(2) cache.Put(2, 1) cache.Put(1, 1) cache.Put(2, 3) cache.Put(4, 1) fmt.Println(cache.Get(1)) fmt.Println(cache.Get(2)) } type Node struct { next *Node pre *Node val int key int } type LRUCache struct { capacity int size int cache map[int]*Node head, tail *Node } func Constructor(capacity int) LRUCache { l := LRUCache{ capacity: capacity, cache: make(map[int]*Node, capacity), head: \u0026amp;Node{}, tail: \u0026amp;Node{}, } l.head.next = l.tail l.tail.pre = l.head return l } // 1 2 3 4 func (l *LRUCache) Get(key int) int { // ä»mapæ‹¿æ•°æ® if _, ok := l.cache[key]; !ok { return -1 } node := l.cache[key] l.MoveToHead(node) return node.val } func (l *LRUCache) Put(key int, val int) { if _, ok := l.cache[key]; ok { l.cache[key].val = val l.MoveToHead(l.cache[key]) } else { l.size++ node := InitNode(key, val) l.cache[key] = node l.AddToHead(node) if l.size \u0026gt; l.capacity { node := l.RemoveTail() l.size-- delete(l.cache, node.key) } } } func InitNode(key, val int) *Node { return \u0026amp;Node{ key: key, val: val, } } // æ·»åŠ åˆ°å¤´èŠ‚ç‚¹ func (l *LRUCache) AddToHead(newNode *Node) *Node { newNode.next = l.head.next newNode.pre = l.head l.head.next.pre = newNode l.head.next = newNode return newNode } func (l *LRUCache) RemoveNode(node *Node) { node.pre.next = node.next node.next.pre = node.pre } func (l *LRUCache) RemoveTail() *Node { node := l.tail.pre //l.tail.pre = node.pre l.RemoveNode(node) return node } func (l *LRUCache) MoveToHead(node *Node) { l.RemoveNode(node) l.AddToHead(node) } ",
"tags":null,
"categories":null
},{
"title":"Mod",
"permalink": "http://localhost:1313/posts/go/mod/",
"summary": "go mod åŠ è½½æœºåˆ¶ go root goçš„å®‰è£…ç›®å½•\ngo path goçš„æºä»£ç å·¥ä½œç›®å½•\ngo mod goä»1.11å¼€å§‹ï¼ŒåŠ å…¥äº† go modã€‚å¼€å¯ go mod ä¹‹åï¼Œä¸éœ€è¦è®²æ‰€æœ‰çš„æºä»£ç æ”¾åˆ°gopathã€‚\ngo çš„åŠ è½½æœºåˆ¶ go ä¼šæŠŠgo modæ‰€åœ¨çš„ç›®å½•å½“æˆå·¥ä½œç›®å½•ï¼Œå…ˆåŠ è½½ç›¸å¯¹è·¯å¾„ä¸‹çš„æœ¬åœ°åŒ…ï¼Œå¦‚æœæ²¡æœ‰ä¼šå»go modæ–‡ä»¶æŸ¥æ‰¾ï¼Œgo mod ä¼šå°è¯•ä»go proxy æ‹‰å–ä»£ç ï¼Œgo proxy æ˜¯Googleç»´æŠ¤çš„goçš„åŒ…ä»“åº“ï¼Œå³ä½¿æŸäº›åŒ…çš„æºç è¢«åˆ é™¤ï¼Œä¹Ÿè¿˜æ˜¯å¯ä»¥ä»åŒ…ä»“åº“ ä¸‹è½½ï¼Œè¿™ä¿è¯äº†åŒ…å¼•å…¥çš„ç¨³å®šæ€§ã€‚å¦‚æœgo proxyæ²¡æœ‰ï¼Œé‚£ä¹ˆgoä¼šå°è¯•ä»ä»£ç ä»“åº“æ‹‰å–æºç ï¼Œæ¯”å¦‚githubä¸Šçš„æºç ã€‚go mod å½“ä¸­ å¸¦æœ‰ // indirectçš„å°±æ˜¯ç›´æ¥æºç ä¸‹è½½çš„ã€‚\nè¿˜å¯ä»¥ä½¿ç”¨ go mod edit -replace [old git package]@[version]=[new git package]@[version] å‘½ä»¤å°†è¿œç¨‹ä»£ç ä»“åº“æ›¿æ¢æˆæœ¬åœ°çš„ä»£ç ã€‚ ä½¿ç”¨go private è®¾ç½®ç§æœ‰åŒ–ä»£ç ä»“åº“çš„è·¯å¾„ï¼Œç„¶åé…ç½®è®¤è¯å°±å¯ä»¥ä½¿ç”¨å†…éƒ¨ä»£ç åº“ã€‚\nå¸¸ç”¨å‘½ä»¤ go mod init åˆå§‹åŒ–æ¨¡å—ï¼Œç”Ÿæˆ go mod go mod tidy æ‹‰å–ä¾èµ–ï¼Œè‡ªåŠ¨å¢åˆ ä¾èµ–ï¼Œç”Ÿæˆgo.sum go mod download å°†ä¾èµ–é¢„ä¸‹è½½åˆ°æœ¬åœ°ç¼“å­˜ go mod vendor å°†ä¸‹è½½çš„ä¾èµ–ç¼“å­˜åˆ° ./vendor,ç”¨äºç¦»çº¿æ„å»º go mod edit ",
"content": "go mod åŠ è½½æœºåˆ¶ go root goçš„å®‰è£…ç›®å½•\ngo path goçš„æºä»£ç å·¥ä½œç›®å½•\ngo mod goä»1.11å¼€å§‹ï¼ŒåŠ å…¥äº† go modã€‚å¼€å¯ go mod ä¹‹åï¼Œä¸éœ€è¦è®²æ‰€æœ‰çš„æºä»£ç æ”¾åˆ°gopathã€‚\ngo çš„åŠ è½½æœºåˆ¶ go ä¼šæŠŠgo modæ‰€åœ¨çš„ç›®å½•å½“æˆå·¥ä½œç›®å½•ï¼Œå…ˆåŠ è½½ç›¸å¯¹è·¯å¾„ä¸‹çš„æœ¬åœ°åŒ…ï¼Œå¦‚æœæ²¡æœ‰ä¼šå»go modæ–‡ä»¶æŸ¥æ‰¾ï¼Œgo mod ä¼šå°è¯•ä»go proxy æ‹‰å–ä»£ç ï¼Œgo proxy æ˜¯Googleç»´æŠ¤çš„goçš„åŒ…ä»“åº“ï¼Œå³ä½¿æŸäº›åŒ…çš„æºç è¢«åˆ é™¤ï¼Œä¹Ÿè¿˜æ˜¯å¯ä»¥ä»åŒ…ä»“åº“ ä¸‹è½½ï¼Œè¿™ä¿è¯äº†åŒ…å¼•å…¥çš„ç¨³å®šæ€§ã€‚å¦‚æœgo proxyæ²¡æœ‰ï¼Œé‚£ä¹ˆgoä¼šå°è¯•ä»ä»£ç ä»“åº“æ‹‰å–æºç ï¼Œæ¯”å¦‚githubä¸Šçš„æºç ã€‚go mod å½“ä¸­ å¸¦æœ‰ // indirectçš„å°±æ˜¯ç›´æ¥æºç ä¸‹è½½çš„ã€‚\nè¿˜å¯ä»¥ä½¿ç”¨ go mod edit -replace [old git package]@[version]=[new git package]@[version] å‘½ä»¤å°†è¿œç¨‹ä»£ç ä»“åº“æ›¿æ¢æˆæœ¬åœ°çš„ä»£ç ã€‚ ä½¿ç”¨go private è®¾ç½®ç§æœ‰åŒ–ä»£ç ä»“åº“çš„è·¯å¾„ï¼Œç„¶åé…ç½®è®¤è¯å°±å¯ä»¥ä½¿ç”¨å†…éƒ¨ä»£ç åº“ã€‚\nå¸¸ç”¨å‘½ä»¤ go mod init åˆå§‹åŒ–æ¨¡å—ï¼Œç”Ÿæˆ go mod go mod tidy æ‹‰å–ä¾èµ–ï¼Œè‡ªåŠ¨å¢åˆ ä¾èµ–ï¼Œç”Ÿæˆgo.sum go mod download å°†ä¾èµ–é¢„ä¸‹è½½åˆ°æœ¬åœ°ç¼“å­˜ go mod vendor å°†ä¸‹è½½çš„ä¾èµ–ç¼“å­˜åˆ° ./vendor,ç”¨äºç¦»çº¿æ„å»º go mod edit ",
"tags":null,
"categories":null
},{
"title":"dddé¢†åŸŸé©±åŠ¨è®¾è®¡",
"permalink": "http://localhost:1313/posts/design_pattern/ddd/",
"summary": "ä»€ä¹ˆæ˜¯DDD? DDDæ˜¯domain design driver çš„ç®€ç§°ï¼Œæ ¹æœ¬çš„ç›®çš„æ˜¯ä¸ºäº†è§£å†³è½¯ä»¶çš„å¤æ‚æ€§çš„ä¸€ç§è®¾è®¡æ€æƒ³ã€‚ä¼ ç»Ÿçš„MVCç­‰ä»£ç ã€è½¯ä»¶æ¶æ„æ˜¯é¢å‘ç¨‹åºå‘˜å·¥ç¨‹å¸ˆçš„ï¼Œè€Œ äº§å“ç»ç†æ›´å¤šåªæ˜¯éœ€æ±‚äº§å“è®¾è®¡ï¼Œè¿™å¯¼è‡´è½¯ä»¶æ¶æ„å’Œå®é™…çš„ä¸šåŠ¡è„±ç¦»ï¼Œå½“ä¸šåŠ¡å˜å¾—å¤æ‚ï¼Œè½¯ä»¶å¤æ‚æ€§æé«˜ä¹‹åï¼Œåç»­çš„ç»´æŠ¤å‡çº§é‡æ„ä¼šé­é‡é‡é‡å›°éš¾ã€‚\nå…³é”®æ¦‚å¿µ å……è¡€æ¨¡å‹andè´«è¡€æ¨¡å‹ è´«è¡€æ¨¡å‹æ˜¯ä¸ºäº†å¼•å‡ºå……è¡€æ¨¡å‹è¿™ä¸€æ¦‚å¿µã€‚è´«è¡€æ¨¡å‹æ˜¯æŒ‡æˆ‘ä»¬é€šå¸¸çš„æ•°æ®åº“æ˜ å°„åªæœ‰å±æ€§ï¼Œè€Œæ²¡æœ‰è¡¨ç°å‡ºå…·ä½“çš„ä¸šåŠ¡å±æ€§ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ å¼•èµ·æ˜ å°„æ•°æ®å˜åŒ–çš„æ–¹æ³•ï¼Œå°±çœ‹ä¸å‡ºæ¥è¿™ä¸ªæ˜ å°„å…·ä½“çš„ä¸šåŠ¡ï¼ŒDDDçš„å»ºè®®æ˜¯æŠŠèƒ½å¼•å‘å˜åŒ–çš„æ–¹æ³•éƒ½å†™åˆ°è¿™ä¸ªå˜åŒ–å†…ï¼Œè¿™æ ·åˆ«äººä¸€çœ‹å°±çŸ¥é“è¿™ä¸ª å®ä½“å…·ä½“åŒ…å«äº†å“ªäº›ä¸šåŠ¡å±æ€§ã€‚\nèšåˆæ ¹ é˜²è…å±‚ æˆ‘çš„ç†è§£ æ•´ä¸ªDDDæ¶æ„é‡Œé¢éµå¾ªäº†è®¾è®¡åŸåˆ™çš„æœ€ä½³å®è·µï¼Œæ¯”å¦‚é«˜å†…èšä½è€¦åˆè¿™ä¸ªå¤§çš„æ€æƒ³ï¼Œä»¥åŠä¸€äº›è®¾è®¡åŸåˆ™\nå•ä¸€èŒè´£,ä¸€ä¸ªæ–¹æ³•ã€ç±»ã€æ¨¡å—åªå¹²ä¸€ä»¶äº‹æƒ… å¼€æ”¾å°é—­ï¼Œå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ ä¾èµ–å€’ç½®ï¼Œä¾èµ–äºæ¥å£è€Œä¸æ˜¯å…·ä½“å®ç°ã€‚ æ¥å£éš”ç¦»ï¼Œæ¥å£å°è€Œç²¾ï¼Œä¸æ˜¯èƒ–è€Œæ‚ é‡Œæ°æ›¿æ¢ï¼Œå¯¹ç»§æ‰¿çš„è¡¥å……ï¼Œä¸€ä¸ªå­ç±»è¦èƒ½å¤Ÿå®Œå…¨æ›¿æ¢çˆ¶ç±»ï¼Œä¹Ÿå°±æ˜¯è¦éµå¾ªçˆ¶ç±»çš„çº¦å®šï¼Œè¿™æ ·å°‘ç ´ååŸæœ‰çš„çº¦å®šã€‚ è¿ªç±³æ´›æ³•åˆ™ï¼ˆæœ€å°‘çŸ¥è¯†åŸåˆ™ï¼‰ï¼Œä¸è¦è·¨å¤šä¸ªå¯¹è±¡è°ƒç”¨æ–¹æ³•ï¼Œä¸éœ€è¦çŸ¥é“è·¨å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚ï¼Œåªè°ƒç”¨æœ€æ–°çš„æœ‹å‹èŠ‚ç‚¹ æˆ˜æœ¯æ„ä»¶å’Œæˆ˜ç•¥æ„ä»¶ DDDæ˜¯ä¸€å¥—æ¶æ„æ€æƒ³æ–¹æ³•è®ºï¼Œå®ƒä¸ºä»£ç å±‚é¢å’Œæ¶æ„å±‚é¢éƒ½æä¾›äº†å¯¹åº”çš„æ„ä»¶å¸®æˆ‘æˆ‘ä»¬è®¾è®¡æ„æ¶ã€‚\næˆ˜æœ¯æ„ä»¶ï¼ˆä»£ç å±‚é¢ï¼‰ å®ä½“ å€¼å¯¹è±¡ æ ¹/èšåˆæ ¹ repository domain å·¥å‚ äº‹ä»¶ æˆ˜ç•¥æ„ä»¶ï¼ˆæ¶æ„å±‚é¢ï¼‰ ç•Œé™ä¸Šä¸‹æ–‡ï¼ˆæ¨¡å—ï¼‰ é€šç”¨è¯­è¨€ï¼ˆä¸šåŠ¡å’ŒæŠ€æœ¯ç”¨åŒä¸€ç§ä¸“ä¸šæœ¯è¯­æ²Ÿé€šï¼Œé˜²æ­¢é¸¡åŒé¸­è®²ï¼‰ ä¸Šä¸‹æ–‡æ˜ å°„ï¼ˆæ¨¡å—ä¹‹é—´å¦‚ä½•å…³è”ï¼‰ å®é™…æ¶æ„ç¤ºä¾‹ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æˆ˜ç•¥æ„ä»¶ (Strategic) â”‚ â”‚----------------------------------------------â”‚ â”‚ é™ç•Œä¸Šä¸‹æ–‡ (Bounded Contexts) â”‚ â”‚ â”œâ”€â”€ ç”¨æˆ·ä¸Šä¸‹æ–‡ (User Context) â”‚ â”‚ â”œâ”€â”€ è®¢å•ä¸Šä¸‹æ–‡ (Order Context) â”‚ â”‚ â”œâ”€â”€ å•†å“ä¸Šä¸‹æ–‡ (Product Context) â”‚ â”‚ â””â”€â”€ æ”¯ä»˜ä¸Šä¸‹æ–‡ (Payment Context) â”‚ â”‚ â”‚ â”‚ ä¸Šä¸‹æ–‡æ˜ å°„ (Context Map) â”‚ â”‚ â”œâ”€â”€ ä¸Šä¸‹æ¸¸ (Upstream/Downstream) â”‚ â”‚ â”œâ”€â”€ é˜²è…å±‚ (ACL) â”‚ â”‚ â”œâ”€â”€ åˆä½œä¼™ä¼´ (Partnership) â”‚ â”‚ â””â”€â”€ å¼€æ”¾ä¸»æœºæœåŠ¡ (OHS) â”‚ â”‚ â”‚ â”‚ é€šç”¨è¯­è¨€ (Ubiquitous Language) â”‚ â”‚ â””â”€â”€ \u0026quot;è®¢å•\u0026quot;ã€\u0026quot;æ”¯ä»˜å•\u0026quot;ã€\u0026quot;é€€æ¬¾å•\u0026quot; â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æˆ˜æœ¯æ„ä»¶ (Tactical) â”‚ â”‚----------------------------------------------â”‚ â”‚ æ¥å£å±‚ (Interface Layer) â”‚ â”‚ â””â”€â”€ Kratos Handler (HTTP/gRPC æ¥å£) â”‚ â”‚ â”‚ â”‚ åº”ç”¨å±‚ (Application Layer) â”‚ â”‚ â””â”€â”€ åº”ç”¨æœåŠ¡ (Application Service) â”‚ â”‚ â†’ OrderUsecase â”‚ â”‚ â”‚ â”‚ é¢†åŸŸå±‚ (Domain Layer) â”‚ â”‚ â”œâ”€â”€ å®ä½“ (Entity) \u0026amp; èšåˆæ ¹ (AggregateRoot) â”‚ â”‚ â”‚ â†’ Order, OrderItem â”‚ â”‚ â”œâ”€â”€ å€¼å¯¹è±¡ (Value Object) â”‚ â”‚ â”‚ â†’ Money, Address â”‚ â”‚ â”œâ”€â”€ é¢†åŸŸæœåŠ¡ (Domain Service) â”‚ â”‚ â”‚ â†’ PaymentService â”‚ â”‚ â”œâ”€â”€ å·¥å‚ (Factory) â”‚ â”‚ â”‚ â†’ NewOrder â”‚ â”‚ â”œâ”€â”€ é¢†åŸŸäº‹ä»¶ (Domain Event) â”‚ â”‚ â”‚ â†’ OrderPaidEvent â”‚ â”‚ â””â”€â”€ ä»“å‚¨æ¥å£ (Repository Interface) â”‚ â”‚ â”‚ â”‚ åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer) â”‚ â”‚ â””â”€â”€ ä»“å‚¨å®ç° (Repository Impl, GORM) â”‚ â”‚ â†’ orderRepo (MySQL) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ kratos å’ŒDDD æ¶æ„å¯¹ç…§ Kratos å±‚çº§ DDD å±‚çº§ ä½œç”¨ service/ Interface / Adapter gRPC/HTTP Handlerï¼Œå‚æ•°éªŒè¯/å“åº”å°è£…ï¼Œè°ƒç”¨ UseCase biz/ Domain + Application ä¸šåŠ¡é€»è¾‘å’Œé¢†åŸŸè§„åˆ™å¤„ç†ï¼ŒUseCaseï¼ˆä¸šåŠ¡æœåŠ¡ï¼‰ï¼Œçº¯ä¸šåŠ¡è®¡ç®— data/ Infrastructure æ•°æ®åº“ã€ç¼“å­˜ã€ç¬¬ä¸‰æ–¹ SDK å°è£…ï¼Œå®ç° Repository æ¥å£ï¼Œæä¾›å¤–éƒ¨ä¾èµ–èƒ½åŠ› pkg/ Infrastructureï¼ˆå…±äº«ç»„ä»¶ï¼‰ å¯å¤ç”¨ SDK å°è£…ã€å·¥å…·å‡½æ•°ã€é€šç”¨åº“ï¼Œè·¨æœåŠ¡å…±äº« å‚è€ƒèµ„æ–™ ç¾å›¢ é¢†åŸŸé©±åŠ¨è®¾è®¡åœ¨äº’è”ç½‘ä¸šåŠ¡å¼€å‘ä¸­çš„å®è·µ ",
"content": "ä»€ä¹ˆæ˜¯DDD? DDDæ˜¯domain design driver çš„ç®€ç§°ï¼Œæ ¹æœ¬çš„ç›®çš„æ˜¯ä¸ºäº†è§£å†³è½¯ä»¶çš„å¤æ‚æ€§çš„ä¸€ç§è®¾è®¡æ€æƒ³ã€‚ä¼ ç»Ÿçš„MVCç­‰ä»£ç ã€è½¯ä»¶æ¶æ„æ˜¯é¢å‘ç¨‹åºå‘˜å·¥ç¨‹å¸ˆçš„ï¼Œè€Œ äº§å“ç»ç†æ›´å¤šåªæ˜¯éœ€æ±‚äº§å“è®¾è®¡ï¼Œè¿™å¯¼è‡´è½¯ä»¶æ¶æ„å’Œå®é™…çš„ä¸šåŠ¡è„±ç¦»ï¼Œå½“ä¸šåŠ¡å˜å¾—å¤æ‚ï¼Œè½¯ä»¶å¤æ‚æ€§æé«˜ä¹‹åï¼Œåç»­çš„ç»´æŠ¤å‡çº§é‡æ„ä¼šé­é‡é‡é‡å›°éš¾ã€‚\nå…³é”®æ¦‚å¿µ å……è¡€æ¨¡å‹andè´«è¡€æ¨¡å‹ è´«è¡€æ¨¡å‹æ˜¯ä¸ºäº†å¼•å‡ºå……è¡€æ¨¡å‹è¿™ä¸€æ¦‚å¿µã€‚è´«è¡€æ¨¡å‹æ˜¯æŒ‡æˆ‘ä»¬é€šå¸¸çš„æ•°æ®åº“æ˜ å°„åªæœ‰å±æ€§ï¼Œè€Œæ²¡æœ‰è¡¨ç°å‡ºå…·ä½“çš„ä¸šåŠ¡å±æ€§ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ å¼•èµ·æ˜ å°„æ•°æ®å˜åŒ–çš„æ–¹æ³•ï¼Œå°±çœ‹ä¸å‡ºæ¥è¿™ä¸ªæ˜ å°„å…·ä½“çš„ä¸šåŠ¡ï¼ŒDDDçš„å»ºè®®æ˜¯æŠŠèƒ½å¼•å‘å˜åŒ–çš„æ–¹æ³•éƒ½å†™åˆ°è¿™ä¸ªå˜åŒ–å†…ï¼Œè¿™æ ·åˆ«äººä¸€çœ‹å°±çŸ¥é“è¿™ä¸ª å®ä½“å…·ä½“åŒ…å«äº†å“ªäº›ä¸šåŠ¡å±æ€§ã€‚\nèšåˆæ ¹ é˜²è…å±‚ æˆ‘çš„ç†è§£ æ•´ä¸ªDDDæ¶æ„é‡Œé¢éµå¾ªäº†è®¾è®¡åŸåˆ™çš„æœ€ä½³å®è·µï¼Œæ¯”å¦‚é«˜å†…èšä½è€¦åˆè¿™ä¸ªå¤§çš„æ€æƒ³ï¼Œä»¥åŠä¸€äº›è®¾è®¡åŸåˆ™\nå•ä¸€èŒè´£,ä¸€ä¸ªæ–¹æ³•ã€ç±»ã€æ¨¡å—åªå¹²ä¸€ä»¶äº‹æƒ… å¼€æ”¾å°é—­ï¼Œå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ ä¾èµ–å€’ç½®ï¼Œä¾èµ–äºæ¥å£è€Œä¸æ˜¯å…·ä½“å®ç°ã€‚ æ¥å£éš”ç¦»ï¼Œæ¥å£å°è€Œç²¾ï¼Œä¸æ˜¯èƒ–è€Œæ‚ é‡Œæ°æ›¿æ¢ï¼Œå¯¹ç»§æ‰¿çš„è¡¥å……ï¼Œä¸€ä¸ªå­ç±»è¦èƒ½å¤Ÿå®Œå…¨æ›¿æ¢çˆ¶ç±»ï¼Œä¹Ÿå°±æ˜¯è¦éµå¾ªçˆ¶ç±»çš„çº¦å®šï¼Œè¿™æ ·å°‘ç ´ååŸæœ‰çš„çº¦å®šã€‚ è¿ªç±³æ´›æ³•åˆ™ï¼ˆæœ€å°‘çŸ¥è¯†åŸåˆ™ï¼‰ï¼Œä¸è¦è·¨å¤šä¸ªå¯¹è±¡è°ƒç”¨æ–¹æ³•ï¼Œä¸éœ€è¦çŸ¥é“è·¨å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚ï¼Œåªè°ƒç”¨æœ€æ–°çš„æœ‹å‹èŠ‚ç‚¹ æˆ˜æœ¯æ„ä»¶å’Œæˆ˜ç•¥æ„ä»¶ DDDæ˜¯ä¸€å¥—æ¶æ„æ€æƒ³æ–¹æ³•è®ºï¼Œå®ƒä¸ºä»£ç å±‚é¢å’Œæ¶æ„å±‚é¢éƒ½æä¾›äº†å¯¹åº”çš„æ„ä»¶å¸®æˆ‘æˆ‘ä»¬è®¾è®¡æ„æ¶ã€‚\næˆ˜æœ¯æ„ä»¶ï¼ˆä»£ç å±‚é¢ï¼‰ å®ä½“ å€¼å¯¹è±¡ æ ¹/èšåˆæ ¹ repository domain å·¥å‚ äº‹ä»¶ æˆ˜ç•¥æ„ä»¶ï¼ˆæ¶æ„å±‚é¢ï¼‰ ç•Œé™ä¸Šä¸‹æ–‡ï¼ˆæ¨¡å—ï¼‰ é€šç”¨è¯­è¨€ï¼ˆä¸šåŠ¡å’ŒæŠ€æœ¯ç”¨åŒä¸€ç§ä¸“ä¸šæœ¯è¯­æ²Ÿé€šï¼Œé˜²æ­¢é¸¡åŒé¸­è®²ï¼‰ ä¸Šä¸‹æ–‡æ˜ å°„ï¼ˆæ¨¡å—ä¹‹é—´å¦‚ä½•å…³è”ï¼‰ å®é™…æ¶æ„ç¤ºä¾‹ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æˆ˜ç•¥æ„ä»¶ (Strategic) â”‚ â”‚----------------------------------------------â”‚ â”‚ é™ç•Œä¸Šä¸‹æ–‡ (Bounded Contexts) â”‚ â”‚ â”œâ”€â”€ ç”¨æˆ·ä¸Šä¸‹æ–‡ (User Context) â”‚ â”‚ â”œâ”€â”€ è®¢å•ä¸Šä¸‹æ–‡ (Order Context) â”‚ â”‚ â”œâ”€â”€ å•†å“ä¸Šä¸‹æ–‡ (Product Context) â”‚ â”‚ â””â”€â”€ æ”¯ä»˜ä¸Šä¸‹æ–‡ (Payment Context) â”‚ â”‚ â”‚ â”‚ ä¸Šä¸‹æ–‡æ˜ å°„ (Context Map) â”‚ â”‚ â”œâ”€â”€ ä¸Šä¸‹æ¸¸ (Upstream/Downstream) â”‚ â”‚ â”œâ”€â”€ é˜²è…å±‚ (ACL) â”‚ â”‚ â”œâ”€â”€ åˆä½œä¼™ä¼´ (Partnership) â”‚ â”‚ â””â”€â”€ å¼€æ”¾ä¸»æœºæœåŠ¡ (OHS) â”‚ â”‚ â”‚ â”‚ é€šç”¨è¯­è¨€ (Ubiquitous Language) â”‚ â”‚ â””â”€â”€ \u0026quot;è®¢å•\u0026quot;ã€\u0026quot;æ”¯ä»˜å•\u0026quot;ã€\u0026quot;é€€æ¬¾å•\u0026quot; â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æˆ˜æœ¯æ„ä»¶ (Tactical) â”‚ â”‚----------------------------------------------â”‚ â”‚ æ¥å£å±‚ (Interface Layer) â”‚ â”‚ â””â”€â”€ Kratos Handler (HTTP/gRPC æ¥å£) â”‚ â”‚ â”‚ â”‚ åº”ç”¨å±‚ (Application Layer) â”‚ â”‚ â””â”€â”€ åº”ç”¨æœåŠ¡ (Application Service) â”‚ â”‚ â†’ OrderUsecase â”‚ â”‚ â”‚ â”‚ é¢†åŸŸå±‚ (Domain Layer) â”‚ â”‚ â”œâ”€â”€ å®ä½“ (Entity) \u0026amp; èšåˆæ ¹ (AggregateRoot) â”‚ â”‚ â”‚ â†’ Order, OrderItem â”‚ â”‚ â”œâ”€â”€ å€¼å¯¹è±¡ (Value Object) â”‚ â”‚ â”‚ â†’ Money, Address â”‚ â”‚ â”œâ”€â”€ é¢†åŸŸæœåŠ¡ (Domain Service) â”‚ â”‚ â”‚ â†’ PaymentService â”‚ â”‚ â”œâ”€â”€ å·¥å‚ (Factory) â”‚ â”‚ â”‚ â†’ NewOrder â”‚ â”‚ â”œâ”€â”€ é¢†åŸŸäº‹ä»¶ (Domain Event) â”‚ â”‚ â”‚ â†’ OrderPaidEvent â”‚ â”‚ â””â”€â”€ ä»“å‚¨æ¥å£ (Repository Interface) â”‚ â”‚ â”‚ â”‚ åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer) â”‚ â”‚ â””â”€â”€ ä»“å‚¨å®ç° (Repository Impl, GORM) â”‚ â”‚ â†’ orderRepo (MySQL) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ kratos å’ŒDDD æ¶æ„å¯¹ç…§ Kratos å±‚çº§ DDD å±‚çº§ ä½œç”¨ service/ Interface / Adapter gRPC/HTTP Handlerï¼Œå‚æ•°éªŒè¯/å“åº”å°è£…ï¼Œè°ƒç”¨ UseCase biz/ Domain + Application ä¸šåŠ¡é€»è¾‘å’Œé¢†åŸŸè§„åˆ™å¤„ç†ï¼ŒUseCaseï¼ˆä¸šåŠ¡æœåŠ¡ï¼‰ï¼Œçº¯ä¸šåŠ¡è®¡ç®— data/ Infrastructure æ•°æ®åº“ã€ç¼“å­˜ã€ç¬¬ä¸‰æ–¹ SDK å°è£…ï¼Œå®ç° Repository æ¥å£ï¼Œæä¾›å¤–éƒ¨ä¾èµ–èƒ½åŠ› pkg/ Infrastructureï¼ˆå…±äº«ç»„ä»¶ï¼‰ å¯å¤ç”¨ SDK å°è£…ã€å·¥å…·å‡½æ•°ã€é€šç”¨åº“ï¼Œè·¨æœåŠ¡å…±äº« å‚è€ƒèµ„æ–™ ç¾å›¢ é¢†åŸŸé©±åŠ¨è®¾è®¡åœ¨äº’è”ç½‘ä¸šåŠ¡å¼€å‘ä¸­çš„å®è·µ ",
"tags":null,
"categories":null
},{
"title":"åˆå§‹åŒ–æ–¹æ³•æ¯”è¾ƒ",
"permalink": "http://localhost:1313/posts/go/%E5%88%9D%E5%A7%8B%E5%8C%96%E6%96%B9%E6%B3%95%E6%AF%94%E8%BE%83/",
"summary": "makeå’Œnewçš„åˆå§‹åŒ–æ¯”è¾ƒ make new è¿”å›å€¼ è¿”å›å®ä¾‹åŒ–å¯¹è±¡æœ¬èº« è¿”å›ç±»å‹å¹¶æ¸…ç©ºè¿”å›å®ä¾‹åŒ–å¯¹è±¡çš„æŒ‡é’ˆ ä½œç”¨ç±»å‹ã€å¸¸è§ç”¨æ³• sliceã€mapã€channel æ‰€æœ‰ç±»å‹ å†…éƒ¨ä½œç”¨æœºåˆ¶ åˆå§‹åŒ–ç»“æ„ä½“ï¼Œå¹¶åˆå§‹åŒ–ç»“æ„ä½“å†…éƒ¨çš„ç›¸å…³å­—æ®µæœºæ„ åˆå§‹åŒ–å¯¹è±¡ï¼Œæ¸…ç©ºå†…å­˜ï¼Œåˆ†é…å†…å­˜ï¼Œç½®ä¸ºé›¶å€¼ ä¸ºä»€ä¹ˆnew slice map å¾—åˆ°æ˜¯nil é¦–å…ˆ new ä¸¥æ ¼éµå®ˆè¿”å›çš„æ˜¯åˆå§‹åŒ–å¯¹è±¡æŒ‡é’ˆçš„åŸåˆ™ï¼Œè€Œnew sliceã€mapçš„æ—¶å€™ï¼Œè¿”å›çš„å°±æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œåªæ˜¯åˆ‡ç‰‡å’Œå“ˆå¸Œçš„ é›¶å€¼å°±æ˜¯nil,æ‰€ä»¥å¦‚æœnewåˆ‡ç‰‡å’Œmapä¼šå‡ºç°æ— æ³•ä½¿ç”¨çš„æƒ…å†µã€‚\n",
"content": "makeå’Œnewçš„åˆå§‹åŒ–æ¯”è¾ƒ make new è¿”å›å€¼ è¿”å›å®ä¾‹åŒ–å¯¹è±¡æœ¬èº« è¿”å›ç±»å‹å¹¶æ¸…ç©ºè¿”å›å®ä¾‹åŒ–å¯¹è±¡çš„æŒ‡é’ˆ ä½œç”¨ç±»å‹ã€å¸¸è§ç”¨æ³• sliceã€mapã€channel æ‰€æœ‰ç±»å‹ å†…éƒ¨ä½œç”¨æœºåˆ¶ åˆå§‹åŒ–ç»“æ„ä½“ï¼Œå¹¶åˆå§‹åŒ–ç»“æ„ä½“å†…éƒ¨çš„ç›¸å…³å­—æ®µæœºæ„ åˆå§‹åŒ–å¯¹è±¡ï¼Œæ¸…ç©ºå†…å­˜ï¼Œåˆ†é…å†…å­˜ï¼Œç½®ä¸ºé›¶å€¼ ä¸ºä»€ä¹ˆnew slice map å¾—åˆ°æ˜¯nil é¦–å…ˆ new ä¸¥æ ¼éµå®ˆè¿”å›çš„æ˜¯åˆå§‹åŒ–å¯¹è±¡æŒ‡é’ˆçš„åŸåˆ™ï¼Œè€Œnew sliceã€mapçš„æ—¶å€™ï¼Œè¿”å›çš„å°±æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œåªæ˜¯åˆ‡ç‰‡å’Œå“ˆå¸Œçš„ é›¶å€¼å°±æ˜¯nil,æ‰€ä»¥å¦‚æœnewåˆ‡ç‰‡å’Œmapä¼šå‡ºç°æ— æ³•ä½¿ç”¨çš„æƒ…å†µã€‚\n",
"tags":["go","make","new","åˆå§‹åŒ–"],
"categories":null
},{
"title":"å†…å­˜æ³„æ¼",
"permalink": "http://localhost:1313/posts/go/%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F/",
"summary": "ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼ æŒ‡å†…å­˜èµ„æºé•¿æœŸå¾—ä¸åˆ°é‡Šæ”¾ï¼Œå¯¼è‡´å†…å­˜æŒç»­å¢é•¿ï¼Œæœ€ç»ˆå¯¼è‡´å†…å­˜æº¢å‡º\nå†…å­˜æ³„æ¼çš„å¸¸è§åœºæ™¯ åç¨‹çš„æ³„æ¼ è€—æ—¶ä»»åŠ¡æˆ–è€…httpè¯·æ±‚ä¸€ç›´å¾—ä¸åˆ°å“åº”ï¼Œåˆæ²¡æœ‰è®¾ç½®è¶…æ—¶æ—¶é—´ chanæœªæ­£ç¡®å…³é—­ã€é˜»å¡ã€‚range channel å‘é€ç«¯æœªå…³é—­å¯¼è‡´æ­»å¾ªç¯ã€‚ é”æœªæ­£ç¡®é‡Šæ”¾ã€å¯¼è‡´åç¨‹æœªèƒ½é‡Šæ”¾ èµ„æºæœªå…³é—­ï¼Œå¦‚fileã€æ•°æ®åº“ã€redisè¿æ¥ã€timerå®šæ—¶å™¨ã€channel cgo å…¶ä»–çš„ä¸€äº› å†…å­˜æ³„æ¼åˆ†æå·¥å…· pprofåˆ†æåç¨‹æ•°é‡ï¼Œå†…å­˜å ç”¨æƒ…å†µç­‰\nå¦‚ä½•é’ˆå¯¹å†…å­˜æ³„æ¼è¿›è¡Œä¼˜åŒ– é’ˆå¯¹åç¨‹æ³„æ¼ è®¾ç½®è¶…æ—¶æ—¶é—´ context.deadline timeout ç»“åˆselectè¿›è¡Œè¶…æ—¶æ§åˆ¶ æ­£ç¡®ä½¿ç”¨channel æ­£ç¡®ä½¿ç”¨äº’æ–¥é”ï¼Œé…å¯¹ä½¿ç”¨ é’ˆå¯¹channelçš„æ³„æ¼ é…å¯¹ä½¿ç”¨ åœ¨å‘é€æ–¹å…³é—­channel æ­£ç¡®ä½¿ç”¨ç¼“å†²channelå’Œéç¼“å†²channel å…»æˆå…³é—­èµ„æºçš„ä¹ æƒ¯ï¼Œä½¿ç”¨defer,clear up ç­‰å·¥å…· cgoå’Œå…¶ä»–åœºæ™¯è®°å¾—é˜²æ­¢åç¨‹æ³„æ¼ ",
"content": "ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼ æŒ‡å†…å­˜èµ„æºé•¿æœŸå¾—ä¸åˆ°é‡Šæ”¾ï¼Œå¯¼è‡´å†…å­˜æŒç»­å¢é•¿ï¼Œæœ€ç»ˆå¯¼è‡´å†…å­˜æº¢å‡º\nå†…å­˜æ³„æ¼çš„å¸¸è§åœºæ™¯ åç¨‹çš„æ³„æ¼ è€—æ—¶ä»»åŠ¡æˆ–è€…httpè¯·æ±‚ä¸€ç›´å¾—ä¸åˆ°å“åº”ï¼Œåˆæ²¡æœ‰è®¾ç½®è¶…æ—¶æ—¶é—´ chanæœªæ­£ç¡®å…³é—­ã€é˜»å¡ã€‚range channel å‘é€ç«¯æœªå…³é—­å¯¼è‡´æ­»å¾ªç¯ã€‚ é”æœªæ­£ç¡®é‡Šæ”¾ã€å¯¼è‡´åç¨‹æœªèƒ½é‡Šæ”¾ èµ„æºæœªå…³é—­ï¼Œå¦‚fileã€æ•°æ®åº“ã€redisè¿æ¥ã€timerå®šæ—¶å™¨ã€channel cgo å…¶ä»–çš„ä¸€äº› å†…å­˜æ³„æ¼åˆ†æå·¥å…· pprofåˆ†æåç¨‹æ•°é‡ï¼Œå†…å­˜å ç”¨æƒ…å†µç­‰\nå¦‚ä½•é’ˆå¯¹å†…å­˜æ³„æ¼è¿›è¡Œä¼˜åŒ– é’ˆå¯¹åç¨‹æ³„æ¼ è®¾ç½®è¶…æ—¶æ—¶é—´ context.deadline timeout ç»“åˆselectè¿›è¡Œè¶…æ—¶æ§åˆ¶ æ­£ç¡®ä½¿ç”¨channel æ­£ç¡®ä½¿ç”¨äº’æ–¥é”ï¼Œé…å¯¹ä½¿ç”¨ é’ˆå¯¹channelçš„æ³„æ¼ é…å¯¹ä½¿ç”¨ åœ¨å‘é€æ–¹å…³é—­channel æ­£ç¡®ä½¿ç”¨ç¼“å†²channelå’Œéç¼“å†²channel å…»æˆå…³é—­èµ„æºçš„ä¹ æƒ¯ï¼Œä½¿ç”¨defer,clear up ç­‰å·¥å…· cgoå’Œå…¶ä»–åœºæ™¯è®°å¾—é˜²æ­¢åç¨‹æ³„æ¼ ",
"tags":null,
"categories":null
},{
"title":"é€ƒé€¸åˆ†æ",
"permalink": "http://localhost:1313/posts/go/%E9%80%83%E9%80%B8%E5%88%86%E6%9E%90/",
"summary": "ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æ è®¡ç®—æœºç§‘å­¦ä¸­å¯¹æŒ‡é’ˆä½œç”¨èŒƒå›´è¿›è¡Œåˆ†æå°±å«åšé€ƒé€¸åˆ†æã€‚åˆ†æå˜é‡æ˜¯åˆ†é…åˆ°å †ä¸Šè¿˜æ˜¯æ ˆä¸Šã€‚ åˆ†é…åˆ°å †ä¸Šå’Œæ ˆä¸Šçš„å¯¹æ¯”\næ ˆ å † åˆ†é…æ–¹å¼ éšç€å‡½æ•°åˆ›å»ºè‡ªåŠ¨åˆ†é… ç¨‹åºå‘˜æ‰‹åŠ¨åˆ†é… èµ„æºæ¶ˆè€— å¾ˆå° ï¼Œå¤§å°å›ºå®š æ¯”è¾ƒå¤§ï¼Œå¤§å°ä¸å›ºå®šï¼Œéœ€è¦å¯»æ‰¾åˆ°åˆé€‚çš„å¤§å°ã€‚å®¹æ˜“äº§ç”Ÿå†…å­˜ç¢ç‰‡ å›æ”¶æ–¹å¼ éšç€å‡½æ•°çš„ç»“æŸè¿›è¡Œé”€æ¯ éœ€è¦æ‰‹åŠ¨å›æ”¶,æˆ–è€…æ ¹æ®gcç®—æ³•è¿›è¡Œå›æ”¶ æ‰€ä»¥è¯´ç¼–è¯‘å™¨ä¼šå°½å¯èƒ½çš„å°†å˜é‡åˆ†é…åˆ°æ ˆä¸Šï¼Œ goä¼šåœ¨é™æ€ç¼–è¯‘é˜¶æ®µå°±ç¡®å®šå˜é‡åˆ°åº•åº”è¯¥åˆ†é…åˆ°å †ä¸Šè¿˜æ˜¯æ ˆä¸Šã€‚ å½“ä¸€ä¸ªå˜é‡åœ¨å‡½æ•°ä¹‹å¤–çš„åœ°æ–¹è¿˜ä¼šè¢«ä½¿ç”¨å°±ä¼šå‘ç”Ÿé€ƒé€¸ã€‚\nä»¥ä¸‹å‡ ä¸ªåœºæ™¯ä¼šå‘ç”Ÿé€ƒé€¸ è¿”å›ä¸€ä¸ªå˜é‡çš„æŒ‡é’ˆ è¿”å›ä¸€ä¸ªé—­åŒ…å‡½æ•°ï¼Œé—­åŒ…å‡½æ•°æ•è·äº†è°ƒç”¨å‡½æ•°çš„å˜é‡ å¾€channelå‘é€äº†å˜é‡çš„æŒ‡é’ˆ å·¨å¤§çš„å˜é‡ï¼Œç¼–è¯‘å™¨ä¸ºäº†é˜²æ­¢æ ˆå†…å­˜ä¸å¤Ÿï¼Œä¼šå°†å…¶åˆ†é…åˆ°å †ä¸Š å¼•ç”¨ç±»å‹çš„ä½¿ç”¨ï¼Œæ¯”å¦‚ä¼ é€’sliceã€mapã€chanã€interfaceç­‰ å¦‚ä½•å¯¹goçš„ç¨‹åºè¿›è¡Œé€ƒé€¸åˆ†æ ä½¿ç”¨æºç go build \u0026ndash;gcflags \u0026lsquo;-m -l\u0026rsquo;åˆ†æï¼Œçœ‹å˜é‡æ˜¯å¦å‘ç”Ÿäº†é€ƒé€¸ è¿˜å¯ä»¥ç»“åˆpprofå¯¹å †å†…å­˜çš„åˆ†é…è¿›è¡ŒæŸ¥çœ‹ï¼Œç»“åˆçƒ­ç‚¹è·¯å¾„ä½¿ç”¨go gc flag è¿›è¡Œåˆ†æ\nå¦‚ä½•ä½¿ç”¨ é€ƒé€¸åˆ†æéœ€è¦æ³¨æ„çš„ç‚¹ åœ¨ä¸å½±å“ä»£ç ç»“æ„åˆç†æ€§çš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œå‡å°‘ä½¿ç”¨æŒ‡é’ˆï¼ˆå˜é‡çš„å†…å­˜å ç”¨ä¸å¤§çš„æƒ…å†µä¸‹ï¼‰ã€‚ ä¸è¦è¿‡åº¦è®¾è®¡ï¼ŒæŒç»­é‡æ„ã€‚ä¹Ÿå°±æ˜¯å…ˆå®ç°ä¸šåŠ¡ï¼Œå†å»ç»“åˆå·¥å…·æ¥è¿›è¡Œè°ƒæ•´ ",
"content": "ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æ è®¡ç®—æœºç§‘å­¦ä¸­å¯¹æŒ‡é’ˆä½œç”¨èŒƒå›´è¿›è¡Œåˆ†æå°±å«åšé€ƒé€¸åˆ†æã€‚åˆ†æå˜é‡æ˜¯åˆ†é…åˆ°å †ä¸Šè¿˜æ˜¯æ ˆä¸Šã€‚ åˆ†é…åˆ°å †ä¸Šå’Œæ ˆä¸Šçš„å¯¹æ¯”\næ ˆ å † åˆ†é…æ–¹å¼ éšç€å‡½æ•°åˆ›å»ºè‡ªåŠ¨åˆ†é… ç¨‹åºå‘˜æ‰‹åŠ¨åˆ†é… èµ„æºæ¶ˆè€— å¾ˆå° ï¼Œå¤§å°å›ºå®š æ¯”è¾ƒå¤§ï¼Œå¤§å°ä¸å›ºå®šï¼Œéœ€è¦å¯»æ‰¾åˆ°åˆé€‚çš„å¤§å°ã€‚å®¹æ˜“äº§ç”Ÿå†…å­˜ç¢ç‰‡ å›æ”¶æ–¹å¼ éšç€å‡½æ•°çš„ç»“æŸè¿›è¡Œé”€æ¯ éœ€è¦æ‰‹åŠ¨å›æ”¶,æˆ–è€…æ ¹æ®gcç®—æ³•è¿›è¡Œå›æ”¶ æ‰€ä»¥è¯´ç¼–è¯‘å™¨ä¼šå°½å¯èƒ½çš„å°†å˜é‡åˆ†é…åˆ°æ ˆä¸Šï¼Œ goä¼šåœ¨é™æ€ç¼–è¯‘é˜¶æ®µå°±ç¡®å®šå˜é‡åˆ°åº•åº”è¯¥åˆ†é…åˆ°å †ä¸Šè¿˜æ˜¯æ ˆä¸Šã€‚ å½“ä¸€ä¸ªå˜é‡åœ¨å‡½æ•°ä¹‹å¤–çš„åœ°æ–¹è¿˜ä¼šè¢«ä½¿ç”¨å°±ä¼šå‘ç”Ÿé€ƒé€¸ã€‚\nä»¥ä¸‹å‡ ä¸ªåœºæ™¯ä¼šå‘ç”Ÿé€ƒé€¸ è¿”å›ä¸€ä¸ªå˜é‡çš„æŒ‡é’ˆ è¿”å›ä¸€ä¸ªé—­åŒ…å‡½æ•°ï¼Œé—­åŒ…å‡½æ•°æ•è·äº†è°ƒç”¨å‡½æ•°çš„å˜é‡ å¾€channelå‘é€äº†å˜é‡çš„æŒ‡é’ˆ å·¨å¤§çš„å˜é‡ï¼Œç¼–è¯‘å™¨ä¸ºäº†é˜²æ­¢æ ˆå†…å­˜ä¸å¤Ÿï¼Œä¼šå°†å…¶åˆ†é…åˆ°å †ä¸Š å¼•ç”¨ç±»å‹çš„ä½¿ç”¨ï¼Œæ¯”å¦‚ä¼ é€’sliceã€mapã€chanã€interfaceç­‰ å¦‚ä½•å¯¹goçš„ç¨‹åºè¿›è¡Œé€ƒé€¸åˆ†æ ä½¿ç”¨æºç go build \u0026ndash;gcflags \u0026lsquo;-m -l\u0026rsquo;åˆ†æï¼Œçœ‹å˜é‡æ˜¯å¦å‘ç”Ÿäº†é€ƒé€¸ è¿˜å¯ä»¥ç»“åˆpprofå¯¹å †å†…å­˜çš„åˆ†é…è¿›è¡ŒæŸ¥çœ‹ï¼Œç»“åˆçƒ­ç‚¹è·¯å¾„ä½¿ç”¨go gc flag è¿›è¡Œåˆ†æ\nå¦‚ä½•ä½¿ç”¨ é€ƒé€¸åˆ†æéœ€è¦æ³¨æ„çš„ç‚¹ åœ¨ä¸å½±å“ä»£ç ç»“æ„åˆç†æ€§çš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œå‡å°‘ä½¿ç”¨æŒ‡é’ˆï¼ˆå˜é‡çš„å†…å­˜å ç”¨ä¸å¤§çš„æƒ…å†µä¸‹ï¼‰ã€‚ ä¸è¦è¿‡åº¦è®¾è®¡ï¼ŒæŒç»­é‡æ„ã€‚ä¹Ÿå°±æ˜¯å…ˆå®ç°ä¸šåŠ¡ï¼Œå†å»ç»“åˆå·¥å…·æ¥è¿›è¡Œè°ƒæ•´ ",
"tags":null,
"categories":null
},{
"title":"Gc",
"permalink": "http://localhost:1313/posts/go/gc/",
"summary": "ä»€ä¹ˆæ˜¯GC gcå°±æ˜¯å†…å­˜åƒåœ¾å›æ”¶ã€‚c/c++è¿™ç±»è¯­è¨€å¯ä»¥ç”±ç¨‹åºå‘˜ç”³è¯·å†…å­˜ï¼Œåˆ†é…åˆ°å †ä¸Šï¼Œå †ä¸Šçš„æ•°æ®éšç€å‡½æ•°ç»“æŸå¹¶ä¸ä¼šè‡ªåŠ¨è¢«æ¸…é›¶ï¼Œéœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨æ¸…ç†ã€‚ è¿™ä¼šç»™ç¼–ç¨‹å¢åŠ è´Ÿæ‹…å’Œéšæ‚£ã€‚é«˜çº§è¯­è¨€å¦‚java/goæ”¯æŒgc,è‡ªåŠ¨åˆ†ææ²¡æœ‰è¢«å¼•ç”¨çš„å˜é‡ï¼Œè¿›è¡Œå†…å­˜å›æ”¶ã€‚\nå¸¸è§çš„GCæ–¹æ³• å¼•ç”¨è®¡æ•°æ³• å¯¹å˜é‡å¯¹è±¡çš„å¼•ç”¨æ¬¡æ•°è¿›è¡Œè®¡æ•°ï¼Œå½“è®¡æ•°ä¸º0å°±ä¼šè¢«å›æ”¶ã€‚å®ƒå®ç°ç®€å•ï¼Œä½†æ•ˆç‡ä¸é«˜æ— æ³•è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚\næ ‡è®°æ¸…é™¤æ³• æ‰«ææ‰€æœ‰å¯¹è±¡ï¼Œå°†æœ‰å¼•ç”¨çš„è¿›è¡Œæ ‡è®°ã€‚ä¼˜ç‚¹æ˜¯å®ç°ç®€å•ï¼Œä½†å¯èƒ½å‡ºç°å¾ˆå¤šå†…å­˜ç¢ç‰‡ï¼Œä¸åˆ©äºå†…å­˜é‡æ–°åˆ†é…ã€‚\nå¤åˆ¶æ³• å‡†å¤‡2ä¸ªå¤§å°ä¸€æ ·çš„å†…å­˜å—ï¼Œå°†å­˜æ´»çš„å¯¹è±¡æ”¾åˆ°æ–°çš„å†…å­˜å—ã€‚ä¼˜ç‚¹æ˜¯è§£å†³äº†å†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œä½†å†…å­˜å¤åˆ¶æ¯”è¾ƒæ¶ˆè€—èµ„æºï¼Œè¿˜éœ€è¦å°†å¼•ç”¨å…³ç³»è¿›è¡Œå¤åˆ¶ã€‚\nåˆ†ä»£æ³• å°†å¯¹è±¡åˆ›å»ºçš„ä¸åŒæ—¶é—´åˆ†ä¸ºé’å¹´ä»£ã€è€å¹´ä»£ã€‚åˆ†ä»£å‘åŸºäºä¸€ç§å®è·µæ€æƒ³ï¼Œå¤§å¤šæ•°å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸéƒ½å¾ˆçŸ­ã€‚\nä¸‰è‰²æ ‡è®°æ³• stwå¯ä»¥æ˜¯start the world æˆ–è€… stop zhe worldçš„ç¼©å†™ï¼Œä»–æŒ‡çš„æ˜¯stop the word åˆ° start the world è¿™ä¸ªé—´éš”çš„æ—¶é—´ã€‚åœ¨gcè¿‡ç¨‹éœ€è¦æš‚åœç”¨æˆ· ä»£ç æ‰§è¡Œï¼Œè¿›è¡Œå†…å­˜æ‰«æï¼Œè¿™ä¸ªstwæ—¶é—´è¶ŠçŸ­ï¼Œå¯¹ç¨‹åºçš„æ€§èƒ½æå‡è¶Šé«˜ã€‚\ngoçš„GCå®ç° goå› ä¸ºå†…å­˜åˆ†é…æ˜¯é‡‡ç”¨tcmallocåˆ†é…æ³•ï¼Œæ‰€æœ‰ä¸éœ€è¦å¤„ç†å†…å­˜ç¢ç‰‡é—®é¢˜ï¼ŒåŒæ—¶goå›¢é˜Ÿæ›´åŠ å¸Œæœ›çš„æ˜¯gcæ“ä½œå¯ä»¥å’Œç”¨æˆ·ä»£ç ä¸€èµ·æ‰§è¡Œï¼Œä¸ä»…æ˜¯å‡å°‘ stwçš„æ—¶é—´ã€‚goé‡‡ç”¨ä¸‰è‰²æ ‡è®°æ³•å¯¹å†…å­˜è¿›è¡Œå›æ”¶ï¼Œå¹¶é‡‡ç”¨æ··åˆå±éšœæå‡å¹¶å‘æ—¶çš„å›æ”¶æ•ˆç‡ã€‚\ntcmallocå†…å­˜åˆ†é… é¦–å…ˆæ¯ä¸ªåç¨‹éƒ½æœ‰è‡ªå·±çš„å†…å­˜åˆ†é…å™¨ï¼Œç”±ä¸€ç³»åˆ—é€’å¢çš„å†…å­˜å¤§å°å—ç»„æˆï¼Œæ¯æ¬¡å†…å­˜ç”³è¯·å›ä¼˜å…ˆåœ¨æœ¬åœ°åˆ†é…å™¨è¿›è¡Œç”³è¯·ï¼Œå½“å†…å­˜ä¸è¶³ä¼šå‘æ›´é«˜ä¸€çº§çš„å†…å­˜åˆ†é…å™¨è¿›è¡Œç”³è¯·ã€‚ å†…å­˜åˆ†ç±»å™¨ä¼šå®šæ—¶æ•´ç†å†…å­˜ç¢ç‰‡ï¼Œå½“ç©ºé—²å†…å­˜è¶…è¿‡ä¸€å®šæ•°é‡æ—¶ä¼šè¿›è¡Œå†…å­˜å›æ”¶ï¼Œä¸è¶³æ—¶ä¼šè¿›è¡Œå†…å­˜åˆ†é…ã€‚\ngoä¸ºä»€ä¹ˆé‡‡ç”¨ä¸‰è‰²æ ‡è®°æ³• goé‡‡ç”¨tcmallocæ‰€ä»¥å¯¹å†…å­˜ç¢ç‰‡ä¼˜åŒ–çš„æ–¹æ¡ˆçš„gcç®—æ³•å¹¶ä¸ä¼šå¸¦æ¥æ˜æ˜¾çš„æ€§èƒ½æå‡ goå›¢é˜Ÿçš„ç›®æ ‡ä¸ä»…ä»…æ˜¯å‡å°‘stwçš„æ—¶å€™ï¼Œè¿˜å¸Œæœ›å›æ”¶è¿‡ç¨‹å¯ä»¥å’Œç”¨æˆ·ä»£ç å…±åŒæ‰§è¡Œï¼Œæå‡ç¨‹åºæ€§èƒ½ã€‚ å®šä¹‰ goçš„gcæ‰«æå™¨å°†æ‰€æœ‰å¯¹è±¡åˆ†ä¸ºä¸‰ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š\nç™½è‰²å¯¹è±¡ï¼ˆå¯èƒ½å­˜æ´»çš„å¯¹è±¡ï¼‰ï¼šä¸€å¼€å§‹æ‰€æœ‰å¯¹è±¡éƒ½æ ‡è®°æˆç™½è‰²å¯¹è±¡ï¼Œå½“æ‰«æå®Œæˆåï¼Œç™½è‰²å¯¹è±¡ä¸å¯è¾¾ ç°è‰²å¯¹è±¡ï¼ˆæ³¢é¢ï¼‰ï¼šæ­£åœ¨è¢«è®¿é—®å™¨è®¿é—®åˆ°çš„å¯¹è±¡ï¼Œä»–å¯èƒ½æŒ‡å‘ç™½è‰²å¯¹è±¡ é»‘è‰²å¯¹è±¡ï¼ˆç¡®å®šå­˜æ´»ï¼‰ï¼šå·²ç»è¢«å›æ”¶æœŸæ‰«æã€‚ æ‰«æè¿‡ç¨‹ åˆ†ä¸º4æ­¥\næ‰€æœ‰æ ¹å¯¹è±¡æ ‡è®°ä¸ºç™½è‰² å°†æ ¹å¯¹è±¡æ”¾å…¥å¾…æ‰«æé˜Ÿåˆ—ï¼Œæ ‡è®°æˆç°è‰² æ‰«æé˜Ÿåˆ—æ‰€æœ‰çš„ç°è‰²å¯¹è±¡ï¼Œæ ‡è®°æˆé»‘è‰²ï¼Œå¹¶å°†å¼•ç”¨å¯¹è±¡æ ‡è®°æˆç°è‰²ã€‚ é‡å¤æ­¥éª¤ä¸‰ï¼Œç›´åˆ°å¾…æ‰«æçš„ç°è‰²å¯¹è±¡ä¸ºç©ºï¼Œæ‰€æœ‰å¯¹è±¡æ ‡è®°æˆé»‘è‰²æˆ–è€…ç™½è‰²ã€‚ç™½è‰²å¯¹è±¡ä¸å¯è¾¾ï¼Œè¿›è¡Œå›æ”¶ã€‚ æ ¹å¯¹è±¡åœ¨åƒåœ¾å›æ”¶æœ¯è¯­ä¸­è¢«ç§°ä¸ºæ ¹é›†åˆï¼Œå®ƒåŒ…å« å…¨å±€å¯¹è±¡ï¼Œç¨‹åºåœ¨ç¼–è¯‘é˜¶æ®µå°±èƒ½ç¡®å®šçš„å­˜åœ¨äºç¨‹åºæ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ æ‰§è¡Œæ ˆï¼Œæ¯ä¸ªgoroutineéƒ½æœ‰è‡ªå·±çš„å†…å­˜æ ˆï¼Œä¼šæœ‰è‡ªå·±çš„æ ˆå¯¹è±¡å’ŒæŒ‡å‘å †åŒºå—çš„æŒ‡é’ˆ å¯„å­˜å™¨ï¼Œè®¡ç®—è¿‡ç¨‹ä¸­å¯èƒ½æŒ‡å‘çš„ä¸€äº›å †åŒºå—çš„æŒ‡é’ˆ æ²¡æœ‰stwå¯èƒ½å¾—é—®é¢˜ï¼Œå¯¹è±¡è¢«é”™è¯¯åˆ é™¤ å‡è®¾ä»¥ä¸‹åœºæ™¯ï¼šæ‰«æåˆ°æŸä¸ªèŠ‚ç‚¹ï¼Œå­˜åœ¨aç°è‰²å¯¹è±¡å¼•ç”¨ç™½è‰²å¯¹è±¡b,å­˜åœ¨ä¸€ä¸ªé»‘è‰²å¯¹è±¡cã€‚æ­¤æ—¶ç°å°†åˆ é™¤aå¯¹bçš„å¼•ç”¨ï¼ŒåŒæ—¶æ·»åŠ  cå¯¹bçš„å¼•ç”¨ã€‚bæœ¬æ¥åº”è¯¥è¢«æ­£ç¡®æ ‡è®°æˆé»‘è‰²çš„ï¼Œç”±äºå¯¹è±¡cä¸ºé»‘è‰²ä¸ä¼šå¯¹å®ƒè¿›è¡Œæ‰«æï¼Œè€Œaåˆåˆ é™¤äº†å¯¹bçš„å¼•ç”¨ï¼Œå°±ä¼šé€ æˆcå§‹ç»ˆä¸å¯è¾¾ é€ æˆè¯¯åˆ é™¤ã€‚\nå½“åŒæ—¶æ»¡è¶³ä»¥ä¸‹2ä¸ªæ¡ä»¶æ—¶ï¼Œä¼šå‡ºç°è¯¯åˆ é™¤ï¼š\nèµ‹å€¼å™¨åˆ›å»ºä¸€ä¸ªé»‘è‰²å¯¹è±¡å¯¹ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ åˆ é™¤ç°è‰²å¯¹è±¡å¯¹è¿™ä¸ªç™½è‰²çš„å¼•ç”¨ åªè¦ç ´åä»»æ„æ¡ä»¶å°±å¯ä»¥é¿å…è¯¯åˆ é™¤ é¿å…æ¡ä»¶ä¸€ï¼Œä¹Ÿå°±é¿å…äº†ä¿®æ”¹å¯¹è±¡æ± å½“ä¸­éœ€è¦è¢«åˆ é™¤çš„å¯¹è±¡çš„å­˜æ´»çŠ¶æ€ï¼Œåº”è¯¥å­˜æ´»çš„å¯¹è±¡å‡å¯è¾¾ã€‚å‡ºç°æ¡ä»¶äºŒï¼Œåˆ é™¤äº†ç°è‰²å¯¹è±¡å¯¹ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ è¿™ä¸ªç™½è‰²å¯¹è±¡ä¹Ÿåº”è¯¥è¢«åˆ é™¤ã€‚ é¿å…æ¡ä»¶äºŒï¼Œç™½è‰²å¯¹è±¡æœ€ç»ˆå¯ä»¥ç”±ç°è‰²è®¿é—®åˆ°ï¼Œè¿›è¡Œæ­£å¸¸æ ‡è®°ã€‚å°±ç®—åˆ›å»ºäº†é»‘è‰²å¯¹è±¡å¯¹ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥ç”±ç°è‰²å¯¹è±¡è§¦è¾¾ã€‚ å±éšœæœºåˆ¶ åˆ†æˆ2ç§èµ‹å€¼å™¨ï¼Œæ’å…¥æ—¶ä½¿ç”¨ç°è‰²èµ‹å€¼å™¨ï¼Œåˆ é™¤æ—¶ä½¿ç”¨é»‘è‰²èµ‹å€¼å™¨\næ’å…¥å±éšœ å½“æ·»åŠ ä¸€æ–°çš„å¯¹è±¡å¼•ç”¨æ—¶ï¼Œä¼šå…ˆå°†æ’å…¥å¯¹è±¡èµ‹å€¼æˆç°è‰²ã€‚ç ´åæ¡ä»¶ä¸€ï¼Œç ´åäº†å¢åŠ äº†ä¸€ä¸ªé»‘è‰²å¯¹è±¡å¯¹ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ã€‚æœ‰ä¸ªä¸€ä¸ªç»†èŠ‚ï¼Œç”±äºå¯¹æ‰€æœ‰å¯¹è±¡è¿›è¡Œæ’å…¥å±éšœä¼šæ¯”è¾ƒ å½±å“æ€§èƒ½ï¼Œgolangå›¢é˜Ÿåæ¥å†³å®šåªå¯¹å †åŒºçš„å¯¹è±¡å¯ç”¨æ’å…¥å±éšœï¼Œæ ˆåŒºçš„å¯¹è±¡ä¼šåœ¨ç¬¬ä¸€æ¬¡gcå®Œæˆä¹‹åstwé‡æ–°æ‰«æä¸€æ¬¡æ ˆåŒºã€‚\nåˆ é™¤å±éšœ å½“åˆ é™¤ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œç°å°†å¯¹è±¡èµ‹å€¼ä¸ºé»‘è‰²ã€‚ç ´åæ¡ä»¶äºŒï¼Œç ´åäº†åˆ é™¤ä¸€ä¸ªç°è‰²å¯¹è±¡å¯¹ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ã€‚\n",
"content": "ä»€ä¹ˆæ˜¯GC gcå°±æ˜¯å†…å­˜åƒåœ¾å›æ”¶ã€‚c/c++è¿™ç±»è¯­è¨€å¯ä»¥ç”±ç¨‹åºå‘˜ç”³è¯·å†…å­˜ï¼Œåˆ†é…åˆ°å †ä¸Šï¼Œå †ä¸Šçš„æ•°æ®éšç€å‡½æ•°ç»“æŸå¹¶ä¸ä¼šè‡ªåŠ¨è¢«æ¸…é›¶ï¼Œéœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨æ¸…ç†ã€‚ è¿™ä¼šç»™ç¼–ç¨‹å¢åŠ è´Ÿæ‹…å’Œéšæ‚£ã€‚é«˜çº§è¯­è¨€å¦‚java/goæ”¯æŒgc,è‡ªåŠ¨åˆ†ææ²¡æœ‰è¢«å¼•ç”¨çš„å˜é‡ï¼Œè¿›è¡Œå†…å­˜å›æ”¶ã€‚\nå¸¸è§çš„GCæ–¹æ³• å¼•ç”¨è®¡æ•°æ³• å¯¹å˜é‡å¯¹è±¡çš„å¼•ç”¨æ¬¡æ•°è¿›è¡Œè®¡æ•°ï¼Œå½“è®¡æ•°ä¸º0å°±ä¼šè¢«å›æ”¶ã€‚å®ƒå®ç°ç®€å•ï¼Œä½†æ•ˆç‡ä¸é«˜æ— æ³•è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚\næ ‡è®°æ¸…é™¤æ³• æ‰«ææ‰€æœ‰å¯¹è±¡ï¼Œå°†æœ‰å¼•ç”¨çš„è¿›è¡Œæ ‡è®°ã€‚ä¼˜ç‚¹æ˜¯å®ç°ç®€å•ï¼Œä½†å¯èƒ½å‡ºç°å¾ˆå¤šå†…å­˜ç¢ç‰‡ï¼Œä¸åˆ©äºå†…å­˜é‡æ–°åˆ†é…ã€‚\nå¤åˆ¶æ³• å‡†å¤‡2ä¸ªå¤§å°ä¸€æ ·çš„å†…å­˜å—ï¼Œå°†å­˜æ´»çš„å¯¹è±¡æ”¾åˆ°æ–°çš„å†…å­˜å—ã€‚ä¼˜ç‚¹æ˜¯è§£å†³äº†å†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œä½†å†…å­˜å¤åˆ¶æ¯”è¾ƒæ¶ˆè€—èµ„æºï¼Œè¿˜éœ€è¦å°†å¼•ç”¨å…³ç³»è¿›è¡Œå¤åˆ¶ã€‚\nåˆ†ä»£æ³• å°†å¯¹è±¡åˆ›å»ºçš„ä¸åŒæ—¶é—´åˆ†ä¸ºé’å¹´ä»£ã€è€å¹´ä»£ã€‚åˆ†ä»£å‘åŸºäºä¸€ç§å®è·µæ€æƒ³ï¼Œå¤§å¤šæ•°å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸéƒ½å¾ˆçŸ­ã€‚\nä¸‰è‰²æ ‡è®°æ³• stwå¯ä»¥æ˜¯start the world æˆ–è€… stop zhe worldçš„ç¼©å†™ï¼Œä»–æŒ‡çš„æ˜¯stop the word åˆ° start the world è¿™ä¸ªé—´éš”çš„æ—¶é—´ã€‚åœ¨gcè¿‡ç¨‹éœ€è¦æš‚åœç”¨æˆ· ä»£ç æ‰§è¡Œï¼Œè¿›è¡Œå†…å­˜æ‰«æï¼Œè¿™ä¸ªstwæ—¶é—´è¶ŠçŸ­ï¼Œå¯¹ç¨‹åºçš„æ€§èƒ½æå‡è¶Šé«˜ã€‚\ngoçš„GCå®ç° goå› ä¸ºå†…å­˜åˆ†é…æ˜¯é‡‡ç”¨tcmallocåˆ†é…æ³•ï¼Œæ‰€æœ‰ä¸éœ€è¦å¤„ç†å†…å­˜ç¢ç‰‡é—®é¢˜ï¼ŒåŒæ—¶goå›¢é˜Ÿæ›´åŠ å¸Œæœ›çš„æ˜¯gcæ“ä½œå¯ä»¥å’Œç”¨æˆ·ä»£ç ä¸€èµ·æ‰§è¡Œï¼Œä¸ä»…æ˜¯å‡å°‘ stwçš„æ—¶é—´ã€‚goé‡‡ç”¨ä¸‰è‰²æ ‡è®°æ³•å¯¹å†…å­˜è¿›è¡Œå›æ”¶ï¼Œå¹¶é‡‡ç”¨æ··åˆå±éšœæå‡å¹¶å‘æ—¶çš„å›æ”¶æ•ˆç‡ã€‚\ntcmallocå†…å­˜åˆ†é… é¦–å…ˆæ¯ä¸ªåç¨‹éƒ½æœ‰è‡ªå·±çš„å†…å­˜åˆ†é…å™¨ï¼Œç”±ä¸€ç³»åˆ—é€’å¢çš„å†…å­˜å¤§å°å—ç»„æˆï¼Œæ¯æ¬¡å†…å­˜ç”³è¯·å›ä¼˜å…ˆåœ¨æœ¬åœ°åˆ†é…å™¨è¿›è¡Œç”³è¯·ï¼Œå½“å†…å­˜ä¸è¶³ä¼šå‘æ›´é«˜ä¸€çº§çš„å†…å­˜åˆ†é…å™¨è¿›è¡Œç”³è¯·ã€‚ å†…å­˜åˆ†ç±»å™¨ä¼šå®šæ—¶æ•´ç†å†…å­˜ç¢ç‰‡ï¼Œå½“ç©ºé—²å†…å­˜è¶…è¿‡ä¸€å®šæ•°é‡æ—¶ä¼šè¿›è¡Œå†…å­˜å›æ”¶ï¼Œä¸è¶³æ—¶ä¼šè¿›è¡Œå†…å­˜åˆ†é…ã€‚\ngoä¸ºä»€ä¹ˆé‡‡ç”¨ä¸‰è‰²æ ‡è®°æ³• goé‡‡ç”¨tcmallocæ‰€ä»¥å¯¹å†…å­˜ç¢ç‰‡ä¼˜åŒ–çš„æ–¹æ¡ˆçš„gcç®—æ³•å¹¶ä¸ä¼šå¸¦æ¥æ˜æ˜¾çš„æ€§èƒ½æå‡ goå›¢é˜Ÿçš„ç›®æ ‡ä¸ä»…ä»…æ˜¯å‡å°‘stwçš„æ—¶å€™ï¼Œè¿˜å¸Œæœ›å›æ”¶è¿‡ç¨‹å¯ä»¥å’Œç”¨æˆ·ä»£ç å…±åŒæ‰§è¡Œï¼Œæå‡ç¨‹åºæ€§èƒ½ã€‚ å®šä¹‰ goçš„gcæ‰«æå™¨å°†æ‰€æœ‰å¯¹è±¡åˆ†ä¸ºä¸‰ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š\nç™½è‰²å¯¹è±¡ï¼ˆå¯èƒ½å­˜æ´»çš„å¯¹è±¡ï¼‰ï¼šä¸€å¼€å§‹æ‰€æœ‰å¯¹è±¡éƒ½æ ‡è®°æˆç™½è‰²å¯¹è±¡ï¼Œå½“æ‰«æå®Œæˆåï¼Œç™½è‰²å¯¹è±¡ä¸å¯è¾¾ ç°è‰²å¯¹è±¡ï¼ˆæ³¢é¢ï¼‰ï¼šæ­£åœ¨è¢«è®¿é—®å™¨è®¿é—®åˆ°çš„å¯¹è±¡ï¼Œä»–å¯èƒ½æŒ‡å‘ç™½è‰²å¯¹è±¡ é»‘è‰²å¯¹è±¡ï¼ˆç¡®å®šå­˜æ´»ï¼‰ï¼šå·²ç»è¢«å›æ”¶æœŸæ‰«æã€‚ æ‰«æè¿‡ç¨‹ åˆ†ä¸º4æ­¥\næ‰€æœ‰æ ¹å¯¹è±¡æ ‡è®°ä¸ºç™½è‰² å°†æ ¹å¯¹è±¡æ”¾å…¥å¾…æ‰«æé˜Ÿåˆ—ï¼Œæ ‡è®°æˆç°è‰² æ‰«æé˜Ÿåˆ—æ‰€æœ‰çš„ç°è‰²å¯¹è±¡ï¼Œæ ‡è®°æˆé»‘è‰²ï¼Œå¹¶å°†å¼•ç”¨å¯¹è±¡æ ‡è®°æˆç°è‰²ã€‚ é‡å¤æ­¥éª¤ä¸‰ï¼Œç›´åˆ°å¾…æ‰«æçš„ç°è‰²å¯¹è±¡ä¸ºç©ºï¼Œæ‰€æœ‰å¯¹è±¡æ ‡è®°æˆé»‘è‰²æˆ–è€…ç™½è‰²ã€‚ç™½è‰²å¯¹è±¡ä¸å¯è¾¾ï¼Œè¿›è¡Œå›æ”¶ã€‚ æ ¹å¯¹è±¡åœ¨åƒåœ¾å›æ”¶æœ¯è¯­ä¸­è¢«ç§°ä¸ºæ ¹é›†åˆï¼Œå®ƒåŒ…å« å…¨å±€å¯¹è±¡ï¼Œç¨‹åºåœ¨ç¼–è¯‘é˜¶æ®µå°±èƒ½ç¡®å®šçš„å­˜åœ¨äºç¨‹åºæ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ æ‰§è¡Œæ ˆï¼Œæ¯ä¸ªgoroutineéƒ½æœ‰è‡ªå·±çš„å†…å­˜æ ˆï¼Œä¼šæœ‰è‡ªå·±çš„æ ˆå¯¹è±¡å’ŒæŒ‡å‘å †åŒºå—çš„æŒ‡é’ˆ å¯„å­˜å™¨ï¼Œè®¡ç®—è¿‡ç¨‹ä¸­å¯èƒ½æŒ‡å‘çš„ä¸€äº›å †åŒºå—çš„æŒ‡é’ˆ æ²¡æœ‰stwå¯èƒ½å¾—é—®é¢˜ï¼Œå¯¹è±¡è¢«é”™è¯¯åˆ é™¤ å‡è®¾ä»¥ä¸‹åœºæ™¯ï¼šæ‰«æåˆ°æŸä¸ªèŠ‚ç‚¹ï¼Œå­˜åœ¨aç°è‰²å¯¹è±¡å¼•ç”¨ç™½è‰²å¯¹è±¡b,å­˜åœ¨ä¸€ä¸ªé»‘è‰²å¯¹è±¡cã€‚æ­¤æ—¶ç°å°†åˆ é™¤aå¯¹bçš„å¼•ç”¨ï¼ŒåŒæ—¶æ·»åŠ  cå¯¹bçš„å¼•ç”¨ã€‚bæœ¬æ¥åº”è¯¥è¢«æ­£ç¡®æ ‡è®°æˆé»‘è‰²çš„ï¼Œç”±äºå¯¹è±¡cä¸ºé»‘è‰²ä¸ä¼šå¯¹å®ƒè¿›è¡Œæ‰«æï¼Œè€Œaåˆåˆ é™¤äº†å¯¹bçš„å¼•ç”¨ï¼Œå°±ä¼šé€ æˆcå§‹ç»ˆä¸å¯è¾¾ é€ æˆè¯¯åˆ é™¤ã€‚\nå½“åŒæ—¶æ»¡è¶³ä»¥ä¸‹2ä¸ªæ¡ä»¶æ—¶ï¼Œä¼šå‡ºç°è¯¯åˆ é™¤ï¼š\nèµ‹å€¼å™¨åˆ›å»ºä¸€ä¸ªé»‘è‰²å¯¹è±¡å¯¹ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ åˆ é™¤ç°è‰²å¯¹è±¡å¯¹è¿™ä¸ªç™½è‰²çš„å¼•ç”¨ åªè¦ç ´åä»»æ„æ¡ä»¶å°±å¯ä»¥é¿å…è¯¯åˆ é™¤ é¿å…æ¡ä»¶ä¸€ï¼Œä¹Ÿå°±é¿å…äº†ä¿®æ”¹å¯¹è±¡æ± å½“ä¸­éœ€è¦è¢«åˆ é™¤çš„å¯¹è±¡çš„å­˜æ´»çŠ¶æ€ï¼Œåº”è¯¥å­˜æ´»çš„å¯¹è±¡å‡å¯è¾¾ã€‚å‡ºç°æ¡ä»¶äºŒï¼Œåˆ é™¤äº†ç°è‰²å¯¹è±¡å¯¹ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ è¿™ä¸ªç™½è‰²å¯¹è±¡ä¹Ÿåº”è¯¥è¢«åˆ é™¤ã€‚ é¿å…æ¡ä»¶äºŒï¼Œç™½è‰²å¯¹è±¡æœ€ç»ˆå¯ä»¥ç”±ç°è‰²è®¿é—®åˆ°ï¼Œè¿›è¡Œæ­£å¸¸æ ‡è®°ã€‚å°±ç®—åˆ›å»ºäº†é»‘è‰²å¯¹è±¡å¯¹ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥ç”±ç°è‰²å¯¹è±¡è§¦è¾¾ã€‚ å±éšœæœºåˆ¶ åˆ†æˆ2ç§èµ‹å€¼å™¨ï¼Œæ’å…¥æ—¶ä½¿ç”¨ç°è‰²èµ‹å€¼å™¨ï¼Œåˆ é™¤æ—¶ä½¿ç”¨é»‘è‰²èµ‹å€¼å™¨\næ’å…¥å±éšœ å½“æ·»åŠ ä¸€æ–°çš„å¯¹è±¡å¼•ç”¨æ—¶ï¼Œä¼šå…ˆå°†æ’å…¥å¯¹è±¡èµ‹å€¼æˆç°è‰²ã€‚ç ´åæ¡ä»¶ä¸€ï¼Œç ´åäº†å¢åŠ äº†ä¸€ä¸ªé»‘è‰²å¯¹è±¡å¯¹ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ã€‚æœ‰ä¸ªä¸€ä¸ªç»†èŠ‚ï¼Œç”±äºå¯¹æ‰€æœ‰å¯¹è±¡è¿›è¡Œæ’å…¥å±éšœä¼šæ¯”è¾ƒ å½±å“æ€§èƒ½ï¼Œgolangå›¢é˜Ÿåæ¥å†³å®šåªå¯¹å †åŒºçš„å¯¹è±¡å¯ç”¨æ’å…¥å±éšœï¼Œæ ˆåŒºçš„å¯¹è±¡ä¼šåœ¨ç¬¬ä¸€æ¬¡gcå®Œæˆä¹‹åstwé‡æ–°æ‰«æä¸€æ¬¡æ ˆåŒºã€‚\nåˆ é™¤å±éšœ å½“åˆ é™¤ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œç°å°†å¯¹è±¡èµ‹å€¼ä¸ºé»‘è‰²ã€‚ç ´åæ¡ä»¶äºŒï¼Œç ´åäº†åˆ é™¤ä¸€ä¸ªç°è‰²å¯¹è±¡å¯¹ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ã€‚\næ··åˆå±éšœ æ ˆåŒºï¼š gcå¼€å§‹é˜¶æ®µæ ˆåŒºæ‰€æœ‰çš„å¯¹è±¡éƒ½è¢«éå†å¹¶æ ‡è®°ä¸ºé»‘è‰² gcè¿›è¡Œé˜¶æ®µï¼Œå¢åŠ å’Œåˆ é™¤çš„å¯¹è±¡ä¹Ÿéƒ½è¢«æ ‡è®°æˆé»‘è‰² å †åŒºï¼šåˆ é™¤æˆ–æ·»åŠ å¯¹è±¡éƒ½æ ‡è®°ä¸ºç°è‰² åˆ†æå·¥å…·å’Œåˆ†ææ–¹æ³• goçš„åƒåœ¾å›æ”¶ç®—æ³•æ˜¯æŒ‰æ¯”ä¾‹ï¼Œæ— åˆ†ä»£ï¼Œä¸ç”¨æˆ·ä»£ç å¹¶å‘æ‰§è¡Œï¼Œæ— å†…å­˜ç§»åŠ¨å¹¶ä¸»åŠ¨å‘æ“ä½œç³»ç»Ÿå½’è¿˜å†…å­˜çš„å›æ”¶ç®—æ³•ï¼Œæ‰€ä»¥éœ€è¦å…³æ³¨çš„ç‚¹æ˜¯ï¼š\nCPUåˆ©ç”¨ç‡ stwçš„æ—¶é—´å’Œé¢‘ç‡ å¦‚ä½•é’ˆå¯¹GCè¿›è¡Œä¼˜åŒ– è°ƒæ•´gc CPUä½¿ç”¨ç‡ é€ƒé€¸åˆ†æå°½å¯èƒ½å°†å˜é‡åˆ†é…åˆ°æ ˆä¸Š ",
"tags":null,
"categories":null
},{
"title":"Map",
"permalink": "http://localhost:1313/posts/go/map/",
"summary": "goçš„å“ˆå¸Œå®ç° é€šç”¨å“ˆå¸Œå®ç° å“ˆå¸Œè¡¨æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡å¯¹keyç»è¿‡å“ˆå¸Œå‡½æ•°è®¡ç®—çš„å€¼å’Œå­˜å‚¨æ•°æ®çš„æ•°ç»„çš„é•¿åº¦ï¼Œä¸¤è€…æ±‚ä½™å¾—åˆ°åœ¨æ•°ç»„æ’å…¥çš„ä½ç½®ã€‚é«˜æ•ˆçš„æŸ¥æ‰¾æ•ˆç‡ æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚\nå“ˆå¸Œå‡½æ•° ä»»æ„é•¿åº¦çš„è¾“å…¥æœ‰å›ºå®šè¾“å‡º åŒä¸€è¾“å…¥ä¼šäº§ç”ŸåŒä¸€ä¸ªè¾“å‡º è¾“å…¥çš„ç»†å°æ”¹å˜ä¼šé€ æˆè¾“å…¥çš„å®Œå…¨ä¸ä¸€æ · é€Ÿåº¦å¿« å•é¡¹ä¸å¯é€† goçš„å“ˆå¸Œåº•å±‚å®ç° é€šè¿‡åº•å±‚ç»“æ„ä½“hmapæ¥å®ä¾‹åŒ–mapå¯¹è±¡ï¼Œhmap åŒ…å«æŒ‡å‘[]bucketæ•°ç»„çš„æŒ‡é’ˆã€‚bucketç»“æ„é‡Œé¢ä¼šå­˜å‚¨çœŸå®çš„æ•°æ® ä»¥key1key2 val1value2 çš„å½¢å¼è¿›è¡Œæ’åˆ—ï¼Œæ–¹ä¾¿å†…å­˜å¯¹é½ã€‚å¤´éƒ¨æœ‰topå“ˆå¸Œæ–¹ä¾¿bucketå†…éƒ¨è¿›è¡Œæ•°æ®å®šä½ï¼Œåº•éƒ¨æœ‰æŒ‡å‘æº¢å‡ºbucketçš„æŒ‡é’ˆã€‚ å½“å‘ç”Ÿå“ˆå¸Œå†²çªï¼Œå†²çªçš„æ•°æ®ä¼šå­˜æ”¾åˆ°æº¢å‡ºbucketé“¾è¡¨ã€‚\næ’å…¥è¿‡ç¨‹ é¦–å…ˆç”¨å“ˆå¸Œå‡½æ•°å¯¹keyè®¡ç®—ï¼Œå¾—åˆ°64ä½æ•°æ®ï¼ˆ64ä½æœºå™¨ä¸Šï¼‰ã€‚ä½Bä½å†³å®šæ•°æ®è½å…¥å“ªä¸ªæ¡¶ã€‚Bæ˜¯log2countï¼Œä¹Ÿå°±æ˜¯ä»¥2ä¸ºåº•bucketå…ƒç´ çš„é•¿åº¦çš„å¯¹æ•°ã€‚ é«˜8ä½å†³å®šè½å…¥bucketå…·ä½“çš„ä½ç½®ã€‚å¦‚æœå‘é€å“ˆå¸Œå†²çªï¼Œå°±æŠŠæ•°æ®å­˜å…¥æº¢å‡ºæ¡¶ã€‚\néå†è¿‡ç¨‹ã€æŸ¥æ‰¾è¿‡ç¨‹ éå†ï¼šä»0-bucketé•¿åº¦éšæœºä¸€ä¸ªæ•°å­—é€‰æ‹©bucketè¿›è¡Œéå†ã€‚æ‰€ä»¥goçš„mapæ˜¯æ— åºã€‚å¦‚æœbucketéå†å®Œï¼Œæº¢å‡ºæ¡¶ä¸ä¸ºç©ºï¼Œç»§ç»­éå†æº¢å‡ºæ¡¶ã€‚ æŸ¥æ‰¾ï¼šå“ˆå¸Œå‡½æ•°å¯¹keyè®¡ç®—ï¼Œä½8ä½æ‰¾åˆ°å…·ä½“çš„æ¡¶ã€‚é«˜8ä½æ‹¿æ¥å’Œbucketçš„topå“ˆå¸Œè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸€è‡´ï¼Œå†æ¯”è¾ƒå…·ä½“çš„key,å¦‚æœç›¸åŒå°±è¿”å›ï¼Œ å¦åˆ™å†çœ‹æº¢å‡ºæ¡¶æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¼šç©ºå¯¹é“¾è¡¨è¿›è¡Œéå†ã€‚å¦‚æœéƒ½æ²¡æœ‰å°±è¿”å›æŸ¥æ‰¾å¤±è´¥ã€‚ goçš„æ‰©å®¹è¿‡ç¨‹ å½“å“ˆå¸Œå‡½æ•°äº§ç”Ÿè¿‡å¤šçš„å“ˆå¸Œç¢°æ’æ—¶ï¼Œå°±ä¼šå¯¼è‡´æŸ¥è¯¢æ•ˆç‡ä½ä¸‹ï¼Œä¸ºäº†å‡å°‘å“ˆå¸Œç¢°æ’ï¼Œéœ€è¦å¯¹åº•å±‚æ•°ç»„çš„å®¹é‡æ‰©å®¹æˆ–è€…å¯¹æ•°æ®è¿›è¡Œä»æ–°æ’åˆ—ã€‚ å½“æ»¡è¶³ä¸€ä¸‹ä»»æ„æ¡ä»¶ä¼šè§¦å‘æ‰©å®¹\nå½“ç¢°æ’å› å­\u0026gt;6.5, ç¢°æ’å› å­=count(å®é™…å…ƒç´ ä¸ªæ•°)/2çš„Bæ¬¡æ–¹ï¼ˆbucketæ•°ç»„æ€»çš„å…ƒç´ é•¿åº¦ï¼‰ å½“æº¢å‡ºæ¡¶è¿‡å¤šæ—¶ï¼Œå½“B \u0026lt; 15 , å½“æº¢å‡ºæ¡¶çš„ä¸ªæ•°\u0026gt;Bæ¬¡æ–¹ï¼Œè§¦å‘æ‰©å®¹ã€‚å½“B\u0026gt;15æ—¶ï¼Œoverflowè¶…è¿‡2çš„15æ¬¡æ–¹ã€‚ ä¸ºä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ sync.mapä½¿ç”¨ sync.mapå¦‚ä½•å®ç°çš„ æ³¨æ„äº‹é¡¹",
"content": "goçš„å“ˆå¸Œå®ç° é€šç”¨å“ˆå¸Œå®ç° å“ˆå¸Œè¡¨æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡å¯¹keyç»è¿‡å“ˆå¸Œå‡½æ•°è®¡ç®—çš„å€¼å’Œå­˜å‚¨æ•°æ®çš„æ•°ç»„çš„é•¿åº¦ï¼Œä¸¤è€…æ±‚ä½™å¾—åˆ°åœ¨æ•°ç»„æ’å…¥çš„ä½ç½®ã€‚é«˜æ•ˆçš„æŸ¥æ‰¾æ•ˆç‡ æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚\nå“ˆå¸Œå‡½æ•° ä»»æ„é•¿åº¦çš„è¾“å…¥æœ‰å›ºå®šè¾“å‡º åŒä¸€è¾“å…¥ä¼šäº§ç”ŸåŒä¸€ä¸ªè¾“å‡º è¾“å…¥çš„ç»†å°æ”¹å˜ä¼šé€ æˆè¾“å…¥çš„å®Œå…¨ä¸ä¸€æ · é€Ÿåº¦å¿« å•é¡¹ä¸å¯é€† goçš„å“ˆå¸Œåº•å±‚å®ç° é€šè¿‡åº•å±‚ç»“æ„ä½“hmapæ¥å®ä¾‹åŒ–mapå¯¹è±¡ï¼Œhmap åŒ…å«æŒ‡å‘[]bucketæ•°ç»„çš„æŒ‡é’ˆã€‚bucketç»“æ„é‡Œé¢ä¼šå­˜å‚¨çœŸå®çš„æ•°æ® ä»¥key1key2 val1value2 çš„å½¢å¼è¿›è¡Œæ’åˆ—ï¼Œæ–¹ä¾¿å†…å­˜å¯¹é½ã€‚å¤´éƒ¨æœ‰topå“ˆå¸Œæ–¹ä¾¿bucketå†…éƒ¨è¿›è¡Œæ•°æ®å®šä½ï¼Œåº•éƒ¨æœ‰æŒ‡å‘æº¢å‡ºbucketçš„æŒ‡é’ˆã€‚ å½“å‘ç”Ÿå“ˆå¸Œå†²çªï¼Œå†²çªçš„æ•°æ®ä¼šå­˜æ”¾åˆ°æº¢å‡ºbucketé“¾è¡¨ã€‚\næ’å…¥è¿‡ç¨‹ é¦–å…ˆç”¨å“ˆå¸Œå‡½æ•°å¯¹keyè®¡ç®—ï¼Œå¾—åˆ°64ä½æ•°æ®ï¼ˆ64ä½æœºå™¨ä¸Šï¼‰ã€‚ä½Bä½å†³å®šæ•°æ®è½å…¥å“ªä¸ªæ¡¶ã€‚Bæ˜¯log2countï¼Œä¹Ÿå°±æ˜¯ä»¥2ä¸ºåº•bucketå…ƒç´ çš„é•¿åº¦çš„å¯¹æ•°ã€‚ é«˜8ä½å†³å®šè½å…¥bucketå…·ä½“çš„ä½ç½®ã€‚å¦‚æœå‘é€å“ˆå¸Œå†²çªï¼Œå°±æŠŠæ•°æ®å­˜å…¥æº¢å‡ºæ¡¶ã€‚\néå†è¿‡ç¨‹ã€æŸ¥æ‰¾è¿‡ç¨‹ éå†ï¼šä»0-bucketé•¿åº¦éšæœºä¸€ä¸ªæ•°å­—é€‰æ‹©bucketè¿›è¡Œéå†ã€‚æ‰€ä»¥goçš„mapæ˜¯æ— åºã€‚å¦‚æœbucketéå†å®Œï¼Œæº¢å‡ºæ¡¶ä¸ä¸ºç©ºï¼Œç»§ç»­éå†æº¢å‡ºæ¡¶ã€‚ æŸ¥æ‰¾ï¼šå“ˆå¸Œå‡½æ•°å¯¹keyè®¡ç®—ï¼Œä½8ä½æ‰¾åˆ°å…·ä½“çš„æ¡¶ã€‚é«˜8ä½æ‹¿æ¥å’Œbucketçš„topå“ˆå¸Œè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸€è‡´ï¼Œå†æ¯”è¾ƒå…·ä½“çš„key,å¦‚æœç›¸åŒå°±è¿”å›ï¼Œ å¦åˆ™å†çœ‹æº¢å‡ºæ¡¶æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¼šç©ºå¯¹é“¾è¡¨è¿›è¡Œéå†ã€‚å¦‚æœéƒ½æ²¡æœ‰å°±è¿”å›æŸ¥æ‰¾å¤±è´¥ã€‚ goçš„æ‰©å®¹è¿‡ç¨‹ å½“å“ˆå¸Œå‡½æ•°äº§ç”Ÿè¿‡å¤šçš„å“ˆå¸Œç¢°æ’æ—¶ï¼Œå°±ä¼šå¯¼è‡´æŸ¥è¯¢æ•ˆç‡ä½ä¸‹ï¼Œä¸ºäº†å‡å°‘å“ˆå¸Œç¢°æ’ï¼Œéœ€è¦å¯¹åº•å±‚æ•°ç»„çš„å®¹é‡æ‰©å®¹æˆ–è€…å¯¹æ•°æ®è¿›è¡Œä»æ–°æ’åˆ—ã€‚ å½“æ»¡è¶³ä¸€ä¸‹ä»»æ„æ¡ä»¶ä¼šè§¦å‘æ‰©å®¹\nå½“ç¢°æ’å› å­\u0026gt;6.5, ç¢°æ’å› å­=count(å®é™…å…ƒç´ ä¸ªæ•°)/2çš„Bæ¬¡æ–¹ï¼ˆbucketæ•°ç»„æ€»çš„å…ƒç´ é•¿åº¦ï¼‰ å½“æº¢å‡ºæ¡¶è¿‡å¤šæ—¶ï¼Œå½“B \u0026lt; 15 , å½“æº¢å‡ºæ¡¶çš„ä¸ªæ•°\u0026gt;Bæ¬¡æ–¹ï¼Œè§¦å‘æ‰©å®¹ã€‚å½“B\u0026gt;15æ—¶ï¼Œoverflowè¶…è¿‡2çš„15æ¬¡æ–¹ã€‚ ä¸ºä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ sync.mapä½¿ç”¨ sync.mapå¦‚ä½•å®ç°çš„ æ³¨æ„äº‹é¡¹ ",
"tags":null,
"categories":null
},{
"title":"Http2_grpc",
"permalink": "http://localhost:1313/posts/network/http2_grpc/",
"summary": "http2 http1çš„å¼Šç«¯ æ•°æ®ä»¥æ–‡æœ¬ä¼ è¾“ï¼Œååˆ†ä½æ•ˆ headerå¤´æ•°æ®å¾ˆå¤š æ¯ä¸ªtcpé“¾æ¥åªèƒ½å‘é€ä¸€æ¬¡é“¾æ¥ åªèƒ½å•å‘ä¼ é€’æ•°æ®ï¼Œç”±æµè§ˆå™¨å‘èµ· åŠ è½½æ— æ³•å®šä¹‰é¡ºåº http2 http2é’ˆå¯¹è¿™äº›ç¼ºç‚¹è¿›è¡Œäº†ä¼˜åŒ–\nå¯¹æ•°æ®è¿›è¡ŒäºŒè¿›åˆ¶åˆ†å¸§ï¼ŒåŸºäºæµä¼ è¾“æé«˜äº†ä¼ è¾“æ•ˆç‡ï¼Œè¿˜å¯ä»¥è¿›è¡Œæµé‡æ§åˆ¶ï¼Œæå‡å®‰å…¨æ€§å’Œå¯é æ€§ å¯¹å¤´æ•°æ®è¿›è¡Œäº†å‹ç¼©ï¼Œé‡‡ç”¨hpackç®—æ³•å¯¹æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œæå‡äº†ä¼ è¾“æ•ˆç‡ é‡‡ç”¨å¤šè·¯å¤ç”¨ï¼Œæ¯ä¸ªtcpè¿æ¥å¯ä»¥å‘èµ·ä»»æ„å¤šçš„ä¼ è¾“è¯·æ±‚ï¼Œå‡å°‘äº†tcpçš„ä¸‰æ¬¡æ¡æ‰‹ç­‰é¢‘ç¹å»ºç«‹è¯·æ±‚ å¯ä»¥å®ç°æœåŠ¡ç«¯æ¨é€ï¼Œä»å•å‘ä¼ è¾“æ”¹ä¸ºåŒå‘ä¼ è¾“ å¯ä»¥æ ¹æ®é¡µé¢ä¸åŒèµ„æºçš„é‡è¦ç¨‹åº¦è®¾ç½®ä¼˜å…ˆçº§è¿›è¡ŒåŠ è½½ é€šè¿‡ä»¥ä¸Šäº”ä¸ªæ–¹é¢http2å¯¹h1è¿›è¡Œäº†å‡çº§ï¼Œæé«˜äº†ä¼ è¾“æ•ˆç‡ï¼Œå¢åŠ æ›´å¤šå®ç°çš„åŠŸèƒ½ï¼Œæå‡äº†å®¢æˆ·ç«¯ç”¨æˆ·ä½“éªŒã€‚ å¦‚ä½•ä½¿ç”¨ åå‘ä»£ç†è½¯ä»¶å¦‚nginx/apacheç­‰è®¾ç½®http2é€‰é¡¹ å¦‚nginx,é¦–å…ˆå¿…é¡»æ”¯æŒssl/tslè¯ä¹¦ï¼Œå†åŠ ä¸Šlisten 443 ssl http2\ngoçš„netç»„ä»¶è‡ªåŠ¨æ”¯æŒhttp2,æ— éœ€æ‰‹åŠ¨å‡çº§ grpc rpc rpcæ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ç§åœ¨ä¸åŒè¿›ç¨‹æˆ–ç»„ä»¶ä¸Šè®©å‡½æ•°è°ƒç”¨å¦‚åŒæœ¬åœ°è°ƒç”¨ä¸€æ ·çš„æŠ€æœ¯ã€‚æœ‰å¤šç§å®ç°ï¼Œæ¯”å¦‚json-rpc,xrpc(åŸºäºxml),gprc googleæ¨å‡ºï¼ŒåŸºäºprotobuf,é€šè¿‡IDL(æ¥å£å®šä¹‰)å®šä¹‰åŒä¹‰çš„æ–¹æ³•å’Œå‚æ•°ï¼Œä½¿ç”¨ä»£ç ç”Ÿæˆå·¥å…·ç”Ÿæˆä¸åŒè¯­è¨€çš„ä»£ç ã€‚\ngrpcä¹Ÿæ˜¯åŸºäºhttp2,æ‰€ä»¥ä»–å¯ä»¥åˆ©ç”¨http2çš„å„ç§ç‰¹æ€§ï¼Œä»–æœ‰googleæ¨å‡ºï¼Œé‡‡ç”¨protobufä¼ è¾“ã€‚\nä»–æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š\nåŸºäºIDLç”Ÿæˆï¼Œæ¥å£åŠå®šä¹‰ï¼Œå¯ä»¥ç”Ÿæˆå¤šè¯­è¨€ï¼Œè¢«å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å…±ç”¨ã€‚ æ•°æ®ä¼ è¾“æ•ˆç‡é«˜ï¼ŒåŸºäºhttp2,æ‹¥æœ‰åŒå‘ä¼ è¾“ã€tcpå¤šè·¯å¤ç”¨ã€äºŒè¿›åˆ¶æ•°æ®å¸§ä¼ è¾“ã€æµé‡æ§åˆ¶ç­‰ç‰¹æ€§ å¸¸è§äºå¾®æœåŠ¡å½“ä¸­ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®šä¹‰ä¸­é—´ä»¶ï¼Œè¿›è¡Œé™æµã€é™çº§ç­‰ç‰¹æ€§ æµè§ˆå™¨ä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚è¿‡ç¨‹ æœåŠ¡å™¨ä¼šå¯åŠ¨è¿›ç¨‹ç›‘å¬æŸä¸ªç«¯å£ï¼Œå½“ç«¯å£ç›‘å¬åˆ°è¯·æ±‚ï¼Œè¿›è¡Œå¤„ç† é€šè¿‡DNSè§£æåŸŸåæ‹¿åˆ°ç›®æ ‡IP,ä¾æ¬¡é€šè¿‡æµè§ˆå™¨ã€æœ¬åœ°ç¼“å­˜æŸ¥è¯¢ï¼Œæ²¡æœ‰å°±å¾€æ ¹dnsæœåŠ¡å™¨æŸ¥è¯¢ã€‚ å¦‚æœæ˜¯httpåè®®éœ€è¦å…ˆé€šè¿‡sslå»ºç«‹å®‰å…¨é€šé“ã€‚ å»ºç«‹TCPè¿æ¥ï¼Œé€šè¿‡äº”å…ƒç»„ï¼šåè®® ip ç«¯å£ ç›®æ ‡IP ç›®æ ‡ç«¯å£ è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Œæ¡æ‰‹å®Œæˆåå¼€å§‹å‘é€æ•°æ® æ•°æ®è¿›è¡Œå°è£…,æ•°æ®ä»åº”ç”¨å±‚ï¼ˆæŠ¥æ–‡ï¼‰-\u0026gt;ä¼ è¾“å±‚ï¼ˆæŠ¥æ–‡+ç«¯å£å·ï¼‰-\u0026gt;ç½‘ç»œIPå±‚ï¼ˆæ•°æ®æ®µ+IPï¼‰-\u0026gt;æ•°æ®é“¾è·¯å±‚(æ•°æ®åŒ…+macä¸»æœºç‰©ç†åœ°å€-\u0026gt;æ•°æ®å¸§)-\u0026gt;ç‰©ç†å±‚(äºŒè¿›åˆ¶æµ)è¿™ä¸ªå±‚æ¬¡ä¾æ¬¡è¿›è¡Œä¼ è¾“ é€šè¿‡ç½‘ç»œå±‚æ‰¾åˆ°ç›®çš„ä¸»æœºï¼Œé€šè¿‡ç«¯å£å·æ‰¾åˆ°ä¸»æœºç›‘å¬ç›®çš„ç«¯å£çš„ç¨‹åºã€‚åº”ç”¨ç¨‹åºå¤„ç†è¯·æ±‚ã€‚ æœåŠ¡å™¨å¤„ç†å“åº”ï¼Œå®Œæˆåï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ æ–­å¼€è¿æ¥ã€4æ¬¡æŒ¥æ‰‹ï¼Œæœ€åä¸€æ¬¡ç­‰å¾…æœåŠ¡å™¨å‘é€å®Œæ¯•æ•°æ® å‚è€ƒèµ„æ–™ https://blog.csdn.net/u012914309/article/details/127507726?spm=1001.2014.3001.5501 ",
"content": "http2 http1çš„å¼Šç«¯ æ•°æ®ä»¥æ–‡æœ¬ä¼ è¾“ï¼Œååˆ†ä½æ•ˆ headerå¤´æ•°æ®å¾ˆå¤š æ¯ä¸ªtcpé“¾æ¥åªèƒ½å‘é€ä¸€æ¬¡é“¾æ¥ åªèƒ½å•å‘ä¼ é€’æ•°æ®ï¼Œç”±æµè§ˆå™¨å‘èµ· åŠ è½½æ— æ³•å®šä¹‰é¡ºåº http2 http2é’ˆå¯¹è¿™äº›ç¼ºç‚¹è¿›è¡Œäº†ä¼˜åŒ–\nå¯¹æ•°æ®è¿›è¡ŒäºŒè¿›åˆ¶åˆ†å¸§ï¼ŒåŸºäºæµä¼ è¾“æé«˜äº†ä¼ è¾“æ•ˆç‡ï¼Œè¿˜å¯ä»¥è¿›è¡Œæµé‡æ§åˆ¶ï¼Œæå‡å®‰å…¨æ€§å’Œå¯é æ€§ å¯¹å¤´æ•°æ®è¿›è¡Œäº†å‹ç¼©ï¼Œé‡‡ç”¨hpackç®—æ³•å¯¹æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œæå‡äº†ä¼ è¾“æ•ˆç‡ é‡‡ç”¨å¤šè·¯å¤ç”¨ï¼Œæ¯ä¸ªtcpè¿æ¥å¯ä»¥å‘èµ·ä»»æ„å¤šçš„ä¼ è¾“è¯·æ±‚ï¼Œå‡å°‘äº†tcpçš„ä¸‰æ¬¡æ¡æ‰‹ç­‰é¢‘ç¹å»ºç«‹è¯·æ±‚ å¯ä»¥å®ç°æœåŠ¡ç«¯æ¨é€ï¼Œä»å•å‘ä¼ è¾“æ”¹ä¸ºåŒå‘ä¼ è¾“ å¯ä»¥æ ¹æ®é¡µé¢ä¸åŒèµ„æºçš„é‡è¦ç¨‹åº¦è®¾ç½®ä¼˜å…ˆçº§è¿›è¡ŒåŠ è½½ é€šè¿‡ä»¥ä¸Šäº”ä¸ªæ–¹é¢http2å¯¹h1è¿›è¡Œäº†å‡çº§ï¼Œæé«˜äº†ä¼ è¾“æ•ˆç‡ï¼Œå¢åŠ æ›´å¤šå®ç°çš„åŠŸèƒ½ï¼Œæå‡äº†å®¢æˆ·ç«¯ç”¨æˆ·ä½“éªŒã€‚ å¦‚ä½•ä½¿ç”¨ åå‘ä»£ç†è½¯ä»¶å¦‚nginx/apacheç­‰è®¾ç½®http2é€‰é¡¹ å¦‚nginx,é¦–å…ˆå¿…é¡»æ”¯æŒssl/tslè¯ä¹¦ï¼Œå†åŠ ä¸Šlisten 443 ssl http2\ngoçš„netç»„ä»¶è‡ªåŠ¨æ”¯æŒhttp2,æ— éœ€æ‰‹åŠ¨å‡çº§ grpc rpc rpcæ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ç§åœ¨ä¸åŒè¿›ç¨‹æˆ–ç»„ä»¶ä¸Šè®©å‡½æ•°è°ƒç”¨å¦‚åŒæœ¬åœ°è°ƒç”¨ä¸€æ ·çš„æŠ€æœ¯ã€‚æœ‰å¤šç§å®ç°ï¼Œæ¯”å¦‚json-rpc,xrpc(åŸºäºxml),gprc googleæ¨å‡ºï¼ŒåŸºäºprotobuf,é€šè¿‡IDL(æ¥å£å®šä¹‰)å®šä¹‰åŒä¹‰çš„æ–¹æ³•å’Œå‚æ•°ï¼Œä½¿ç”¨ä»£ç ç”Ÿæˆå·¥å…·ç”Ÿæˆä¸åŒè¯­è¨€çš„ä»£ç ã€‚\ngrpcä¹Ÿæ˜¯åŸºäºhttp2,æ‰€ä»¥ä»–å¯ä»¥åˆ©ç”¨http2çš„å„ç§ç‰¹æ€§ï¼Œä»–æœ‰googleæ¨å‡ºï¼Œé‡‡ç”¨protobufä¼ è¾“ã€‚\nä»–æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š\nåŸºäºIDLç”Ÿæˆï¼Œæ¥å£åŠå®šä¹‰ï¼Œå¯ä»¥ç”Ÿæˆå¤šè¯­è¨€ï¼Œè¢«å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å…±ç”¨ã€‚ æ•°æ®ä¼ è¾“æ•ˆç‡é«˜ï¼ŒåŸºäºhttp2,æ‹¥æœ‰åŒå‘ä¼ è¾“ã€tcpå¤šè·¯å¤ç”¨ã€äºŒè¿›åˆ¶æ•°æ®å¸§ä¼ è¾“ã€æµé‡æ§åˆ¶ç­‰ç‰¹æ€§ å¸¸è§äºå¾®æœåŠ¡å½“ä¸­ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®šä¹‰ä¸­é—´ä»¶ï¼Œè¿›è¡Œé™æµã€é™çº§ç­‰ç‰¹æ€§ æµè§ˆå™¨ä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚è¿‡ç¨‹ æœåŠ¡å™¨ä¼šå¯åŠ¨è¿›ç¨‹ç›‘å¬æŸä¸ªç«¯å£ï¼Œå½“ç«¯å£ç›‘å¬åˆ°è¯·æ±‚ï¼Œè¿›è¡Œå¤„ç† é€šè¿‡DNSè§£æåŸŸåæ‹¿åˆ°ç›®æ ‡IP,ä¾æ¬¡é€šè¿‡æµè§ˆå™¨ã€æœ¬åœ°ç¼“å­˜æŸ¥è¯¢ï¼Œæ²¡æœ‰å°±å¾€æ ¹dnsæœåŠ¡å™¨æŸ¥è¯¢ã€‚ å¦‚æœæ˜¯httpåè®®éœ€è¦å…ˆé€šè¿‡sslå»ºç«‹å®‰å…¨é€šé“ã€‚ å»ºç«‹TCPè¿æ¥ï¼Œé€šè¿‡äº”å…ƒç»„ï¼šåè®® ip ç«¯å£ ç›®æ ‡IP ç›®æ ‡ç«¯å£ è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Œæ¡æ‰‹å®Œæˆåå¼€å§‹å‘é€æ•°æ® æ•°æ®è¿›è¡Œå°è£…,æ•°æ®ä»åº”ç”¨å±‚ï¼ˆæŠ¥æ–‡ï¼‰-\u0026gt;ä¼ è¾“å±‚ï¼ˆæŠ¥æ–‡+ç«¯å£å·ï¼‰-\u0026gt;ç½‘ç»œIPå±‚ï¼ˆæ•°æ®æ®µ+IPï¼‰-\u0026gt;æ•°æ®é“¾è·¯å±‚(æ•°æ®åŒ…+macä¸»æœºç‰©ç†åœ°å€-\u0026gt;æ•°æ®å¸§)-\u0026gt;ç‰©ç†å±‚(äºŒè¿›åˆ¶æµ)è¿™ä¸ªå±‚æ¬¡ä¾æ¬¡è¿›è¡Œä¼ è¾“ é€šè¿‡ç½‘ç»œå±‚æ‰¾åˆ°ç›®çš„ä¸»æœºï¼Œé€šè¿‡ç«¯å£å·æ‰¾åˆ°ä¸»æœºç›‘å¬ç›®çš„ç«¯å£çš„ç¨‹åºã€‚åº”ç”¨ç¨‹åºå¤„ç†è¯·æ±‚ã€‚ æœåŠ¡å™¨å¤„ç†å“åº”ï¼Œå®Œæˆåï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ æ–­å¼€è¿æ¥ã€4æ¬¡æŒ¥æ‰‹ï¼Œæœ€åä¸€æ¬¡ç­‰å¾…æœåŠ¡å™¨å‘é€å®Œæ¯•æ•°æ® å‚è€ƒèµ„æ–™ https://blog.csdn.net/u012914309/article/details/127507726?spm=1001.2014.3001.5501 ",
"tags":null,
"categories":null
},{
"title":"CAP",
"permalink": "http://localhost:1313/posts/architecture/cap/",
"summary": "å®šä¹‰ CAPç†è®ºæ˜¯æŒ‡åˆ†å¸ƒå¼å½“ä¸­ä¸€è‡´æ€§ã€å¯ç”¨æ€§ä»¥åŠåˆ†åŒºå®¹é”™æ€§ä¸‰è€…ä¸å¯å…¼å¾—ã€‚æˆ‘ä»¬éœ€è¦æ ¹æ®å®é™…åº”ç”¨åœºæ™¯åšå‡ºç›¸åº”çš„å–èˆï¼Œ åœ¨ç°å®ä¸­ï¼Œä¸€èˆ¬æ¥è¯´åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ç½‘ç»œæ˜¯ä¸å¯èƒ½å®Œå…¨ä¿è¯å¯ç”¨çš„ï¼Œæ‰€ä»¥å°±éœ€è¦åœ¨CAå’ŒCPä¸­åšå‡ºé€‰æ‹©ã€‚\ncä¸€è‡´æ€§(consistency) åŒä¸€ä»½æ•°æ®åŒä¸€æ—¶é—´åœ¨ä¸åŒçš„èŠ‚ç‚¹çœ‹åˆ°çš„ç»“æœåº”è¯¥æ˜¯ä¸€è‡´æ€§çš„\naå¯ç”¨æ€§ï¼ˆavailabilityï¼‰ å½“ç³»ç»Ÿå½“ä¸­æŸäº›èŠ‚ç‚¹æ•…éšœä»ç„¶å¯ä»¥åœ¨ä¸€å®šæ—¶é—´å†…å“åº”ç”¨æˆ·è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ç³»ç»Ÿåœ¨ä»»ä½•æ—¶é—´å¯¹äºéé”™è¯·æ±‚éƒ½èƒ½åœ¨ä¸€å®šæ—¶é—´åšå‡ºå“åº”ï¼Œä¸”ä¸è¿”å›é”™è¯¯ã€‚\npåˆ†åŒºå®¹é”™æ€§ï¼ˆpartition toleranceï¼‰ å½“é›†ç¾¤ä¸­å‘ç”Ÿç½‘ç»œåˆ†åŒºï¼Œå› ä¸ºç½‘ç»œæ•…éšœå¯¼è‡´èŠ‚ç‚¹ä¹‹é—´ä¸èƒ½æ­£å¸¸é€šä¿¡ï¼Œç³»ç»Ÿä»ç„¶æ­£å¸¸è¿è¡Œï¼Œèƒ½å¤Ÿå¯¹å¤–æä¾›æœåŠ¡ã€‚\næ‹œå åº­å°†å†›é—®é¢˜ æ˜¯æŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¯èƒ½æœ‰æ¶æ„èŠ‚ç‚¹å¯¹æ•°æ®ä¸€è‡´æ€§é€ æˆç ´åã€‚å¦‚æœç³»ç»Ÿä¸­çš„èŠ‚ç‚¹æ˜¯fä¸ªï¼Œä¸ºäº†è§£å†³éæ‹œå åº­å°†å†›é—®é¢˜ï¼Œè‡³å°‘éœ€è¦3f+1 ä¸ªèŠ‚ç‚¹ã€‚èƒ½å®¹å¿æ‹œå åº­å®¹é”™çš„ç³»ç»Ÿä¸€èˆ¬æ˜¯é«˜å®‰å…¨æ€§è¦æ±‚çš„ç³»ç»Ÿï¼Œæ¯”å¦‚åŒºè·¨é“¾ã€é‡‘èã€å†›äº‹ç­‰ã€‚\nè„‘è£‚ è„‘è£‚æ˜¯æŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç”±äºç½‘ç»œæ³¢åŠ¨æˆ–ä¸­æ–­ï¼Œå¯¼è‡´ç³»ç»Ÿè¢«åˆ†æˆå¤šä¸ªå­ç³»ç»Ÿï¼Œå­ç³»ç»Ÿåœ¨å†…éƒ¨é€‰ä¸¾leaderï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚è¿™ä¼šå¯¼è‡´ ä¸¥é‡çš„é—®é¢˜ï¼Œæ¯”å¦‚\næ•°æ®ä¸ä¸€è‡´\tä¸¤ä¸ªåˆ†åŒºåŒæ—¶å†™å…¥åŒä¸€æ•°æ®ï¼ˆå¦‚è´¦æˆ·ä½™é¢ï¼‰ï¼Œå¯¼è‡´å†²çªä¸”æ— æ³•è‡ªåŠ¨åˆå¹¶ã€‚ èµ„æºå†²çª\tä¸¤ä¸ªâ€œé¢†å¯¼è€…â€åŒæ—¶æ“ä½œå…±äº«èµ„æºï¼ˆå¦‚åˆ†é…åŒä¸€IPåœ°å€ã€é”å®šåŒä¸€æ–‡ä»¶ï¼‰ã€‚ çŠ¶æ€æ··ä¹±\tå®¢æˆ·ç«¯å¯èƒ½è¢«ä¸åŒåˆ†åŒºå“åº”çŸ›ç›¾çš„ç»“æœï¼ˆå¦‚Aåˆ†åŒºè¯´â€œæ”¯ä»˜æˆåŠŸâ€ï¼ŒBåˆ†åŒºè¯´â€œæœªæ”¯ä»˜â€ï¼‰ã€‚ æ•°æ®æ°¸ä¹…ä¸¢å¤±\tåˆ†åŒºæ¢å¤åï¼Œå†²çªå†™å…¥å¯èƒ½å¯¼è‡´éƒ¨åˆ†æ•°æ®è¢«è¦†ç›–æˆ–ä¸¢å¼ƒã€‚ ä¸ºäº†é˜²æ­¢è„‘è£‚ï¼Œä¸€èˆ¬åˆ†å¸ƒå¼ä¸€è‡´æ€§åè®®éƒ½ä¼šé‡‡ç”¨å¤šæ•°æ´¾åŸåˆ™è¿›è¡Œé¿å…ï¼Œæ¯”å¦‚äº”ä¸ªèŠ‚ç‚¹çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œéœ€è¦3ä¸ªèŠ‚ç‚¹çš„ç¡®è®¤æ‰èƒ½æˆä¸ºleader,å¦åˆ™ä¼š å› ä¸ºæ— æ³•é€‰ä¸»è€Œåœæ­¢å¯¹å¤–æä¾›æœåŠ¡ã€‚\nraftåè®® raftåè®®æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¤šä¸ªèŠ‚ç‚¹å¯¹äºæŸä¸ªèµ„æºçš„ä¸€è‡´æ€§çš„è¾¾æˆæ‰€é‡‡ç”¨çš„ä¸€ç§åè®®ï¼Œä¸»è¦æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼š\nä¸»ä»é€‰æ‹© æ—¥å¿—å¤åˆ¶ å®‰å…¨æ€§å’Œä¸€è‡´æ€§ä¿è¯ raftåè®®æ˜¯å¼ºä¸€è‡´çš„ã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–çš„ä¸€è‡´æ€§ç»„ä»¶æ¯”å¦‚zookeeperã€‚raftåè®®æä¾›äº†å¼ºä¸€è‡´æ€§çš„æ–¹æ¡ˆã€‚ zookeeper å®è·µ å¸¸è§çš„ä½¿ç”¨åœºæ™¯ ä¸€äº›å¸¸è§çš„å¼€æºè½¯ä»¶çš„ä½¿ç”¨æˆ‘ä»¬ä¼šç»å¸¸é‡åˆ°è¿™ä¸ªåœºæ™¯ã€‚æ‹¿æœ€å¸¸è§çš„redisä¸ºä¾‹ï¼Œredisçš„åˆ†å¸ƒå¼éƒ¨ç½²æ–¹æ¡ˆæœ‰ä¸‰ç§ï¼Œä¸»ä»ã€å“¨å…µã€clusterã€‚\ngo ç®€å•çš„å®è·µ package main import ( \u0026#34;fmt\u0026#34; \u0026#34;io\u0026#34; \u0026#34;log\u0026#34; \u0026#34;net\u0026#34; \u0026#34;os\u0026#34; \u0026#34;time\u0026#34; \u0026#34;github.com/hashicorp/raft\u0026#34; bolt \u0026#34;github.com/hashicorp/raft-boltdb\u0026#34; ) // ç®€å•çš„ FSMï¼šæäº¤å³æ‰“å° type FSM struct{} func (f *FSM) Apply(l *raft.Log) interface{} { fmt.Printf(\u0026#34;Apply: %s\\n\u0026#34;, string(l.Data)) return nil } func (f *FSM) Snapshot() (raft.FSMSnapshot, error) { return \u0026amp;snapshot{}, nil } func (f *FSM) Restore(io.ReadCloser) error { return nil } type snapshot struct{} func (s *snapshot) Persist(sink raft.SnapshotSink) error { return sink.Close() } func (s *snapshot) Release() {} func main() { // 1) é…ç½® config := raft.DefaultConfig() config.LocalID = raft.ServerID(os.Args[1]) // èŠ‚ç‚¹ ID æ¥è‡ªç¬¬ä¸€ä¸ªå‚æ•° // 2) ç½‘ç»œä¼ è¾“ï¼šTCP addr, err := net.ResolveTCPAddr(\u0026#34;tcp\u0026#34;, os.Args[2]) if err != nil { log.Fatal(err) } transport, err := raft.NewTCPTransport(os.Args[2], addr, 3, 10*time.Second, os.Stdout) if err != nil { log.Fatal(err) } // 3) æ—¥å¿—ä¸å¿«ç…§å­˜å‚¨ store, err := bolt.NewBoltStore(fmt.Sprintf(\u0026#34;raft-%s.db\u0026#34;, os.Args[1])) if err != nil { log.Fatal(err) } snapshotStore := raft.NewInmemSnapshotStore() // 4) åˆ›å»º Raft å®ä¾‹ r, err := raft.NewRaft(config, \u0026amp;FSM{}, store, store, snapshotStore, transport) if err != nil { log.Fatal(err) } // 5) Bootstrap ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ if os.Args[1] == \u0026#34;node1\u0026#34; { cfg := raft.Configuration{ Servers: []raft.Server{ {ID: \u0026#34;node1\u0026#34;, Address: transport.LocalAddr()}, {ID: \u0026#34;node2\u0026#34;, Address: raft.ServerAddress(\u0026#34;127.0.0.1:12002\u0026#34;)}, {ID: \u0026#34;node3\u0026#34;, Address: raft.ServerAddress(\u0026#34;127.0.0.1:12003\u0026#34;)}, }, } r.BootstrapCluster(cfg) } // 6) ç®€å•å‘½ä»¤è¡Œæäº¤ if config.LocalID == \u0026#34;node1\u0026#34; { go func() { for { time.Sleep(3 * time.Second) f := r.Apply([]byte(\u0026#34;hello raft\u0026#34;), 5*time.Second) if err := f.Error(); err != nil { log.Println(\u0026#34;apply error:\u0026#34;, err) } } }() } select {} // é˜»å¡ } `\n",
"content": "å®šä¹‰ CAPç†è®ºæ˜¯æŒ‡åˆ†å¸ƒå¼å½“ä¸­ä¸€è‡´æ€§ã€å¯ç”¨æ€§ä»¥åŠåˆ†åŒºå®¹é”™æ€§ä¸‰è€…ä¸å¯å…¼å¾—ã€‚æˆ‘ä»¬éœ€è¦æ ¹æ®å®é™…åº”ç”¨åœºæ™¯åšå‡ºç›¸åº”çš„å–èˆï¼Œ åœ¨ç°å®ä¸­ï¼Œä¸€èˆ¬æ¥è¯´åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ç½‘ç»œæ˜¯ä¸å¯èƒ½å®Œå…¨ä¿è¯å¯ç”¨çš„ï¼Œæ‰€ä»¥å°±éœ€è¦åœ¨CAå’ŒCPä¸­åšå‡ºé€‰æ‹©ã€‚\ncä¸€è‡´æ€§(consistency) åŒä¸€ä»½æ•°æ®åŒä¸€æ—¶é—´åœ¨ä¸åŒçš„èŠ‚ç‚¹çœ‹åˆ°çš„ç»“æœåº”è¯¥æ˜¯ä¸€è‡´æ€§çš„\naå¯ç”¨æ€§ï¼ˆavailabilityï¼‰ å½“ç³»ç»Ÿå½“ä¸­æŸäº›èŠ‚ç‚¹æ•…éšœä»ç„¶å¯ä»¥åœ¨ä¸€å®šæ—¶é—´å†…å“åº”ç”¨æˆ·è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ç³»ç»Ÿåœ¨ä»»ä½•æ—¶é—´å¯¹äºéé”™è¯·æ±‚éƒ½èƒ½åœ¨ä¸€å®šæ—¶é—´åšå‡ºå“åº”ï¼Œä¸”ä¸è¿”å›é”™è¯¯ã€‚\npåˆ†åŒºå®¹é”™æ€§ï¼ˆpartition toleranceï¼‰ å½“é›†ç¾¤ä¸­å‘ç”Ÿç½‘ç»œåˆ†åŒºï¼Œå› ä¸ºç½‘ç»œæ•…éšœå¯¼è‡´èŠ‚ç‚¹ä¹‹é—´ä¸èƒ½æ­£å¸¸é€šä¿¡ï¼Œç³»ç»Ÿä»ç„¶æ­£å¸¸è¿è¡Œï¼Œèƒ½å¤Ÿå¯¹å¤–æä¾›æœåŠ¡ã€‚\næ‹œå åº­å°†å†›é—®é¢˜ æ˜¯æŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¯èƒ½æœ‰æ¶æ„èŠ‚ç‚¹å¯¹æ•°æ®ä¸€è‡´æ€§é€ æˆç ´åã€‚å¦‚æœç³»ç»Ÿä¸­çš„èŠ‚ç‚¹æ˜¯fä¸ªï¼Œä¸ºäº†è§£å†³éæ‹œå åº­å°†å†›é—®é¢˜ï¼Œè‡³å°‘éœ€è¦3f+1 ä¸ªèŠ‚ç‚¹ã€‚èƒ½å®¹å¿æ‹œå åº­å®¹é”™çš„ç³»ç»Ÿä¸€èˆ¬æ˜¯é«˜å®‰å…¨æ€§è¦æ±‚çš„ç³»ç»Ÿï¼Œæ¯”å¦‚åŒºè·¨é“¾ã€é‡‘èã€å†›äº‹ç­‰ã€‚\nè„‘è£‚ è„‘è£‚æ˜¯æŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç”±äºç½‘ç»œæ³¢åŠ¨æˆ–ä¸­æ–­ï¼Œå¯¼è‡´ç³»ç»Ÿè¢«åˆ†æˆå¤šä¸ªå­ç³»ç»Ÿï¼Œå­ç³»ç»Ÿåœ¨å†…éƒ¨é€‰ä¸¾leaderï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚è¿™ä¼šå¯¼è‡´ ä¸¥é‡çš„é—®é¢˜ï¼Œæ¯”å¦‚\næ•°æ®ä¸ä¸€è‡´\tä¸¤ä¸ªåˆ†åŒºåŒæ—¶å†™å…¥åŒä¸€æ•°æ®ï¼ˆå¦‚è´¦æˆ·ä½™é¢ï¼‰ï¼Œå¯¼è‡´å†²çªä¸”æ— æ³•è‡ªåŠ¨åˆå¹¶ã€‚ èµ„æºå†²çª\tä¸¤ä¸ªâ€œé¢†å¯¼è€…â€åŒæ—¶æ“ä½œå…±äº«èµ„æºï¼ˆå¦‚åˆ†é…åŒä¸€IPåœ°å€ã€é”å®šåŒä¸€æ–‡ä»¶ï¼‰ã€‚ çŠ¶æ€æ··ä¹±\tå®¢æˆ·ç«¯å¯èƒ½è¢«ä¸åŒåˆ†åŒºå“åº”çŸ›ç›¾çš„ç»“æœï¼ˆå¦‚Aåˆ†åŒºè¯´â€œæ”¯ä»˜æˆåŠŸâ€ï¼ŒBåˆ†åŒºè¯´â€œæœªæ”¯ä»˜â€ï¼‰ã€‚ æ•°æ®æ°¸ä¹…ä¸¢å¤±\tåˆ†åŒºæ¢å¤åï¼Œå†²çªå†™å…¥å¯èƒ½å¯¼è‡´éƒ¨åˆ†æ•°æ®è¢«è¦†ç›–æˆ–ä¸¢å¼ƒã€‚ ä¸ºäº†é˜²æ­¢è„‘è£‚ï¼Œä¸€èˆ¬åˆ†å¸ƒå¼ä¸€è‡´æ€§åè®®éƒ½ä¼šé‡‡ç”¨å¤šæ•°æ´¾åŸåˆ™è¿›è¡Œé¿å…ï¼Œæ¯”å¦‚äº”ä¸ªèŠ‚ç‚¹çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œéœ€è¦3ä¸ªèŠ‚ç‚¹çš„ç¡®è®¤æ‰èƒ½æˆä¸ºleader,å¦åˆ™ä¼š å› ä¸ºæ— æ³•é€‰ä¸»è€Œåœæ­¢å¯¹å¤–æä¾›æœåŠ¡ã€‚\nraftåè®® raftåè®®æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¤šä¸ªèŠ‚ç‚¹å¯¹äºæŸä¸ªèµ„æºçš„ä¸€è‡´æ€§çš„è¾¾æˆæ‰€é‡‡ç”¨çš„ä¸€ç§åè®®ï¼Œä¸»è¦æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼š\nä¸»ä»é€‰æ‹© æ—¥å¿—å¤åˆ¶ å®‰å…¨æ€§å’Œä¸€è‡´æ€§ä¿è¯ raftåè®®æ˜¯å¼ºä¸€è‡´çš„ã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–çš„ä¸€è‡´æ€§ç»„ä»¶æ¯”å¦‚zookeeperã€‚raftåè®®æä¾›äº†å¼ºä¸€è‡´æ€§çš„æ–¹æ¡ˆã€‚ zookeeper å®è·µ å¸¸è§çš„ä½¿ç”¨åœºæ™¯ ä¸€äº›å¸¸è§çš„å¼€æºè½¯ä»¶çš„ä½¿ç”¨æˆ‘ä»¬ä¼šç»å¸¸é‡åˆ°è¿™ä¸ªåœºæ™¯ã€‚æ‹¿æœ€å¸¸è§çš„redisä¸ºä¾‹ï¼Œredisçš„åˆ†å¸ƒå¼éƒ¨ç½²æ–¹æ¡ˆæœ‰ä¸‰ç§ï¼Œä¸»ä»ã€å“¨å…µã€clusterã€‚\ngo ç®€å•çš„å®è·µ package main import ( \u0026#34;fmt\u0026#34; \u0026#34;io\u0026#34; \u0026#34;log\u0026#34; \u0026#34;net\u0026#34; \u0026#34;os\u0026#34; \u0026#34;time\u0026#34; \u0026#34;github.com/hashicorp/raft\u0026#34; bolt \u0026#34;github.com/hashicorp/raft-boltdb\u0026#34; ) // ç®€å•çš„ FSMï¼šæäº¤å³æ‰“å° type FSM struct{} func (f *FSM) Apply(l *raft.Log) interface{} { fmt.Printf(\u0026#34;Apply: %s\\n\u0026#34;, string(l.Data)) return nil } func (f *FSM) Snapshot() (raft.FSMSnapshot, error) { return \u0026amp;snapshot{}, nil } func (f *FSM) Restore(io.ReadCloser) error { return nil } type snapshot struct{} func (s *snapshot) Persist(sink raft.SnapshotSink) error { return sink.Close() } func (s *snapshot) Release() {} func main() { // 1) é…ç½® config := raft.DefaultConfig() config.LocalID = raft.ServerID(os.Args[1]) // èŠ‚ç‚¹ ID æ¥è‡ªç¬¬ä¸€ä¸ªå‚æ•° // 2) ç½‘ç»œä¼ è¾“ï¼šTCP addr, err := net.ResolveTCPAddr(\u0026#34;tcp\u0026#34;, os.Args[2]) if err != nil { log.Fatal(err) } transport, err := raft.NewTCPTransport(os.Args[2], addr, 3, 10*time.Second, os.Stdout) if err != nil { log.Fatal(err) } // 3) æ—¥å¿—ä¸å¿«ç…§å­˜å‚¨ store, err := bolt.NewBoltStore(fmt.Sprintf(\u0026#34;raft-%s.db\u0026#34;, os.Args[1])) if err != nil { log.Fatal(err) } snapshotStore := raft.NewInmemSnapshotStore() // 4) åˆ›å»º Raft å®ä¾‹ r, err := raft.NewRaft(config, \u0026amp;FSM{}, store, store, snapshotStore, transport) if err != nil { log.Fatal(err) } // 5) Bootstrap ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ if os.Args[1] == \u0026#34;node1\u0026#34; { cfg := raft.Configuration{ Servers: []raft.Server{ {ID: \u0026#34;node1\u0026#34;, Address: transport.LocalAddr()}, {ID: \u0026#34;node2\u0026#34;, Address: raft.ServerAddress(\u0026#34;127.0.0.1:12002\u0026#34;)}, {ID: \u0026#34;node3\u0026#34;, Address: raft.ServerAddress(\u0026#34;127.0.0.1:12003\u0026#34;)}, }, } r.BootstrapCluster(cfg) } // 6) ç®€å•å‘½ä»¤è¡Œæäº¤ if config.LocalID == \u0026#34;node1\u0026#34; { go func() { for { time.Sleep(3 * time.Second) f := r.Apply([]byte(\u0026#34;hello raft\u0026#34;), 5*time.Second) if err := f.Error(); err != nil { log.Println(\u0026#34;apply error:\u0026#34;, err) } } }() } select {} // é˜»å¡ } `\næ‰§è¡Œ go run main.go node1 127.0.0.1:12001 æ‰§è¡Œ go run main.go node1 127.0.0.1:12002 æ‰§è¡Œ go run main.go node1 127.0.0.1:12003 åœæ‰node1 ä¼šé‡æ–°è§¦å‘é€‰ä¸» ` æ‹“å±•ç‚¹-çŠ¶æ€æœº çŠ¶æ€æœºå¯ä»¥çœ‹ä½œæ˜¯ifelse çš„å°è£…å°†å¼ºç‰ˆæœ¬ï¼Œæ›´å®¹æ˜“é›†ä¸­ç®¡ç†åŠ¨ä½œä¹‹åçŠ¶æ€çš„å˜æ›´ã€‚\nç‰¹ç‚¹ FSMï¼ˆå¦‚ looplab/fsmï¼‰ ä¼ ç»Ÿ if-else ç»“æ„æ¸…æ™° æ˜ç¡®çŠ¶æ€è½¬æ¢å›¾ï¼Œé€»è¾‘é›†ä¸­ é€»è¾‘åˆ†æ•£ï¼Œè€¦åˆé«˜ æ˜“äºæ‰©å±• å¢åŠ çŠ¶æ€åªéœ€é…ç½® å¢åŠ é€»è¾‘å¯èƒ½åŠ¨å¾ˆå¤š if ä¾¿äºæµ‹è¯• æ¯ä¸ªçŠ¶æ€è½¬æ¢å¯å•æµ‹ if else æ··æ‚ï¼Œä¸å¥½æµ‹ å¯è§†åŒ– æ˜“è½¬ä¸ºçŠ¶æ€å›¾ å¾ˆéš¾ æ¡ä»¶é’©å­ before_event/after_event å¾ˆæ–¹ä¾¿ æ‰‹å†™æ§åˆ¶æµç¨‹ çŠ¶æ€åˆæ³•æ€§æ§åˆ¶ å†…å»ºæ ¡éªŒéæ³•çŠ¶æ€è·³è½¬ è‡ªå·±åŠ åˆ¤æ–­ ä½¿ç”¨å¼€æºåº“å¯ä»¥æ„Ÿå—ä¸€ä¸‹\npackage workflow import ( \u0026#34;errors\u0026#34; \u0026#34;github.com/looplab/fsm\u0026#34; ) // æ‰€æœ‰å¯èƒ½çš„çŠ¶æ€ const ( StateA = \u0026#34;A_PENDING\u0026#34; // åˆå§‹ç”± A å®¡æ‰¹ StateCountersign = \u0026#34;COUNTERSIGN_PENDING\u0026#34;// Bã€C ä¼šç­¾é˜¶æ®µ StateD = \u0026#34;D_PENDING\u0026#34; // D å®¡æ‰¹ StateE = \u0026#34;E_PENDING\u0026#34; // E å®¡æ‰¹ StateDone = \u0026#34;APPROVED\u0026#34; // æœ€ç»ˆå®¡æ‰¹é€šè¿‡ StateRejected = \u0026#34;REJECTED\u0026#34; // æµç¨‹ç»ˆæ­¢ï¼ˆå¯é€‰ï¼‰ ) // äº‹ä»¶å const ( EventAApprove = \u0026#34;a_approve\u0026#34; EventACancel = \u0026#34;a_cancel\u0026#34; // A æ‹’ç»æˆ–æ’¤å› EventCountersignOK = \u0026#34;countersign_ok\u0026#34; // Bã€C ä¼šç­¾å®Œæˆï¼ˆéƒ½åŒæ„ï¼‰ EventDCancel = \u0026#34;d_reject\u0026#34; // D æ‹’ç» EventDApprove = \u0026#34;d_approve\u0026#34; EventECancel = \u0026#34;e_reject\u0026#34; // E æ‹’ç» EventEApprove = \u0026#34;e_approve\u0026#34; ) // NewWorkflowFSM åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªåŸºäºå½“å‰çŠ¶æ€çš„ FSM func NewWorkflowFSM(currentState string) *fsm.FSM { return fsm.NewFSM( currentState, fsm.Events{ // A åŒæ„ï¼Œè¿›å…¥ä¼šç­¾é˜¶æ®µ {Name: EventAApprove, Src: []string{StateA}, Dst: StateCountersign}, // ä¼šç­¾å®Œæˆåï¼Œè¿›å…¥ D é˜¶æ®µ {Name: EventCountersignOK, Src: []string{StateCountersign}, Dst: StateD}, // D åŒæ„ï¼Œè¿›å…¥ E {Name: EventDApprove, Src: []string{StateD}, Dst: StateE}, // E åŒæ„ï¼Œæ•´ä¸ªæµç¨‹å®Œæˆ {Name: EventEApprove, Src: []string{StateE}, Dst: StateDone}, // é©³å›ï¼å›é€€é€»è¾‘ {Name: EventDCancel, Src: []string{StateD}, Dst: StateA}, {Name: EventECancel, Src: []string{StateE}, Dst: StateD}, {Name: EventACancel, Src: []string{StateA, StateCountersign}, Dst: StateRejected}, }, fsm.Callbacks{ \u0026#34;enter_state\u0026#34;: func(e *fsm.Event) { // é€šç”¨è¿›çŠ¶æ€æ—¥å¿—ï¼›ä¹Ÿå¯é’ˆå¯¹å…·ä½“çŠ¶æ€åšæ‰©å±• // fmt.Printf(\u0026#34;Transition: %s -\u0026gt; %s via %s\\n\u0026#34;, e.Src, e.Dst, e.Event) }, }, ) } // ä¸šåŠ¡å±‚è°ƒç”¨ç¤ºä¾‹ï¼š // wf := NewWorkflowFSM(dbRecord.State) // if err := wf.Event(EventAApprove); err != nil { â€¦ } // dbRecord.State = wf.Current() // save(dbRecord) type ApprovalRecord struct { ID string State string // å­˜å‚¨åœ¨ DBï¼šFSM å½“å‰çŠ¶æ€ ApprovedByB bool ApprovedByC bool } // Bã€C å®¡æ‰¹ API è°ƒç”¨ç¤ºä¾‹ func ApproveByB(record *ApprovalRecord) error { if record.State != StateCountersign { return errors.New(\u0026#34;ä¸åœ¨ä¼šç­¾é˜¶æ®µ\u0026#34;) } record.ApprovedByB = true return tryFinishCountersign(record) } func ApproveByC(record *ApprovalRecord) error { if record.State != StateCountersign { return errors.New(\u0026#34;ä¸åœ¨ä¼šç­¾é˜¶æ®µ\u0026#34;) } record.ApprovedByC = true return tryFinishCountersign(record) } // å½“ Bã€C éƒ½åŒæ„åï¼Œè§¦å‘ FSM çš„ countersign_ok func tryFinishCountersign(record *ApprovalRecord) error { if record.ApprovedByB \u0026amp;\u0026amp; record.ApprovedByC { wf := NewWorkflowFSM(record.State) if err := wf.Event(EventCountersignOK); err != nil { return err } record.State = wf.Current() // æŒä¹…åŒ– record.Stateã€ApprovedByB/C åˆ°æ•°æ®åº“ } return nil } redis çš„sentinel å’Œcluster redisæœ‰ä¸¤ç§åˆ†å¸ƒå¼éƒ¨ç½²æ–¹æ¡ˆï¼Œåˆ†åˆ«æ˜¯sentinelå“¨å…µå®ç°ä¸»ä»æ¶æ„ï¼Œå“¨å…µè´Ÿè´£ç›‘æ§å’Œä¸»èŠ‚ç‚¹ä¸‹çº¿ä¹‹åçš„é€‰ä¸»ã€‚clusterå®ç°æ•°æ®åˆ†ç‰‡ å’Œä¸»ä»åˆ‡æ¢ã€‚\nå“¨å…µåªæœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼Œclusteræ¨¡å¼é€šå¸¸æœ‰å¤šä¸ªä¸»èŠ‚ç‚¹ã€‚clusterè¦æ±‚è‡³å°‘éœ€è¦ä¸‰ä¸»ä¸‰ä»ï¼Œclusterå¦‚æœè¯·æ±‚çš„æ•°æ®ä¸åœ¨å½“å‰èŠ‚ç‚¹ä¼šè¿”å›movedå’Œask,éœ€è¦æ”¯æŒ clusterçš„å®¢æˆ·ç«¯è¿›è¡Œé‡å®šå‘ï¼Œæ¯”å¦‚go-redisç­‰ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯åœ¨åˆ†å¸ƒå¼éƒ¨ç½²ä¸‹ï¼Œåˆ†å¸ƒå¼é”éƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œæ¯”å¦‚redis sentinelæ¨¡å¼ä¸‹ä¸»ä»åˆ‡æ¢ã€å®¢æˆ·ç«¯æœªæ„ŸçŸ¥ä¸»ä»åˆ‡æ¢å¯¼è‡´é”å¤±æ•ˆã€‚ clusteræ¨¡å¼ä¸‹ä¼šå‡ºç°ä¸èƒ½å¤škeyæ“ä½œä»¥åŠsentinelå‡ºç°çš„ä¸»å¤‡åˆ‡æ¢å®¢æˆ·ç«¯æ— æ³•æ„ŸçŸ¥ç­‰é—®é¢˜ã€‚\næ•°æ®åˆ†ç‰‡ æ•°æ®åˆ†ç‰‡æ˜¯æŒ‡å°†ä¸€ä¸ªå¤§æ•°æ®é›†æŒ‰ç…§æŸä¸ªè§„åˆ™åˆ†æ•£æˆè¾ƒå°çš„æ•°æ®é›†\næ³¨æ„äº‹é¡¹ è¿™ä¸ªç†è®ºæé†’æˆ‘ä»¬åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­éœ€è¦æ ¹æ®å…·ä½“çš„éœ€æ±‚åšå‡ºå–èˆã€‚ raftåè®®çš„åªä¿è¯å†™å¼ºä¸€è‡´ï¼Œå¯¹äºè¯»é»˜è®¤æ˜¯ä»leaderè¯»å°±æ²¡é—®é¢˜ï¼Œå¦‚æœä»followerå¯èƒ½ä¼šä¸ä¸€è‡´ã€‚éœ€è¦æ³¨æ„ raftåè®®æ˜¯åœ¨éæ‹œå åº­æƒ…å†µä¸‹ä¸ºäº†è¾¾æˆä¸€è‡´æ€§çš„ä¸€ç§åè®®ï¼Œéœ€è¦æ³¨æ„è¿™ç‚¹ã€‚ raftåè®®çš„ç»„ä»¶ä¸é€‚åˆåšåˆ†å¸ƒå¼é”çš„å®ç°ï¼Œå› ä¸ºåˆ†å¸ƒå¼é”ä¸€èˆ¬å¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜ï¼Œè€Œraftéœ€è¦å†™æ—¥å¿—ï¼ŒåŒæ­¥ç­‰æ¯”è¾ƒè´¹æ—¶çš„æ“ä½œã€‚ redisåˆ†å¸ƒå¼é”åœ¨åˆ†å¸ƒå¼éƒ¨ç½²æƒ…å†µä¸‹çš„é—®é¢˜ ç®€å•æ¥è¯´éœ€è¦æŠŠæ‰€æœ‰é”æ“ä½œé™å®šåˆ°ä¸€ä¸ªæ§½é‡Œé¢ï¼Œå…¶æ¬¡å¯ä»¥ä½¿ç”¨å¼€æºçš„è§£å†³æ–¹æ¡ˆæ¯”å¦‚redLock,ä»¥åŠä¼˜ç§€çš„rediså®¢æˆ·ç«¯åœ¨å‘ç”Ÿkeyåœ¨å…¶ä»–èŠ‚ç‚¹ä¼šè‡ªåŠ¨å¸®åŠ©æˆ‘ä»¬ å¤„ç†moveæ“ä½œ\nå‚è€ƒèµ„æ–™ ç»´åŸºç™¾ç§‘ç¼–è€…. CAPå®šç†. ç»´åŸºç™¾ç§‘. æœ€åä¿®è®¢äº2023å¹´11æœˆ9æ—¥. è®¿é—®äº2025å¹´7æœˆ16æ—¥. CNBLOG. ZooKeeper æ˜¯ä»€ä¹ˆ. ç»´åŸºç™¾ç§‘. æœ€åä¿®è®¢äº2020-12-30 10:53. è®¿é—®äº2025å¹´7æœˆ20æ—¥. DTM. DTM. è®¿é—®äº2025å¹´8æœˆ20æ—¥. ",
"tags":null,
"categories":null
},{
"title":"Socket",
"permalink": "http://localhost:1313/posts/network/socket/",
"summary": "Socket IOæ¨¡å‹ å¸¸è§çš„IOæ¨¡å‹æœ‰å››ç§ï¼šå¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹ã€IOå¤ç”¨ã€åç¨‹\nå¤šè¿›ç¨‹ï¼šæœ€åŸå§‹çš„ä¸€ç§æ¨¡å¼ï¼Œå¥½å¤„æ˜¯å¼€å‘éš¾åº¦å°ï¼ŒåŒä¸€ä¸ªè¿›ç¨‹å…±äº«å†…å®¹ï¼Œç¼ºç‚¹æ˜¯åˆ›å»ºå’Œé”€æ¯çš„æˆæœ¬å¾ˆé«˜ã€‚å¸¸è§çš„æ¯”å¦‚phpçš„php-fpm å¤šçº¿ç¨‹ï¼šç›¸æ¯”äºå¤šè¿›ç¨‹å¼€é”€æ›´å°ï¼Œä½†æ˜¯é‡åˆ°C10Ké—®é¢˜è¿˜æ˜¯ä¼šå‡ºç°ç“¶é¢ˆï¼Œçº¿ç¨‹çš„å†…å­˜å ç”¨é€šå¸¸ä»¥Mä¸ºå•ä½ã€‚æé«˜äº†æ•ˆç‡ï¼Œä½†æ˜¯é‡åˆ°é«˜å¹¶å‘ï¼Œèµ„æºå ç”¨è¿˜æ˜¯æ¯”è¾ƒå¤§ã€‚å¸¸è§çš„æ¯”å¦‚javaçš„å¤šçº¿ç¨‹ IOæ¨¡å‹: åŸºäºäº‹ä»¶çš„IOå¤„ç†æœºåˆ¶ï¼Œæ˜¯å•çº¿ç¨‹æ¨¡å‹ï¼Œé€šè¿‡ç›‘å¬æ–‡ä»¶å¥æŸ„socket,æ³¨å†Œäº‹ä»¶ï¼Œ å½“æœ‰IOäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä¼šè§¦å‘å›è°ƒå‡½æ•°ã€‚ç”±äºåœ¨å•çº¿ç¨‹æ¨¡å‹ï¼Œå¼€é”€æ›´å°ï¼Œé€‚åˆå¤„ç†é«˜å¹¶å‘ã€‚å¸¸è§çš„å¦‚nodejsã€redisã€‚ åç¨‹: åç¨‹æ˜¯æ€çº¿ç¨‹ï¼Œåç¨‹çš„åˆ‡æ¢å¼€é”€å°ï¼Œé€šå¸¸ä»¥kbä¸ºå•ä½ï¼Œé€šå¸¸ä¸€ä¸ªåç¨‹åªå ç”¨4KBï¼Œé€‚åˆå¤„ç†é«˜å¹¶å‘ã€‚å¸¸è§çš„å¦‚goè¯­è¨€ã€‚ Socketå®šä¹‰ socketæ˜¯åº”ç”¨å±‚å’Œä¼ è¾“å±‚çš„ä¸€ç»„APIæ¥å£ï¼Œç”¨äºå®ç°ç½‘ç»œé€šä¿¡ã€‚ linuxå½“ä¸­ä¸€åˆ‡çš†æ–‡ä»¶ï¼Œæ“ä½œç³»ç»Ÿä¸ºäº†ç»Ÿä¸€å¤„ç†IOæ¨¡å‹ï¼Œå°†socketä¹Ÿè§†ä½œæ–‡ä»¶å¥æŸ„ã€‚\nç‰¹æ€§ æ™®é€šæ–‡ä»¶ Socketï¼ˆç½‘ç»œæ–‡ä»¶ï¼‰ åº•å±‚å¯¹è±¡ struct inode + struct file struct socket + struct file æ“ä½œé›† read/write æ“ä½œè¯»å†™ç£ç›˜æ•°æ® recv/sendï¼ˆä¹Ÿæ”¯æŒ read/writeï¼Œæœ€ç»ˆæ˜ å°„åˆ°ç½‘ç»œæ”¶å‘ï¼‰ åç§»é‡ï¼ˆoffsetï¼‰ æœ‰ï¼ŒæŒ‡ç¤ºæ–‡ä»¶è¯»å†™ä½ç½® æ— æ„ä¹‰ï¼Œæ€»æ˜¯ä»¥æµï¼æŠ¥æ–‡æ–¹å¼æ”¶å‘ é˜»å¡ï¼éé˜»å¡ å¯è®¾ç½®é˜»å¡æˆ–éé˜»å¡ åŒæ ·æ”¯æŒé˜»å¡æ¨¡å¼å’Œéé˜»å¡æ¨¡å¼ I/O å¤šè·¯å¤ç”¨ æ”¯æŒ select/poll/epoll å®Œå…¨æ”¯æŒ é€šè¿‡ç›‘å¬æ–‡ä»¶å¥æŸ„ï¼Œç»“åˆselect/pull/epoll, å¯ä»¥å®ç°ç½‘ç»œç¼–ç¨‹ã€‚\nwebsocket websocketæ˜¯ä¸€ç§åŸºäºhttpçš„åè®®ï¼Œç”¨äºæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œé•¿è¿æ¥å®æ—¶é€šä¿¡ã€‚ä¸€èˆ¬ä¼šé€šè¿‡å¯¹httpè¯·æ±‚å‡çº§upgradeï¼Œå°†httpåè®®å‡çº§ä¸ºwebsocketåè®®ã€‚\nå¦‚ä½•ä½¿ç”¨ tcpè¿æ¥éœ€è¦æŒ‡å®šäº”å…ƒç»„ï¼šipã€ç«¯å£ã€åè®®ã€æºipã€æºç«¯å£ï¼ŒåŒæ ·çš„socketä¹Ÿéœ€è¦æŒ‡å®šè¿™äº›å‚æ•°ã€‚ serverç«¯çš„å»ºç«‹è¿‡ç¨‹ï¼š\nsocket() bind() listen() accept() close clientç«¯çš„å»ºç«‹è¿‡ç¨‹ï¼š\nsocket() connect() accept() close() ä»£ç ç¤ºä¾‹ åŸå§‹æ–¹æ¡ˆï¼Œä½¿ç”¨netåŒ…:\nseverç«¯\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;os\u0026#34; \u0026#34;syscall\u0026#34; ) func check(err error) { if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;é”™è¯¯ï¼š\u0026#34;, err) os.Exit(1) } } func main() { // 1. åˆ›å»º socket fd, err := syscall.Socket(syscall.AF_INET, syscall.SOCK_STREAM, syscall.IPPROTO_TCP) check(err) defer syscall.Close(fd) // 2. ç»‘å®šåˆ°æœ¬åœ°åœ°å€ 0.0.0.0:8888 sa := \u0026amp;syscall.SockaddrInet4{Port: 8888} // IP å…¨ 0 è¡¨ç¤º INADDR_ANY check(syscall.Bind(fd, sa)) // 3. å¼€å§‹ç›‘å¬ï¼ˆbacklog 128ï¼‰ check(syscall.Listen(fd, 128)) fmt.Println(\u0026#34;raw socket æœåŠ¡å™¨å·²å¯åŠ¨ï¼Œç«¯å£ 8888\u0026#34;) // 4. æ¥å—è¿æ¥ nfd, rsa, err := syscall.Accept(fd) check(err) fmt.Printf(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯ï¼š%v\\n\u0026#34;, rsa) defer syscall.Close(nfd) // 5. å…¨åŒå·¥ï¼šä¸€ä¸ª goroutine ä» stdin å‘å‡ºå»ï¼Œä¸€ä¸ª goroutine ä» socket è¯»è¿›æ¥ go func() { buf := make([]byte, 1024) for { // ä»æ ‡å‡†è¾“å…¥è¯» n, err := syscall.Read(syscall.Stdin, buf) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;stdin è¯»å–é”™è¯¯ï¼š\u0026#34;, err) return } if n \u0026gt; 0 { _, err = syscall.Write(nfd, buf[:n]) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;å‘å®¢æˆ·ç«¯å†™å…¥é”™è¯¯ï¼š\u0026#34;, err) return } } } }() // ä¸» goroutine è´Ÿè´£ä» socket è¯»å¹¶å†™åˆ° stdout buf := make([]byte, 1024) for { n, err := syscall.Read(nfd, buf) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;ä»å®¢æˆ·ç«¯è¯»å–é”™è¯¯ï¼š\u0026#34;, err) return } if n \u0026gt; 0 { // æ‰“å°åˆ°æ ‡å‡†è¾“å‡º _, err = syscall.Write(syscall.Stdout, buf[:n]) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;å†™åˆ° stdout é”™è¯¯ï¼š\u0026#34;, err) return } } } } clientç«¯\n",
"content": "Socket IOæ¨¡å‹ å¸¸è§çš„IOæ¨¡å‹æœ‰å››ç§ï¼šå¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹ã€IOå¤ç”¨ã€åç¨‹\nå¤šè¿›ç¨‹ï¼šæœ€åŸå§‹çš„ä¸€ç§æ¨¡å¼ï¼Œå¥½å¤„æ˜¯å¼€å‘éš¾åº¦å°ï¼ŒåŒä¸€ä¸ªè¿›ç¨‹å…±äº«å†…å®¹ï¼Œç¼ºç‚¹æ˜¯åˆ›å»ºå’Œé”€æ¯çš„æˆæœ¬å¾ˆé«˜ã€‚å¸¸è§çš„æ¯”å¦‚phpçš„php-fpm å¤šçº¿ç¨‹ï¼šç›¸æ¯”äºå¤šè¿›ç¨‹å¼€é”€æ›´å°ï¼Œä½†æ˜¯é‡åˆ°C10Ké—®é¢˜è¿˜æ˜¯ä¼šå‡ºç°ç“¶é¢ˆï¼Œçº¿ç¨‹çš„å†…å­˜å ç”¨é€šå¸¸ä»¥Mä¸ºå•ä½ã€‚æé«˜äº†æ•ˆç‡ï¼Œä½†æ˜¯é‡åˆ°é«˜å¹¶å‘ï¼Œèµ„æºå ç”¨è¿˜æ˜¯æ¯”è¾ƒå¤§ã€‚å¸¸è§çš„æ¯”å¦‚javaçš„å¤šçº¿ç¨‹ IOæ¨¡å‹: åŸºäºäº‹ä»¶çš„IOå¤„ç†æœºåˆ¶ï¼Œæ˜¯å•çº¿ç¨‹æ¨¡å‹ï¼Œé€šè¿‡ç›‘å¬æ–‡ä»¶å¥æŸ„socket,æ³¨å†Œäº‹ä»¶ï¼Œ å½“æœ‰IOäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä¼šè§¦å‘å›è°ƒå‡½æ•°ã€‚ç”±äºåœ¨å•çº¿ç¨‹æ¨¡å‹ï¼Œå¼€é”€æ›´å°ï¼Œé€‚åˆå¤„ç†é«˜å¹¶å‘ã€‚å¸¸è§çš„å¦‚nodejsã€redisã€‚ åç¨‹: åç¨‹æ˜¯æ€çº¿ç¨‹ï¼Œåç¨‹çš„åˆ‡æ¢å¼€é”€å°ï¼Œé€šå¸¸ä»¥kbä¸ºå•ä½ï¼Œé€šå¸¸ä¸€ä¸ªåç¨‹åªå ç”¨4KBï¼Œé€‚åˆå¤„ç†é«˜å¹¶å‘ã€‚å¸¸è§çš„å¦‚goè¯­è¨€ã€‚ Socketå®šä¹‰ socketæ˜¯åº”ç”¨å±‚å’Œä¼ è¾“å±‚çš„ä¸€ç»„APIæ¥å£ï¼Œç”¨äºå®ç°ç½‘ç»œé€šä¿¡ã€‚ linuxå½“ä¸­ä¸€åˆ‡çš†æ–‡ä»¶ï¼Œæ“ä½œç³»ç»Ÿä¸ºäº†ç»Ÿä¸€å¤„ç†IOæ¨¡å‹ï¼Œå°†socketä¹Ÿè§†ä½œæ–‡ä»¶å¥æŸ„ã€‚\nç‰¹æ€§ æ™®é€šæ–‡ä»¶ Socketï¼ˆç½‘ç»œæ–‡ä»¶ï¼‰ åº•å±‚å¯¹è±¡ struct inode + struct file struct socket + struct file æ“ä½œé›† read/write æ“ä½œè¯»å†™ç£ç›˜æ•°æ® recv/sendï¼ˆä¹Ÿæ”¯æŒ read/writeï¼Œæœ€ç»ˆæ˜ å°„åˆ°ç½‘ç»œæ”¶å‘ï¼‰ åç§»é‡ï¼ˆoffsetï¼‰ æœ‰ï¼ŒæŒ‡ç¤ºæ–‡ä»¶è¯»å†™ä½ç½® æ— æ„ä¹‰ï¼Œæ€»æ˜¯ä»¥æµï¼æŠ¥æ–‡æ–¹å¼æ”¶å‘ é˜»å¡ï¼éé˜»å¡ å¯è®¾ç½®é˜»å¡æˆ–éé˜»å¡ åŒæ ·æ”¯æŒé˜»å¡æ¨¡å¼å’Œéé˜»å¡æ¨¡å¼ I/O å¤šè·¯å¤ç”¨ æ”¯æŒ select/poll/epoll å®Œå…¨æ”¯æŒ é€šè¿‡ç›‘å¬æ–‡ä»¶å¥æŸ„ï¼Œç»“åˆselect/pull/epoll, å¯ä»¥å®ç°ç½‘ç»œç¼–ç¨‹ã€‚\nwebsocket websocketæ˜¯ä¸€ç§åŸºäºhttpçš„åè®®ï¼Œç”¨äºæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œé•¿è¿æ¥å®æ—¶é€šä¿¡ã€‚ä¸€èˆ¬ä¼šé€šè¿‡å¯¹httpè¯·æ±‚å‡çº§upgradeï¼Œå°†httpåè®®å‡çº§ä¸ºwebsocketåè®®ã€‚\nå¦‚ä½•ä½¿ç”¨ tcpè¿æ¥éœ€è¦æŒ‡å®šäº”å…ƒç»„ï¼šipã€ç«¯å£ã€åè®®ã€æºipã€æºç«¯å£ï¼ŒåŒæ ·çš„socketä¹Ÿéœ€è¦æŒ‡å®šè¿™äº›å‚æ•°ã€‚ serverç«¯çš„å»ºç«‹è¿‡ç¨‹ï¼š\nsocket() bind() listen() accept() close clientç«¯çš„å»ºç«‹è¿‡ç¨‹ï¼š\nsocket() connect() accept() close() ä»£ç ç¤ºä¾‹ åŸå§‹æ–¹æ¡ˆï¼Œä½¿ç”¨netåŒ…:\nseverç«¯\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;os\u0026#34; \u0026#34;syscall\u0026#34; ) func check(err error) { if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;é”™è¯¯ï¼š\u0026#34;, err) os.Exit(1) } } func main() { // 1. åˆ›å»º socket fd, err := syscall.Socket(syscall.AF_INET, syscall.SOCK_STREAM, syscall.IPPROTO_TCP) check(err) defer syscall.Close(fd) // 2. ç»‘å®šåˆ°æœ¬åœ°åœ°å€ 0.0.0.0:8888 sa := \u0026amp;syscall.SockaddrInet4{Port: 8888} // IP å…¨ 0 è¡¨ç¤º INADDR_ANY check(syscall.Bind(fd, sa)) // 3. å¼€å§‹ç›‘å¬ï¼ˆbacklog 128ï¼‰ check(syscall.Listen(fd, 128)) fmt.Println(\u0026#34;raw socket æœåŠ¡å™¨å·²å¯åŠ¨ï¼Œç«¯å£ 8888\u0026#34;) // 4. æ¥å—è¿æ¥ nfd, rsa, err := syscall.Accept(fd) check(err) fmt.Printf(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯ï¼š%v\\n\u0026#34;, rsa) defer syscall.Close(nfd) // 5. å…¨åŒå·¥ï¼šä¸€ä¸ª goroutine ä» stdin å‘å‡ºå»ï¼Œä¸€ä¸ª goroutine ä» socket è¯»è¿›æ¥ go func() { buf := make([]byte, 1024) for { // ä»æ ‡å‡†è¾“å…¥è¯» n, err := syscall.Read(syscall.Stdin, buf) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;stdin è¯»å–é”™è¯¯ï¼š\u0026#34;, err) return } if n \u0026gt; 0 { _, err = syscall.Write(nfd, buf[:n]) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;å‘å®¢æˆ·ç«¯å†™å…¥é”™è¯¯ï¼š\u0026#34;, err) return } } } }() // ä¸» goroutine è´Ÿè´£ä» socket è¯»å¹¶å†™åˆ° stdout buf := make([]byte, 1024) for { n, err := syscall.Read(nfd, buf) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;ä»å®¢æˆ·ç«¯è¯»å–é”™è¯¯ï¼š\u0026#34;, err) return } if n \u0026gt; 0 { // æ‰“å°åˆ°æ ‡å‡†è¾“å‡º _, err = syscall.Write(syscall.Stdout, buf[:n]) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;å†™åˆ° stdout é”™è¯¯ï¼š\u0026#34;, err) return } } } } clientç«¯\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;os\u0026#34; \u0026#34;syscall\u0026#34; ) func check(err error) { if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;é”™è¯¯ï¼š\u0026#34;, err) os.Exit(1) } } func main() { // 1. åˆ›å»º socket fd, err := syscall.Socket(syscall.AF_INET, syscall.SOCK_STREAM, syscall.IPPROTO_TCP) check(err) defer syscall.Close(fd) // 2. è¿æ¥åˆ°æœåŠ¡å™¨ 127.0.0.1:8888 sa := \u0026amp;syscall.SockaddrInet4{Port: 8888} copy(sa.Addr[:], []byte{127, 0, 0, 1}) check(syscall.Connect(fd, sa)) fmt.Println(\u0026#34;raw socket å·²è¿æ¥åˆ° 127.0.0.1:8888\u0026#34;) // 3. å…¨åŒå·¥ï¼šä¸€ä¸ª goroutine ä» stdin å‘å‡ºå»ï¼Œä¸€ä¸ªä» socket è¯»è¿›æ¥ go func() { buf := make([]byte, 1024) for { n, err := syscall.Read(syscall.Stdin, buf) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;stdin è¯»å–é”™è¯¯ï¼š\u0026#34;, err) return } if n \u0026gt; 0 { _, err = syscall.Write(fd, buf[:n]) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;å†™åˆ°æœåŠ¡å™¨é”™è¯¯ï¼š\u0026#34;, err) return } } } }() // ä¸» goroutine è´Ÿè´£ä» socket è¯»å¹¶å†™åˆ° stdout buf := make([]byte, 1024) for { n, err := syscall.Read(fd, buf) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;ä»æœåŠ¡å™¨è¯»å–é”™è¯¯ï¼š\u0026#34;, err) return } if n \u0026gt; 0 { _, err = syscall.Write(syscall.Stdout, buf[:n]) if err != nil { fmt.Fprintln(os.Stderr, \u0026#34;å†™åˆ° stdout é”™è¯¯ï¼š\u0026#34;, err) return } } } } å°è£…æˆnetåŒ…ï¼Œä»£ç æ›´ç®€æ´ã€‚\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;io\u0026#34; \u0026#34;net\u0026#34; \u0026#34;os\u0026#34; ) func main() { // socket bind listen con, err := net.Listen(\u0026#34;tcp\u0026#34;, \u0026#34;:8099\u0026#34;) if err != nil { panic(err) } conn, err := con.Accept() go func() { if _, err := io.Copy(conn, os.Stdin); err != nil { fmt.Errorf(\u0026#34;server to client :%w\u0026#34;, err) } }() if _, err := io.Copy(os.Stdout, conn); err != nil { fmt.Errorf(\u0026#34;from client :%w\u0026#34;, err) } } clientç«¯\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;io\u0026#34; \u0026#34;net\u0026#34; \u0026#34;os\u0026#34; ) func main() { // socket connect conn, err := net.Dial(\u0026#34;tcp\u0026#34;, \u0026#34;:8099\u0026#34;) if err != nil { panic(err) } go func() { if _, err := io.Copy(conn, os.Stdin); err != nil { fmt.Errorf(\u0026#34; to server :%w\u0026#34;, err) } }() if _, err := io.Copy(os.Stdout, conn); err != nil { fmt.Errorf(\u0026#34;from server :%w\u0026#34;, err) } } æ³¨æ„äº‹é¡¹ æ³¨æ„å…³é—­æ–‡ä»¶å¥æŸ„ å®ç°é«˜å¯ç”¨ï¼Œéœ€è¦å¤„ç†é‡è¯•é€»è¾‘ ",
"tags":null,
"categories":null
},{
"title":"BFS\u0026\u0026DFS",
"permalink": "http://localhost:1313/posts/datastructalgorithm/bfs_dfs/",
"summary": "æ ‘çš„éå† æ·±åº¦ä¼˜å…ˆéå†DFS package main import \u0026#34;fmt\u0026#34; func main() { root := \u0026amp;TreeNode{ Val: 1, } root.Left = \u0026amp;TreeNode{Val: 2} root.Right = \u0026amp;TreeNode{Val: 3} root.Right.Left = \u0026amp;TreeNode{Val: 4} root.Left.Left = \u0026amp;TreeNode{Val: 5} list := make([]int, 0) var treeDFS = func(root *TreeNode) {} treeDFS = func(root *TreeNode) { if root == nil { return } list = append(list, root.Val) treeDFS(root.Left) treeDFS(root.Right) } treeDFS(root) fmt.Println(list) //list2 := TreeBFS(root) //fmt.Println(list2) } type TreeNode struct { Val int Left *TreeNode Right *TreeNode } å‡½æ•°ç‰ˆæœ¬\npackage main import \u0026#34;fmt\u0026#34; func main() { root := \u0026amp;TreeNode{ Val: 1, } root.Left = \u0026amp;TreeNode{Val: 2} root.Right = \u0026amp;TreeNode{Val: 3} root.Right.Left = \u0026amp;TreeNode{Val: 4} root.Left.Left = \u0026amp;TreeNode{Val: 5} list := make([]int, 0) TreeDFS(root, \u0026amp;list) fmt.Println(list) //list2 := TreeBFS(root) //fmt.Println(list2) } func TreeDFS(root *TreeNode, list *[]int) { if root == nil { return } *list = append(*list, root.Val) TreeDFS(root.Left, list) TreeDFS(root.Right, list) } type TreeNode struct { Val int Left *TreeNode Right *TreeNode } å¹¿åº¦ä¼˜å…ˆéå†BFS list2 := make([]int, 0) queue := make([]*TreeNode, 0) queue = append(queue, root) for len(queue) \u0026gt; 0 { count := len(queue) for i := 0; i \u0026lt; count; i++ { node := queue[0] queue = queue[1:] list2 = append(list2, node.Val) if node.Left != nil { queue = append(queue, node.Left) } if node.Right != nil { queue = append(queue, node.Right) } } } fmt.Println(list2) æ ¹æ®å…ˆåºéå†å’Œä¸­åºéå†æ„é€ äºŒå‰æ ‘ package main import \u0026#34;fmt\u0026#34; func main() { // 1 // [1 2 5 3 4] å…ˆåº // [2 5 1 3 4] ä¸­åº // 1 [2 5] [2 5] i = 2 [3 4] // [2 5 3 4] [2 5] // [5 3 4] [5] copyTreeRoot := BuildTree([]int{1, 2, 5, 3, 4}, []int{2, 5, 1, 3, 4}) fmt.Println(copyTreeRoot) list3 := make([]int, 0) TreeDFS(copyTreeRoot, \u0026amp;list3) fmt.Println(\u0026#34;list3:\u0026#34;, list3) //SliceTest() } func BuildTree(first []int, mid []int) *TreeNode { if len(first) == 0 { return nil } root := \u0026amp;TreeNode{Val: first[0]} node := first[0] i := 0 for ; i \u0026lt; len(mid); i++ { if mid[i] == node { break } } root.Left = BuildTree(first[1:i+1], mid[:i]) root.Right = BuildTree(first[i+1:], mid[i+1:]) return root } å›¾çš„éå† æ·±åº¦ä¼˜å…ˆéå†DFS \u0026amp;\u0026amp; å¹¿åº¦ä¼˜å…ˆéå†BFS package main import ( \u0026#34;container/list\u0026#34; \u0026#34;fmt\u0026#34; ) func main() { // 0 // 1 -\u0026gt; 4 -\u0026gt; 5 // 0 2 -\u0026gt; 6 -\u0026gt; 7 // 3 -\u0026gt;^ g := make([][]int, 8) //g = append(g, []int{1, 2, 3} g[0] = []int{1, 2, 3} g[1] = []int{4} g[2] = []int{6} g[3] = []int{6} g[4] = []int{5} g[6] = []int{7} g2 := make(map[int][]int) g2[0] = []int{1, 2, 3} g2[1] = []int{4} g2[2] = []int{6} g2[3] = []int{6} g2[4] = []int{5} g2[6] = []int{7} graphDFS(0, g) //graphBFS(g) fmt.Println(\u0026#34;-----\u0026#34;) graphBFSWithQueue(g2) fmt.Println(\u0026#34;-----\u0026#34;) listC := graphBFSWithC(g2) fmt.Println(listC) } func graphDFS(root int, graph [][]int) { fmt.Println(root) if graph[root] == nil { return } //fmt.Println(root) for i := 0; i \u0026lt; len(graph[root]); i++ { graphDFS(graph[root][i], graph) } return } func graphBFSWithQueue(graph map[int][]int) { queue := make([]int, 0) queue = append(queue, 0) fmt.Println(0) visited := make(map[int]bool) for len(queue) \u0026gt; 0 { node := queue[0] queue = queue[1:] g := graph[node] size := len(g) for i := 0; i \u0026lt; size; i++ { if visited[g[i]] { continue } else { fmt.Println(g[i]) queue = append(queue, g[i]) visited[g[i]] = true } } } } func graphBFSWithC(graph map[int][]int) []int { queue := list.New() order := make([]int, 0) visited := make(map[int]bool) queue.PushBack(0) for queue.Len() \u0026gt; 0 { node := queue.Remove(queue.Front()).(int) order = append(order, node) neighbor := graph[node] size := len(neighbor) for i := 0; i \u0026lt; size; i++ { if visited[neighbor[i]] { continue } else { queue.PushBack(neighbor[i]) visited[neighbor[i]] = true } } } return order } å¸¦æƒå›¾çš„æœ€çŸ­è·¯å¾„ç®—æ³• dijkstra å‚è€ƒ å¯è§†åŒ–ç½‘ç«™. å¯è§†åŒ–ç½‘ç«™. ",
"content": "æ ‘çš„éå† æ·±åº¦ä¼˜å…ˆéå†DFS package main import \u0026#34;fmt\u0026#34; func main() { root := \u0026amp;TreeNode{ Val: 1, } root.Left = \u0026amp;TreeNode{Val: 2} root.Right = \u0026amp;TreeNode{Val: 3} root.Right.Left = \u0026amp;TreeNode{Val: 4} root.Left.Left = \u0026amp;TreeNode{Val: 5} list := make([]int, 0) var treeDFS = func(root *TreeNode) {} treeDFS = func(root *TreeNode) { if root == nil { return } list = append(list, root.Val) treeDFS(root.Left) treeDFS(root.Right) } treeDFS(root) fmt.Println(list) //list2 := TreeBFS(root) //fmt.Println(list2) } type TreeNode struct { Val int Left *TreeNode Right *TreeNode } å‡½æ•°ç‰ˆæœ¬\npackage main import \u0026#34;fmt\u0026#34; func main() { root := \u0026amp;TreeNode{ Val: 1, } root.Left = \u0026amp;TreeNode{Val: 2} root.Right = \u0026amp;TreeNode{Val: 3} root.Right.Left = \u0026amp;TreeNode{Val: 4} root.Left.Left = \u0026amp;TreeNode{Val: 5} list := make([]int, 0) TreeDFS(root, \u0026amp;list) fmt.Println(list) //list2 := TreeBFS(root) //fmt.Println(list2) } func TreeDFS(root *TreeNode, list *[]int) { if root == nil { return } *list = append(*list, root.Val) TreeDFS(root.Left, list) TreeDFS(root.Right, list) } type TreeNode struct { Val int Left *TreeNode Right *TreeNode } å¹¿åº¦ä¼˜å…ˆéå†BFS list2 := make([]int, 0) queue := make([]*TreeNode, 0) queue = append(queue, root) for len(queue) \u0026gt; 0 { count := len(queue) for i := 0; i \u0026lt; count; i++ { node := queue[0] queue = queue[1:] list2 = append(list2, node.Val) if node.Left != nil { queue = append(queue, node.Left) } if node.Right != nil { queue = append(queue, node.Right) } } } fmt.Println(list2) æ ¹æ®å…ˆåºéå†å’Œä¸­åºéå†æ„é€ äºŒå‰æ ‘ package main import \u0026#34;fmt\u0026#34; func main() { // 1 // [1 2 5 3 4] å…ˆåº // [2 5 1 3 4] ä¸­åº // 1 [2 5] [2 5] i = 2 [3 4] // [2 5 3 4] [2 5] // [5 3 4] [5] copyTreeRoot := BuildTree([]int{1, 2, 5, 3, 4}, []int{2, 5, 1, 3, 4}) fmt.Println(copyTreeRoot) list3 := make([]int, 0) TreeDFS(copyTreeRoot, \u0026amp;list3) fmt.Println(\u0026#34;list3:\u0026#34;, list3) //SliceTest() } func BuildTree(first []int, mid []int) *TreeNode { if len(first) == 0 { return nil } root := \u0026amp;TreeNode{Val: first[0]} node := first[0] i := 0 for ; i \u0026lt; len(mid); i++ { if mid[i] == node { break } } root.Left = BuildTree(first[1:i+1], mid[:i]) root.Right = BuildTree(first[i+1:], mid[i+1:]) return root } å›¾çš„éå† æ·±åº¦ä¼˜å…ˆéå†DFS \u0026amp;\u0026amp; å¹¿åº¦ä¼˜å…ˆéå†BFS package main import ( \u0026#34;container/list\u0026#34; \u0026#34;fmt\u0026#34; ) func main() { // 0 // 1 -\u0026gt; 4 -\u0026gt; 5 // 0 2 -\u0026gt; 6 -\u0026gt; 7 // 3 -\u0026gt;^ g := make([][]int, 8) //g = append(g, []int{1, 2, 3} g[0] = []int{1, 2, 3} g[1] = []int{4} g[2] = []int{6} g[3] = []int{6} g[4] = []int{5} g[6] = []int{7} g2 := make(map[int][]int) g2[0] = []int{1, 2, 3} g2[1] = []int{4} g2[2] = []int{6} g2[3] = []int{6} g2[4] = []int{5} g2[6] = []int{7} graphDFS(0, g) //graphBFS(g) fmt.Println(\u0026#34;-----\u0026#34;) graphBFSWithQueue(g2) fmt.Println(\u0026#34;-----\u0026#34;) listC := graphBFSWithC(g2) fmt.Println(listC) } func graphDFS(root int, graph [][]int) { fmt.Println(root) if graph[root] == nil { return } //fmt.Println(root) for i := 0; i \u0026lt; len(graph[root]); i++ { graphDFS(graph[root][i], graph) } return } func graphBFSWithQueue(graph map[int][]int) { queue := make([]int, 0) queue = append(queue, 0) fmt.Println(0) visited := make(map[int]bool) for len(queue) \u0026gt; 0 { node := queue[0] queue = queue[1:] g := graph[node] size := len(g) for i := 0; i \u0026lt; size; i++ { if visited[g[i]] { continue } else { fmt.Println(g[i]) queue = append(queue, g[i]) visited[g[i]] = true } } } } func graphBFSWithC(graph map[int][]int) []int { queue := list.New() order := make([]int, 0) visited := make(map[int]bool) queue.PushBack(0) for queue.Len() \u0026gt; 0 { node := queue.Remove(queue.Front()).(int) order = append(order, node) neighbor := graph[node] size := len(neighbor) for i := 0; i \u0026lt; size; i++ { if visited[neighbor[i]] { continue } else { queue.PushBack(neighbor[i]) visited[neighbor[i]] = true } } } return order } å¸¦æƒå›¾çš„æœ€çŸ­è·¯å¾„ç®—æ³• dijkstra å‚è€ƒ å¯è§†åŒ–ç½‘ç«™. å¯è§†åŒ–ç½‘ç«™. ",
"tags":["ç®—æ³•","æ•°æ®ç»“æ„","BFS","DFS","dijkstra"],
"categories":null
},{
"title":"httpsåŸç†",
"permalink": "http://localhost:1313/posts/network/https/",
"summary": "å®šä¹‰ http httpæ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œç”¨äºä¼ è¾“ç½‘é¡µå†…å®¹ï¼Œå®ƒåŸºäºTCPï¼Œæ‰€ä»¥æ˜¯å¯é æ€§ä¼ è¾“ã€‚ä½†æ˜¯å®ƒæ²¡æœ‰è§£å†³æ•°æ®å®‰å…¨æ€§ æ–¹é¢çš„é—®é¢˜\nhttpå®‰å…¨æ–¹é¢çš„é—®é¢˜ httpæ²¡æœ‰å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä»»ä½•äººéƒ½å¯ä»¥éšæ„è¯»å–è¿™äº›æ•°æ®ï¼Œé­æˆæ•°æ®çš„æ³„å¯†ã€‚ å…¶æ¬¡æ²¡æœ‰è®¤è¯ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰åŠæ³•çŸ¥é“æ•°æ®æ¥æºçš„å¯é æ€§ï¼Œæ”»å‡»è€…å¯ä»¥ä¸­é—´äººæ”»å‡»æ¥ä¼ªé€ æ•°æ® æ•°æ®å®Œæ•´æ€§ï¼Œä»»ä½•äººå¯ä»¥è¯»å–ä¹Ÿå¯ä»¥ä¿®æ”¹æ•°æ® httpsæ˜¯ä»€ä¹ˆ httpsæ˜¯httpçš„å®‰å…¨ç‰ˆæœ¬ï¼ŒhttpsåŸºäºsslï¼ŒsslåŸºäºtlsã€‚http+æ•°æ®åŠ å¯†+è®¤è¯+æ•°æ®å®Œæ•´æ€§å°±æ˜¯httpsã€‚\nhttpsæ€ä¹ˆè§£å†³çš„è¿™äº›é—®é¢˜ æ•°æ®åŠ å¯† åŠ å¯†ç®—æ³• åŠ å¯†ç®—æ³•åˆ†ä¸ºå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œè¿˜æœ‰ä¸€äº›æ‘˜è¦ç®—æ³• / å“ˆå¸Œç®—æ³•ï¼Œä¸€ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„åŠ å¯†ç®—æ³•\nç±»å‹ ç¤ºä¾‹ æ˜¯å¦å¯é€† è¯´æ˜ å¯¹ç§°åŠ å¯† DES / AES / 3DES âœ… åŠ å¯†è§£å¯†ç”¨åŒä¸€å¯†é’¥ éå¯¹ç§°åŠ å¯† RSA / ECC âœ… å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯† æ‘˜è¦ç®—æ³• MD5 / SHA256 âŒ ä¸å¯é€†ï¼Œç”¨äºæ ¡éªŒå®Œæ•´æ€§ ç­¾åç®—æ³• DSA / RSAç­¾å âŒ ç”¨ç§é’¥ç­¾åï¼Œå…¬é’¥éªŒç­¾ æœåŠ¡å™¨ç«¯ç”Ÿæˆå¯†é’¥å¯¹ï¼Œå°†å…¬é’¥å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨å…¬é’¥åŠ å¯†å¯¹ç§°åŠ å¯†ä½¿ç”¨çš„ç§˜é’¥ï¼Œå‘é€ç»™æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡å™¨ç«¯ä½¿ç”¨ç§é’¥è§£å¯†æ•°æ®ï¼Œ å¾—åˆ°ç§˜é’¥ï¼Œåç»­é€šè¿‡è¿™ä¸ªç§˜é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†è§£å¯†ã€‚\nCA CAï¼ˆCertificate Authorityï¼‰æ˜¯è¯ä¹¦é¢å‘æœºæ„ï¼Œå®ƒè´Ÿè´£ç­¾å‘è¯ä¹¦ï¼Œå¹¶ç®¡ç†è¯ä¹¦çš„é¢å‘å’ŒåŠé”€ã€‚\nä¸ºä»€ä¹ˆéœ€è¦CA å®¢æˆ·ç«¯æ— æ³•çŸ¥æ™“æ‹¿åˆ°çš„å…¬é’¥æ˜¯ç”±ç›®æ ‡æœåŠ¡å™¨é¢å‘çš„ï¼Œä¸ºäº†éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§ï¼Œé˜²æŠ¤ä¸­é—´äººæ”»å‡»ï¼Œéœ€è¦CAè¯ä¹¦é¢å‘æœºæ„ç­¾å‘è¯ä¹¦ã€‚\nè¯ä¹¦ç”Ÿæˆ é¦–å…ˆï¼ŒæœåŠ¡å™¨ç®¡ç†å‘˜ä¼šå‘CAæèµ·è¯ä¹¦ç”³è¯·ï¼ŒCAä¼šéªŒè¯åŸŸåçš„æ‰€å±æƒï¼Œåšæ³•é€šå¸¸æ˜¯åœ¨åŸŸåè§£æåŠ ä¸€ä¸ªç‰¹å®šå€¼ã€‚ éªŒè¯é€šè¿‡åï¼ŒCAä¼šå°†æœåŠ¡å™¨çš„å…¬é’¥ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œç­¾åï¼Œç”Ÿæˆè¯ä¹¦ã€‚å¹¶é¢å‘ç»™æœåŠ¡å™¨ç®¡ç†å‘˜ã€‚\nè¯ä¹¦éªŒè¯è¿‡ç¨‹ å®¢æˆ·ç«¯å‘èµ·è¿æ¥è¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›è¯ä¹¦ï¼Œå®¢æˆ·ç«¯ä¼šéªŒè¯è¯ä¹¦çš„åˆæ³•æ€§ï¼Œå¹¶è·å–è¯ä¹¦çš„å…¬é’¥ã€‚ æµè§ˆå™¨ä¼šåœ¨å‘ç‰ˆçš„æ—¶å€™å°†å„å¤§CAæœºæ„çš„å…¬é’¥é¢„åˆ¶åœ¨æµè§ˆå™¨ä¸­ï¼Œä½¿ç”¨CAçš„å…¬é’¥å¯¹æœåŠ¡å™¨çš„è¯ä¹¦è¿›è¡Œè§£å¯†ï¼Œæ‹¿åˆ°è§£å¯†çš„hashå€¼ã€‚åŒæ—¶ ä½¿ç”¨åŒæ ·çš„æ‘˜è¦ç®—æ³•å¯¹åŸå§‹å†…å®¹è¿›è¡ŒåŠ å¯†ï¼Œç”¨å¾—åˆ°çš„æ‘˜è¦å’Œè§£å¯†çš„æ‘˜è¦å¯¹æ¯”ï¼Œå¦‚æœç›¸ç­‰ï¼Œè¯´æ˜è¯ä¹¦æ˜¯CAé¢å‘çš„ï¼Œä¹Ÿå°±è¯æ˜ äº†è¯ä¹¦çš„åˆæ³•æ€§å’Œå®Œæ•´æ€§ã€‚\næ›´åŠ æ·±å…¥çš„äº†è§£https httpæ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œå®ƒä¼šæœ‰ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š\nçªƒå¬é£é™©ï¼Œç”±äºTCPä¼ è¾“è¿‡ç¨‹ä¸­ä¼šç»è¿‡è·¯ç”±å™¨ã€ä¸»æœºç­‰å¤šä¸ªè®¾å¤‡ï¼Œå­˜åœ¨è¢«æˆªè·æ•°æ®çš„é£é™©ï¼Œæ³„æ¼å¯†ç ç­‰æœºå¯†ä¿¡æ¯ ç¯¡æ”¹é£é™©ï¼Œè¢«æˆªè·çš„æ•°æ®å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ï¼Œåœ¨äº¤æ˜“ç­‰é‡è¦ç³»ç»Ÿä¼šäº§ç”Ÿéå¸¸å¤§çš„ç ´åæ€§ èº«ä»½ä¼ªé€ ï¼Œæ— æ³•çŸ¥æ™“æˆ‘ä»¬è®¿é—®çš„æœåŠ¡ç«¯æ˜¯å¦æ˜¯çœŸå®çš„ httpsé€šè¿‡ä»¥ä¸‹å‡ ä¸ªæ–¹å¼è§£å†³ä¸Šè¿°é—®é¢˜\næœºå¯†æ€§ï¼Œé€šè¿‡å¯¹ç§°åŠ å¯†ç®—æ³•ä¿è¯ å®Œæ•´æ€§ï¼Œé€šè¿‡æ‘˜è¦ç®—æ³•ä¿è¯ï¼ˆmd5ã€sha256ï¼‰ èº«ä»½è®¤è¯ï¼Œé€šè¿‡CA(è¯ä¹¦é¢å‘æœºæ„) ä¸ºä»€ä¹ˆhttpsé‡‡ç”¨äº†å¯¹ç­–åŠ å¯†+éå¯¹ç§°åŠ å¯†+CA? åªç”¨å¯¹ç§°åŠ å¯†ä¸å¥½è§£å†³å¯†é’¥ä¼ è¾“ä¿å­˜çš„é—®é¢˜ï¼Œéå¯¹ç§°åŠ å¯†ç”±äºåŠ è§£å¯†æ¯”è¾ƒæ¶ˆè€—èµ„æºï¼Œä¸é€‚åˆå¯¹å¤§é‡æ•°æ®è¿›è¡ŒåŠ è§£å¯†ã€‚\n",
"content": "å®šä¹‰ http httpæ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œç”¨äºä¼ è¾“ç½‘é¡µå†…å®¹ï¼Œå®ƒåŸºäºTCPï¼Œæ‰€ä»¥æ˜¯å¯é æ€§ä¼ è¾“ã€‚ä½†æ˜¯å®ƒæ²¡æœ‰è§£å†³æ•°æ®å®‰å…¨æ€§ æ–¹é¢çš„é—®é¢˜\nhttpå®‰å…¨æ–¹é¢çš„é—®é¢˜ httpæ²¡æœ‰å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä»»ä½•äººéƒ½å¯ä»¥éšæ„è¯»å–è¿™äº›æ•°æ®ï¼Œé­æˆæ•°æ®çš„æ³„å¯†ã€‚ å…¶æ¬¡æ²¡æœ‰è®¤è¯ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰åŠæ³•çŸ¥é“æ•°æ®æ¥æºçš„å¯é æ€§ï¼Œæ”»å‡»è€…å¯ä»¥ä¸­é—´äººæ”»å‡»æ¥ä¼ªé€ æ•°æ® æ•°æ®å®Œæ•´æ€§ï¼Œä»»ä½•äººå¯ä»¥è¯»å–ä¹Ÿå¯ä»¥ä¿®æ”¹æ•°æ® httpsæ˜¯ä»€ä¹ˆ httpsæ˜¯httpçš„å®‰å…¨ç‰ˆæœ¬ï¼ŒhttpsåŸºäºsslï¼ŒsslåŸºäºtlsã€‚http+æ•°æ®åŠ å¯†+è®¤è¯+æ•°æ®å®Œæ•´æ€§å°±æ˜¯httpsã€‚\nhttpsæ€ä¹ˆè§£å†³çš„è¿™äº›é—®é¢˜ æ•°æ®åŠ å¯† åŠ å¯†ç®—æ³• åŠ å¯†ç®—æ³•åˆ†ä¸ºå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œè¿˜æœ‰ä¸€äº›æ‘˜è¦ç®—æ³• / å“ˆå¸Œç®—æ³•ï¼Œä¸€ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„åŠ å¯†ç®—æ³•\nç±»å‹ ç¤ºä¾‹ æ˜¯å¦å¯é€† è¯´æ˜ å¯¹ç§°åŠ å¯† DES / AES / 3DES âœ… åŠ å¯†è§£å¯†ç”¨åŒä¸€å¯†é’¥ éå¯¹ç§°åŠ å¯† RSA / ECC âœ… å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯† æ‘˜è¦ç®—æ³• MD5 / SHA256 âŒ ä¸å¯é€†ï¼Œç”¨äºæ ¡éªŒå®Œæ•´æ€§ ç­¾åç®—æ³• DSA / RSAç­¾å âŒ ç”¨ç§é’¥ç­¾åï¼Œå…¬é’¥éªŒç­¾ æœåŠ¡å™¨ç«¯ç”Ÿæˆå¯†é’¥å¯¹ï¼Œå°†å…¬é’¥å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨å…¬é’¥åŠ å¯†å¯¹ç§°åŠ å¯†ä½¿ç”¨çš„ç§˜é’¥ï¼Œå‘é€ç»™æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡å™¨ç«¯ä½¿ç”¨ç§é’¥è§£å¯†æ•°æ®ï¼Œ å¾—åˆ°ç§˜é’¥ï¼Œåç»­é€šè¿‡è¿™ä¸ªç§˜é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†è§£å¯†ã€‚\nCA CAï¼ˆCertificate Authorityï¼‰æ˜¯è¯ä¹¦é¢å‘æœºæ„ï¼Œå®ƒè´Ÿè´£ç­¾å‘è¯ä¹¦ï¼Œå¹¶ç®¡ç†è¯ä¹¦çš„é¢å‘å’ŒåŠé”€ã€‚\nä¸ºä»€ä¹ˆéœ€è¦CA å®¢æˆ·ç«¯æ— æ³•çŸ¥æ™“æ‹¿åˆ°çš„å…¬é’¥æ˜¯ç”±ç›®æ ‡æœåŠ¡å™¨é¢å‘çš„ï¼Œä¸ºäº†éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§ï¼Œé˜²æŠ¤ä¸­é—´äººæ”»å‡»ï¼Œéœ€è¦CAè¯ä¹¦é¢å‘æœºæ„ç­¾å‘è¯ä¹¦ã€‚\nè¯ä¹¦ç”Ÿæˆ é¦–å…ˆï¼ŒæœåŠ¡å™¨ç®¡ç†å‘˜ä¼šå‘CAæèµ·è¯ä¹¦ç”³è¯·ï¼ŒCAä¼šéªŒè¯åŸŸåçš„æ‰€å±æƒï¼Œåšæ³•é€šå¸¸æ˜¯åœ¨åŸŸåè§£æåŠ ä¸€ä¸ªç‰¹å®šå€¼ã€‚ éªŒè¯é€šè¿‡åï¼ŒCAä¼šå°†æœåŠ¡å™¨çš„å…¬é’¥ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œç­¾åï¼Œç”Ÿæˆè¯ä¹¦ã€‚å¹¶é¢å‘ç»™æœåŠ¡å™¨ç®¡ç†å‘˜ã€‚\nè¯ä¹¦éªŒè¯è¿‡ç¨‹ å®¢æˆ·ç«¯å‘èµ·è¿æ¥è¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›è¯ä¹¦ï¼Œå®¢æˆ·ç«¯ä¼šéªŒè¯è¯ä¹¦çš„åˆæ³•æ€§ï¼Œå¹¶è·å–è¯ä¹¦çš„å…¬é’¥ã€‚ æµè§ˆå™¨ä¼šåœ¨å‘ç‰ˆçš„æ—¶å€™å°†å„å¤§CAæœºæ„çš„å…¬é’¥é¢„åˆ¶åœ¨æµè§ˆå™¨ä¸­ï¼Œä½¿ç”¨CAçš„å…¬é’¥å¯¹æœåŠ¡å™¨çš„è¯ä¹¦è¿›è¡Œè§£å¯†ï¼Œæ‹¿åˆ°è§£å¯†çš„hashå€¼ã€‚åŒæ—¶ ä½¿ç”¨åŒæ ·çš„æ‘˜è¦ç®—æ³•å¯¹åŸå§‹å†…å®¹è¿›è¡ŒåŠ å¯†ï¼Œç”¨å¾—åˆ°çš„æ‘˜è¦å’Œè§£å¯†çš„æ‘˜è¦å¯¹æ¯”ï¼Œå¦‚æœç›¸ç­‰ï¼Œè¯´æ˜è¯ä¹¦æ˜¯CAé¢å‘çš„ï¼Œä¹Ÿå°±è¯æ˜ äº†è¯ä¹¦çš„åˆæ³•æ€§å’Œå®Œæ•´æ€§ã€‚\næ›´åŠ æ·±å…¥çš„äº†è§£https httpæ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œå®ƒä¼šæœ‰ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š\nçªƒå¬é£é™©ï¼Œç”±äºTCPä¼ è¾“è¿‡ç¨‹ä¸­ä¼šç»è¿‡è·¯ç”±å™¨ã€ä¸»æœºç­‰å¤šä¸ªè®¾å¤‡ï¼Œå­˜åœ¨è¢«æˆªè·æ•°æ®çš„é£é™©ï¼Œæ³„æ¼å¯†ç ç­‰æœºå¯†ä¿¡æ¯ ç¯¡æ”¹é£é™©ï¼Œè¢«æˆªè·çš„æ•°æ®å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ï¼Œåœ¨äº¤æ˜“ç­‰é‡è¦ç³»ç»Ÿä¼šäº§ç”Ÿéå¸¸å¤§çš„ç ´åæ€§ èº«ä»½ä¼ªé€ ï¼Œæ— æ³•çŸ¥æ™“æˆ‘ä»¬è®¿é—®çš„æœåŠ¡ç«¯æ˜¯å¦æ˜¯çœŸå®çš„ httpsé€šè¿‡ä»¥ä¸‹å‡ ä¸ªæ–¹å¼è§£å†³ä¸Šè¿°é—®é¢˜\næœºå¯†æ€§ï¼Œé€šè¿‡å¯¹ç§°åŠ å¯†ç®—æ³•ä¿è¯ å®Œæ•´æ€§ï¼Œé€šè¿‡æ‘˜è¦ç®—æ³•ä¿è¯ï¼ˆmd5ã€sha256ï¼‰ èº«ä»½è®¤è¯ï¼Œé€šè¿‡CA(è¯ä¹¦é¢å‘æœºæ„) ä¸ºä»€ä¹ˆhttpsé‡‡ç”¨äº†å¯¹ç­–åŠ å¯†+éå¯¹ç§°åŠ å¯†+CA? åªç”¨å¯¹ç§°åŠ å¯†ä¸å¥½è§£å†³å¯†é’¥ä¼ è¾“ä¿å­˜çš„é—®é¢˜ï¼Œéå¯¹ç§°åŠ å¯†ç”±äºåŠ è§£å¯†æ¯”è¾ƒæ¶ˆè€—èµ„æºï¼Œä¸é€‚åˆå¯¹å¤§é‡æ•°æ®è¿›è¡ŒåŠ è§£å¯†ã€‚\ntlsçš„è¯·æ±‚å»ºç«‹å…·ä½“çš„æµç¨‹å’Œä»£ç ç¤ºä¾‹ ",
"tags":["è®¡ç®—æœºç½‘ç»œ","https"],
"categories":null
},{
"title":"About Me",
"permalink": "http://localhost:1313/about/me/",
"summary": " ä¸‰å¹´PHPç»éªŒï¼Œ2å¹´å…¨æ ˆç»éªŒï¼Œä¸‰å¹´golangç»éªŒï¼ŒæŒç»­å­¦ä¹ ä¸­\u0026hellip; ",
"content": " ä¸‰å¹´PHPç»éªŒï¼Œ2å¹´å…¨æ ˆç»éªŒï¼Œä¸‰å¹´golangç»éªŒï¼ŒæŒç»­å­¦ä¹ ä¸­\u0026hellip; ",
"tags":null,
"categories":null
},{
"title":"golangçš„interfaceå’Œreflect",
"permalink": "http://localhost:1313/posts/go/interfacereflect/",
"summary": "interface é¸­å­ç±»å‹ å¦‚æœä¸€ä¸ªä¸œè¥¿ï¼Œèµ°èµ·æ¥åƒé¸­å­ï¼Œå«èµ·æ¥åƒé¸­å­ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¤ä¸ºä»–å°±æ˜¯é¸­å­ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å…³æ³¨å¯¹è±¡çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯å¯¹è±¡æœ¬èº«ã€‚\ngoé‡Œé¢é€šè¿‡æ¥å£æ¥è¾¾åˆ°é¸­å­ç±»å‹çš„æ•ˆæœã€‚\nå¤šæ€ å¤šæ€æ˜¯æŒ‡åŒä¸€ä¸ªæ“ä½œï¼ˆå‡½æ•°ã€æ–¹æ³•ï¼‰ï¼Œåœ¨ä¸é€šçš„å¯¹è±¡çš„ä½œç”¨ä¸‹ï¼Œä¼šæœ‰ä¸åŒçš„è¡Œä¸ºã€‚ ä¸€èˆ¬å¤šæ€æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š\nç»§æ‰¿å’Œç»„åˆï¼Œæ¯”å¦‚javaã€c++ã€‚ æ¥å£çš„å½¢å¼ åœ¨goé‡Œé¢å®ƒæ²¡æœ‰ç»§æ‰¿çš„æ¦‚å¿µï¼Œä½†æ˜¯goé‡Œé¢æœ‰ç»„åˆã€‚ç»„åˆå¼æ˜¯ä¸€ç§æ›´çµæ´»çš„æ–¹å¼ã€‚ ä»–å¯ä»¥é€šè¿‡ç»„åˆå’Œé‡å†™æ¥å®ç°ç»§æ‰¿ã€‚åœ¨è°ƒç”¨ç»“æ„ä½“çš„æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šä¼˜å…ˆè°ƒç”¨æœ€è¿‘çš„ç»“æ„ä½“çš„æ–¹æ³•ã€‚ æˆ‘ä»¬æ¨èåœ¨goé‡Œé€šè¿‡æ¥å£æ¥å®ç°å¤šæ€ï¼Œä¼šæ›´åŠ æ¸…æ™°æ˜äº†ã€‚\ngoçš„interface å®šä¹‰ goé‡Œé¢çš„æ¥å£æ˜¯ä¸€ç§å¤åˆæ•°æ®ç±»å‹ã€‚ä»–çš„åº•å±‚æœ‰2ç§å®ç°ï¼Œefaceå’Œifaceã€‚\n//eface ç»“æ„ type eface struct { tab *typtab data unsafe.Pointer } // ifaceç»“æ„ type iface struct { tab *itab data unsafe.Pointer } goé‡Œé¢çš„æ‰€æœ‰æ•°æ®ç±»å‹éƒ½å®ç°äº†eface,ä¹Ÿå°±æ˜¯è¯´å¯ä»¥å€ŸåŠ©interfaceæ¥è¡¨ç¤ºä»–çš„æ•°æ®ç±»å‹ã€‚ è¿˜å¯ä»¥é€šè¿‡interfaceæ¥å®šä¹‰æ–¹æ³•é›†åˆ ã€‚\ntype A interface { method() } å¯èƒ½ä½ ä¼šæœ‰ä¸€ä¸ªç–‘é—®ï¼Œé‚£goæ˜¯æ€ä¹ˆç¡®å®šinterface åˆ°åº•åº”è¯¥æ˜¯ä½¿ç”¨eface è¿˜æ˜¯ ifaceå‘¢ï¼Ÿ goæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå°±ä¼šç¡®å®šå¥½interface ä½¿ç”¨çš„eface è¿˜æ˜¯ ifaceã€‚åé¢ä¸ä¼šæ”¹å˜ã€‚\nå¦‚ä½•ä½¿ç”¨ ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨interface é€šè¿‡æ¥å£æ¥å®ç°è§£è€¦åˆï¼Œæ¯”å¦‚ä¾èµ–æ³¨å…¥ã€é€‚é…å™¨æ¨¡å¼ã€‚ ä¸ç¡®å®šä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œéœ€è¦åœ¨è¿è¡Œæ—¶æ¥ç¡®å®šã€‚ ä½¿ç”¨æ–¹æ³• æ¥å£åˆ—è¡¨ type animal interface { move() } type dog struct {} func (d dog) move() { fmt.Println(\u0026#34;dog moving\u0026#34;) } type cat struct {} func (c cat) move() { fmt.Println(\u0026#34;cat moving\u0026#34;) } func main() { var a animal a = dog{} a.move() a = cat{} // aæ˜¯ç»“æ„å¯ä»¥åŒæ„è°ƒç”¨ a.move() // æ¥å£æ³¨å…¥ call(a) // ä¸ç¡®å®šå…·ä½“çš„å‚æ•° vat func1 = func(param any) {} func1 = func(param any) { fmt.Println(\u0026#34;call any\u0026#34;, param) } } func call(a animal) { fmt.Println(\u0026#34;call animal \\n\u0026#34;) a.move() } éœ€è¦æ³¨æ„çš„ç‚¹å’Œå‘ ä½¿ç”¨æ¥å£ä¼šè®©ç¼–è¯‘å™¨æ— æ³•ç¡®å®šæ•°æ®ç±»å‹ï¼Œå¯¼è‡´æ— æ³•å†ç¼–è¯‘é˜¶æ®µå‘ç°ç±»å‹é”™è¯¯ï¼Œå¼•å‘è¿è¡Œæ—¶é”™è¯¯ã€‚ ä½¿ç”¨æ¥å£ä¼šè®©ç¨‹åºå˜å¾—éš¾ä»¥é˜…è¯»å’Œç†è§£ã€‚ æ€§èƒ½ä¼šæŸå¤±å¤§æ¦‚ä¸€å€ reflect unsafe.pointer goè¯­è¨€unsafeåŒ…æä¾›äº†ä¸€äº›å‡½æ•°ï¼Œå¯ä»¥è·å–æŒ‡é’ˆï¼Œä¿®æ”¹æŒ‡é’ˆï¼Œè·å–æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ï¼Œä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ã€‚ ç®€å•æ¥è®²ï¼Œgoæœ¬èº«ä¸èƒ½æ“ä½œæŒ‡é’ˆï¼Œä½†æ˜¯æä¾›äº†reflectåŒ…è®©æˆ‘ä»¬å¯ä»¥æ“ä½œæŒ‡é’ˆæ¥è·å¾—ç¨‹åºçš„ æ€§èƒ½æå‡ã€‚\n",
"content": "interface é¸­å­ç±»å‹ å¦‚æœä¸€ä¸ªä¸œè¥¿ï¼Œèµ°èµ·æ¥åƒé¸­å­ï¼Œå«èµ·æ¥åƒé¸­å­ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¤ä¸ºä»–å°±æ˜¯é¸­å­ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å…³æ³¨å¯¹è±¡çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯å¯¹è±¡æœ¬èº«ã€‚\ngoé‡Œé¢é€šè¿‡æ¥å£æ¥è¾¾åˆ°é¸­å­ç±»å‹çš„æ•ˆæœã€‚\nå¤šæ€ å¤šæ€æ˜¯æŒ‡åŒä¸€ä¸ªæ“ä½œï¼ˆå‡½æ•°ã€æ–¹æ³•ï¼‰ï¼Œåœ¨ä¸é€šçš„å¯¹è±¡çš„ä½œç”¨ä¸‹ï¼Œä¼šæœ‰ä¸åŒçš„è¡Œä¸ºã€‚ ä¸€èˆ¬å¤šæ€æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š\nç»§æ‰¿å’Œç»„åˆï¼Œæ¯”å¦‚javaã€c++ã€‚ æ¥å£çš„å½¢å¼ åœ¨goé‡Œé¢å®ƒæ²¡æœ‰ç»§æ‰¿çš„æ¦‚å¿µï¼Œä½†æ˜¯goé‡Œé¢æœ‰ç»„åˆã€‚ç»„åˆå¼æ˜¯ä¸€ç§æ›´çµæ´»çš„æ–¹å¼ã€‚ ä»–å¯ä»¥é€šè¿‡ç»„åˆå’Œé‡å†™æ¥å®ç°ç»§æ‰¿ã€‚åœ¨è°ƒç”¨ç»“æ„ä½“çš„æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šä¼˜å…ˆè°ƒç”¨æœ€è¿‘çš„ç»“æ„ä½“çš„æ–¹æ³•ã€‚ æˆ‘ä»¬æ¨èåœ¨goé‡Œé€šè¿‡æ¥å£æ¥å®ç°å¤šæ€ï¼Œä¼šæ›´åŠ æ¸…æ™°æ˜äº†ã€‚\ngoçš„interface å®šä¹‰ goé‡Œé¢çš„æ¥å£æ˜¯ä¸€ç§å¤åˆæ•°æ®ç±»å‹ã€‚ä»–çš„åº•å±‚æœ‰2ç§å®ç°ï¼Œefaceå’Œifaceã€‚\n//eface ç»“æ„ type eface struct { tab *typtab data unsafe.Pointer } // ifaceç»“æ„ type iface struct { tab *itab data unsafe.Pointer } goé‡Œé¢çš„æ‰€æœ‰æ•°æ®ç±»å‹éƒ½å®ç°äº†eface,ä¹Ÿå°±æ˜¯è¯´å¯ä»¥å€ŸåŠ©interfaceæ¥è¡¨ç¤ºä»–çš„æ•°æ®ç±»å‹ã€‚ è¿˜å¯ä»¥é€šè¿‡interfaceæ¥å®šä¹‰æ–¹æ³•é›†åˆ ã€‚\ntype A interface { method() } å¯èƒ½ä½ ä¼šæœ‰ä¸€ä¸ªç–‘é—®ï¼Œé‚£goæ˜¯æ€ä¹ˆç¡®å®šinterface åˆ°åº•åº”è¯¥æ˜¯ä½¿ç”¨eface è¿˜æ˜¯ ifaceå‘¢ï¼Ÿ goæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå°±ä¼šç¡®å®šå¥½interface ä½¿ç”¨çš„eface è¿˜æ˜¯ ifaceã€‚åé¢ä¸ä¼šæ”¹å˜ã€‚\nå¦‚ä½•ä½¿ç”¨ ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨interface é€šè¿‡æ¥å£æ¥å®ç°è§£è€¦åˆï¼Œæ¯”å¦‚ä¾èµ–æ³¨å…¥ã€é€‚é…å™¨æ¨¡å¼ã€‚ ä¸ç¡®å®šä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œéœ€è¦åœ¨è¿è¡Œæ—¶æ¥ç¡®å®šã€‚ ä½¿ç”¨æ–¹æ³• æ¥å£åˆ—è¡¨ type animal interface { move() } type dog struct {} func (d dog) move() { fmt.Println(\u0026#34;dog moving\u0026#34;) } type cat struct {} func (c cat) move() { fmt.Println(\u0026#34;cat moving\u0026#34;) } func main() { var a animal a = dog{} a.move() a = cat{} // aæ˜¯ç»“æ„å¯ä»¥åŒæ„è°ƒç”¨ a.move() // æ¥å£æ³¨å…¥ call(a) // ä¸ç¡®å®šå…·ä½“çš„å‚æ•° vat func1 = func(param any) {} func1 = func(param any) { fmt.Println(\u0026#34;call any\u0026#34;, param) } } func call(a animal) { fmt.Println(\u0026#34;call animal \\n\u0026#34;) a.move() } éœ€è¦æ³¨æ„çš„ç‚¹å’Œå‘ ä½¿ç”¨æ¥å£ä¼šè®©ç¼–è¯‘å™¨æ— æ³•ç¡®å®šæ•°æ®ç±»å‹ï¼Œå¯¼è‡´æ— æ³•å†ç¼–è¯‘é˜¶æ®µå‘ç°ç±»å‹é”™è¯¯ï¼Œå¼•å‘è¿è¡Œæ—¶é”™è¯¯ã€‚ ä½¿ç”¨æ¥å£ä¼šè®©ç¨‹åºå˜å¾—éš¾ä»¥é˜…è¯»å’Œç†è§£ã€‚ æ€§èƒ½ä¼šæŸå¤±å¤§æ¦‚ä¸€å€ reflect unsafe.pointer goè¯­è¨€unsafeåŒ…æä¾›äº†ä¸€äº›å‡½æ•°ï¼Œå¯ä»¥è·å–æŒ‡é’ˆï¼Œä¿®æ”¹æŒ‡é’ˆï¼Œè·å–æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ï¼Œä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ã€‚ ç®€å•æ¥è®²ï¼Œgoæœ¬èº«ä¸èƒ½æ“ä½œæŒ‡é’ˆï¼Œä½†æ˜¯æä¾›äº†reflectåŒ…è®©æˆ‘ä»¬å¯ä»¥æ“ä½œæŒ‡é’ˆæ¥è·å¾—ç¨‹åºçš„ æ€§èƒ½æå‡ã€‚\nå®šä¹‰ åœ¨è®¡ç®—æœºé¢†åŸŸï¼Œåå°„ï¼ˆReflectionï¼‰æ˜¯æŒ‡ç¨‹åºåœ¨è¿è¡Œæ—¶èƒ½å¤Ÿæ£€æŸ¥è‡ªèº«ï¼Œå¹¶è·å–å…¶å†…éƒ¨ä¿¡æ¯ã€‚å¯ä»¥ä¿®æ”¹æ•°æ®ï¼Œè°ƒç”¨æ–¹æ³•çš„ ä¸€ç§èƒ½åŠ›ã€‚ goè¯­è¨€æä¾›äº†ä¸€ç§åœ¨è¿è¡Œæ—¶èƒ½å¤Ÿè·å–æ•°æ®æœ¬èº«çš„çŠ¶æ€ï¼Œæ•°æ®ï¼Œå’Œè°ƒç”¨æ–¹æ³•çš„èƒ½åŠ›ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µ æ˜¯ä¸çŸ¥é“å…·ä½“çš„ç±»å‹çš„ï¼Œéœ€è¦åœ¨è¿è¡Œæ—¶ç¡®å®šã€‚\nä½¿ç”¨ å¸¸è§ä½¿ç”¨åœºæ™¯ å‡½æ•°å‚æ•°çš„åŠ¨æ€ä¼ å…¥ï¼Œé€šè¿‡reflectè·å–å‚æ•°çš„ç±»å‹ åŠ¨æ€ä¿®æ”¹åˆ‡ç‰‡ï¼Œmapï¼Œç»“æ„ä½“ åŠ¨æ€åˆ›å»ºå‡½æ•° GORM,é€šè¿‡åå°„è·å–ç»“æ„ä½“çš„tagæ¥æ„å»ºæ•°æ®çš„sqlè¯­å¥ ä½¿ç”¨æ–¹æ³• reflect.ValueOf(a) reflect.TypeOf((a) å¯¹æŒ‡é’ˆè§£å¼•ç”¨ reflect.ValueOf(a).Elem() è·å–æŒ‡é’ˆç±»å‹ reflect.TypeOf(a).Elem() è·å–tag reflect.TypeOf(a).Elem().Field(0).Tag.Get(\u0026#34;json\u0026#34;) è·å–å­—æ®µ reflect.TypeOf(a).Elem().Field(0) åŠ¨æ€åˆ›å»ºå‡½æ•° func1 := reflect.MakeFunc(reflect.TypeOf(func(param any) {}), func(args []reflect.Value) []reflect.Value {}) // åŠ¨æ€è°ƒç”¨å‡½æ•° func1.Call([]reflect.Value{reflect.ValueOf(param)}) éœ€è¦æ³¨æ„çš„ç‚¹å’Œå‘ ä½¿ç”¨åå°„ä¼šæŸå¤±æ€§èƒ½ ä½¿ç”¨åå°„ä¼šæ”¹å˜ä»£ç çš„å¯è¯»æ€§ ç¼–è¯‘å™¨ä¸èƒ½æ£€æŸ¥æ•°æ®ç±»å‹ï¼Œä¼šå¼•å‘è¿è¡Œæ—¶é”™è¯¯ ",
"tags":["go","interface","reflect"],
"categories":null
}]